output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (70, 32, 32, 3)
[INFOR]: shape of y: (70, 1)
[INFOR]: get pretrained model
2021-09-13 12:43:39.563942: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 12:43:39.587970: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:43:39.592353: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:43:39.600540: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:43:39.602601: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:43:39.607707: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:43:39.611055: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:43:39.617117: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:43:39.621955: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:43:39.625336: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:43:39.627510: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:43:39.629310: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 12:43:39.642124: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x19f3ada59e0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:43:39.645985: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 12:43:39.648000: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:43:39.652774: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:43:39.654839: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:43:39.657217: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:43:39.659324: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:43:39.661895: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:43:39.663992: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:43:39.666106: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:43:39.668174: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:43:39.670705: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:43:40.098305: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 12:43:40.100618: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 12:43:40.101976: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 12:43:40.103563: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 12:43:40.110650: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x19f634ce970 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:43:40.113528: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 12:43:42.360481: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 12:43:43.550471: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:43:44.209643: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:43:44.216710: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:43:45.577064: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:43:45.627033: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:43:46.192765: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 230ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :15.0


[INFOR]: Index of second most vote     :408
[INFOR]: Class of second most vote     :amphibian, amphibious vehicle
[INFOR]: Number of second most vote    :2.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 65ms/step
[INFOR]: Toltal norm before transform: 0.5426
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.2017

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 64ms/step
[INFOR]: SEN training of class 133_35 before transform: 15
[INFOR]: SPE training of class 133_35 before transform: 24

[INFOR]: SEN training of class 133_35 after transform: 34
[INFOR]: SPE training of class 133_35 after transform: 24
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (68, 32, 32, 3)
[INFOR]: shape of y: (68, 1)
3/3 [==============================] - 0s 63ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :10.0


[INFOR]: Index of second most vote     :427
[INFOR]: Class of second most vote     :barrel, cask
[INFOR]: Number of second most vote    :2.0
[INFOR]: SEN testing of class 133_34 before transform: 10
[INFOR]: SPE testing of class 133_34 before transform: 21

[INFOR]: SEN testing of class 133_34 after transform: 32
[INFOR]: SPE testing of class 133_34 after transform: 3
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name stanford_car --class_name_train 134_46 --class_name_test 134_46
2021-09-13 12:43:50.951805: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  stanford_car
class_name_train =  134_46
class_name_test =  134_46
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (92, 32, 32, 3)
[INFOR]: shape of y: (92, 1)
[INFOR]: get pretrained model
2021-09-13 12:43:53.466420: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 12:43:53.492299: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:43:53.497048: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:43:53.505220: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:43:53.507313: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:43:53.512376: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:43:53.515823: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:43:53.522138: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:43:53.526957: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:43:53.530168: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:43:53.532445: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:43:53.534334: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 12:43:53.547410: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x22f3b23a170 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:43:53.551213: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 12:43:53.553408: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:43:53.557957: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:43:53.560052: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:43:53.562223: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:43:53.564835: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:43:53.567039: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:43:53.569112: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:43:53.571303: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:43:53.574038: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:43:53.576098: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:43:54.008114: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 12:43:54.011165: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 12:43:54.012531: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 12:43:54.014019: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 12:43:54.021057: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x22f5c440880 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:43:54.024079: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 12:43:56.279845: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 12:43:57.467101: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:43:58.130138: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:43:58.138099: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:43:59.498484: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:43:59.553143: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:44:00.115869: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 298ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :13.0


[INFOR]: Index of second most vote     :408
[INFOR]: Class of second most vote     :amphibian, amphibious vehicle
[INFOR]: Number of second most vote    :6.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 81ms/step
[INFOR]: Toltal norm before transform: 0.7098
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0467

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 80ms/step
[INFOR]: SEN training of class 134_46 before transform: 13
[INFOR]: SPE training of class 134_46 before transform: 33

[INFOR]: SEN training of class 134_46 after transform: 46
[INFOR]: SPE training of class 134_46 after transform: 33
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (92, 32, 32, 3)
[INFOR]: shape of y: (92, 1)
3/3 [==============================] - 0s 81ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :8.0


[INFOR]: Index of second most vote     :408
[INFOR]: Class of second most vote     :amphibian, amphibious vehicle
[INFOR]: Number of second most vote    :6.0
[INFOR]: SEN testing of class 134_46 before transform: 8
[INFOR]: SPE testing of class 134_46 before transform: 31

[INFOR]: SEN testing of class 134_46 after transform: 46
[INFOR]: SPE testing of class 134_46 after transform: 1
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name stanford_car --class_name_train 135_45 --class_name_test 135_44
2021-09-13 12:44:04.791137: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  stanford_car
class_name_train =  135_45
class_name_test =  135_44
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (90, 32, 32, 3)
[INFOR]: shape of y: (90, 1)
[INFOR]: get pretrained model
2021-09-13 12:44:07.324928: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 12:44:07.351111: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:44:07.356097: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:44:07.364391: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:44:07.366790: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:44:07.372868: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:44:07.376790: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:44:07.383748: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:44:07.389011: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:44:07.392280: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:44:07.394649: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:44:07.397071: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 12:44:07.410042: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x21d37220fa0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:44:07.413354: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 12:44:07.416040: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:44:07.420679: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:44:07.423591: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:44:07.425968: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:44:07.428265: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:44:07.430361: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:44:07.432984: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:44:07.435227: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:44:07.437411: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:44:07.439571: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:44:07.867026: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 12:44:07.870362: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 12:44:07.871727: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 12:44:07.873205: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 12:44:07.880389: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x21d675b8930 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:44:07.883382: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 12:44:10.132074: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 12:44:11.309963: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:44:11.970563: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:44:11.977608: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:44:13.343247: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:44:13.391895: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:44:13.953365: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 291ms/step
[INFOR]: Index of most vote   :482
[INFOR]: Class of most vote   :cassette player
[INFOR]: Number of most vote  :7.0


[INFOR]: Index of second most vote     :674
[INFOR]: Class of second most vote     :mousetrap
[INFOR]: Number of second most vote    :6.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 80ms/step
[INFOR]: Toltal norm before transform: 0.8337
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.2959

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 80ms/step
[INFOR]: SEN training of class 135_45 before transform: 7
[INFOR]: SPE training of class 135_45 before transform: 43

[INFOR]: SEN training of class 135_45 after transform: 41
[INFOR]: SPE training of class 135_45 after transform: 40
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (88, 32, 32, 3)
[INFOR]: shape of y: (88, 1)
3/3 [==============================] - 0s 78ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :19.0


[INFOR]: Index of second most vote     :408
[INFOR]: Class of second most vote     :amphibian, amphibious vehicle
[INFOR]: Number of second most vote    :4.0
[INFOR]: SEN testing of class 135_44 before transform: 19
[INFOR]: SPE testing of class 135_44 before transform: 34

[INFOR]: SEN testing of class 135_44 after transform: 44
[INFOR]: SPE testing of class 135_44 after transform: 0
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name stanford_car --class_name_train 136_33 --class_name_test 136_32
2021-09-13 12:44:19.053531: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  stanford_car
class_name_train =  136_33
class_name_test =  136_32
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
[INFOR]: get pretrained model
2021-09-13 12:44:21.588461: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 12:44:21.613243: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:44:21.617786: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:44:21.626034: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:44:21.628247: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:44:21.633319: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:44:21.636736: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:44:21.642893: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:44:21.647775: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:44:21.650956: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:44:21.653031: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:44:21.654897: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 12:44:21.668097: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x24d34357a70 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:44:21.671289: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 12:44:21.673349: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:44:21.678129: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:44:21.680315: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:44:21.682441: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:44:21.684604: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:44:21.687165: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:44:21.689436: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:44:21.691518: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:44:21.693635: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:44:21.696070: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:44:22.118549: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 12:44:22.121645: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 12:44:22.123009: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 12:44:22.124497: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 12:44:22.131753: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x24d5d3972c0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:44:22.134595: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 12:44:24.402899: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 12:44:25.604340: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:44:26.263665: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:44:26.270729: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:44:27.633524: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:44:27.683691: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:44:28.249891: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 218ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :4.0


[INFOR]: Index of second most vote     :510
[INFOR]: Class of second most vote     :container ship, containership, container vessel
[INFOR]: Number of second most vote    :3.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 62ms/step
[INFOR]: Toltal norm before transform: 0.8697
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1234

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 62ms/step
[INFOR]: SEN training of class 136_33 before transform: 4
[INFOR]: SPE training of class 136_33 before transform: 22

[INFOR]: SEN training of class 136_33 after transform: 32
[INFOR]: SPE training of class 136_33 after transform: 22
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (64, 32, 32, 3)
[INFOR]: shape of y: (64, 1)
2/2 [==============================] - 1s 108ms/step
[INFOR]: Index of most vote   :510
[INFOR]: Class of most vote   :container ship, containership, container vessel
[INFOR]: Number of most vote  :5.0


[INFOR]: Index of second most vote     :674
[INFOR]: Class of second most vote     :mousetrap
[INFOR]: Number of second most vote    :4.0
[INFOR]: SEN testing of class 136_32 before transform: 5
[INFOR]: SPE testing of class 136_32 before transform: 30

[INFOR]: SEN testing of class 136_32 after transform: 32
[INFOR]: SPE testing of class 136_32 after transform: 0
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name stanford_car --class_name_train 137_44 --class_name_test 137_43
2021-09-13 12:44:34.840017: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  stanford_car
class_name_train =  137_44
class_name_test =  137_43
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (88, 32, 32, 3)
[INFOR]: shape of y: (88, 1)
[INFOR]: get pretrained model
2021-09-13 12:44:37.340969: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 12:44:37.413314: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:44:37.417978: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:44:37.426003: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:44:37.428167: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:44:37.433475: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:44:37.437157: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:44:37.443591: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:44:37.448630: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:44:37.451979: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:44:37.454352: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:44:37.456377: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 12:44:37.468849: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x248b6049e40 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:44:37.471926: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 12:44:37.474009: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:44:37.478686: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:44:37.480828: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:44:37.482949: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:44:37.485060: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:44:37.487584: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:44:37.489711: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:44:37.491851: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:44:37.493952: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:44:37.496530: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:44:37.929610: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 12:44:37.932695: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 12:44:37.934026: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 12:44:37.935533: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 12:44:37.942614: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x248e4496300 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:44:37.945485: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 12:44:40.203173: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 12:44:41.393696: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:44:42.056564: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:44:42.064245: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:44:43.430271: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:44:43.479859: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:44:44.043515: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 279ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :8.0


[INFOR]: Index of second most vote     :491
[INFOR]: Class of second most vote     :chain saw, chainsaw
[INFOR]: Number of second most vote    :4.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 78ms/step
[INFOR]: Toltal norm before transform: 0.8292
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0869

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 78ms/step
[INFOR]: SEN training of class 137_44 before transform: 8
[INFOR]: SPE training of class 137_44 before transform: 28

[INFOR]: SEN training of class 137_44 after transform: 44
[INFOR]: SPE training of class 137_44 after transform: 28
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (86, 32, 32, 3)
[INFOR]: shape of y: (86, 1)
3/3 [==============================] - 0s 77ms/step
[INFOR]: Index of most vote   :510
[INFOR]: Class of most vote   :container ship, containership, container vessel
[INFOR]: Number of most vote  :5.0


[INFOR]: Index of second most vote     :674
[INFOR]: Class of second most vote     :mousetrap
[INFOR]: Number of second most vote    :5.0
[INFOR]: SEN testing of class 137_43 before transform: 5
[INFOR]: SPE testing of class 137_43 before transform: 40

[INFOR]: SEN testing of class 137_43 after transform: 43
[INFOR]: SPE testing of class 137_43 after transform: 7
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name stanford_car --class_name_train 138_35 --class_name_test 138_35
2021-09-13 12:44:49.082245: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  stanford_car
class_name_train =  138_35
class_name_test =  138_35
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (70, 32, 32, 3)
[INFOR]: shape of y: (70, 1)
[INFOR]: get pretrained model
2021-09-13 12:44:51.626833: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 12:44:51.653086: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:44:51.658204: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:44:51.666053: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:44:51.668220: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:44:51.673513: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:44:51.676866: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:44:51.682991: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:44:51.688109: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:44:51.691654: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:44:51.693795: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:44:51.695671: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 12:44:51.708133: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x29239ce2b90 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:44:51.711476: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 12:44:51.713476: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:44:51.718192: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:44:51.720411: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:44:51.722542: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:44:51.724662: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:44:51.727231: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:44:51.729284: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:44:51.731522: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:44:51.733649: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:44:51.736164: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:44:52.169594: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 12:44:52.172516: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 12:44:52.173863: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 12:44:52.175341: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 12:44:52.182324: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x2926895ed30 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:44:52.185216: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 12:44:54.430809: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 12:44:55.604718: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:44:56.265606: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:44:56.272227: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:44:57.643810: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:44:57.699226: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:44:58.264970: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 232ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :13.0


[INFOR]: Index of second most vote     :482
[INFOR]: Class of second most vote     :cassette player
[INFOR]: Number of second most vote    :3.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 65ms/step
[INFOR]: Toltal norm before transform: 0.6070
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0424

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 64ms/step
[INFOR]: SEN training of class 138_35 before transform: 13
[INFOR]: SPE training of class 138_35 before transform: 24

[INFOR]: SEN training of class 138_35 after transform: 34
[INFOR]: SPE training of class 138_35 after transform: 24
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (70, 32, 32, 3)
[INFOR]: shape of y: (70, 1)
3/3 [==============================] - 0s 65ms/step
[INFOR]: Index of most vote   :408
[INFOR]: Class of most vote   :amphibian, amphibious vehicle
[INFOR]: Number of most vote  :8.0


[INFOR]: Index of second most vote     :674
[INFOR]: Class of second most vote     :mousetrap
[INFOR]: Number of second most vote    :6.0
[INFOR]: SEN testing of class 138_35 before transform: 8
[INFOR]: SPE testing of class 138_35 before transform: 28

[INFOR]: SEN testing of class 138_35 after transform: 35
[INFOR]: SPE testing of class 138_35 after transform: 1
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name stanford_car --class_name_train 139_43 --class_name_test 139_42
2021-09-13 12:45:02.656426: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  stanford_car
class_name_train =  139_43
class_name_test =  139_42
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (86, 32, 32, 3)
[INFOR]: shape of y: (86, 1)
[INFOR]: get pretrained model
2021-09-13 12:45:05.165316: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 12:45:05.189461: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:45:05.193985: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:45:05.202115: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:45:05.204259: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:45:05.209380: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:45:05.212781: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:45:05.219118: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:45:05.224220: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:45:05.227436: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:45:05.229506: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:45:05.231336: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 12:45:05.243688: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1e8b435a720 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:45:05.247132: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 12:45:05.249151: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:45:05.253752: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:45:05.255889: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:45:05.257974: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:45:05.260152: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:45:05.262618: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:45:05.264711: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:45:05.266844: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:45:05.269173: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:45:05.271911: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:45:05.705017: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 12:45:05.707971: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 12:45:05.709334: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 12:45:05.710838: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 12:45:05.718115: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1e8e3e71520 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:45:05.721045: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 12:45:07.961198: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 12:45:09.143722: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:45:09.807735: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:45:09.814853: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:45:11.169576: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:45:11.217873: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:45:11.778034: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 277ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :17.0


[INFOR]: Index of second most vote     :408
[INFOR]: Class of second most vote     :amphibian, amphibious vehicle
[INFOR]: Number of second most vote    :11.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 76ms/step
[INFOR]: Toltal norm before transform: 0.5826
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1111

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 77ms/step
[INFOR]: SEN training of class 139_43 before transform: 17
[INFOR]: SPE training of class 139_43 before transform: 27

[INFOR]: SEN training of class 139_43 after transform: 41
[INFOR]: SPE training of class 139_43 after transform: 27
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (84, 32, 32, 3)
[INFOR]: shape of y: (84, 1)
3/3 [==============================] - 0s 76ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :20.0


[INFOR]: Index of second most vote     :408
[INFOR]: Class of second most vote     :amphibian, amphibious vehicle
[INFOR]: Number of second most vote    :8.0
[INFOR]: SEN testing of class 139_42 before transform: 20
[INFOR]: SPE testing of class 139_42 before transform: 28

[INFOR]: SEN testing of class 139_42 after transform: 41
[INFOR]: SPE testing of class 139_42 after transform: 2
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name stanford_car --class_name_train 140_38 --class_name_test 140_37
2021-09-13 12:45:16.810825: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  stanford_car
class_name_train =  140_38
class_name_test =  140_37
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (76, 32, 32, 3)
[INFOR]: shape of y: (76, 1)
[INFOR]: get pretrained model
2021-09-13 12:45:19.343389: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 12:45:19.370335: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:45:19.375042: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:45:19.383447: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:45:19.385722: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:45:19.390916: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:45:19.394397: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:45:19.400851: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:45:19.405890: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:45:19.409243: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:45:19.411505: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:45:19.413484: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 12:45:19.426628: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x22eba281a20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:45:19.430250: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 12:45:19.432442: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:45:19.437189: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:45:19.439369: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:45:19.441558: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:45:19.444149: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:45:19.446268: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:45:19.448344: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:45:19.450772: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:45:19.453457: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:45:19.455543: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:45:19.881940: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 12:45:19.885150: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 12:45:19.886501: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 12:45:19.887976: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 12:45:19.895248: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x22ee5fbaa80 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:45:19.898311: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 12:45:22.155425: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 12:45:23.340391: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:45:23.998979: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:45:24.005911: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:45:25.372618: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:45:25.424066: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:45:25.988026: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 249ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :16.0


[INFOR]: Index of second most vote     :408
[INFOR]: Class of second most vote     :amphibian, amphibious vehicle
[INFOR]: Number of second most vote    :4.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 69ms/step
[INFOR]: Toltal norm before transform: 0.5750
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1062

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 69ms/step
[INFOR]: SEN training of class 140_38 before transform: 16
[INFOR]: SPE training of class 140_38 before transform: 22

[INFOR]: SEN training of class 140_38 after transform: 38
[INFOR]: SPE training of class 140_38 after transform: 22
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (74, 32, 32, 3)
[INFOR]: shape of y: (74, 1)
3/3 [==============================] - 0s 68ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :10.0


[INFOR]: Index of second most vote     :408
[INFOR]: Class of second most vote     :amphibian, amphibious vehicle
[INFOR]: Number of second most vote    :4.0
[INFOR]: SEN testing of class 140_37 before transform: 10
[INFOR]: SPE testing of class 140_37 before transform: 22

[INFOR]: SEN testing of class 140_37 after transform: 37
[INFOR]: SPE testing of class 140_37 after transform: 0
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name stanford_car --class_name_train 141_41 --class_name_test 141_40
2021-09-13 12:45:30.825074: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  stanford_car
class_name_train =  141_41
class_name_test =  141_40
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (82, 32, 32, 3)
[INFOR]: shape of y: (82, 1)
[INFOR]: get pretrained model
2021-09-13 12:45:33.368382: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 12:45:33.395637: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:45:33.400829: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:45:33.408956: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:45:33.411007: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:45:33.416237: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:45:33.419519: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:45:33.425687: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:45:33.430704: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:45:33.433939: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:45:33.436134: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:45:33.438032: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 12:45:33.450392: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x26bb9a66970 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:45:33.453575: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 12:45:33.455575: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:45:33.460300: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:45:33.462441: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:45:33.464651: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:45:33.466760: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:45:33.469265: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:45:33.471363: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:45:33.473617: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:45:33.475720: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:45:33.478259: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:45:33.910539: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 12:45:33.913436: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 12:45:33.914783: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 12:45:33.916277: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 12:45:33.923344: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x26be9841990 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:45:33.926162: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 12:45:36.183941: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 12:45:37.359798: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:45:38.019544: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:45:38.025996: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:45:39.392617: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:45:39.445661: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:45:40.007375: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 265ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :19.0


[INFOR]: Index of second most vote     :408
[INFOR]: Class of second most vote     :amphibian, amphibious vehicle
[INFOR]: Number of second most vote    :3.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 73ms/step
[INFOR]: Toltal norm before transform: 0.4946
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0044

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 73ms/step
[INFOR]: SEN training of class 141_41 before transform: 19
[INFOR]: SPE training of class 141_41 before transform: 24

[INFOR]: SEN training of class 141_41 after transform: 40
[INFOR]: SPE training of class 141_41 after transform: 24
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (80, 32, 32, 3)
[INFOR]: shape of y: (80, 1)
3/3 [==============================] - 0s 72ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :21.0


[INFOR]: Index of second most vote     :482
[INFOR]: Class of second most vote     :cassette player
[INFOR]: Number of second most vote    :4.0
[INFOR]: SEN testing of class 141_40 before transform: 21
[INFOR]: SPE testing of class 141_40 before transform: 22

[INFOR]: SEN testing of class 141_40 after transform: 40
[INFOR]: SPE testing of class 141_40 after transform: 0
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name stanford_car --class_name_train 142_42 --class_name_test 142_42
2021-09-13 12:45:44.898728: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  stanford_car
class_name_train =  142_42
class_name_test =  142_42
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (84, 32, 32, 3)
[INFOR]: shape of y: (84, 1)
[INFOR]: get pretrained model
2021-09-13 12:45:47.421791: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 12:45:47.446793: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:45:47.452093: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:45:47.460238: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:45:47.462375: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:45:47.467526: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:45:47.470865: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:45:47.477287: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:45:47.482332: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:45:47.485579: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:45:47.487757: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:45:47.489721: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 12:45:47.502511: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x2a23763d5b0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:45:47.505820: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 12:45:47.507843: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:45:47.512503: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:45:47.514683: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:45:47.516956: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:45:47.519497: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:45:47.521651: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:45:47.523740: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:45:47.525960: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:45:47.528483: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:45:47.530773: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:45:47.959568: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 12:45:47.963155: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 12:45:47.964505: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 12:45:47.965997: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 12:45:47.973724: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x2a26713f2c0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:45:47.976614: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 12:45:50.236341: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 12:45:51.416808: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:45:52.076945: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:45:52.083906: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:45:53.449767: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:45:53.499726: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:45:54.063468: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 271ms/step
[INFOR]: Index of most vote   :408
[INFOR]: Class of most vote   :amphibian, amphibious vehicle
[INFOR]: Number of most vote  :11.0


[INFOR]: Index of second most vote     :674
[INFOR]: Class of second most vote     :mousetrap
[INFOR]: Number of second most vote    :8.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 75ms/step
[INFOR]: Toltal norm before transform: 0.6988
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.2328

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 75ms/step
[INFOR]: SEN training of class 142_42 before transform: 11
[INFOR]: SPE training of class 142_42 before transform: 37

[INFOR]: SEN training of class 142_42 after transform: 41
[INFOR]: SPE training of class 142_42 after transform: 37
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (84, 32, 32, 3)
[INFOR]: shape of y: (84, 1)
3/3 [==============================] - 0s 75ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :22.0


[INFOR]: Index of second most vote     :408
[INFOR]: Class of second most vote     :amphibian, amphibious vehicle
[INFOR]: Number of second most vote    :6.0
[INFOR]: SEN testing of class 142_42 before transform: 22
[INFOR]: SPE testing of class 142_42 before transform: 24

[INFOR]: SEN testing of class 142_42 after transform: 41
[INFOR]: SPE testing of class 142_42 after transform: 0
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name stanford_car --class_name_train 143_43 --class_name_test 143_43
2021-09-13 12:45:58.629681: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  stanford_car
class_name_train =  143_43
class_name_test =  143_43
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (86, 32, 32, 3)
[INFOR]: shape of y: (86, 1)
[INFOR]: get pretrained model
2021-09-13 12:46:01.169740: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 12:46:01.194285: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:46:01.199669: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:46:01.208127: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:46:01.210423: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:46:01.215963: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:46:01.219482: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:46:01.226392: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:46:01.232261: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:46:01.235278: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:46:01.237489: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:46:01.239805: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 12:46:01.251702: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x24d3361b6f0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:46:01.255027: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 12:46:01.257398: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:46:01.261720: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:46:01.263857: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:46:01.266451: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:46:01.268630: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:46:01.270777: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:46:01.272881: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:46:01.275441: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:46:01.277583: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:46:01.279674: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:46:01.711504: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 12:46:01.714565: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 12:46:01.715930: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 12:46:01.717420: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 12:46:01.724575: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x24d6231e860 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:46:01.727586: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 12:46:03.972428: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 12:46:05.166474: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:46:05.847641: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:46:05.854094: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:46:07.237489: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:46:07.293189: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:46:07.856255: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 279ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :5.0


[INFOR]: Index of second most vote     :491
[INFOR]: Class of second most vote     :chain saw, chainsaw
[INFOR]: Number of second most vote    :4.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 77ms/step
[INFOR]: Toltal norm before transform: 0.8881
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0512

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 77ms/step
[INFOR]: SEN training of class 143_43 before transform: 5
[INFOR]: SPE training of class 143_43 before transform: 31

[INFOR]: SEN training of class 143_43 after transform: 41
[INFOR]: SPE training of class 143_43 after transform: 31
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (86, 32, 32, 3)
[INFOR]: shape of y: (86, 1)
3/3 [==============================] - 0s 77ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :9.0


[INFOR]: Index of second most vote     :147
[INFOR]: Class of second most vote     :grey whale, gray whale, devilfish, Eschrichtius gibbosus, Eschrichtius robustus
[INFOR]: Number of second most vote    :4.0
[INFOR]: SEN testing of class 143_43 before transform: 9
[INFOR]: SPE testing of class 143_43 before transform: 23

[INFOR]: SEN testing of class 143_43 after transform: 41
[INFOR]: SPE testing of class 143_43 after transform: 1
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name stanford_car --class_name_train 144_41 --class_name_test 144_41
2021-09-13 12:46:12.466997: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  stanford_car
class_name_train =  144_41
class_name_test =  144_41
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (82, 32, 32, 3)
[INFOR]: shape of y: (82, 1)
[INFOR]: get pretrained model
2021-09-13 12:46:15.007600: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 12:46:15.034129: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:46:15.038461: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:46:15.046462: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:46:15.048571: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:46:15.053699: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:46:15.057009: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:46:15.063237: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:46:15.068187: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:46:15.071530: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:46:15.073753: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:46:15.075602: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 12:46:15.087929: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1d4b45658a0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:46:15.091270: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 12:46:15.093242: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:46:15.097877: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:46:15.100023: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:46:15.102161: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:46:15.104401: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:46:15.106945: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:46:15.109026: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:46:15.111235: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:46:15.113481: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:46:15.115947: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:46:15.545533: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 12:46:15.548662: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 12:46:15.550016: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 12:46:15.551612: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 12:46:15.558704: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1d4e3cb3560 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:46:15.561621: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 12:46:17.841692: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 12:46:19.047160: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:46:19.707718: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:46:19.714668: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:46:21.087444: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:46:21.136136: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:46:21.698452: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 268ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :12.0


[INFOR]: Index of second most vote     :408
[INFOR]: Class of second most vote     :amphibian, amphibious vehicle
[INFOR]: Number of second most vote    :5.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 74ms/step
[INFOR]: Toltal norm before transform: 0.6687
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1877

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 75ms/step
[INFOR]: SEN training of class 144_41 before transform: 12
[INFOR]: SPE training of class 144_41 before transform: 29

[INFOR]: SEN training of class 144_41 after transform: 41
[INFOR]: SPE training of class 144_41 after transform: 29
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (82, 32, 32, 3)
[INFOR]: shape of y: (82, 1)
3/3 [==============================] - 0s 75ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :19.0


[INFOR]: Index of second most vote     :482
[INFOR]: Class of second most vote     :cassette player
[INFOR]: Number of second most vote    :6.0
[INFOR]: SEN testing of class 144_41 before transform: 19
[INFOR]: SPE testing of class 144_41 before transform: 29

[INFOR]: SEN testing of class 144_41 after transform: 41
[INFOR]: SPE testing of class 144_41 after transform: 0
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name stanford_car --class_name_train 145_45 --class_name_test 145_44
2021-09-13 12:46:26.333378: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  stanford_car
class_name_train =  145_45
class_name_test =  145_44
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (90, 32, 32, 3)
[INFOR]: shape of y: (90, 1)
[INFOR]: get pretrained model
2021-09-13 12:46:28.950748: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 12:46:28.975746: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:46:28.980557: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:46:28.988679: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:46:28.990855: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:46:28.996129: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:46:28.999619: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:46:29.005918: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:46:29.011163: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:46:29.014532: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:46:29.016724: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:46:29.018743: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 12:46:29.031378: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x172b608abc0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:46:29.034357: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 12:46:29.036435: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:46:29.041288: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:46:29.043528: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:46:29.045710: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:46:29.048372: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:46:29.050687: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:46:29.052863: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:46:29.055119: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:46:29.057945: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:46:29.060150: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:46:29.500633: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 12:46:29.503903: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 12:46:29.505444: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 12:46:29.507067: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 12:46:29.514644: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x172e5cebf70 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:46:29.517780: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 12:46:31.774670: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 12:46:32.954637: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:46:33.621680: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:46:33.628342: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:46:34.994753: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:46:35.044798: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:46:35.605752: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 289ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :16.0


[INFOR]: Index of second most vote     :408
[INFOR]: Class of second most vote     :amphibian, amphibious vehicle
[INFOR]: Number of second most vote    :4.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 79ms/step
[INFOR]: Toltal norm before transform: 0.5728
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.2317

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 79ms/step
[INFOR]: SEN training of class 145_45 before transform: 16
[INFOR]: SPE training of class 145_45 before transform: 23

[INFOR]: SEN training of class 145_45 after transform: 45
[INFOR]: SPE training of class 145_45 after transform: 23
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (88, 32, 32, 3)
[INFOR]: shape of y: (88, 1)
3/3 [==============================] - 0s 77ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :16.0


[INFOR]: Index of second most vote     :408
[INFOR]: Class of second most vote     :amphibian, amphibious vehicle
[INFOR]: Number of second most vote    :6.0
[INFOR]: SEN testing of class 145_44 before transform: 16
[INFOR]: SPE testing of class 145_44 before transform: 22

[INFOR]: SEN testing of class 145_44 after transform: 44
[INFOR]: SPE testing of class 145_44 after transform: 0
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name stanford_car --class_name_train 146_40 --class_name_test 146_40
2021-09-13 12:46:40.684638: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  stanford_car
class_name_train =  146_40
class_name_test =  146_40
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (80, 32, 32, 3)
[INFOR]: shape of y: (80, 1)
[INFOR]: get pretrained model
2021-09-13 12:46:43.222449: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 12:46:43.249535: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:46:43.254131: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:46:43.262222: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:46:43.264397: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:46:43.269583: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:46:43.272897: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:46:43.279143: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:46:43.284122: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:46:43.287593: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:46:43.289852: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:46:43.291716: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 12:46:43.304426: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1a337731e40 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:46:43.308133: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 12:46:43.310152: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:46:43.314985: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:46:43.317229: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:46:43.319333: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:46:43.321437: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:46:43.324129: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:46:43.326221: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:46:43.328333: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:46:43.330868: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:46:43.332957: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:46:43.763222: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 12:46:43.766284: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 12:46:43.767650: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 12:46:43.769120: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 12:46:43.776146: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1a362ec2f30 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:46:43.778960: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 12:46:46.018606: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 12:46:47.199895: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:46:47.856172: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:46:47.863613: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:46:49.228125: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:46:49.278531: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:46:49.843802: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 253ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :15.0


[INFOR]: Index of second most vote     :408
[INFOR]: Class of second most vote     :amphibian, amphibious vehicle
[INFOR]: Number of second most vote    :8.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 72ms/step
[INFOR]: Toltal norm before transform: 0.5991
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1376

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 72ms/step
[INFOR]: SEN training of class 146_40 before transform: 15
[INFOR]: SPE training of class 146_40 before transform: 24

[INFOR]: SEN training of class 146_40 after transform: 40
[INFOR]: SPE training of class 146_40 after transform: 24
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (80, 32, 32, 3)
[INFOR]: shape of y: (80, 1)
3/3 [==============================] - 0s 72ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :15.0


[INFOR]: Index of second most vote     :408
[INFOR]: Class of second most vote     :amphibian, amphibious vehicle
[INFOR]: Number of second most vote    :6.0
[INFOR]: SEN testing of class 146_40 before transform: 15
[INFOR]: SPE testing of class 146_40 before transform: 29

[INFOR]: SEN testing of class 146_40 after transform: 40
[INFOR]: SPE testing of class 146_40 after transform: 0
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name stanford_car --class_name_train 147_40 --class_name_test 147_39
2021-09-13 12:46:54.359200: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  stanford_car
class_name_train =  147_40
class_name_test =  147_39
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (80, 32, 32, 3)
[INFOR]: shape of y: (80, 1)
[INFOR]: get pretrained model
2021-09-13 12:46:56.854842: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 12:46:56.881022: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:46:56.886003: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:46:56.893849: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:46:56.895981: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:46:56.901120: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:46:56.904562: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:46:56.910819: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:46:56.915858: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:46:56.919106: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:46:56.921316: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:46:56.923206: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 12:46:56.935176: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x15c39d536d0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:46:56.938740: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 12:46:56.940790: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:46:56.945671: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:46:56.947808: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:46:56.949903: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:46:56.952021: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:46:56.954544: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:46:56.956637: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:46:56.958752: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:46:56.960977: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:46:56.963494: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:46:57.413155: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 12:46:57.416120: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 12:46:57.417490: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 12:46:57.418956: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 12:46:57.426026: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x15c684d7570 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:46:57.429072: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 12:46:59.702365: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 12:47:00.890130: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:47:01.548210: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:47:01.555143: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:47:02.914771: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:47:02.964374: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:47:03.530362: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 254ms/step
[INFOR]: Index of most vote   :408
[INFOR]: Class of most vote   :amphibian, amphibious vehicle
[INFOR]: Number of most vote  :10.0


[INFOR]: Index of second most vote     :674
[INFOR]: Class of second most vote     :mousetrap
[INFOR]: Number of second most vote    :7.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 72ms/step
[INFOR]: Toltal norm before transform: 0.7339
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.2871

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 71ms/step
[INFOR]: SEN training of class 147_40 before transform: 10
[INFOR]: SPE training of class 147_40 before transform: 35

[INFOR]: SEN training of class 147_40 after transform: 40
[INFOR]: SPE training of class 147_40 after transform: 35
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (78, 32, 32, 3)
[INFOR]: shape of y: (78, 1)
3/3 [==============================] - 0s 71ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :9.0


[INFOR]: Index of second most vote     :510
[INFOR]: Class of second most vote     :container ship, containership, container vessel
[INFOR]: Number of second most vote    :7.0
[INFOR]: SEN testing of class 147_39 before transform: 9
[INFOR]: SPE testing of class 147_39 before transform: 24

[INFOR]: SEN testing of class 147_39 after transform: 39
[INFOR]: SPE testing of class 147_39 after transform: 0
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name stanford_car --class_name_train 148_47 --class_name_test 148_46
2021-09-13 12:47:08.425709: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  stanford_car
class_name_train =  148_47
class_name_test =  148_46
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (94, 32, 32, 3)
[INFOR]: shape of y: (94, 1)
[INFOR]: get pretrained model
2021-09-13 12:47:10.946641: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 12:47:10.971758: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:47:10.976349: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:47:10.984446: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:47:10.986556: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:47:10.991618: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:47:10.994990: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:47:11.001346: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:47:11.006294: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:47:11.009471: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:47:11.011556: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:47:11.013383: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 12:47:11.026342: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x15fba667e40 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:47:11.030007: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 12:47:11.031961: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:47:11.036543: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:47:11.038717: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:47:11.040793: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:47:11.042900: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:47:11.045418: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:47:11.047490: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:47:11.049639: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:47:11.051742: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:47:11.054224: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:47:11.475045: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 12:47:11.478063: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 12:47:11.479411: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 12:47:11.480871: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 12:47:11.487956: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x15fe9f40000 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:47:11.490846: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 12:47:13.779381: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 12:47:14.964870: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:47:15.631007: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:47:15.637707: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:47:16.999131: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:47:17.049868: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:47:17.614651: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 301ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :10.0


[INFOR]: Index of second most vote     :482
[INFOR]: Class of second most vote     :cassette player
[INFOR]: Number of second most vote    :5.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 82ms/step
[INFOR]: Toltal norm before transform: 0.7809
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0146

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 82ms/step
[INFOR]: SEN training of class 148_47 before transform: 10
[INFOR]: SPE training of class 148_47 before transform: 30

[INFOR]: SEN training of class 148_47 after transform: 47
[INFOR]: SPE training of class 148_47 after transform: 30
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (92, 32, 32, 3)
[INFOR]: shape of y: (92, 1)
3/3 [==============================] - 0s 82ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :6.0


[INFOR]: Index of second most vote     :502
[INFOR]: Class of second most vote     :clog, geta, patten, sabot
[INFOR]: Number of second most vote    :5.0
[INFOR]: SEN testing of class 148_46 before transform: 6
[INFOR]: SPE testing of class 148_46 before transform: 25

[INFOR]: SEN testing of class 148_46 after transform: 46
[INFOR]: SPE testing of class 148_46 after transform: 1
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name stanford_car --class_name_train 149_38 --class_name_test 149_37
2021-09-13 12:47:22.777839: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  stanford_car
class_name_train =  149_38
class_name_test =  149_37
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (76, 32, 32, 3)
[INFOR]: shape of y: (76, 1)
[INFOR]: get pretrained model
2021-09-13 12:47:25.299383: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 12:47:25.324425: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:47:25.329328: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:47:25.337365: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:47:25.339698: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:47:25.345276: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:47:25.348816: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:47:25.355602: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:47:25.360723: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:47:25.363590: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:47:25.366257: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:47:25.368197: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 12:47:25.381150: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x18f36529c70 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:47:25.384826: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 12:47:25.387330: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:47:25.391526: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:47:25.393765: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:47:25.395843: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:47:25.398402: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:47:25.400620: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:47:25.402696: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:47:25.405257: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:47:25.407354: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:47:25.409496: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:47:25.843872: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 12:47:25.846964: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 12:47:25.848459: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 12:47:25.850085: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 12:47:25.857344: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x18f64f14560 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:47:25.860290: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 12:47:28.120691: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 12:47:29.321805: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:47:29.982035: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:47:29.989175: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:47:31.347292: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:47:31.397099: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:47:31.961121: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 248ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :10.0


[INFOR]: Index of second most vote     :510
[INFOR]: Class of second most vote     :container ship, containership, container vessel
[INFOR]: Number of second most vote    :7.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 68ms/step
[INFOR]: Toltal norm before transform: 0.7275
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.2769

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 69ms/step
[INFOR]: SEN training of class 149_38 before transform: 10
[INFOR]: SPE training of class 149_38 before transform: 26

[INFOR]: SEN training of class 149_38 after transform: 38
[INFOR]: SPE training of class 149_38 after transform: 26
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (74, 32, 32, 3)
[INFOR]: shape of y: (74, 1)
3/3 [==============================] - 0s 68ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :10.0


[INFOR]: Index of second most vote     :510
[INFOR]: Class of second most vote     :container ship, containership, container vessel
[INFOR]: Number of second most vote    :7.0
[INFOR]: SEN testing of class 149_37 before transform: 10
[INFOR]: SPE testing of class 149_37 before transform: 20

[INFOR]: SEN testing of class 149_37 after transform: 37
[INFOR]: SPE testing of class 149_37 after transform: 0
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name stanford_car --class_name_train 150_44 --class_name_test 150_44
2021-09-13 12:47:36.785506: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  stanford_car
class_name_train =  150_44
class_name_test =  150_44
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (88, 32, 32, 3)
[INFOR]: shape of y: (88, 1)
[INFOR]: get pretrained model
2021-09-13 12:47:39.317153: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 12:47:39.342712: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:47:39.347596: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:47:39.355908: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:47:39.358062: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:47:39.363554: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:47:39.366920: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:47:39.373519: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:47:39.378570: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:47:39.381534: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:47:39.383663: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:47:39.385540: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 12:47:39.397907: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x2af39eb62d0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:47:39.401100: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 12:47:39.403063: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:47:39.407839: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:47:39.409981: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:47:39.412079: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:47:39.414637: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:47:39.416758: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:47:39.418863: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:47:39.420996: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:47:39.423493: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:47:39.425615: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:47:39.851271: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 12:47:39.854260: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 12:47:39.855598: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 12:47:39.857064: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 12:47:39.864131: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x2af6317b580 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:47:39.866910: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 12:47:42.129297: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 12:47:43.314732: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:47:43.975275: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:47:43.982219: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:47:45.338723: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:47:45.388507: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:47:45.948342: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 277ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :17.0


[INFOR]: Index of second most vote     :408
[INFOR]: Class of second most vote     :amphibian, amphibious vehicle
[INFOR]: Number of second most vote    :10.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 77ms/step
[INFOR]: Toltal norm before transform: 0.5587
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0335

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 78ms/step
[INFOR]: SEN training of class 150_44 before transform: 17
[INFOR]: SPE training of class 150_44 before transform: 26

[INFOR]: SEN training of class 150_44 after transform: 37
[INFOR]: SPE training of class 150_44 after transform: 26
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (88, 32, 32, 3)
[INFOR]: shape of y: (88, 1)
3/3 [==============================] - 0s 78ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :18.0


[INFOR]: Index of second most vote     :408
[INFOR]: Class of second most vote     :amphibian, amphibious vehicle
[INFOR]: Number of second most vote    :7.0
[INFOR]: SEN testing of class 150_44 before transform: 18
[INFOR]: SPE testing of class 150_44 before transform: 32

[INFOR]: SEN testing of class 150_44 after transform: 42
[INFOR]: SPE testing of class 150_44 after transform: 3
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name stanford_car --class_name_train 151_45 --class_name_test 151_44
2021-09-13 12:47:50.559409: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  stanford_car
class_name_train =  151_45
class_name_test =  151_44
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (90, 32, 32, 3)
[INFOR]: shape of y: (90, 1)
[INFOR]: get pretrained model
2021-09-13 12:47:53.070123: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 12:47:53.096460: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:47:53.101522: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:47:53.109655: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:47:53.112000: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:47:53.117579: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:47:53.120946: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:47:53.127850: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:47:53.133161: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:47:53.136159: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:47:53.138267: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:47:53.140124: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 12:47:53.152015: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x194b60319c0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:47:53.155284: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 12:47:53.157289: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:47:53.161929: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:47:53.164042: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:47:53.166133: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:47:53.168741: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:47:53.170869: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:47:53.173178: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:47:53.175337: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:47:53.177844: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:47:53.179936: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:47:53.615497: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 12:47:53.617852: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 12:47:53.619210: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 12:47:53.620685: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 12:47:53.627850: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x194daa105f0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:47:53.630684: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 12:47:55.875880: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 12:47:57.053182: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:47:57.705759: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:47:57.712973: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:47:59.072343: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:47:59.121313: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:47:59.689239: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 291ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :12.0


[INFOR]: Index of second most vote     :408
[INFOR]: Class of second most vote     :amphibian, amphibious vehicle
[INFOR]: Number of second most vote    :7.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 80ms/step
[INFOR]: Toltal norm before transform: 0.7198
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0607

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 80ms/step
[INFOR]: SEN training of class 151_45 before transform: 12
[INFOR]: SPE training of class 151_45 before transform: 30

[INFOR]: SEN training of class 151_45 after transform: 44
[INFOR]: SPE training of class 151_45 after transform: 30
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (88, 32, 32, 3)
[INFOR]: shape of y: (88, 1)
3/3 [==============================] - 0s 79ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :8.0


[INFOR]: Index of second most vote     :510
[INFOR]: Class of second most vote     :container ship, containership, container vessel
[INFOR]: Number of second most vote    :6.0
[INFOR]: SEN testing of class 151_44 before transform: 8
[INFOR]: SPE testing of class 151_44 before transform: 27

[INFOR]: SEN testing of class 151_44 after transform: 43
[INFOR]: SPE testing of class 151_44 after transform: 0
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name stanford_car --class_name_train 152_45 --class_name_test 152_44
2021-09-13 12:48:04.790932: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  stanford_car
class_name_train =  152_45
class_name_test =  152_44
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (90, 32, 32, 3)
[INFOR]: shape of y: (90, 1)
[INFOR]: get pretrained model
2021-09-13 12:48:07.316358: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 12:48:07.341559: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:48:07.346312: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:48:07.354200: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:48:07.356495: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:48:07.361688: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:48:07.365074: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:48:07.371411: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:48:07.376349: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:48:07.379735: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:48:07.381962: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:48:07.383831: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 12:48:07.396131: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x2903478da80 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:48:07.399247: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 12:48:07.401313: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:48:07.405947: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:48:07.408064: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:48:07.410180: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:48:07.412307: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:48:07.414835: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:48:07.416943: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:48:07.419045: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:48:07.421141: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:48:07.423701: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:48:07.855501: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 12:48:07.858787: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 12:48:07.860172: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 12:48:07.861687: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 12:48:07.868725: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x2906410fee0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:48:07.871595: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 12:48:10.143051: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 12:48:11.328620: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:48:11.992963: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:48:11.999510: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:48:13.365487: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:48:13.414979: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:48:13.980663: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 291ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :13.0


[INFOR]: Index of second most vote     :510
[INFOR]: Class of second most vote     :container ship, containership, container vessel
[INFOR]: Number of second most vote    :9.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 80ms/step
[INFOR]: Toltal norm before transform: 0.6655
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1413

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 80ms/step
[INFOR]: SEN training of class 152_45 before transform: 13
[INFOR]: SPE training of class 152_45 before transform: 30

[INFOR]: SEN training of class 152_45 after transform: 43
[INFOR]: SPE training of class 152_45 after transform: 30
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (88, 32, 32, 3)
[INFOR]: shape of y: (88, 1)
3/3 [==============================] - 0s 79ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :15.0


[INFOR]: Index of second most vote     :510
[INFOR]: Class of second most vote     :container ship, containership, container vessel
[INFOR]: Number of second most vote    :7.0
[INFOR]: SEN testing of class 152_44 before transform: 15
[INFOR]: SPE testing of class 152_44 before transform: 30

[INFOR]: SEN testing of class 152_44 after transform: 44
[INFOR]: SPE testing of class 152_44 after transform: 0
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name stanford_car --class_name_train 153_37 --class_name_test 153_36
2021-09-13 12:48:19.083078: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  stanford_car
class_name_train =  153_37
class_name_test =  153_36
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (74, 32, 32, 3)
[INFOR]: shape of y: (74, 1)
[INFOR]: get pretrained model
2021-09-13 12:48:21.635428: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 12:48:21.661389: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:48:21.666114: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:48:21.674043: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:48:21.676178: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:48:21.681222: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:48:21.684493: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:48:21.690626: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:48:21.695534: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:48:21.698809: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:48:21.700879: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:48:21.702801: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 12:48:21.715607: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x2e5391421d0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:48:21.719328: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 12:48:21.721297: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:48:21.726014: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:48:21.728201: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:48:21.730374: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:48:21.732460: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:48:21.734915: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:48:21.737052: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:48:21.739235: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:48:21.741370: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:48:21.743930: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:48:22.173908: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 12:48:22.176842: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 12:48:22.178199: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 12:48:22.179683: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 12:48:22.186686: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x2e5640068c0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:48:22.189492: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 12:48:24.469465: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 12:48:25.658937: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:48:26.318446: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:48:26.325286: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:48:27.683397: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:48:27.732539: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:48:28.293528: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 242ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :15.0


[INFOR]: Index of second most vote     :408
[INFOR]: Class of second most vote     :amphibian, amphibious vehicle
[INFOR]: Number of second most vote    :7.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 68ms/step
[INFOR]: Toltal norm before transform: 0.6222
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1190

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 67ms/step
[INFOR]: SEN training of class 153_37 before transform: 15
[INFOR]: SPE training of class 153_37 before transform: 27

[INFOR]: SEN training of class 153_37 after transform: 37
[INFOR]: SPE training of class 153_37 after transform: 27
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (72, 32, 32, 3)
[INFOR]: shape of y: (72, 1)
3/3 [==============================] - 0s 66ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :24.0


[INFOR]: Index of second most vote     :408
[INFOR]: Class of second most vote     :amphibian, amphibious vehicle
[INFOR]: Number of second most vote    :4.0
[INFOR]: SEN testing of class 153_36 before transform: 24
[INFOR]: SPE testing of class 153_36 before transform: 21

[INFOR]: SEN testing of class 153_36 after transform: 36
[INFOR]: SPE testing of class 153_36 after transform: 0
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name stanford_car --class_name_train 154_43 --class_name_test 154_43
2021-09-13 12:48:33.083830: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  stanford_car
class_name_train =  154_43
class_name_test =  154_43
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (86, 32, 32, 3)
[INFOR]: shape of y: (86, 1)
[INFOR]: get pretrained model
2021-09-13 12:48:35.590321: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 12:48:35.616743: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:48:35.621554: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:48:35.629410: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:48:35.631744: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:48:35.636774: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:48:35.640094: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:48:35.646376: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:48:35.651230: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:48:35.654430: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:48:35.656553: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:48:35.658389: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 12:48:35.671195: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1843359d370 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:48:35.675254: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 12:48:35.677254: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:48:35.681867: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:48:35.684044: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:48:35.686118: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:48:35.688312: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:48:35.690925: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:48:35.693000: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:48:35.695350: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:48:35.697455: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:48:35.699976: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:48:36.130037: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 12:48:36.133078: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 12:48:36.134562: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 12:48:36.136053: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 12:48:36.143337: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1845e7d5c60 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:48:36.146272: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 12:48:38.416746: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 12:48:39.601482: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:48:40.261831: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:48:40.269022: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:48:41.619970: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:48:41.669457: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:48:42.227137: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 277ms/step
[INFOR]: Index of most vote   :408
[INFOR]: Class of most vote   :amphibian, amphibious vehicle
[INFOR]: Number of most vote  :14.0


[INFOR]: Index of second most vote     :674
[INFOR]: Class of second most vote     :mousetrap
[INFOR]: Number of second most vote    :12.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 77ms/step
[INFOR]: Toltal norm before transform: 0.6926
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0764

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 77ms/step
[INFOR]: SEN training of class 154_43 before transform: 14
[INFOR]: SPE training of class 154_43 before transform: 37

[INFOR]: SEN training of class 154_43 after transform: 41
[INFOR]: SPE training of class 154_43 after transform: 37
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (86, 32, 32, 3)
[INFOR]: shape of y: (86, 1)
3/3 [==============================] - 0s 78ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :20.0


[INFOR]: Index of second most vote     :408
[INFOR]: Class of second most vote     :amphibian, amphibious vehicle
[INFOR]: Number of second most vote    :6.0
[INFOR]: SEN testing of class 154_43 before transform: 20
[INFOR]: SPE testing of class 154_43 before transform: 24

[INFOR]: SEN testing of class 154_43 after transform: 43
[INFOR]: SPE testing of class 154_43 after transform: 0
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name stanford_car --class_name_train 155_37 --class_name_test 155_37
2021-09-13 12:48:46.797084: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  stanford_car
class_name_train =  155_37
class_name_test =  155_37
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (74, 32, 32, 3)
[INFOR]: shape of y: (74, 1)
[INFOR]: get pretrained model
2021-09-13 12:48:49.338786: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 12:48:49.366335: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:48:49.371419: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:48:49.379334: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:48:49.381705: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:48:49.386829: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:48:49.390167: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:48:49.396347: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:48:49.401349: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:48:49.404611: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:48:49.406920: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:48:49.408792: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 12:48:49.421550: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x15438058100 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:48:49.424759: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 12:48:49.426766: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:48:49.431325: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:48:49.433435: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:48:49.435660: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:48:49.437871: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:48:49.440414: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:48:49.442515: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:48:49.444680: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:48:49.446905: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:48:49.449389: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:48:49.882568: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 12:48:49.885609: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 12:48:49.886989: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 12:48:49.888466: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 12:48:49.895523: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x154664e1360 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:48:49.898318: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 12:48:52.161314: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 12:48:53.354242: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:48:54.013633: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:48:54.020744: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:48:55.382499: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:48:55.431695: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:48:55.991230: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 241ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :19.0


[INFOR]: Index of second most vote     :408
[INFOR]: Class of second most vote     :amphibian, amphibious vehicle
[INFOR]: Number of second most vote    :7.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 67ms/step
[INFOR]: Toltal norm before transform: 0.4479
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1849

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 68ms/step
[INFOR]: SEN training of class 155_37 before transform: 19
[INFOR]: SPE training of class 155_37 before transform: 26

[INFOR]: SEN training of class 155_37 after transform: 37
[INFOR]: SPE training of class 155_37 after transform: 26
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (74, 32, 32, 3)
[INFOR]: shape of y: (74, 1)
3/3 [==============================] - 0s 67ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :18.0


[INFOR]: Index of second most vote     :408
[INFOR]: Class of second most vote     :amphibian, amphibious vehicle
[INFOR]: Number of second most vote    :6.0
[INFOR]: SEN testing of class 155_37 before transform: 18
[INFOR]: SPE testing of class 155_37 before transform: 25

[INFOR]: SEN testing of class 155_37 after transform: 36
[INFOR]: SPE testing of class 155_37 after transform: 0
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name stanford_car --class_name_train 156_44 --class_name_test 156_44
2021-09-13 12:49:00.421568: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  stanford_car
class_name_train =  156_44
class_name_test =  156_44
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (88, 32, 32, 3)
[INFOR]: shape of y: (88, 1)
[INFOR]: get pretrained model
2021-09-13 12:49:02.924615: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 12:49:02.951762: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:49:02.957101: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:49:02.965146: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:49:02.967465: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:49:02.972840: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:49:02.976396: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:49:02.982743: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:49:02.987651: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:49:02.990959: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:49:02.993052: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:49:02.994965: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 12:49:03.007675: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x149ba1422a0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:49:03.011214: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 12:49:03.013179: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:49:03.017720: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:49:03.019877: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:49:03.022035: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:49:03.024646: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:49:03.026746: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:49:03.028798: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:49:03.030968: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:49:03.033566: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:49:03.035751: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:49:03.460897: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 12:49:03.464266: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 12:49:03.465625: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 12:49:03.467138: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 12:49:03.474156: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x149e9424e40 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:49:03.477014: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 12:49:05.768937: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 12:49:06.975818: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:49:07.640455: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:49:07.647382: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:49:09.008325: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:49:09.063052: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:49:09.624025: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 276ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :15.0


[INFOR]: Index of second most vote     :408
[INFOR]: Class of second most vote     :amphibian, amphibious vehicle
[INFOR]: Number of second most vote    :9.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 77ms/step
[INFOR]: Toltal norm before transform: 0.6327
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1085

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 78ms/step
[INFOR]: SEN training of class 156_44 before transform: 15
[INFOR]: SPE training of class 156_44 before transform: 26

[INFOR]: SEN training of class 156_44 after transform: 44
[INFOR]: SPE training of class 156_44 after transform: 26
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (88, 32, 32, 3)
[INFOR]: shape of y: (88, 1)
3/3 [==============================] - 0s 78ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :19.0


[INFOR]: Index of second most vote     :408
[INFOR]: Class of second most vote     :amphibian, amphibious vehicle
[INFOR]: Number of second most vote    :3.0
[INFOR]: SEN testing of class 156_44 before transform: 19
[INFOR]: SPE testing of class 156_44 before transform: 30

[INFOR]: SEN testing of class 156_44 after transform: 44
[INFOR]: SPE testing of class 156_44 after transform: 1
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name stanford_car --class_name_train 157_30 --class_name_test 157_29
2021-09-13 12:49:14.240529: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  stanford_car
class_name_train =  157_30
class_name_test =  157_29
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (60, 32, 32, 3)
[INFOR]: shape of y: (60, 1)
[INFOR]: get pretrained model
2021-09-13 12:49:16.747767: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 12:49:16.772175: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:49:16.776999: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:49:16.784957: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:49:16.787101: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:49:16.792199: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:49:16.795574: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:49:16.801827: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:49:16.806685: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:49:16.809967: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:49:16.812119: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:49:16.813978: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 12:49:16.826431: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x232b9152010 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:49:16.830347: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 12:49:16.832549: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:49:16.837652: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:49:16.840022: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:49:16.842325: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:49:16.845166: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:49:16.847656: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:49:16.850008: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:49:16.852507: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:49:16.855323: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:49:16.857544: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:49:17.297366: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 12:49:17.300826: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 12:49:17.302344: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 12:49:17.303928: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 12:49:17.311398: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x232e4d4c330 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:49:17.314474: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 12:49:19.561295: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 12:49:20.757113: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:49:21.422147: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:49:21.429820: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:49:22.808635: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:49:22.857804: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:49:23.420012: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
2/2 [==============================] - 4s 525ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :18.0


[INFOR]: Index of second most vote     :408
[INFOR]: Class of second most vote     :amphibian, amphibious vehicle
[INFOR]: Number of second most vote    :4.0

[INFOR]: Create PDF for Positive Label

2/2 [==============================] - 1s 98ms/step
[INFOR]: Toltal norm before transform: 0.3807
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1207

[INFOR]: Create PDF for Negative Label

2/2 [==============================] - 0s 101ms/step
[INFOR]: SEN training of class 157_30 before transform: 18
[INFOR]: SPE training of class 157_30 before transform: 21

[INFOR]: SEN training of class 157_30 after transform: 30
[INFOR]: SPE training of class 157_30 after transform: 21
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (58, 32, 32, 3)
[INFOR]: shape of y: (58, 1)
2/2 [==============================] - 0s 95ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :23.0


[INFOR]: Index of second most vote     :660
[INFOR]: Class of second most vote     :mobile home, manufactured home
[INFOR]: Number of second most vote    :2.0
[INFOR]: SEN testing of class 157_29 before transform: 23
[INFOR]: SPE testing of class 157_29 before transform: 20

[INFOR]: SEN testing of class 157_29 after transform: 29
[INFOR]: SPE testing of class 157_29 after transform: 0
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name stanford_car --class_name_train 158_45 --class_name_test 158_45
2021-09-13 12:49:28.153339: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  stanford_car
class_name_train =  158_45
class_name_test =  158_45
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (90, 32, 32, 3)
[INFOR]: shape of y: (90, 1)
[INFOR]: get pretrained model
2021-09-13 12:49:30.671450: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 12:49:30.696135: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:49:30.700895: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:49:30.708907: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:49:30.711032: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:49:30.716161: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:49:30.719525: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:49:30.725799: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:49:30.730828: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:49:30.734088: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:49:30.736240: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:49:30.738215: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 12:49:30.750498: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x19933507390 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:49:30.753788: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 12:49:30.755801: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:49:30.760757: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:49:30.762869: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:49:30.765037: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:49:30.767150: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:49:30.769690: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:49:30.771849: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:49:30.773961: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:49:30.776156: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:49:30.778717: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:49:31.206977: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 12:49:31.210022: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 12:49:31.211370: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 12:49:31.212848: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 12:49:31.219920: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1995f2194d0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:49:31.222707: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 12:49:33.479490: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 12:49:34.669018: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:49:35.330860: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:49:35.338135: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:49:36.700317: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:49:36.750651: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:49:37.312337: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 290ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :21.0


[INFOR]: Index of second most vote     :855
[INFOR]: Class of second most vote     :thimble
[INFOR]: Number of second most vote    :6.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 79ms/step
[INFOR]: Toltal norm before transform: 0.4926
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1464

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 81ms/step
[INFOR]: SEN training of class 158_45 before transform: 21
[INFOR]: SPE training of class 158_45 before transform: 31

[INFOR]: SEN training of class 158_45 after transform: 44
[INFOR]: SPE training of class 158_45 after transform: 31
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (90, 32, 32, 3)
[INFOR]: shape of y: (90, 1)
3/3 [==============================] - 0s 81ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :17.0


[INFOR]: Index of second most vote     :408
[INFOR]: Class of second most vote     :amphibian, amphibious vehicle
[INFOR]: Number of second most vote    :7.0
[INFOR]: SEN testing of class 158_45 before transform: 17
[INFOR]: SPE testing of class 158_45 before transform: 32

[INFOR]: SEN testing of class 158_45 after transform: 45
[INFOR]: SPE testing of class 158_45 after transform: 0
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name stanford_car --class_name_train 159_42 --class_name_test 159_41
2021-09-13 12:49:41.986058: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  stanford_car
class_name_train =  159_42
class_name_test =  159_41
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (84, 32, 32, 3)
[INFOR]: shape of y: (84, 1)
[INFOR]: get pretrained model
2021-09-13 12:49:44.504275: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 12:49:44.530066: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:49:44.534683: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:49:44.542756: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:49:44.544865: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:49:44.550025: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:49:44.553451: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:49:44.559710: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:49:44.564625: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:49:44.567832: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:49:44.569949: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:49:44.571965: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 12:49:44.584219: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x193b5090350 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:49:44.587449: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 12:49:44.589496: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:49:44.594080: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:49:44.596202: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:49:44.598325: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:49:44.600726: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:49:44.603222: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:49:44.605375: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:49:44.607600: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:49:44.609724: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:49:44.612244: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:49:45.048457: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 12:49:45.051424: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 12:49:45.052787: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 12:49:45.054270: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 12:49:45.061431: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x193df9a8450 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:49:45.064263: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 12:49:47.330274: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 12:49:48.512001: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:49:49.176353: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:49:49.183744: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:49:50.549664: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:49:50.599225: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:49:51.164344: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 271ms/step
[INFOR]: Index of most vote   :408
[INFOR]: Class of most vote   :amphibian, amphibious vehicle
[INFOR]: Number of most vote  :10.0


[INFOR]: Index of second most vote     :674
[INFOR]: Class of second most vote     :mousetrap
[INFOR]: Number of second most vote    :8.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 75ms/step
[INFOR]: Toltal norm before transform: 0.7668
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.3018

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 75ms/step
[INFOR]: SEN training of class 159_42 before transform: 10
[INFOR]: SPE training of class 159_42 before transform: 36

[INFOR]: SEN training of class 159_42 after transform: 41
[INFOR]: SPE training of class 159_42 after transform: 36
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (82, 32, 32, 3)
[INFOR]: shape of y: (82, 1)
3/3 [==============================] - 0s 75ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :11.0


[INFOR]: Index of second most vote     :510
[INFOR]: Class of second most vote     :container ship, containership, container vessel
[INFOR]: Number of second most vote    :6.0
[INFOR]: SEN testing of class 159_41 before transform: 11
[INFOR]: SPE testing of class 159_41 before transform: 27

[INFOR]: SEN testing of class 159_41 after transform: 40
[INFOR]: SPE testing of class 159_41 after transform: 0
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name stanford_car --class_name_train 160_39 --class_name_test 160_38
2021-09-13 12:49:56.164561: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  stanford_car
class_name_train =  160_39
class_name_test =  160_38
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (78, 32, 32, 3)
[INFOR]: shape of y: (78, 1)
[INFOR]: get pretrained model
2021-09-13 12:49:58.710695: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 12:49:58.737598: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:49:58.742447: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:49:58.750374: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:49:58.752802: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:49:58.757837: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:49:58.761285: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:49:58.767503: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:49:58.772388: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:49:58.775729: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:49:58.777868: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:49:58.779886: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 12:49:58.792434: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x15bb6a2f0a0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:49:58.795458: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 12:49:58.797484: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:49:58.802378: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:49:58.804559: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:49:58.806775: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:49:58.809255: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:49:58.811949: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:49:58.814071: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:49:58.816264: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:49:58.818443: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:49:58.820962: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:49:59.256084: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 12:49:59.259212: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 12:49:59.260671: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 12:49:59.262240: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 12:49:59.269622: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x15be06d4380 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:49:59.272425: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 12:50:01.552218: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 12:50:02.727742: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:50:03.389448: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:50:03.396879: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:50:04.757406: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:50:04.812725: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:50:05.374310: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 255ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :12.0


[INFOR]: Index of second most vote     :482
[INFOR]: Class of second most vote     :cassette player
[INFOR]: Number of second most vote    :6.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 71ms/step
[INFOR]: Toltal norm before transform: 0.6614
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1465

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 71ms/step
[INFOR]: SEN training of class 160_39 before transform: 12
[INFOR]: SPE training of class 160_39 before transform: 26

[INFOR]: SEN training of class 160_39 after transform: 36
[INFOR]: SPE training of class 160_39 after transform: 26
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (76, 32, 32, 3)
[INFOR]: shape of y: (76, 1)
3/3 [==============================] - 0s 69ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :15.0


[INFOR]: Index of second most vote     :482
[INFOR]: Class of second most vote     :cassette player
[INFOR]: Number of second most vote    :2.0
[INFOR]: SEN testing of class 160_38 before transform: 15
[INFOR]: SPE testing of class 160_38 before transform: 26

[INFOR]: SEN testing of class 160_38 after transform: 37
[INFOR]: SPE testing of class 160_38 after transform: 0
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name stanford_car --class_name_train 161_40 --class_name_test 161_40
2021-09-13 12:50:10.268252: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  stanford_car
class_name_train =  161_40
class_name_test =  161_40
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (80, 32, 32, 3)
[INFOR]: shape of y: (80, 1)
[INFOR]: get pretrained model
2021-09-13 12:50:12.811303: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 12:50:12.837104: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:50:12.841754: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:50:12.849657: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:50:12.851734: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:50:12.856954: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:50:12.860459: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:50:12.866824: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:50:12.871969: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:50:12.875364: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:50:12.877587: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:50:12.879512: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 12:50:12.892595: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x20233d89750 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:50:12.895531: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 12:50:12.897576: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:50:12.902239: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:50:12.904416: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:50:12.906646: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:50:12.909167: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:50:12.911478: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:50:12.913735: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:50:12.915996: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:50:12.918532: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:50:12.920631: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:50:13.349227: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 12:50:13.352717: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 12:50:13.354057: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 12:50:13.355894: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 12:50:13.363138: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x2026427d260 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:50:13.365937: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 12:50:15.641468: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 12:50:16.829658: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:50:17.491706: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:50:17.498436: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:50:18.859974: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:50:18.910502: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:50:19.473927: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 254ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :12.0


[INFOR]: Index of second most vote     :855
[INFOR]: Class of second most vote     :thimble
[INFOR]: Number of second most vote    :5.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 73ms/step
[INFOR]: Toltal norm before transform: 0.6673
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0799

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 72ms/step
[INFOR]: SEN training of class 161_40 before transform: 12
[INFOR]: SPE training of class 161_40 before transform: 26

[INFOR]: SEN training of class 161_40 after transform: 38
[INFOR]: SPE training of class 161_40 after transform: 26
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (80, 32, 32, 3)
[INFOR]: shape of y: (80, 1)
3/3 [==============================] - 0s 73ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :16.0


[INFOR]: Index of second most vote     :855
[INFOR]: Class of second most vote     :thimble
[INFOR]: Number of second most vote    :9.0
[INFOR]: SEN testing of class 161_40 before transform: 16
[INFOR]: SPE testing of class 161_40 before transform: 30

[INFOR]: SEN testing of class 161_40 after transform: 40
[INFOR]: SPE testing of class 161_40 after transform: 0
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name stanford_car --class_name_train 162_38 --class_name_test 162_38
2021-09-13 12:50:23.997875: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  stanford_car
class_name_train =  162_38
class_name_test =  162_38
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (76, 32, 32, 3)
[INFOR]: shape of y: (76, 1)
[INFOR]: get pretrained model
2021-09-13 12:50:26.527679: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 12:50:26.554375: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:50:26.559419: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:50:26.567363: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:50:26.569597: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:50:26.574791: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:50:26.578151: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:50:26.584391: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:50:26.589520: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:50:26.592776: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:50:26.594916: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:50:26.596886: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 12:50:26.609330: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x298b762ca90 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:50:26.612634: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 12:50:26.614651: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:50:26.619497: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:50:26.621619: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:50:26.623818: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:50:26.626386: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:50:26.628645: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:50:26.630794: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:50:26.633007: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:50:26.635827: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:50:26.638106: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:50:27.068629: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 12:50:27.071610: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 12:50:27.072990: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 12:50:27.074490: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 12:50:27.081476: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x298e12111f0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:50:27.084359: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 12:50:29.347259: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 12:50:30.552083: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:50:31.211054: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:50:31.218683: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:50:32.573233: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:50:32.622700: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:50:33.184514: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 249ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :20.0


[INFOR]: Index of second most vote     :408
[INFOR]: Class of second most vote     :amphibian, amphibious vehicle
[INFOR]: Number of second most vote    :4.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 70ms/step
[INFOR]: Toltal norm before transform: 0.4056
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0468

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 70ms/step
[INFOR]: SEN training of class 162_38 before transform: 20
[INFOR]: SPE training of class 162_38 before transform: 25

[INFOR]: SEN training of class 162_38 after transform: 38
[INFOR]: SPE training of class 162_38 after transform: 25
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (76, 32, 32, 3)
[INFOR]: shape of y: (76, 1)
3/3 [==============================] - 0s 69ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :15.0


[INFOR]: Index of second most vote     :408
[INFOR]: Class of second most vote     :amphibian, amphibious vehicle
[INFOR]: Number of second most vote    :8.0
[INFOR]: SEN testing of class 162_38 before transform: 15
[INFOR]: SPE testing of class 162_38 before transform: 26

[INFOR]: SEN testing of class 162_38 after transform: 37
[INFOR]: SPE testing of class 162_38 after transform: 0
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name stanford_car --class_name_train 163_39 --class_name_test 163_39
2021-09-13 12:50:37.638117: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  stanford_car
class_name_train =  163_39
class_name_test =  163_39
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (78, 32, 32, 3)
[INFOR]: shape of y: (78, 1)
[INFOR]: get pretrained model
2021-09-13 12:50:40.144894: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 12:50:40.171101: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:50:40.175655: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:50:40.183923: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:50:40.186156: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:50:40.191341: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:50:40.194650: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:50:40.201027: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:50:40.205959: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:50:40.209390: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:50:40.211532: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:50:40.213457: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 12:50:40.226210: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1efb42aa090 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:50:40.229368: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 12:50:40.231347: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:50:40.235924: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:50:40.238077: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:50:40.240181: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:50:40.242319: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:50:40.244824: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:50:40.246966: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:50:40.249149: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:50:40.251251: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:50:40.253731: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:50:40.683946: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 12:50:40.687028: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 12:50:40.688505: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 12:50:40.690127: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 12:50:40.697320: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1efe265edc0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:50:40.700257: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 12:50:42.955835: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 12:50:44.138688: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:50:44.798941: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:50:44.806848: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:50:46.174339: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:50:46.224558: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:50:46.787067: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 256ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :12.0


[INFOR]: Index of second most vote     :408
[INFOR]: Class of second most vote     :amphibian, amphibious vehicle
[INFOR]: Number of second most vote    :5.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 70ms/step
[INFOR]: Toltal norm before transform: 0.6615
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0524

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 71ms/step
[INFOR]: SEN training of class 163_39 before transform: 12
[INFOR]: SPE training of class 163_39 before transform: 30

[INFOR]: SEN training of class 163_39 after transform: 38
[INFOR]: SPE training of class 163_39 after transform: 30
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (78, 32, 32, 3)
[INFOR]: shape of y: (78, 1)
3/3 [==============================] - 0s 70ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :12.0


[INFOR]: Index of second most vote     :408
[INFOR]: Class of second most vote     :amphibian, amphibious vehicle
[INFOR]: Number of second most vote    :5.0
[INFOR]: SEN testing of class 163_39 before transform: 12
[INFOR]: SPE testing of class 163_39 before transform: 22

[INFOR]: SEN testing of class 163_39 after transform: 38
[INFOR]: SPE testing of class 163_39 after transform: 0
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name stanford_car --class_name_train 164_43 --class_name_test 164_42
2021-09-13 12:50:51.296423: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  stanford_car
class_name_train =  164_43
class_name_test =  164_42
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (86, 32, 32, 3)
[INFOR]: shape of y: (86, 1)
[INFOR]: get pretrained model
2021-09-13 12:50:53.831234: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 12:50:53.855482: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:50:53.859644: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:50:53.867998: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:50:53.870139: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:50:53.875284: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:50:53.878672: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:50:53.885121: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:50:53.890077: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:50:53.893477: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:50:53.895695: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:50:53.897575: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 12:50:53.910493: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x250b5fa8c60 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:50:53.914326: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 12:50:53.916550: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:50:53.921322: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:50:53.923484: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:50:53.925602: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:50:53.928143: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:50:53.930262: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:50:53.932326: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:50:53.934530: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:50:53.937110: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:50:53.939180: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:50:54.375337: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 12:50:54.378430: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 12:50:54.379903: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 12:50:54.381401: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 12:50:54.388719: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x250e12e8550 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:50:54.391547: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 12:50:56.638937: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 12:50:57.825355: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:50:58.485355: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:50:58.492695: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:50:59.855617: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:50:59.911558: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:51:00.477868: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 279ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :20.0


[INFOR]: Index of second most vote     :855
[INFOR]: Class of second most vote     :thimble
[INFOR]: Number of second most vote    :5.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 76ms/step
[INFOR]: Toltal norm before transform: 0.4904
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1839

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 77ms/step
[INFOR]: SEN training of class 164_43 before transform: 20
[INFOR]: SPE training of class 164_43 before transform: 28

[INFOR]: SEN training of class 164_43 after transform: 43
[INFOR]: SPE training of class 164_43 after transform: 28
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (84, 32, 32, 3)
[INFOR]: shape of y: (84, 1)
3/3 [==============================] - 0s 76ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :11.0


[INFOR]: Index of second most vote     :855
[INFOR]: Class of second most vote     :thimble
[INFOR]: Number of second most vote    :10.0
[INFOR]: SEN testing of class 164_42 before transform: 11
[INFOR]: SPE testing of class 164_42 before transform: 32

[INFOR]: SEN testing of class 164_42 after transform: 40
[INFOR]: SPE testing of class 164_42 after transform: 0
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name stanford_car --class_name_train 165_35 --class_name_test 165_35
2021-09-13 12:51:05.518082: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  stanford_car
class_name_train =  165_35
class_name_test =  165_35
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (70, 32, 32, 3)
[INFOR]: shape of y: (70, 1)
[INFOR]: get pretrained model
2021-09-13 12:51:08.026454: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 12:51:08.052337: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:51:08.056907: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:51:08.065013: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:51:08.067104: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:51:08.072262: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:51:08.075972: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:51:08.082276: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:51:08.087321: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:51:08.090590: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:51:08.092792: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:51:08.094658: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 12:51:08.107381: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x25a3a3125b0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:51:08.110616: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 12:51:08.112628: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:51:08.117269: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:51:08.119385: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:51:08.121476: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:51:08.124118: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:51:08.126200: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:51:08.128394: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:51:08.130535: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:51:08.132683: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:51:08.135252: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:51:08.569648: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 12:51:08.572686: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 12:51:08.574112: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 12:51:08.575598: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 12:51:08.582952: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x25a5b3ffd70 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:51:08.585874: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 12:51:10.847516: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 12:51:12.042159: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:51:12.704983: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:51:12.712253: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:51:14.097617: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:51:14.147283: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:51:14.712139: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 229ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :23.0


[INFOR]: Index of second most vote     :408
[INFOR]: Class of second most vote     :amphibian, amphibious vehicle
[INFOR]: Number of second most vote    :6.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 64ms/step
[INFOR]: Toltal norm before transform: 0.3506
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0554

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 65ms/step
[INFOR]: SEN training of class 165_35 before transform: 23
[INFOR]: SPE training of class 165_35 before transform: 25

[INFOR]: SEN training of class 165_35 after transform: 35
[INFOR]: SPE training of class 165_35 after transform: 25
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (70, 32, 32, 3)
[INFOR]: shape of y: (70, 1)
3/3 [==============================] - 0s 65ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :22.0


[INFOR]: Index of second most vote     :408
[INFOR]: Class of second most vote     :amphibian, amphibious vehicle
[INFOR]: Number of second most vote    :2.0
[INFOR]: SEN testing of class 165_35 before transform: 22
[INFOR]: SPE testing of class 165_35 before transform: 21

[INFOR]: SEN testing of class 165_35 after transform: 35
[INFOR]: SPE testing of class 165_35 after transform: 0
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name stanford_car --class_name_train 166_45 --class_name_test 166_45
2021-09-13 12:51:19.079258: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  stanford_car
class_name_train =  166_45
class_name_test =  166_45
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (90, 32, 32, 3)
[INFOR]: shape of y: (90, 1)
[INFOR]: get pretrained model
2021-09-13 12:51:21.579442: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 12:51:21.605484: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:51:21.610167: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:51:21.618352: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:51:21.620479: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:51:21.625708: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:51:21.629108: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:51:21.635637: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:51:21.640921: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:51:21.644224: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:51:21.646322: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:51:21.648175: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 12:51:21.660149: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x2f0b61171e0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:51:21.663367: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 12:51:21.665372: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:51:21.670161: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:51:21.672291: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:51:21.674453: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:51:21.676567: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:51:21.679238: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:51:21.681321: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:51:21.683432: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:51:21.685656: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:51:21.688127: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:51:22.124234: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 12:51:22.127219: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 12:51:22.128688: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 12:51:22.130153: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 12:51:22.137202: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x2f0e4e5cd20 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:51:22.140009: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 12:51:24.387154: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 12:51:25.569057: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:51:26.223402: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:51:26.230289: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:51:27.596130: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:51:27.645480: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:51:28.211000: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 290ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :18.0


[INFOR]: Index of second most vote     :408
[INFOR]: Class of second most vote     :amphibian, amphibious vehicle
[INFOR]: Number of second most vote    :7.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 80ms/step
[INFOR]: Toltal norm before transform: 0.5490
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.3065

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 80ms/step
[INFOR]: SEN training of class 166_45 before transform: 18
[INFOR]: SPE training of class 166_45 before transform: 32

[INFOR]: SEN training of class 166_45 after transform: 45
[INFOR]: SPE training of class 166_45 after transform: 32
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (90, 32, 32, 3)
[INFOR]: shape of y: (90, 1)
3/3 [==============================] - 0s 83ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :11.0


[INFOR]: Index of second most vote     :408
[INFOR]: Class of second most vote     :amphibian, amphibious vehicle
[INFOR]: Number of second most vote    :7.0
[INFOR]: SEN testing of class 166_45 before transform: 11
[INFOR]: SPE testing of class 166_45 before transform: 28

[INFOR]: SEN testing of class 166_45 after transform: 45
[INFOR]: SPE testing of class 166_45 after transform: 0
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name stanford_car --class_name_train 167_45 --class_name_test 167_44
2021-09-13 12:51:32.913959: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  stanford_car
class_name_train =  167_45
class_name_test =  167_44
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (90, 32, 32, 3)
[INFOR]: shape of y: (90, 1)
[INFOR]: get pretrained model
2021-09-13 12:51:35.427368: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 12:51:35.451969: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:51:35.456416: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:51:35.464497: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:51:35.466576: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:51:35.471768: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:51:35.475222: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:51:35.481678: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:51:35.486677: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:51:35.489982: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:51:35.492163: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:51:35.494273: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 12:51:35.507575: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x22137f70470 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:51:35.511128: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 12:51:35.513135: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:51:35.517783: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:51:35.519850: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:51:35.521963: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:51:35.524592: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:51:35.526693: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:51:35.528730: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:51:35.530801: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:51:35.533406: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:51:35.535444: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:51:35.968285: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 12:51:35.971628: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 12:51:35.973042: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 12:51:35.974539: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 12:51:35.981625: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x2216609e6e0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:51:35.984418: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 12:51:38.254232: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 12:51:39.435845: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:51:40.102035: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:51:40.108846: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:51:41.465652: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:51:41.515172: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:51:42.076199: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 287ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :13.0


[INFOR]: Index of second most vote     :408
[INFOR]: Class of second most vote     :amphibian, amphibious vehicle
[INFOR]: Number of second most vote    :11.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 80ms/step
[INFOR]: Toltal norm before transform: 0.7148
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1158

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 79ms/step
[INFOR]: SEN training of class 167_45 before transform: 13
[INFOR]: SPE training of class 167_45 before transform: 28

[INFOR]: SEN training of class 167_45 after transform: 43
[INFOR]: SPE training of class 167_45 after transform: 28
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (88, 32, 32, 3)
[INFOR]: shape of y: (88, 1)
3/3 [==============================] - 0s 77ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :10.0


[INFOR]: Index of second most vote     :408
[INFOR]: Class of second most vote     :amphibian, amphibious vehicle
[INFOR]: Number of second most vote    :6.0
[INFOR]: SEN testing of class 167_44 before transform: 10
[INFOR]: SPE testing of class 167_44 before transform: 26

[INFOR]: SEN testing of class 167_44 after transform: 44
[INFOR]: SPE testing of class 167_44 after transform: 0
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name stanford_car --class_name_train 168_44 --class_name_test 168_43
2021-09-13 12:51:47.197294: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  stanford_car
class_name_train =  168_44
class_name_test =  168_43
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (88, 32, 32, 3)
[INFOR]: shape of y: (88, 1)
[INFOR]: get pretrained model
2021-09-13 12:51:49.712034: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 12:51:49.737800: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:51:49.742350: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:51:49.750293: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:51:49.752438: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:51:49.757501: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:51:49.760952: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:51:49.767181: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:51:49.772063: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:51:49.775372: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:51:49.777452: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:51:49.779285: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 12:51:49.792231: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1b7b35ae3f0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:51:49.796170: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 12:51:49.798123: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:51:49.802837: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:51:49.805165: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:51:49.807230: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:51:49.809331: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:51:49.811942: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:51:49.814077: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:51:49.816247: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:51:49.818392: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:51:49.821006: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:51:50.262604: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 12:51:50.265566: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 12:51:50.266924: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 12:51:50.268411: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 12:51:50.275571: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1b7db7fb170 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:51:50.278386: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 12:51:52.537571: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 12:51:53.726348: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:51:54.388283: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:51:54.395915: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:51:55.754972: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:51:55.808747: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:51:56.369426: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 277ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :18.0


[INFOR]: Index of second most vote     :408
[INFOR]: Class of second most vote     :amphibian, amphibious vehicle
[INFOR]: Number of second most vote    :12.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 78ms/step
[INFOR]: Toltal norm before transform: 0.5490
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0535

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 77ms/step
[INFOR]: SEN training of class 168_44 before transform: 18
[INFOR]: SPE training of class 168_44 before transform: 28

[INFOR]: SEN training of class 168_44 after transform: 43
[INFOR]: SPE training of class 168_44 after transform: 28
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (86, 32, 32, 3)
[INFOR]: shape of y: (86, 1)
3/3 [==============================] - 0s 77ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :16.0


[INFOR]: Index of second most vote     :408
[INFOR]: Class of second most vote     :amphibian, amphibious vehicle
[INFOR]: Number of second most vote    :7.0
[INFOR]: SEN testing of class 168_43 before transform: 16
[INFOR]: SPE testing of class 168_43 before transform: 31

[INFOR]: SEN testing of class 168_43 after transform: 43
[INFOR]: SPE testing of class 168_43 after transform: 1
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name stanford_car --class_name_train 169_44 --class_name_test 169_44
2021-09-13 12:52:01.436785: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  stanford_car
class_name_train =  169_44
class_name_test =  169_44
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (88, 32, 32, 3)
[INFOR]: shape of y: (88, 1)
[INFOR]: get pretrained model
2021-09-13 12:52:03.937455: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 12:52:03.962440: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:52:03.967394: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:52:03.975267: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:52:03.977387: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:52:03.982577: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:52:03.985976: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:52:03.992265: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:52:03.997254: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:52:04.000446: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:52:04.002651: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:52:04.004503: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 12:52:04.017423: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x19036acdc90 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:52:04.020631: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 12:52:04.022641: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:52:04.027221: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:52:04.029386: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:52:04.031576: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:52:04.033735: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:52:04.036354: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:52:04.038453: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:52:04.040784: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:52:04.043437: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:52:04.045554: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:52:04.482313: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 12:52:04.485268: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 12:52:04.486618: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 12:52:04.488091: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 12:52:04.495124: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x190663d2c60 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:52:04.497917: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 12:52:06.745463: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 12:52:07.926160: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:52:08.583115: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:52:08.590749: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:52:09.951529: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:52:10.001918: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:52:10.564818: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 277ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :16.0


[INFOR]: Index of second most vote     :408
[INFOR]: Class of second most vote     :amphibian, amphibious vehicle
[INFOR]: Number of second most vote    :5.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 78ms/step
[INFOR]: Toltal norm before transform: 0.5367
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0580

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 78ms/step
[INFOR]: SEN training of class 169_44 before transform: 16
[INFOR]: SPE training of class 169_44 before transform: 24

[INFOR]: SEN training of class 169_44 after transform: 39
[INFOR]: SPE training of class 169_44 after transform: 24
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (88, 32, 32, 3)
[INFOR]: shape of y: (88, 1)
3/3 [==============================] - 0s 78ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :16.0


[INFOR]: Index of second most vote     :510
[INFOR]: Class of second most vote     :container ship, containership, container vessel
[INFOR]: Number of second most vote    :8.0
[INFOR]: SEN testing of class 169_44 before transform: 16
[INFOR]: SPE testing of class 169_44 before transform: 26

[INFOR]: SEN testing of class 169_44 after transform: 43
[INFOR]: SPE testing of class 169_44 after transform: 1
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name stanford_car --class_name_train 170_44 --class_name_test 170_43
2021-09-13 12:52:15.192824: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  stanford_car
class_name_train =  170_44
class_name_test =  170_43
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (88, 32, 32, 3)
[INFOR]: shape of y: (88, 1)
[INFOR]: get pretrained model
2021-09-13 12:52:17.740457: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 12:52:17.764867: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:52:17.769811: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:52:17.777790: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:52:17.780168: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:52:17.785431: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:52:17.788956: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:52:17.795367: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:52:17.800257: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:52:17.803592: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:52:17.805683: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:52:17.807552: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 12:52:17.820655: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1eab3be2cf0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:52:17.824018: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 12:52:17.826179: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:52:17.830846: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:52:17.833083: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:52:17.835196: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:52:17.837714: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:52:17.839831: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:52:17.841902: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:52:17.844131: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:52:17.846702: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:52:17.848941: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:52:18.282920: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 12:52:18.286123: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 12:52:18.287610: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 12:52:18.289220: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 12:52:18.296543: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1eae23c7450 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:52:18.299585: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 12:52:20.559348: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 12:52:21.742835: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:52:22.401951: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:52:22.409380: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:52:23.775152: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:52:23.825634: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:52:24.391019: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 279ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :21.0


[INFOR]: Index of second most vote     :408
[INFOR]: Class of second most vote     :amphibian, amphibious vehicle
[INFOR]: Number of second most vote    :9.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 78ms/step
[INFOR]: Toltal norm before transform: 0.5092
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.2106

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 78ms/step
[INFOR]: SEN training of class 170_44 before transform: 21
[INFOR]: SPE training of class 170_44 before transform: 26

[INFOR]: SEN training of class 170_44 after transform: 44
[INFOR]: SPE training of class 170_44 after transform: 26
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (86, 32, 32, 3)
[INFOR]: shape of y: (86, 1)
3/3 [==============================] - 0s 77ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :19.0


[INFOR]: Index of second most vote     :482
[INFOR]: Class of second most vote     :cassette player
[INFOR]: Number of second most vote    :4.0
[INFOR]: SEN testing of class 170_43 before transform: 19
[INFOR]: SPE testing of class 170_43 before transform: 26

[INFOR]: SEN testing of class 170_43 after transform: 43
[INFOR]: SPE testing of class 170_43 after transform: 0
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name stanford_car --class_name_train 171_41 --class_name_test 171_40
2021-09-13 12:52:29.460002: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  stanford_car
class_name_train =  171_41
class_name_test =  171_40
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (82, 32, 32, 3)
[INFOR]: shape of y: (82, 1)
[INFOR]: get pretrained model
2021-09-13 12:52:32.009703: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 12:52:32.037602: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:52:32.042178: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:52:32.050324: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:52:32.052453: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:52:32.057567: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:52:32.061087: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:52:32.067236: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:52:32.072071: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:52:32.075866: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:52:32.078092: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:52:32.080054: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 12:52:32.093085: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x228b94e63e0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:52:32.096940: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 12:52:32.098993: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:52:32.103555: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:52:32.105938: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:52:32.108159: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:52:32.110860: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:52:32.113019: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:52:32.115175: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:52:32.117353: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:52:32.119970: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:52:32.122074: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:52:32.553142: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 12:52:32.556375: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 12:52:32.557793: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 12:52:32.559258: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 12:52:32.566464: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x228e353bab0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:52:32.569445: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 12:52:34.828454: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 12:52:36.006186: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:52:36.672241: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:52:36.679948: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:52:38.040041: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:52:38.088784: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:52:38.650756: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 264ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :15.0


[INFOR]: Index of second most vote     :408
[INFOR]: Class of second most vote     :amphibian, amphibious vehicle
[INFOR]: Number of second most vote    :6.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 74ms/step
[INFOR]: Toltal norm before transform: 0.5941
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0553

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 74ms/step
[INFOR]: SEN training of class 171_41 before transform: 15
[INFOR]: SPE training of class 171_41 before transform: 32

[INFOR]: SEN training of class 171_41 after transform: 41
[INFOR]: SPE training of class 171_41 after transform: 32
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (80, 32, 32, 3)
[INFOR]: shape of y: (80, 1)
3/3 [==============================] - 0s 72ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :12.0


[INFOR]: Index of second most vote     :408
[INFOR]: Class of second most vote     :amphibian, amphibious vehicle
[INFOR]: Number of second most vote    :8.0
[INFOR]: SEN testing of class 171_40 before transform: 12
[INFOR]: SPE testing of class 171_40 before transform: 23

[INFOR]: SEN testing of class 171_40 after transform: 40
[INFOR]: SPE testing of class 171_40 after transform: 0
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name stanford_car --class_name_train 172_38 --class_name_test 172_37
2021-09-13 12:52:43.569034: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  stanford_car
class_name_train =  172_38
class_name_test =  172_37
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (76, 32, 32, 3)
[INFOR]: shape of y: (76, 1)
[INFOR]: get pretrained model
2021-09-13 12:52:46.067946: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 12:52:46.092189: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:52:46.097067: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:52:46.105091: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:52:46.107252: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:52:46.112480: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:52:46.115772: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:52:46.122037: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:52:46.127008: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:52:46.130259: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:52:46.132414: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:52:46.134343: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 12:52:46.146749: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1cb35e46f30 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:52:46.149878: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 12:52:46.151872: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:52:46.156452: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:52:46.158592: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:52:46.160712: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:52:46.162814: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:52:46.165334: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:52:46.167455: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:52:46.169624: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:52:46.171735: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:52:46.174183: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:52:46.609407: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 12:52:46.612341: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 12:52:46.613733: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 12:52:46.615242: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 12:52:46.622332: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1cb64b49130 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:52:46.625114: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 12:52:48.891126: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 12:52:50.072574: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:52:50.732862: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:52:50.740119: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:52:52.100162: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:52:52.150022: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:52:52.711085: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 247ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :19.0


[INFOR]: Index of second most vote     :482
[INFOR]: Class of second most vote     :cassette player
[INFOR]: Number of second most vote    :4.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 68ms/step
[INFOR]: Toltal norm before transform: 0.4879
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0462

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 70ms/step
[INFOR]: SEN training of class 172_38 before transform: 19
[INFOR]: SPE training of class 172_38 before transform: 26

[INFOR]: SEN training of class 172_38 after transform: 38
[INFOR]: SPE training of class 172_38 after transform: 26
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (74, 32, 32, 3)
[INFOR]: shape of y: (74, 1)
3/3 [==============================] - 0s 67ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :23.0


[INFOR]: Index of second most vote     :482
[INFOR]: Class of second most vote     :cassette player
[INFOR]: Number of second most vote    :3.0
[INFOR]: SEN testing of class 172_37 before transform: 23
[INFOR]: SPE testing of class 172_37 before transform: 21

[INFOR]: SEN testing of class 172_37 after transform: 37
[INFOR]: SPE testing of class 172_37 after transform: 0
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name stanford_car --class_name_train 173_49 --class_name_test 173_48
2021-09-13 12:52:57.595013: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  stanford_car
class_name_train =  173_49
class_name_test =  173_48
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (98, 32, 32, 3)
[INFOR]: shape of y: (98, 1)
[INFOR]: get pretrained model
2021-09-13 12:53:00.121677: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 12:53:00.148115: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:53:00.152682: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:53:00.160689: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:53:00.162782: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:53:00.167898: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:53:00.171293: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:53:00.177646: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:53:00.182726: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:53:00.186081: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:53:00.188311: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:53:00.190169: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 12:53:00.203300: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1dab2e9b030 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:53:00.206951: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 12:53:00.208985: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:53:00.213582: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:53:00.215705: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:53:00.217933: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:53:00.220510: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:53:00.222627: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:53:00.224695: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:53:00.226799: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:53:00.229345: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:53:00.231646: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:53:00.664686: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 12:53:00.667843: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 12:53:00.669323: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 12:53:00.670801: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 12:53:00.678242: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1dae2f26860 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:53:00.681061: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 12:53:02.936435: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 12:53:04.115924: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:53:04.775172: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:53:04.782701: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:53:06.145091: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:53:06.193120: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:53:06.755530: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
4/4 [==============================] - 4s 165ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :12.0


[INFOR]: Index of second most vote     :408
[INFOR]: Class of second most vote     :amphibian, amphibious vehicle
[INFOR]: Number of second most vote    :6.0

[INFOR]: Create PDF for Positive Label

4/4 [==============================] - 1s 62ms/step
[INFOR]: Toltal norm before transform: 0.7477
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1468

[INFOR]: Create PDF for Negative Label

4/4 [==============================] - 0s 63ms/step
[INFOR]: SEN training of class 173_49 before transform: 12
[INFOR]: SPE training of class 173_49 before transform: 31

[INFOR]: SEN training of class 173_49 after transform: 49
[INFOR]: SPE training of class 173_49 after transform: 31
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (96, 32, 32, 3)
[INFOR]: shape of y: (96, 1)
3/3 [==============================] - 1s 84ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :18.0


[INFOR]: Index of second most vote     :408
[INFOR]: Class of second most vote     :amphibian, amphibious vehicle
[INFOR]: Number of second most vote    :6.0
[INFOR]: SEN testing of class 173_48 before transform: 18
[INFOR]: SPE testing of class 173_48 before transform: 30

[INFOR]: SEN testing of class 173_48 after transform: 48
[INFOR]: SPE testing of class 173_48 after transform: 0
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name stanford_car --class_name_train 174_45 --class_name_test 174_45
2021-09-13 12:53:13.656920: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  stanford_car
class_name_train =  174_45
class_name_test =  174_45
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (90, 32, 32, 3)
[INFOR]: shape of y: (90, 1)
[INFOR]: get pretrained model
2021-09-13 12:53:16.164641: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 12:53:16.189032: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:53:16.193689: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:53:16.201679: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:53:16.204001: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:53:16.209573: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:53:16.213021: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:53:16.219311: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:53:16.224266: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:53:16.227618: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:53:16.229904: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:53:16.231877: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 12:53:16.245329: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x19ab68d15b0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:53:16.248387: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 12:53:16.250543: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:53:16.255425: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:53:16.257724: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:53:16.260425: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:53:16.262733: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:53:16.264981: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:53:16.267107: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:53:16.269631: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:53:16.271741: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:53:16.273921: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:53:16.708743: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 12:53:16.711697: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 12:53:16.713050: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 12:53:16.714701: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 12:53:16.721903: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x19ae48e9110 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:53:16.724698: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 12:53:19.000861: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 12:53:20.188978: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:53:20.844622: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:53:20.852049: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:53:22.221660: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:53:22.269716: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:53:22.835272: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 291ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :11.0


[INFOR]: Index of second most vote     :408
[INFOR]: Class of second most vote     :amphibian, amphibious vehicle
[INFOR]: Number of second most vote    :4.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 79ms/step
[INFOR]: Toltal norm before transform: 0.7169
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1800

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 80ms/step
[INFOR]: SEN training of class 174_45 before transform: 11
[INFOR]: SPE training of class 174_45 before transform: 26

[INFOR]: SEN training of class 174_45 after transform: 41
[INFOR]: SPE training of class 174_45 after transform: 26
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (90, 32, 32, 3)
[INFOR]: shape of y: (90, 1)
3/3 [==============================] - 0s 80ms/step
[INFOR]: Index of most vote   :491
[INFOR]: Class of most vote   :chain saw, chainsaw
[INFOR]: Number of most vote  :6.0


[INFOR]: Index of second most vote     :674
[INFOR]: Class of second most vote     :mousetrap
[INFOR]: Number of second most vote    :6.0
[INFOR]: SEN testing of class 174_45 before transform: 6
[INFOR]: SPE testing of class 174_45 before transform: 45

[INFOR]: SEN testing of class 174_45 after transform: 44
[INFOR]: SPE testing of class 174_45 after transform: 3
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name stanford_car --class_name_train 175_43 --class_name_test 175_43
2021-09-13 12:53:27.498286: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  stanford_car
class_name_train =  175_43
class_name_test =  175_43
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (86, 32, 32, 3)
[INFOR]: shape of y: (86, 1)
[INFOR]: get pretrained model
2021-09-13 12:53:30.032226: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 12:53:30.057199: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:53:30.061908: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:53:30.069857: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:53:30.071946: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:53:30.077192: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:53:30.080560: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:53:30.086863: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:53:30.091894: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:53:30.095084: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:53:30.097282: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:53:30.099153: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 12:53:30.111714: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1ec3b358b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:53:30.114875: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 12:53:30.116879: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:53:30.121457: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:53:30.123729: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:53:30.125842: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:53:30.127995: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:53:30.130524: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:53:30.132602: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:53:30.134689: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:53:30.136789: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:53:30.139315: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:53:30.572310: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 12:53:30.575417: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 12:53:30.576854: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 12:53:30.578353: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 12:53:30.585391: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1ec6533ebd0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:53:30.588284: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 12:53:32.853154: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 12:53:34.030355: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:53:34.693725: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:53:34.700578: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:53:36.062076: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:53:36.113166: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:53:36.675133: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 277ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :7.0


[INFOR]: Index of second most vote     :511
[INFOR]: Class of second most vote     :convertible
[INFOR]: Number of second most vote    :5.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 76ms/step
[INFOR]: Toltal norm before transform: 0.8455
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.2784

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 77ms/step
[INFOR]: SEN training of class 175_43 before transform: 7
[INFOR]: SPE training of class 175_43 before transform: 32

[INFOR]: SEN training of class 175_43 after transform: 42
[INFOR]: SPE training of class 175_43 after transform: 32
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (86, 32, 32, 3)
[INFOR]: shape of y: (86, 1)
3/3 [==============================] - 0s 77ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :12.0


[INFOR]: Index of second most vote     :408
[INFOR]: Class of second most vote     :amphibian, amphibious vehicle
[INFOR]: Number of second most vote    :10.0
[INFOR]: SEN testing of class 175_43 before transform: 12
[INFOR]: SPE testing of class 175_43 before transform: 28

[INFOR]: SEN testing of class 175_43 after transform: 43
[INFOR]: SPE testing of class 175_43 after transform: 0
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name stanford_car --class_name_train 176_45 --class_name_test 176_45
2021-09-13 12:53:41.227355: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  stanford_car
class_name_train =  176_45
class_name_test =  176_45
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (90, 32, 32, 3)
[INFOR]: shape of y: (90, 1)
[INFOR]: get pretrained model
2021-09-13 12:53:43.745338: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 12:53:43.769995: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:53:43.774606: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:53:43.782449: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:53:43.784650: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:53:43.789707: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:53:43.793072: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:53:43.799441: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:53:43.804319: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:53:43.807674: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:53:43.809810: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:53:43.811637: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 12:53:43.824654: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1f236b1da20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:53:43.828118: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 12:53:43.830128: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:53:43.834794: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:53:43.836943: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:53:43.839159: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:53:43.841292: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:53:43.843908: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:53:43.846082: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:53:43.848217: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:53:43.850856: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:53:43.852971: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:53:44.284211: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 12:53:44.287646: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 12:53:44.289002: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 12:53:44.290587: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 12:53:44.297992: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1f26163eb10 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:53:44.301014: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 12:53:46.547598: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 12:53:47.724314: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:53:48.390952: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:53:48.398672: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:53:49.754079: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:53:49.810790: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:53:50.380709: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 291ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :16.0


[INFOR]: Index of second most vote     :586
[INFOR]: Class of second most vote     :half track
[INFOR]: Number of second most vote    :5.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 79ms/step
[INFOR]: Toltal norm before transform: 0.6143
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.3084

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 80ms/step
[INFOR]: SEN training of class 176_45 before transform: 16
[INFOR]: SPE training of class 176_45 before transform: 29

[INFOR]: SEN training of class 176_45 after transform: 43
[INFOR]: SPE training of class 176_45 after transform: 29
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (90, 32, 32, 3)
[INFOR]: shape of y: (90, 1)
3/3 [==============================] - 0s 80ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :13.0


[INFOR]: Index of second most vote     :408
[INFOR]: Class of second most vote     :amphibian, amphibious vehicle
[INFOR]: Number of second most vote    :12.0
[INFOR]: SEN testing of class 176_45 before transform: 13
[INFOR]: SPE testing of class 176_45 before transform: 29

[INFOR]: SEN testing of class 176_45 after transform: 45
[INFOR]: SPE testing of class 176_45 after transform: 0
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name stanford_car --class_name_train 177_45 --class_name_test 177_45
2021-09-13 12:53:55.010513: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  stanford_car
class_name_train =  177_45
class_name_test =  177_45
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (90, 32, 32, 3)
[INFOR]: shape of y: (90, 1)
[INFOR]: get pretrained model
2021-09-13 12:53:57.529067: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 12:53:57.554236: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:53:57.558961: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:53:57.567232: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:53:57.569535: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:53:57.575203: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:53:57.578724: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:53:57.585538: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:53:57.590561: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:53:57.593646: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:53:57.595904: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:53:57.597875: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 12:53:57.610624: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x226b9f50800 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:53:57.613687: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 12:53:57.615707: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:53:57.620462: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:53:57.622591: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:53:57.624684: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:53:57.627273: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:53:57.629414: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:53:57.631458: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:53:57.633578: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:53:57.636142: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:53:57.638586: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:53:58.070311: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 12:53:58.073271: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 12:53:58.074622: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 12:53:58.076090: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 12:53:58.083135: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x226e2ef3270 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:53:58.085935: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 12:54:00.357856: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 12:54:01.541023: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:54:02.199640: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:54:02.206780: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:54:03.566944: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:54:03.618190: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:54:04.179238: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 289ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :16.0


[INFOR]: Index of second most vote     :855
[INFOR]: Class of second most vote     :thimble
[INFOR]: Number of second most vote    :4.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 80ms/step
[INFOR]: Toltal norm before transform: 0.6259
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0043

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 79ms/step
[INFOR]: SEN training of class 177_45 before transform: 16
[INFOR]: SPE training of class 177_45 before transform: 31

[INFOR]: SEN training of class 177_45 after transform: 45
[INFOR]: SPE training of class 177_45 after transform: 31
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (90, 32, 32, 3)
[INFOR]: shape of y: (90, 1)
3/3 [==============================] - 0s 80ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :16.0


[INFOR]: Index of second most vote     :408
[INFOR]: Class of second most vote     :amphibian, amphibious vehicle
[INFOR]: Number of second most vote    :9.0
[INFOR]: SEN testing of class 177_45 before transform: 16
[INFOR]: SPE testing of class 177_45 before transform: 29

[INFOR]: SEN testing of class 177_45 after transform: 44
[INFOR]: SPE testing of class 177_45 after transform: 1
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name stanford_car --class_name_train 178_41 --class_name_test 178_40
2021-09-13 12:54:08.832681: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  stanford_car
class_name_train =  178_41
class_name_test =  178_40
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (82, 32, 32, 3)
[INFOR]: shape of y: (82, 1)
[INFOR]: get pretrained model
2021-09-13 12:54:11.377978: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 12:54:11.402489: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:54:11.406715: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:54:11.414741: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:54:11.416835: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:54:11.422065: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:54:11.425597: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:54:11.431754: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:54:11.436748: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:54:11.440077: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:54:11.442188: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:54:11.444046: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 12:54:11.457114: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1d6b5ce9e70 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:54:11.460670: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 12:54:11.462711: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:54:11.467324: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:54:11.469541: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:54:11.471673: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:54:11.473804: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:54:11.476563: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:54:11.478661: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:54:11.480881: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:54:11.483474: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:54:11.485628: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:54:11.916280: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 12:54:11.919567: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 12:54:11.921010: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 12:54:11.922651: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 12:54:11.929862: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1d6df2c3760 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:54:11.932775: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 12:54:14.194447: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 12:54:15.383268: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:54:16.047993: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:54:16.055354: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:54:17.412521: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:54:17.460623: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:54:18.020791: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 263ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :20.0


[INFOR]: Index of second most vote     :408
[INFOR]: Class of second most vote     :amphibian, amphibious vehicle
[INFOR]: Number of second most vote    :4.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 73ms/step
[INFOR]: Toltal norm before transform: 0.4447
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0647

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 75ms/step
[INFOR]: SEN training of class 178_41 before transform: 20
[INFOR]: SPE training of class 178_41 before transform: 27

[INFOR]: SEN training of class 178_41 after transform: 41
[INFOR]: SPE training of class 178_41 after transform: 27
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (80, 32, 32, 3)
[INFOR]: shape of y: (80, 1)
3/3 [==============================] - 0s 72ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :23.0


[INFOR]: Index of second most vote     :408
[INFOR]: Class of second most vote     :amphibian, amphibious vehicle
[INFOR]: Number of second most vote    :8.0
[INFOR]: SEN testing of class 178_40 before transform: 23
[INFOR]: SPE testing of class 178_40 before transform: 29

[INFOR]: SEN testing of class 178_40 after transform: 40
[INFOR]: SPE testing of class 178_40 after transform: 0
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name stanford_car --class_name_train 179_42 --class_name_test 179_42
2021-09-13 12:54:22.974810: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  stanford_car
class_name_train =  179_42
class_name_test =  179_42
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (84, 32, 32, 3)
[INFOR]: shape of y: (84, 1)
[INFOR]: get pretrained model
2021-09-13 12:54:25.479099: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 12:54:25.502887: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:54:25.507401: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:54:25.515498: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:54:25.517678: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:54:25.522986: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:54:25.526295: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:54:25.532495: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:54:25.537460: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:54:25.540702: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:54:25.542922: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:54:25.544807: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 12:54:25.557151: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1aeb5ee46a0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:54:25.560354: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 12:54:25.562413: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:54:25.567041: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:54:25.569211: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:54:25.571372: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:54:25.573498: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:54:25.576127: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:54:25.578266: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:54:25.580366: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:54:25.582471: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:54:25.585098: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:54:26.011260: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 12:54:26.014280: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 12:54:26.015659: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 12:54:26.017123: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 12:54:26.024259: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1aee0215a50 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:54:26.027112: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 12:54:28.303933: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 12:54:29.491279: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:54:30.151308: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:54:30.158150: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:54:31.521285: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:54:31.576550: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:54:32.141169: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 270ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :20.0


[INFOR]: Index of second most vote     :408
[INFOR]: Class of second most vote     :amphibian, amphibious vehicle
[INFOR]: Number of second most vote    :3.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 75ms/step
[INFOR]: Toltal norm before transform: 0.4740
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0082

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 75ms/step
[INFOR]: SEN training of class 179_42 before transform: 20
[INFOR]: SPE training of class 179_42 before transform: 31

[INFOR]: SEN training of class 179_42 after transform: 40
[INFOR]: SPE training of class 179_42 after transform: 31
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (84, 32, 32, 3)
[INFOR]: shape of y: (84, 1)
3/3 [==============================] - 0s 75ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :16.0


[INFOR]: Index of second most vote     :408
[INFOR]: Class of second most vote     :amphibian, amphibious vehicle
[INFOR]: Number of second most vote    :7.0
[INFOR]: SEN testing of class 179_42 before transform: 16
[INFOR]: SPE testing of class 179_42 before transform: 27

[INFOR]: SEN testing of class 179_42 after transform: 42
[INFOR]: SPE testing of class 179_42 after transform: 0
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name stanford_car --class_name_train 180_44 --class_name_test 180_43
2021-09-13 12:54:36.707415: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  stanford_car
class_name_train =  180_44
class_name_test =  180_43
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (88, 32, 32, 3)
[INFOR]: shape of y: (88, 1)
[INFOR]: get pretrained model
2021-09-13 12:54:39.234117: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 12:54:39.259506: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:54:39.264367: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:54:39.272425: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:54:39.274522: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:54:39.279509: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:54:39.282794: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:54:39.289228: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:54:39.294058: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:54:39.297402: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:54:39.299617: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:54:39.301451: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 12:54:39.314433: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1bb361f4860 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:54:39.317883: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 12:54:39.319898: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:54:39.324542: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:54:39.326668: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:54:39.328833: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:54:39.331443: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:54:39.333552: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:54:39.335625: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:54:39.337824: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:54:39.340356: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:54:39.342424: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:54:39.770843: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 12:54:39.773930: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 12:54:39.775391: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 12:54:39.776984: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 12:54:39.784252: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1bb646f79d0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:54:39.787154: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 12:54:42.058194: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 12:54:43.244279: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:54:43.908447: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:54:43.916044: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:54:45.280010: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:54:45.329900: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:54:45.890669: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 276ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :21.0


[INFOR]: Index of second most vote     :408
[INFOR]: Class of second most vote     :amphibian, amphibious vehicle
[INFOR]: Number of second most vote    :7.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 78ms/step
[INFOR]: Toltal norm before transform: 0.4514
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.2423

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 78ms/step
[INFOR]: SEN training of class 180_44 before transform: 21
[INFOR]: SPE training of class 180_44 before transform: 26

[INFOR]: SEN training of class 180_44 after transform: 43
[INFOR]: SPE training of class 180_44 after transform: 26
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (86, 32, 32, 3)
[INFOR]: shape of y: (86, 1)
3/3 [==============================] - 0s 77ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :20.0


[INFOR]: Index of second most vote     :408
[INFOR]: Class of second most vote     :amphibian, amphibious vehicle
[INFOR]: Number of second most vote    :7.0
[INFOR]: SEN testing of class 180_43 before transform: 20
[INFOR]: SPE testing of class 180_43 before transform: 23

[INFOR]: SEN testing of class 180_43 after transform: 43
[INFOR]: SPE testing of class 180_43 after transform: 1
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name stanford_car --class_name_train 181_43 --class_name_test 181_42
2021-09-13 12:54:50.932800: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  stanford_car
class_name_train =  181_43
class_name_test =  181_42
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (86, 32, 32, 3)
[INFOR]: shape of y: (86, 1)
[INFOR]: get pretrained model
2021-09-13 12:54:53.475656: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 12:54:53.501120: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:54:53.506423: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:54:53.514425: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:54:53.516896: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:54:53.522576: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:54:53.526040: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:54:53.532516: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:54:53.537513: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:54:53.540355: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:54:53.542584: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:54:53.544429: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 12:54:53.557114: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1ffba236040 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:54:53.560502: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 12:54:53.562506: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:54:53.567085: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:54:53.569318: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:54:53.571505: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:54:53.574030: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:54:53.576138: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:54:53.578213: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:54:53.580586: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:54:53.583109: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:54:53.585203: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:54:54.017511: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 12:54:54.020320: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 12:54:54.021699: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 12:54:54.023202: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 12:54:54.030316: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1ffe5714d00 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:54:54.033230: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 12:54:56.290169: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 12:54:57.477689: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:54:58.142313: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:54:58.149372: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:54:59.503839: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:54:59.552901: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:55:00.112329: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 276ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :17.0


[INFOR]: Index of second most vote     :408
[INFOR]: Class of second most vote     :amphibian, amphibious vehicle
[INFOR]: Number of second most vote    :9.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 76ms/step
[INFOR]: Toltal norm before transform: 0.6004
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0612

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 77ms/step
[INFOR]: SEN training of class 181_43 before transform: 17
[INFOR]: SPE training of class 181_43 before transform: 32

[INFOR]: SEN training of class 181_43 after transform: 38
[INFOR]: SPE training of class 181_43 after transform: 32
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (84, 32, 32, 3)
[INFOR]: shape of y: (84, 1)
3/3 [==============================] - 0s 77ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :20.0


[INFOR]: Index of second most vote     :408
[INFOR]: Class of second most vote     :amphibian, amphibious vehicle
[INFOR]: Number of second most vote    :6.0
[INFOR]: SEN testing of class 181_42 before transform: 20
[INFOR]: SPE testing of class 181_42 before transform: 26

[INFOR]: SEN testing of class 181_42 after transform: 42
[INFOR]: SPE testing of class 181_42 after transform: 0
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name stanford_car --class_name_train 182_44 --class_name_test 182_44
2021-09-13 12:55:05.129615: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  stanford_car
class_name_train =  182_44
class_name_test =  182_44
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (88, 32, 32, 3)
[INFOR]: shape of y: (88, 1)
[INFOR]: get pretrained model
2021-09-13 12:55:07.591608: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 12:55:07.617352: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:55:07.622724: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:55:07.630692: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:55:07.632837: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:55:07.637952: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:55:07.641344: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:55:07.647821: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:55:07.652730: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:55:07.655968: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:55:07.658087: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:55:07.659974: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 12:55:07.672371: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x18db66cf510 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:55:07.675632: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 12:55:07.677628: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:55:07.682304: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:55:07.684421: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:55:07.686516: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:55:07.689007: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:55:07.691570: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:55:07.693632: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:55:07.695728: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:55:07.697922: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:55:07.700398: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:55:08.126733: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 12:55:08.129670: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 12:55:08.131011: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 12:55:08.132466: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 12:55:08.139695: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x18de59c3a30 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:55:08.142631: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 12:55:10.396322: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 12:55:11.577234: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:55:12.240989: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:55:12.248582: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:55:13.607282: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:55:13.655720: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:55:14.216627: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 278ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :13.0


[INFOR]: Index of second most vote     :855
[INFOR]: Class of second most vote     :thimble
[INFOR]: Number of second most vote    :6.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 79ms/step
[INFOR]: Toltal norm before transform: 0.6530
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.2947

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 78ms/step
[INFOR]: SEN training of class 182_44 before transform: 13
[INFOR]: SPE training of class 182_44 before transform: 26

[INFOR]: SEN training of class 182_44 after transform: 39
[INFOR]: SPE training of class 182_44 after transform: 26
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (88, 32, 32, 3)
[INFOR]: shape of y: (88, 1)
3/3 [==============================] - 0s 78ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :17.0


[INFOR]: Index of second most vote     :855
[INFOR]: Class of second most vote     :thimble
[INFOR]: Number of second most vote    :6.0
[INFOR]: SEN testing of class 182_44 before transform: 17
[INFOR]: SPE testing of class 182_44 before transform: 33

[INFOR]: SEN testing of class 182_44 after transform: 44
[INFOR]: SPE testing of class 182_44 after transform: 0
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name stanford_car --class_name_train 183_40 --class_name_test 183_39
2021-09-13 12:55:18.829552: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  stanford_car
class_name_train =  183_40
class_name_test =  183_39
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (80, 32, 32, 3)
[INFOR]: shape of y: (80, 1)
[INFOR]: get pretrained model
2021-09-13 12:55:21.389011: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 12:55:21.414508: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:55:21.419156: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:55:21.427426: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:55:21.429683: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:55:21.435187: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:55:21.438777: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:55:21.445150: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:55:21.450225: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:55:21.453610: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:55:21.455958: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:55:21.457849: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 12:55:21.470268: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1ea3538ef20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:55:21.473552: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 12:55:21.475610: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:55:21.480173: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:55:21.482428: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:55:21.484540: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:55:21.487248: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:55:21.489527: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:55:21.491639: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:55:21.493820: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:55:21.496523: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:55:21.498635: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:55:21.942110: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 12:55:21.945174: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 12:55:21.946512: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 12:55:21.948050: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 12:55:21.955370: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1ea63ef6280 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:55:21.958153: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 12:55:24.222648: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 12:55:25.406952: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:55:26.074244: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:55:26.081101: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:55:27.445402: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:55:27.499315: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:55:28.061180: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 253ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :25.0


[INFOR]: Index of second most vote     :408
[INFOR]: Class of second most vote     :amphibian, amphibious vehicle
[INFOR]: Number of second most vote    :3.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 72ms/step
[INFOR]: Toltal norm before transform: 0.3288
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1071

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 72ms/step
[INFOR]: SEN training of class 183_40 before transform: 25
[INFOR]: SPE training of class 183_40 before transform: 25

[INFOR]: SEN training of class 183_40 after transform: 40
[INFOR]: SPE training of class 183_40 after transform: 25
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (78, 32, 32, 3)
[INFOR]: shape of y: (78, 1)
3/3 [==============================] - 0s 71ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :19.0


[INFOR]: Index of second most vote     :662
[INFOR]: Class of second most vote     :modem
[INFOR]: Number of second most vote    :4.0
[INFOR]: SEN testing of class 183_39 before transform: 19
[INFOR]: SPE testing of class 183_39 before transform: 24

[INFOR]: SEN testing of class 183_39 after transform: 39
[INFOR]: SPE testing of class 183_39 after transform: 0
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name stanford_car --class_name_train 184_44 --class_name_test 184_44
2021-09-13 12:55:32.976073: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  stanford_car
class_name_train =  184_44
class_name_test =  184_44
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (88, 32, 32, 3)
[INFOR]: shape of y: (88, 1)
[INFOR]: get pretrained model
2021-09-13 12:55:35.517131: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 12:55:35.542778: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:55:35.547874: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:55:35.555956: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:55:35.558106: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:55:35.563677: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:55:35.567154: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:55:35.573944: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:55:35.579041: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:55:35.582057: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:55:35.584280: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:55:35.586145: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 12:55:35.598103: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x2b1b3620500 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:55:35.601255: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 12:55:35.603269: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:55:35.607985: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:55:35.610102: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:55:35.612186: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:55:35.614698: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:55:35.616817: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:55:35.618891: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:55:35.621156: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:55:35.623258: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:55:35.625858: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:55:36.056470: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 12:55:36.059608: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 12:55:36.060982: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 12:55:36.062456: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 12:55:36.069624: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x2b1d49e1320 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:55:36.072483: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 12:55:38.337828: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 12:55:39.523389: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:55:40.182585: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:55:40.189494: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:55:41.547304: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:55:41.595450: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:55:42.156388: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 279ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :18.0


[INFOR]: Index of second most vote     :855
[INFOR]: Class of second most vote     :thimble
[INFOR]: Number of second most vote    :5.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 79ms/step
[INFOR]: Toltal norm before transform: 0.5798
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0672

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 79ms/step
[INFOR]: SEN training of class 184_44 before transform: 18
[INFOR]: SPE training of class 184_44 before transform: 32

[INFOR]: SEN training of class 184_44 after transform: 44
[INFOR]: SPE training of class 184_44 after transform: 32
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (88, 32, 32, 3)
[INFOR]: shape of y: (88, 1)
3/3 [==============================] - 0s 78ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :19.0


[INFOR]: Index of second most vote     :408
[INFOR]: Class of second most vote     :amphibian, amphibious vehicle
[INFOR]: Number of second most vote    :4.0
[INFOR]: SEN testing of class 184_44 before transform: 19
[INFOR]: SPE testing of class 184_44 before transform: 29

[INFOR]: SEN testing of class 184_44 after transform: 42
[INFOR]: SPE testing of class 184_44 after transform: 0
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name stanford_car --class_name_train 185_41 --class_name_test 185_41
2021-09-13 12:55:46.776482: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  stanford_car
class_name_train =  185_41
class_name_test =  185_41
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (82, 32, 32, 3)
[INFOR]: shape of y: (82, 1)
[INFOR]: get pretrained model
2021-09-13 12:55:49.316018: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 12:55:49.341999: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:55:49.347012: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:55:49.355177: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:55:49.357429: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:55:49.363139: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:55:49.366687: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:55:49.373198: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:55:49.378437: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:55:49.381300: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:55:49.383410: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:55:49.385249: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 12:55:49.397978: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x19938073b10 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:55:49.401140: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 12:55:49.403190: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:55:49.407689: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:55:49.409898: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:55:49.412017: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:55:49.414509: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:55:49.416533: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:55:49.418659: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:55:49.420838: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:55:49.423363: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:55:49.425422: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:55:49.853941: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 12:55:49.856956: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 12:55:49.858296: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 12:55:49.859752: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 12:55:49.866748: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x19966ed6dc0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:55:49.869522: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 12:55:52.107448: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 12:55:53.293818: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:55:53.953609: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:55:53.959894: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:55:55.328543: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:55:55.384317: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:55:55.946152: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 265ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :5.0


[INFOR]: Index of second most vote     :491
[INFOR]: Class of second most vote     :chain saw, chainsaw
[INFOR]: Number of second most vote    :4.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 74ms/step
[INFOR]: Toltal norm before transform: 0.8748
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.2403

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 74ms/step
[INFOR]: SEN training of class 185_41 before transform: 5
[INFOR]: SPE training of class 185_41 before transform: 24

[INFOR]: SEN training of class 185_41 after transform: 41
[INFOR]: SPE training of class 185_41 after transform: 24
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (82, 32, 32, 3)
[INFOR]: shape of y: (82, 1)
3/3 [==============================] - 0s 73ms/step
[INFOR]: Index of most vote   :491
[INFOR]: Class of most vote   :chain saw, chainsaw
[INFOR]: Number of most vote  :6.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :4.0
[INFOR]: SEN testing of class 185_41 before transform: 6
[INFOR]: SPE testing of class 185_41 before transform: 41

[INFOR]: SEN testing of class 185_41 after transform: 41
[INFOR]: SPE testing of class 185_41 after transform: 0
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name stanford_car --class_name_train 186_41 --class_name_test 186_41
2021-09-13 12:56:00.505437: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  stanford_car
class_name_train =  186_41
class_name_test =  186_41
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (82, 32, 32, 3)
[INFOR]: shape of y: (82, 1)
[INFOR]: get pretrained model
2021-09-13 12:56:03.052835: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 12:56:03.076214: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:56:03.080433: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:56:03.088450: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:56:03.090544: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:56:03.095635: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:56:03.099068: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:56:03.105351: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:56:03.110267: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:56:03.113579: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:56:03.115738: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:56:03.117636: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 12:56:03.129693: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x22433583a10 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:56:03.133284: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 12:56:03.135268: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:56:03.139838: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:56:03.141966: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:56:03.144145: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:56:03.146242: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:56:03.148810: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:56:03.150887: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:56:03.153082: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:56:03.155186: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:56:03.157683: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:56:03.585538: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 12:56:03.588846: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 12:56:03.590205: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 12:56:03.591659: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 12:56:03.598823: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x2245b7431f0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:56:03.601595: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 12:56:05.881765: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 12:56:07.071959: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:56:07.737658: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:56:07.744851: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:56:09.104246: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:56:09.152673: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:56:09.714401: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 266ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :17.0


[INFOR]: Index of second most vote     :408
[INFOR]: Class of second most vote     :amphibian, amphibious vehicle
[INFOR]: Number of second most vote    :6.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 75ms/step
[INFOR]: Toltal norm before transform: 0.5482
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.2393

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 74ms/step
[INFOR]: SEN training of class 186_41 before transform: 17
[INFOR]: SPE training of class 186_41 before transform: 25

[INFOR]: SEN training of class 186_41 after transform: 39
[INFOR]: SPE training of class 186_41 after transform: 25
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (82, 32, 32, 3)
[INFOR]: shape of y: (82, 1)
3/3 [==============================] - 0s 74ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :13.0


[INFOR]: Index of second most vote     :408
[INFOR]: Class of second most vote     :amphibian, amphibious vehicle
[INFOR]: Number of second most vote    :8.0
[INFOR]: SEN testing of class 186_41 before transform: 13
[INFOR]: SPE testing of class 186_41 before transform: 25

[INFOR]: SEN testing of class 186_41 after transform: 40
[INFOR]: SPE testing of class 186_41 after transform: 0
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name stanford_car --class_name_train 187_39 --class_name_test 187_38
2021-09-13 12:56:14.258581: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  stanford_car
class_name_train =  187_39
class_name_test =  187_38
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (78, 32, 32, 3)
[INFOR]: shape of y: (78, 1)
[INFOR]: get pretrained model
2021-09-13 12:56:16.756601: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 12:56:16.781859: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:56:16.786589: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:56:16.794553: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:56:16.796819: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:56:16.802235: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:56:16.805482: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:56:16.811769: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:56:16.816677: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:56:16.820014: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:56:16.822276: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:56:16.824253: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 12:56:16.837833: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1f7b92ff7d0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:56:16.841802: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 12:56:16.843965: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:56:16.848912: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:56:16.851204: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:56:16.853480: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:56:16.856178: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:56:16.858343: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:56:16.860416: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:56:16.862602: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:56:16.865100: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:56:16.867264: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:56:17.296441: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 12:56:17.299553: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 12:56:17.301003: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 12:56:17.302585: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 12:56:17.309958: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1f7e833ef70 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:56:17.312868: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 12:56:19.569803: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 12:56:20.752701: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:56:21.418438: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:56:21.425884: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:56:22.789291: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:56:22.838150: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:56:23.398396: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 257ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :16.0


[INFOR]: Index of second most vote     :408
[INFOR]: Class of second most vote     :amphibian, amphibious vehicle
[INFOR]: Number of second most vote    :9.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 71ms/step
[INFOR]: Toltal norm before transform: 0.5822
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1991

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 70ms/step
[INFOR]: SEN training of class 187_39 before transform: 16
[INFOR]: SPE training of class 187_39 before transform: 21

[INFOR]: SEN training of class 187_39 after transform: 39
[INFOR]: SPE training of class 187_39 after transform: 21
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (76, 32, 32, 3)
[INFOR]: shape of y: (76, 1)
3/3 [==============================] - 0s 69ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :12.0


[INFOR]: Index of second most vote     :408
[INFOR]: Class of second most vote     :amphibian, amphibious vehicle
[INFOR]: Number of second most vote    :9.0
[INFOR]: SEN testing of class 187_38 before transform: 12
[INFOR]: SPE testing of class 187_38 before transform: 26

[INFOR]: SEN testing of class 187_38 after transform: 38
[INFOR]: SPE testing of class 187_38 after transform: 0
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name stanford_car --class_name_train 188_40 --class_name_test 188_40
2021-09-13 12:56:28.288217: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  stanford_car
class_name_train =  188_40
class_name_test =  188_40
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (80, 32, 32, 3)
[INFOR]: shape of y: (80, 1)
[INFOR]: get pretrained model
2021-09-13 12:56:30.801870: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 12:56:30.826888: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:56:30.831680: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:56:30.839725: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:56:30.841866: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:56:30.846948: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:56:30.850325: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:56:30.856601: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:56:30.861537: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:56:30.864820: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:56:30.866901: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:56:30.868740: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 12:56:30.881691: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x22cb4515c50 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:56:30.885116: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 12:56:30.887177: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:56:30.891930: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:56:30.894085: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:56:30.896261: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:56:30.898395: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:56:30.900927: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:56:30.903042: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:56:30.905301: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:56:30.907388: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:56:30.909850: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:56:31.334623: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 12:56:31.337249: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 12:56:31.338648: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 12:56:31.340125: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 12:56:31.347005: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x22cdddfd3e0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:56:31.349849: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 12:56:33.620373: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 12:56:34.805108: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:56:35.465313: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:56:35.472196: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:56:36.828415: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:56:36.877190: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:56:37.438420: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 253ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :17.0


[INFOR]: Index of second most vote     :408
[INFOR]: Class of second most vote     :amphibian, amphibious vehicle
[INFOR]: Number of second most vote    :5.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 72ms/step
[INFOR]: Toltal norm before transform: 0.5283
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0409

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 73ms/step
[INFOR]: SEN training of class 188_40 before transform: 17
[INFOR]: SPE training of class 188_40 before transform: 28

[INFOR]: SEN training of class 188_40 after transform: 40
[INFOR]: SPE training of class 188_40 after transform: 28
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (80, 32, 32, 3)
[INFOR]: shape of y: (80, 1)
3/3 [==============================] - 0s 73ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :15.0


[INFOR]: Index of second most vote     :408
[INFOR]: Class of second most vote     :amphibian, amphibious vehicle
[INFOR]: Number of second most vote    :4.0
[INFOR]: SEN testing of class 188_40 before transform: 15
[INFOR]: SPE testing of class 188_40 before transform: 21

[INFOR]: SEN testing of class 188_40 after transform: 40
[INFOR]: SPE testing of class 188_40 after transform: 0
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name stanford_car --class_name_train 189_39 --class_name_test 189_39
2021-09-13 12:56:41.949706: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  stanford_car
class_name_train =  189_39
class_name_test =  189_39
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (78, 32, 32, 3)
[INFOR]: shape of y: (78, 1)
[INFOR]: get pretrained model
2021-09-13 12:56:44.430567: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 12:56:44.455051: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:56:44.460021: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:56:44.468008: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:56:44.470218: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:56:44.475454: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:56:44.478823: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:56:44.485204: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:56:44.490249: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:56:44.493590: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:56:44.495876: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:56:44.497828: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 12:56:44.510090: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x23f335c6e00 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:56:44.513365: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 12:56:44.515361: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:56:44.520066: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:56:44.522233: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:56:44.524402: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:56:44.526632: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:56:44.529260: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:56:44.531306: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:56:44.533443: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:56:44.535546: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:56:44.538152: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:56:44.962225: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 12:56:44.965291: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 12:56:44.966619: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 12:56:44.968067: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 12:56:44.975322: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x23f5dff3f70 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:56:44.978128: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 12:56:47.225765: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 12:56:48.416446: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:56:49.080851: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:56:49.087584: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:56:50.450219: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:56:50.500105: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:56:51.062425: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 254ms/step
[INFOR]: Index of most vote   :510
[INFOR]: Class of most vote   :container ship, containership, container vessel
[INFOR]: Number of most vote  :10.0


[INFOR]: Index of second most vote     :674
[INFOR]: Class of second most vote     :mousetrap
[INFOR]: Number of second most vote    :10.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 70ms/step
[INFOR]: Toltal norm before transform: 0.7552
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.2259

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 71ms/step
[INFOR]: SEN training of class 189_39 before transform: 10
[INFOR]: SPE training of class 189_39 before transform: 38

[INFOR]: SEN training of class 189_39 after transform: 37
[INFOR]: SPE training of class 189_39 after transform: 36
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (78, 32, 32, 3)
[INFOR]: shape of y: (78, 1)
3/3 [==============================] - 0s 71ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :12.0


[INFOR]: Index of second most vote     :408
[INFOR]: Class of second most vote     :amphibian, amphibious vehicle
[INFOR]: Number of second most vote    :7.0
[INFOR]: SEN testing of class 189_39 before transform: 12
[INFOR]: SPE testing of class 189_39 before transform: 21

[INFOR]: SEN testing of class 189_39 after transform: 39
[INFOR]: SPE testing of class 189_39 after transform: 1
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name stanford_car --class_name_train 190_44 --class_name_test 190_43
2021-09-13 12:56:55.565438: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  stanford_car
class_name_train =  190_44
class_name_test =  190_43
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (88, 32, 32, 3)
[INFOR]: shape of y: (88, 1)
[INFOR]: get pretrained model
2021-09-13 12:56:58.094736: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 12:56:58.119556: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:56:58.124837: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:56:58.132883: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:56:58.134964: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:56:58.139992: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:56:58.143561: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:56:58.149945: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:56:58.154902: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:56:58.158232: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:56:58.160564: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:56:58.162501: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 12:56:58.175510: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x201b42fa1e0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:56:58.178751: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 12:56:58.180795: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:56:58.185412: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:56:58.187707: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:56:58.189804: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:56:58.192440: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:56:58.194605: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:56:58.196825: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:56:58.199023: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:56:58.201532: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:56:58.203666: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:56:58.637996: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 12:56:58.640911: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 12:56:58.642390: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 12:56:58.643963: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 12:56:58.651133: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x201dc119780 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:56:58.653997: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 12:57:00.914591: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 12:57:02.111449: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:57:02.775436: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:57:02.782551: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:57:04.139497: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:57:04.189361: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:57:04.751131: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 278ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :17.0


[INFOR]: Index of second most vote     :408
[INFOR]: Class of second most vote     :amphibian, amphibious vehicle
[INFOR]: Number of second most vote    :4.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 78ms/step
[INFOR]: Toltal norm before transform: 0.5220
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0136

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 78ms/step
[INFOR]: SEN training of class 190_44 before transform: 17
[INFOR]: SPE training of class 190_44 before transform: 30

[INFOR]: SEN training of class 190_44 after transform: 42
[INFOR]: SPE training of class 190_44 after transform: 30
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (86, 32, 32, 3)
[INFOR]: shape of y: (86, 1)
3/3 [==============================] - 0s 77ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :14.0


[INFOR]: Index of second most vote     :408
[INFOR]: Class of second most vote     :amphibian, amphibious vehicle
[INFOR]: Number of second most vote    :7.0
[INFOR]: SEN testing of class 190_43 before transform: 14
[INFOR]: SPE testing of class 190_43 before transform: 25

[INFOR]: SEN testing of class 190_43 after transform: 40
[INFOR]: SPE testing of class 190_43 after transform: 0
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name stanford_car --class_name_train 191_46 --class_name_test 191_45
2021-09-13 12:57:09.790922: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  stanford_car
class_name_train =  191_46
class_name_test =  191_45
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (92, 32, 32, 3)
[INFOR]: shape of y: (92, 1)
[INFOR]: get pretrained model
2021-09-13 12:57:12.324880: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 12:57:12.349056: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:57:12.353983: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:57:12.362127: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:57:12.364367: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:57:12.369539: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:57:12.373044: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:57:12.379304: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:57:12.384292: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:57:12.387645: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:57:12.389873: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:57:12.391727: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 12:57:12.404621: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1cab5c39fd0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:57:12.407633: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 12:57:12.409663: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:57:12.414469: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:57:12.416813: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:57:12.418900: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:57:12.421472: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:57:12.423706: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:57:12.425898: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:57:12.428108: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:57:12.430721: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:57:12.432819: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:57:12.856378: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 12:57:12.859464: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 12:57:12.860829: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 12:57:12.862336: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 12:57:12.869485: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1cae3c511f0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:57:12.872354: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 12:57:15.117392: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 12:57:16.290481: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:57:16.951112: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:57:16.958394: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:57:18.330475: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:57:18.379603: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:57:18.942177: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 298ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :23.0


[INFOR]: Index of second most vote     :855
[INFOR]: Class of second most vote     :thimble
[INFOR]: Number of second most vote    :5.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 80ms/step
[INFOR]: Toltal norm before transform: 0.4179
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1515

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 81ms/step
[INFOR]: SEN training of class 191_46 before transform: 23
[INFOR]: SPE training of class 191_46 before transform: 25

[INFOR]: SEN training of class 191_46 after transform: 46
[INFOR]: SPE training of class 191_46 after transform: 25
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (90, 32, 32, 3)
[INFOR]: shape of y: (90, 1)
3/3 [==============================] - 0s 80ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :29.0


[INFOR]: Index of second most vote     :855
[INFOR]: Class of second most vote     :thimble
[INFOR]: Number of second most vote    :3.0
[INFOR]: SEN testing of class 191_45 before transform: 29
[INFOR]: SPE testing of class 191_45 before transform: 28

[INFOR]: SEN testing of class 191_45 after transform: 45
[INFOR]: SPE testing of class 191_45 after transform: 0
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name stanford_car --class_name_train 192_41 --class_name_test 192_41
2021-09-13 12:57:24.102433: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  stanford_car
class_name_train =  192_41
class_name_test =  192_41
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (82, 32, 32, 3)
[INFOR]: shape of y: (82, 1)
[INFOR]: get pretrained model
2021-09-13 12:57:26.610972: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 12:57:26.637467: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:57:26.642617: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:57:26.650603: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:57:26.652762: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:57:26.658000: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:57:26.661436: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:57:26.667781: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:57:26.672722: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:57:26.676014: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:57:26.678321: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:57:26.680214: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 12:57:26.692797: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1f1b778cbe0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:57:26.695831: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 12:57:26.697857: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:57:26.702507: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:57:26.704629: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:57:26.706770: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:57:26.708927: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:57:26.711494: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:57:26.713701: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:57:26.715966: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:57:26.718069: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:57:26.720688: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:57:27.144075: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 12:57:27.147179: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 12:57:27.148528: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 12:57:27.150000: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 12:57:27.157084: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1f1e277bdf0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:57:27.159877: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 12:57:29.422609: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 12:57:30.613180: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:57:31.276199: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:57:31.283388: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:57:32.644198: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:57:32.699242: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:57:33.266227: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 266ms/step
[INFOR]: Index of most vote   :510
[INFOR]: Class of most vote   :container ship, containership, container vessel
[INFOR]: Number of most vote  :9.0


[INFOR]: Index of second most vote     :408
[INFOR]: Class of second most vote     :amphibian, amphibious vehicle
[INFOR]: Number of second most vote    :4.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 74ms/step
[INFOR]: Toltal norm before transform: 0.7757
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1134

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 73ms/step
[INFOR]: SEN training of class 192_41 before transform: 9
[INFOR]: SPE training of class 192_41 before transform: 39

[INFOR]: SEN training of class 192_41 after transform: 41
[INFOR]: SPE training of class 192_41 after transform: 38
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (82, 32, 32, 3)
[INFOR]: shape of y: (82, 1)
3/3 [==============================] - 0s 74ms/step
[INFOR]: Index of most vote   :510
[INFOR]: Class of most vote   :container ship, containership, container vessel
[INFOR]: Number of most vote  :13.0


[INFOR]: Index of second most vote     :674
[INFOR]: Class of second most vote     :mousetrap
[INFOR]: Number of second most vote    :10.0
[INFOR]: SEN testing of class 192_41 before transform: 13
[INFOR]: SPE testing of class 192_41 before transform: 41

[INFOR]: SEN testing of class 192_41 after transform: 40
[INFOR]: SPE testing of class 192_41 after transform: 1
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name stanford_car --class_name_train 193_42 --class_name_test 193_42
2021-09-13 12:57:37.844140: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  stanford_car
class_name_train =  193_42
class_name_test =  193_42
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (84, 32, 32, 3)
[INFOR]: shape of y: (84, 1)
[INFOR]: get pretrained model
2021-09-13 12:57:40.362580: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 12:57:40.385865: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:57:40.390136: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:57:40.398194: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:57:40.400507: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:57:40.405581: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:57:40.408938: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:57:40.415233: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:57:40.420101: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:57:40.423388: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:57:40.425690: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:57:40.427594: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 12:57:40.439839: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1bd36e30a00 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:57:40.443405: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 12:57:40.445456: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:57:40.450321: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:57:40.452549: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:57:40.454672: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:57:40.456853: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:57:40.459436: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:57:40.461533: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:57:40.463673: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:57:40.465918: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:57:40.468565: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:57:40.900572: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 12:57:40.903609: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 12:57:40.905034: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 12:57:40.906557: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 12:57:40.913510: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1bd62365760 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:57:40.916346: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 12:57:43.173625: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 12:57:44.356840: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:57:45.019350: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:57:45.026246: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:57:46.394539: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:57:46.449748: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:57:47.012739: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 271ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :8.0


[INFOR]: Index of second most vote     :408
[INFOR]: Class of second most vote     :amphibian, amphibious vehicle
[INFOR]: Number of second most vote    :6.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 75ms/step
[INFOR]: Toltal norm before transform: 0.8117
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.3325

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 76ms/step
[INFOR]: SEN training of class 193_42 before transform: 8
[INFOR]: SPE training of class 193_42 before transform: 29

[INFOR]: SEN training of class 193_42 after transform: 39
[INFOR]: SPE training of class 193_42 after transform: 29
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (84, 32, 32, 3)
[INFOR]: shape of y: (84, 1)
3/3 [==============================] - 0s 76ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :13.0


[INFOR]: Index of second most vote     :408
[INFOR]: Class of second most vote     :amphibian, amphibious vehicle
[INFOR]: Number of second most vote    :3.0
[INFOR]: SEN testing of class 193_42 before transform: 13
[INFOR]: SPE testing of class 193_42 before transform: 30

[INFOR]: SEN testing of class 193_42 after transform: 41
[INFOR]: SPE testing of class 193_42 after transform: 1
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name stanford_car --class_name_train 194_46 --class_name_test 194_46
2021-09-13 12:57:51.559013: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  stanford_car
class_name_train =  194_46
class_name_test =  194_46
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (92, 32, 32, 3)
[INFOR]: shape of y: (92, 1)
[INFOR]: get pretrained model
2021-09-13 12:57:54.086823: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 12:57:54.112249: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:57:54.117073: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:57:54.125119: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:57:54.127285: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:57:54.132633: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:57:54.136022: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:57:54.142276: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:57:54.147311: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:57:54.150589: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:57:54.152846: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:57:54.154747: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 12:57:54.167019: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x2cfb8f21590 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:57:54.170006: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 12:57:54.172093: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:57:54.176808: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:57:54.179010: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:57:54.181115: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:57:54.183251: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:57:54.185796: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:57:54.187966: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:57:54.190102: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:57:54.192246: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:57:54.194847: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:57:54.624054: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 12:57:54.627438: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 12:57:54.628786: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 12:57:54.630265: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 12:57:54.637334: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x2cfe4a21a80 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:57:54.640141: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 12:57:56.891748: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 12:57:58.069821: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:57:58.728108: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:57:58.735099: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:58:00.098706: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:58:00.148151: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:58:00.711799: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 295ms/step
[INFOR]: Index of most vote   :408
[INFOR]: Class of most vote   :amphibian, amphibious vehicle
[INFOR]: Number of most vote  :7.0


[INFOR]: Index of second most vote     :674
[INFOR]: Class of second most vote     :mousetrap
[INFOR]: Number of second most vote    :7.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 81ms/step
[INFOR]: Toltal norm before transform: 0.8362
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.3243

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 81ms/step
[INFOR]: SEN training of class 194_46 before transform: 7
[INFOR]: SPE training of class 194_46 before transform: 42

[INFOR]: SEN training of class 194_46 after transform: 44
[INFOR]: SPE training of class 194_46 after transform: 42
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (92, 32, 32, 3)
[INFOR]: shape of y: (92, 1)
3/3 [==============================] - 0s 83ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :13.0


[INFOR]: Index of second most vote     :408
[INFOR]: Class of second most vote     :amphibian, amphibious vehicle
[INFOR]: Number of second most vote    :5.0
[INFOR]: SEN testing of class 194_46 before transform: 13
[INFOR]: SPE testing of class 194_46 before transform: 31

[INFOR]: SEN testing of class 194_46 after transform: 46
[INFOR]: SPE testing of class 194_46 after transform: 1
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name stanford_car --class_name_train 195_28 --class_name_test 195_27
2021-09-13 12:58:05.399180: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  stanford_car
class_name_train =  195_28
class_name_test =  195_27
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (56, 32, 32, 3)
[INFOR]: shape of y: (56, 1)
[INFOR]: get pretrained model
2021-09-13 12:58:07.899574: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 12:58:07.925560: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:58:07.930352: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:58:07.938651: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:58:07.940741: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:58:07.946005: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:58:07.949395: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:58:07.955660: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:58:07.960578: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:58:07.963786: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:58:07.965884: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:58:07.967705: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 12:58:07.980575: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x233b9b97720 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:58:07.984227: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 12:58:07.986256: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:58:07.991007: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:58:07.993179: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:58:07.995305: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:58:07.997879: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:58:08.000005: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:58:08.002038: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:58:08.004131: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:58:08.006596: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:58:08.008669: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:58:08.435198: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 12:58:08.438299: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 12:58:08.439689: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 12:58:08.441181: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 12:58:08.448015: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x233e8895250 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:58:08.451039: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 12:58:10.732450: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 12:58:11.923706: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:58:12.581915: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:58:12.588191: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:58:13.948916: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:58:14.000322: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:58:14.566213: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
2/2 [==============================] - 4s 490ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :7.0


[INFOR]: Index of second most vote     :855
[INFOR]: Class of second most vote     :thimble
[INFOR]: Number of second most vote    :3.0

[INFOR]: Create PDF for Positive Label

2/2 [==============================] - 1s 93ms/step
[INFOR]: Toltal norm before transform: 0.7253
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1938

[INFOR]: Create PDF for Negative Label

2/2 [==============================] - 0s 94ms/step
[INFOR]: SEN training of class 195_28 before transform: 7
[INFOR]: SPE training of class 195_28 before transform: 18

[INFOR]: SEN training of class 195_28 after transform: 28
[INFOR]: SPE training of class 195_28 after transform: 18
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (54, 32, 32, 3)
[INFOR]: shape of y: (54, 1)
2/2 [==============================] - 0s 91ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :5.0


[INFOR]: Index of second most vote     :482
[INFOR]: Class of second most vote     :cassette player
[INFOR]: Number of second most vote    :3.0
[INFOR]: SEN testing of class 195_27 before transform: 5
[INFOR]: SPE testing of class 195_27 before transform: 18

[INFOR]: SEN testing of class 195_27 after transform: 27
[INFOR]: SPE testing of class 195_27 after transform: 0
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>