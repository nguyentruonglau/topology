model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
[INFOR]: get pretrained model
2021-09-13 10:03:51.348032: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 10:03:51.374809: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 10:03:51.380980: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 10:03:51.388900: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:03:51.391091: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:03:51.396818: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 10:03:51.400229: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 10:03:51.406697: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 10:03:51.411985: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 10:03:51.414934: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:03:51.417102: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 10:03:51.419030: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 10:03:51.431689: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x26ab4b29a00 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 10:03:51.434744: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 10:03:51.436819: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 10:03:51.441259: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 10:03:51.443652: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:03:51.445836: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:03:51.448648: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 10:03:51.451020: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 10:03:51.453267: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 10:03:51.455529: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 10:03:51.458197: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:03:51.460389: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 10:03:51.899058: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 10:03:51.902173: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 10:03:51.903645: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 10:03:51.905147: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 10:03:51.911895: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x26ae3ac8e10 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 10:03:51.914738: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 10:03:54.204481: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 10:03:55.397537: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:03:56.039035: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:03:56.045199: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:03:57.404371: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 10:03:57.453016: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 10:03:58.020919: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 219ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :20.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :13.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 62ms/step
[INFOR]: Toltal norm before transform: 0.3248
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0412

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 63ms/step
[INFOR]: SEN training of class 37_33 before transform: 20
[INFOR]: SPE training of class 37_33 before transform: 21

[INFOR]: SEN training of class 37_33 after transform: 28
[INFOR]: SPE training of class 37_33 after transform: 21
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
3/3 [==============================] - 0s 62ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :18.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :12.0
[INFOR]: SEN testing of class 37_33 before transform: 18
[INFOR]: SPE testing of class 37_33 before transform: 22

[INFOR]: SEN testing of class 37_33 after transform: 32
[INFOR]: SPE testing of class 37_33 after transform: 2
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name fgvc_aircraft --class_name_train 38_33 --class_name_test 38_34
2021-09-13 10:04:02.393166: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  fgvc_aircraft
class_name_train =  38_33
class_name_test =  38_34
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
[INFOR]: get pretrained model
2021-09-13 10:04:04.893973: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 10:04:04.920374: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 10:04:04.925740: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 10:04:04.933844: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:04:04.936071: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:04:04.941344: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 10:04:04.944942: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 10:04:04.951253: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 10:04:04.956334: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 10:04:04.959407: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:04:04.961684: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 10:04:04.963628: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 10:04:04.975557: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1f032dbae70 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 10:04:04.979024: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 10:04:04.981430: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 10:04:04.986057: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 10:04:04.988303: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:04:04.990704: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:04:04.992963: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 10:04:04.995180: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 10:04:04.997463: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 10:04:04.999921: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 10:04:05.002177: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:04:05.004424: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 10:04:05.430368: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 10:04:05.433481: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 10:04:05.434885: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 10:04:05.436435: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 10:04:05.443377: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1f062fa8640 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 10:04:05.446433: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 10:04:07.710085: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 10:04:08.907116: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:04:09.549214: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:04:09.556736: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:04:10.902867: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 10:04:10.958310: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 10:04:11.550298: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 219ms/step
[INFOR]: Index of most vote   :510
[INFOR]: Class of most vote   :container ship, containership, container vessel
[INFOR]: Number of most vote  :14.0


[INFOR]: Index of second most vote     :404
[INFOR]: Class of second most vote     :airliner
[INFOR]: Number of second most vote    :13.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 63ms/step
[INFOR]: Toltal norm before transform: 0.6450
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0492

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 62ms/step
[INFOR]: SEN training of class 38_33 before transform: 14
[INFOR]: SPE training of class 38_33 before transform: 20

[INFOR]: SEN training of class 38_33 after transform: 26
[INFOR]: SPE training of class 38_33 after transform: 20
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (68, 32, 32, 3)
[INFOR]: shape of y: (68, 1)
3/3 [==============================] - 0s 63ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :16.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :14.0
[INFOR]: SEN testing of class 38_34 before transform: 16
[INFOR]: SPE testing of class 38_34 before transform: 23

[INFOR]: SEN testing of class 38_34 after transform: 34
[INFOR]: SPE testing of class 38_34 after transform: 0
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name fgvc_aircraft --class_name_train 39_34 --class_name_test 39_33
2021-09-13 10:04:16.332419: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  fgvc_aircraft
class_name_train =  39_34
class_name_test =  39_33
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (68, 32, 32, 3)
[INFOR]: shape of y: (68, 1)
[INFOR]: get pretrained model
2021-09-13 10:04:18.922345: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 10:04:18.948923: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 10:04:18.954029: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 10:04:18.961977: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:04:18.964155: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:04:18.969636: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 10:04:18.973044: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 10:04:18.979309: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 10:04:18.984574: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 10:04:18.987570: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:04:18.989746: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 10:04:18.991654: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 10:04:19.004607: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x15ab43f1980 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 10:04:19.007881: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 10:04:19.009973: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 10:04:19.014602: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 10:04:19.016817: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:04:19.019004: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:04:19.021411: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 10:04:19.023705: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 10:04:19.025930: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 10:04:19.028203: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 10:04:19.030548: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:04:19.034091: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 10:04:19.485618: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 10:04:19.488444: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 10:04:19.489875: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 10:04:19.491616: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 10:04:19.498204: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x15ae23db970 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 10:04:19.501052: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 10:04:21.829153: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 10:04:23.050410: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:04:23.702680: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:04:23.709959: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:04:25.056182: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 10:04:25.104548: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 10:04:25.699696: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 227ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :15.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :12.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 63ms/step
[INFOR]: Toltal norm before transform: 0.4911
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0806

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 63ms/step
[INFOR]: SEN training of class 39_34 before transform: 15
[INFOR]: SPE training of class 39_34 before transform: 19

[INFOR]: SEN training of class 39_34 after transform: 26
[INFOR]: SPE training of class 39_34 after transform: 19
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
3/3 [==============================] - 0s 64ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :19.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :5.0
[INFOR]: SEN testing of class 39_33 before transform: 19
[INFOR]: SPE testing of class 39_33 before transform: 19

[INFOR]: SEN testing of class 39_33 after transform: 31
[INFOR]: SPE testing of class 39_33 after transform: 7
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name fgvc_aircraft --class_name_train 40_33 --class_name_test 40_33
2021-09-13 10:04:30.495352: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  fgvc_aircraft
class_name_train =  40_33
class_name_test =  40_33
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
[INFOR]: get pretrained model
2021-09-13 10:04:33.064484: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 10:04:33.088535: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 10:04:33.093617: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 10:04:33.101980: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:04:33.104355: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:04:33.109622: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 10:04:33.113175: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 10:04:33.119896: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 10:04:33.126499: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 10:04:33.129931: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:04:33.132340: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 10:04:33.134414: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 10:04:33.146246: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1e833bfa340 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 10:04:33.149460: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 10:04:33.151718: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 10:04:33.156309: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 10:04:33.158774: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:04:33.161032: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:04:33.163322: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 10:04:33.165838: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 10:04:33.168147: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 10:04:33.170448: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 10:04:33.172751: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:04:33.175024: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 10:04:33.598258: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 10:04:33.601164: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 10:04:33.602674: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 10:04:33.604219: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 10:04:33.611658: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1e85b6bdce0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 10:04:33.614514: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 10:04:35.884649: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 10:04:37.082897: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:04:37.737430: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:04:37.744629: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:04:39.103437: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 10:04:39.152659: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 10:04:39.755746: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 242ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :13.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :12.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 63ms/step
[INFOR]: Toltal norm before transform: 0.5468
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0070

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 62ms/step
[INFOR]: SEN training of class 40_33 before transform: 13
[INFOR]: SPE training of class 40_33 before transform: 21

[INFOR]: SEN training of class 40_33 after transform: 31
[INFOR]: SPE training of class 40_33 after transform: 21
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
3/3 [==============================] - 0s 70ms/step
[INFOR]: Index of most vote   :510
[INFOR]: Class of most vote   :container ship, containership, container vessel
[INFOR]: Number of most vote  :19.0


[INFOR]: Index of second most vote     :404
[INFOR]: Class of second most vote     :airliner
[INFOR]: Number of second most vote    :10.0
[INFOR]: SEN testing of class 40_33 before transform: 19
[INFOR]: SPE testing of class 40_33 before transform: 20

[INFOR]: SEN testing of class 40_33 after transform: 33
[INFOR]: SPE testing of class 40_33 after transform: 0
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name fgvc_aircraft --class_name_train 41_33 --class_name_test 41_34
2021-09-13 10:04:44.167993: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  fgvc_aircraft
class_name_train =  41_33
class_name_test =  41_34
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
[INFOR]: get pretrained model
2021-09-13 10:04:46.706734: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 10:04:46.730278: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 10:04:46.735248: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 10:04:46.743257: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:04:46.745426: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:04:46.750733: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 10:04:46.754092: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 10:04:46.760393: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 10:04:46.765353: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 10:04:46.768451: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:04:46.770633: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 10:04:46.772505: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 10:04:46.784678: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x2a039dbef90 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 10:04:46.788002: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 10:04:46.790118: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 10:04:46.794485: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 10:04:46.796770: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:04:46.799102: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:04:46.801554: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 10:04:46.804024: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 10:04:46.806312: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 10:04:46.808568: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 10:04:46.810823: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:04:46.813352: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 10:04:47.237321: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 10:04:47.240587: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 10:04:47.241982: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 10:04:47.243522: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 10:04:47.250037: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x2a06a39ade0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 10:04:47.253233: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 10:04:49.566205: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 10:04:50.771562: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:04:51.414118: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:04:51.421354: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:04:52.748304: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 10:04:52.797299: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 10:04:53.363967: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 233ms/step
[INFOR]: Index of most vote   :510
[INFOR]: Class of most vote   :container ship, containership, container vessel
[INFOR]: Number of most vote  :14.0


[INFOR]: Index of second most vote     :404
[INFOR]: Class of second most vote     :airliner
[INFOR]: Number of second most vote    :10.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 63ms/step
[INFOR]: Toltal norm before transform: 0.5987
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1361

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 63ms/step
[INFOR]: SEN training of class 41_33 before transform: 14
[INFOR]: SPE training of class 41_33 before transform: 17

[INFOR]: SEN training of class 41_33 after transform: 29
[INFOR]: SPE training of class 41_33 after transform: 17
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (68, 32, 32, 3)
[INFOR]: shape of y: (68, 1)
3/3 [==============================] - 0s 70ms/step
[INFOR]: Index of most vote   :510
[INFOR]: Class of most vote   :container ship, containership, container vessel
[INFOR]: Number of most vote  :19.0


[INFOR]: Index of second most vote     :404
[INFOR]: Class of second most vote     :airliner
[INFOR]: Number of second most vote    :10.0
[INFOR]: SEN testing of class 41_34 before transform: 19
[INFOR]: SPE testing of class 41_34 before transform: 26

[INFOR]: SEN testing of class 41_34 after transform: 30
[INFOR]: SPE testing of class 41_34 after transform: 6
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name fgvc_aircraft --class_name_train 42_34 --class_name_test 42_33
2021-09-13 10:04:58.143403: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  fgvc_aircraft
class_name_train =  42_34
class_name_test =  42_33
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (68, 32, 32, 3)
[INFOR]: shape of y: (68, 1)
[INFOR]: get pretrained model
2021-09-13 10:05:00.724436: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 10:05:00.750355: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 10:05:00.754815: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 10:05:00.762987: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:05:00.765159: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:05:00.770307: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 10:05:00.773989: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 10:05:00.780979: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 10:05:00.786095: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 10:05:00.789515: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:05:00.791725: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 10:05:00.793655: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 10:05:00.806051: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x261b47ad6f0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 10:05:00.809613: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 10:05:00.811925: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 10:05:00.816373: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 10:05:00.818570: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:05:00.820950: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:05:00.823258: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 10:05:00.825475: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 10:05:00.827751: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 10:05:00.830015: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 10:05:00.832360: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:05:00.834590: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 10:05:01.252914: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 10:05:01.256117: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 10:05:01.257528: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 10:05:01.259063: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 10:05:01.266063: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x261e2c703f0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 10:05:01.268897: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 10:05:03.559316: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 10:05:04.759792: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:05:05.428929: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:05:05.436003: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:05:06.760437: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 10:05:06.809739: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 10:05:07.376524: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 227ms/step
[INFOR]: Index of most vote   :510
[INFOR]: Class of most vote   :container ship, containership, container vessel
[INFOR]: Number of most vote  :10.0


[INFOR]: Index of second most vote     :811
[INFOR]: Class of second most vote     :space heater
[INFOR]: Number of second most vote    :9.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 63ms/step
[INFOR]: Toltal norm before transform: 0.6763
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.2338

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 70ms/step
[INFOR]: SEN training of class 42_34 before transform: 10
[INFOR]: SPE training of class 42_34 before transform: 18

[INFOR]: SEN training of class 42_34 after transform: 31
[INFOR]: SPE training of class 42_34 after transform: 18
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
3/3 [==============================] - 0s 63ms/step
[INFOR]: Index of most vote   :510
[INFOR]: Class of most vote   :container ship, containership, container vessel
[INFOR]: Number of most vote  :11.0


[INFOR]: Index of second most vote     :404
[INFOR]: Class of second most vote     :airliner
[INFOR]: Number of second most vote    :9.0
[INFOR]: SEN testing of class 42_33 before transform: 11
[INFOR]: SPE testing of class 42_33 before transform: 20

[INFOR]: SEN testing of class 42_33 after transform: 31
[INFOR]: SPE testing of class 42_33 after transform: 8
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name fgvc_aircraft --class_name_train 43_33 --class_name_test 43_33
2021-09-13 10:05:12.081593: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  fgvc_aircraft
class_name_train =  43_33
class_name_test =  43_33
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
[INFOR]: get pretrained model
2021-09-13 10:05:14.609176: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 10:05:14.635455: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 10:05:14.641295: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 10:05:14.649350: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:05:14.651559: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:05:14.656910: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 10:05:14.660587: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 10:05:14.666990: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 10:05:14.672160: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 10:05:14.675189: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:05:14.677614: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 10:05:14.679534: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 10:05:14.691641: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1adba453ae0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 10:05:14.695044: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 10:05:14.697216: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 10:05:14.701688: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 10:05:14.703954: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:05:14.706168: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:05:14.708405: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 10:05:14.710641: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 10:05:14.712872: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 10:05:14.715163: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 10:05:14.717484: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:05:14.719698: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 10:05:15.154882: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 10:05:15.158065: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 10:05:15.159481: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 10:05:15.160998: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 10:05:15.167596: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1ade49a4fa0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 10:05:15.170651: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 10:05:17.434160: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 10:05:18.648339: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:05:19.298771: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:05:19.305935: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:05:20.634754: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 10:05:20.693794: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 10:05:21.280729: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 220ms/step
[INFOR]: Index of most vote   :510
[INFOR]: Class of most vote   :container ship, containership, container vessel
[INFOR]: Number of most vote  :12.0


[INFOR]: Index of second most vote     :811
[INFOR]: Class of second most vote     :space heater
[INFOR]: Number of second most vote    :6.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 63ms/step
[INFOR]: Toltal norm before transform: 0.5832
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.2762

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 63ms/step
[INFOR]: SEN training of class 43_33 before transform: 12
[INFOR]: SPE training of class 43_33 before transform: 22

[INFOR]: SEN training of class 43_33 after transform: 32
[INFOR]: SPE training of class 43_33 after transform: 22
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
3/3 [==============================] - 0s 61ms/step
[INFOR]: Index of most vote   :510
[INFOR]: Class of most vote   :container ship, containership, container vessel
[INFOR]: Number of most vote  :17.0


[INFOR]: Index of second most vote     :404
[INFOR]: Class of second most vote     :airliner
[INFOR]: Number of second most vote    :5.0
[INFOR]: SEN testing of class 43_33 before transform: 17
[INFOR]: SPE testing of class 43_33 before transform: 19

[INFOR]: SEN testing of class 43_33 after transform: 31
[INFOR]: SPE testing of class 43_33 after transform: 1
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name fgvc_aircraft --class_name_train 44_33 --class_name_test 44_34
2021-09-13 10:05:25.643795: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  fgvc_aircraft
class_name_train =  44_33
class_name_test =  44_34
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
[INFOR]: get pretrained model
2021-09-13 10:05:28.217094: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 10:05:28.240149: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 10:05:28.244505: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 10:05:28.252736: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:05:28.254902: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:05:28.260053: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 10:05:28.263520: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 10:05:28.269692: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 10:05:28.274589: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 10:05:28.277535: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:05:28.279697: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 10:05:28.281579: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 10:05:28.293669: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x22b39825690 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 10:05:28.296984: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 10:05:28.299249: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 10:05:28.303546: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 10:05:28.305767: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:05:28.308039: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:05:28.310476: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 10:05:28.312673: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 10:05:28.315066: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 10:05:28.317361: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 10:05:28.319638: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:05:28.321834: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 10:05:28.735386: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 10:05:28.738162: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 10:05:28.739595: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 10:05:28.741141: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 10:05:28.748077: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x22b681b85a0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 10:05:28.750937: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 10:05:31.049998: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 10:05:32.267639: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:05:32.917012: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:05:32.924490: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:05:34.282021: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 10:05:34.332668: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 10:05:34.914867: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 250ms/step
[INFOR]: Index of most vote   :510
[INFOR]: Class of most vote   :container ship, containership, container vessel
[INFOR]: Number of most vote  :22.0


[INFOR]: Index of second most vote     :404
[INFOR]: Class of second most vote     :airliner
[INFOR]: Number of second most vote    :2.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 63ms/step
[INFOR]: Toltal norm before transform: 0.2281
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0587

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 63ms/step
[INFOR]: SEN training of class 44_33 before transform: 22
[INFOR]: SPE training of class 44_33 before transform: 16

[INFOR]: SEN training of class 44_33 after transform: 32
[INFOR]: SPE training of class 44_33 after transform: 16
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (68, 32, 32, 3)
[INFOR]: shape of y: (68, 1)
3/3 [==============================] - 0s 62ms/step
[INFOR]: Index of most vote   :510
[INFOR]: Class of most vote   :container ship, containership, container vessel
[INFOR]: Number of most vote  :17.0


[INFOR]: Index of second most vote     :811
[INFOR]: Class of second most vote     :space heater
[INFOR]: Number of second most vote    :3.0
[INFOR]: SEN testing of class 44_34 before transform: 17
[INFOR]: SPE testing of class 44_34 before transform: 24

[INFOR]: SEN testing of class 44_34 after transform: 33
[INFOR]: SPE testing of class 44_34 after transform: 3
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name fgvc_aircraft --class_name_train 45_34 --class_name_test 45_33
2021-09-13 10:05:39.737306: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  fgvc_aircraft
class_name_train =  45_34
class_name_test =  45_33
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (68, 32, 32, 3)
[INFOR]: shape of y: (68, 1)
[INFOR]: get pretrained model
2021-09-13 10:05:42.230608: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 10:05:42.255480: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 10:05:42.260892: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 10:05:42.268967: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:05:42.271214: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:05:42.276448: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 10:05:42.279970: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 10:05:42.286315: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 10:05:42.291448: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 10:05:42.294461: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:05:42.296707: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 10:05:42.298818: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 10:05:42.310930: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x16833518010 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 10:05:42.314427: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 10:05:42.316653: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 10:05:42.321211: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 10:05:42.323448: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:05:42.325884: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:05:42.328131: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 10:05:42.330376: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 10:05:42.332588: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 10:05:42.334833: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 10:05:42.337255: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:05:42.339459: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 10:05:42.762666: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 10:05:42.765732: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 10:05:42.767170: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 10:05:42.768819: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 10:05:42.775622: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x16862ac88e0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 10:05:42.778585: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 10:05:45.050514: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 10:05:46.261211: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:05:46.907868: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:05:46.915318: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:05:48.245394: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 10:05:48.293235: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 10:05:48.859393: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 221ms/step
[INFOR]: Index of most vote   :510
[INFOR]: Class of most vote   :container ship, containership, container vessel
[INFOR]: Number of most vote  :20.0


[INFOR]: Index of second most vote     :811
[INFOR]: Class of second most vote     :space heater
[INFOR]: Number of second most vote    :2.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 71ms/step
[INFOR]: Toltal norm before transform: 0.3377
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0635

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 62ms/step
[INFOR]: SEN training of class 45_34 before transform: 20
[INFOR]: SPE training of class 45_34 before transform: 23

[INFOR]: SEN training of class 45_34 after transform: 34
[INFOR]: SPE training of class 45_34 after transform: 23
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
3/3 [==============================] - 0s 63ms/step
[INFOR]: Index of most vote   :510
[INFOR]: Class of most vote   :container ship, containership, container vessel
[INFOR]: Number of most vote  :20.0


[INFOR]: Index of second most vote     :539
[INFOR]: Class of second most vote     :doormat, welcome mat
[INFOR]: Number of second most vote    :3.0
[INFOR]: SEN testing of class 45_33 before transform: 20
[INFOR]: SPE testing of class 45_33 before transform: 19

[INFOR]: SEN testing of class 45_33 after transform: 31
[INFOR]: SPE testing of class 45_33 after transform: 1
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name fgvc_aircraft --class_name_train 46_33 --class_name_test 46_33
2021-09-13 10:05:53.578706: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  fgvc_aircraft
class_name_train =  46_33
class_name_test =  46_33
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
[INFOR]: get pretrained model
2021-09-13 10:05:56.159340: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 10:05:56.185738: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 10:05:56.190998: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 10:05:56.199786: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:05:56.202034: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:05:56.207548: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 10:05:56.211026: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 10:05:56.217337: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 10:05:56.222411: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 10:05:56.225616: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:05:56.227818: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 10:05:56.229746: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 10:05:56.242274: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x21e3ab4f2b0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 10:05:56.245853: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 10:05:56.248025: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 10:05:56.252531: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 10:05:56.254848: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:05:56.257114: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:05:56.259414: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 10:05:56.261747: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 10:05:56.264044: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 10:05:56.266377: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 10:05:56.268983: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:05:56.271257: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 10:05:56.710847: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 10:05:56.714048: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 10:05:56.715427: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 10:05:56.716936: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 10:05:56.723899: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x21e646d8f20 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 10:05:56.726746: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 10:05:59.125450: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 10:06:00.346466: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:06:00.986669: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:06:00.993719: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:06:02.331561: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 10:06:02.380626: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 10:06:02.949463: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 227ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :18.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :12.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 70ms/step
[INFOR]: Toltal norm before transform: 0.2292
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0109

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 62ms/step
[INFOR]: SEN training of class 46_33 before transform: 18
[INFOR]: SPE training of class 46_33 before transform: 23

[INFOR]: SEN training of class 46_33 after transform: 30
[INFOR]: SPE training of class 46_33 after transform: 23
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
3/3 [==============================] - 0s 70ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :16.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :9.0
[INFOR]: SEN testing of class 46_33 before transform: 16
[INFOR]: SPE testing of class 46_33 before transform: 23

[INFOR]: SEN testing of class 46_33 after transform: 32
[INFOR]: SPE testing of class 46_33 after transform: 4
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name fgvc_aircraft --class_name_train 47_33 --class_name_test 47_34
2021-09-13 10:06:07.421276: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  fgvc_aircraft
class_name_train =  47_33
class_name_test =  47_34
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
[INFOR]: get pretrained model
2021-09-13 10:06:09.924497: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 10:06:09.950126: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 10:06:09.955000: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 10:06:09.963080: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:06:09.965248: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:06:09.970463: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 10:06:09.973854: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 10:06:09.980176: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 10:06:09.985129: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 10:06:09.988097: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:06:09.990463: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 10:06:09.992653: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 10:06:10.005089: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x22cb9912ab0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 10:06:10.008182: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 10:06:10.010489: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 10:06:10.015029: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 10:06:10.017281: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:06:10.019572: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:06:10.022100: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 10:06:10.025224: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 10:06:10.027473: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 10:06:10.029734: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 10:06:10.032102: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:06:10.034350: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 10:06:10.458838: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 10:06:10.462268: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 10:06:10.463677: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 10:06:10.465383: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 10:06:10.472027: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x22cdc94ff80 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 10:06:10.474876: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 10:06:12.783186: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 10:06:13.977359: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:06:14.626528: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:06:14.633511: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:06:15.957912: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 10:06:16.007865: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 10:06:16.573594: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 217ms/step
[INFOR]: Index of most vote   :510
[INFOR]: Class of most vote   :container ship, containership, container vessel
[INFOR]: Number of most vote  :20.0


[INFOR]: Index of second most vote     :404
[INFOR]: Class of second most vote     :airliner
[INFOR]: Number of second most vote    :8.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 62ms/step
[INFOR]: Toltal norm before transform: 0.3415
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0625

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 68ms/step
[INFOR]: SEN training of class 47_33 before transform: 20
[INFOR]: SPE training of class 47_33 before transform: 19

[INFOR]: SEN training of class 47_33 after transform: 30
[INFOR]: SPE training of class 47_33 after transform: 18
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (68, 32, 32, 3)
[INFOR]: shape of y: (68, 1)
3/3 [==============================] - 0s 62ms/step
[INFOR]: Index of most vote   :510
[INFOR]: Class of most vote   :container ship, containership, container vessel
[INFOR]: Number of most vote  :17.0


[INFOR]: Index of second most vote     :404
[INFOR]: Class of second most vote     :airliner
[INFOR]: Number of second most vote    :12.0
[INFOR]: SEN testing of class 47_34 before transform: 17
[INFOR]: SPE testing of class 47_34 before transform: 18

[INFOR]: SEN testing of class 47_34 after transform: 24
[INFOR]: SPE testing of class 47_34 after transform: 6
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name fgvc_aircraft --class_name_train 48_34 --class_name_test 48_33
2021-09-13 10:06:21.332121: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  fgvc_aircraft
class_name_train =  48_34
class_name_test =  48_33
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (68, 32, 32, 3)
[INFOR]: shape of y: (68, 1)
[INFOR]: get pretrained model
2021-09-13 10:06:23.876891: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 10:06:23.902235: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 10:06:23.907446: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 10:06:23.915469: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:06:23.917750: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:06:23.923008: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 10:06:23.926602: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 10:06:23.933151: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 10:06:23.938143: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 10:06:23.941363: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:06:23.943604: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 10:06:23.945713: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 10:06:23.957729: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x20535de6f00 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 10:06:23.961017: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 10:06:23.963238: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 10:06:23.967735: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 10:06:23.970001: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:06:23.972400: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:06:23.974660: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 10:06:23.976879: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 10:06:23.979104: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 10:06:23.981361: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 10:06:23.983686: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:06:23.986127: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 10:06:24.408872: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 10:06:24.411931: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 10:06:24.413316: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 10:06:24.414824: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 10:06:24.421591: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x20565560570 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 10:06:24.424452: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 10:06:26.680602: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 10:06:27.876855: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:06:28.519303: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:06:28.525884: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:06:29.845129: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 10:06:29.894052: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 10:06:30.465365: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 228ms/step
[INFOR]: Index of most vote   :510
[INFOR]: Class of most vote   :container ship, containership, container vessel
[INFOR]: Number of most vote  :16.0


[INFOR]: Index of second most vote     :404
[INFOR]: Class of second most vote     :airliner
[INFOR]: Number of second most vote    :10.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 62ms/step
[INFOR]: Toltal norm before transform: 0.6110
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1726

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 63ms/step
[INFOR]: SEN training of class 48_34 before transform: 16
[INFOR]: SPE training of class 48_34 before transform: 22

[INFOR]: SEN training of class 48_34 after transform: 24
[INFOR]: SPE training of class 48_34 after transform: 22
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
3/3 [==============================] - 0s 63ms/step
[INFOR]: Index of most vote   :510
[INFOR]: Class of most vote   :container ship, containership, container vessel
[INFOR]: Number of most vote  :16.0


[INFOR]: Index of second most vote     :404
[INFOR]: Class of second most vote     :airliner
[INFOR]: Number of second most vote    :11.0
[INFOR]: SEN testing of class 48_33 before transform: 16
[INFOR]: SPE testing of class 48_33 before transform: 16

[INFOR]: SEN testing of class 48_33 after transform: 26
[INFOR]: SPE testing of class 48_33 after transform: 3
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name fgvc_aircraft --class_name_train 49_33 --class_name_test 49_34
2021-09-13 10:06:35.127918: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  fgvc_aircraft
class_name_train =  49_33
class_name_test =  49_34
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
[INFOR]: get pretrained model
2021-09-13 10:06:37.671079: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 10:06:37.695704: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 10:06:37.700231: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 10:06:37.708350: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:06:37.710683: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:06:37.715831: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 10:06:37.719325: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 10:06:37.725503: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 10:06:37.730409: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 10:06:37.733345: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:06:37.735651: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 10:06:37.737579: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 10:06:37.750253: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x23b33f81d20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 10:06:37.754029: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 10:06:37.756140: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 10:06:37.760412: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 10:06:37.762703: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:06:37.764948: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:06:37.767421: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 10:06:37.769677: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 10:06:37.771899: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 10:06:37.774152: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 10:06:37.776456: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:06:37.778670: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 10:06:38.193574: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 10:06:38.196745: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 10:06:38.198151: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 10:06:38.199876: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 10:06:38.206560: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x23b5da2b800 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 10:06:38.209400: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 10:06:40.495070: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 10:06:41.695594: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:06:42.340314: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:06:42.346772: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:06:43.679200: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 10:06:43.729237: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 10:06:44.294798: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 220ms/step
[INFOR]: Index of most vote   :510
[INFOR]: Class of most vote   :container ship, containership, container vessel
[INFOR]: Number of most vote  :12.0


[INFOR]: Index of second most vote     :404
[INFOR]: Class of second most vote     :airliner
[INFOR]: Number of second most vote    :9.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 63ms/step
[INFOR]: Toltal norm before transform: 0.6406
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.2145

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 63ms/step
[INFOR]: SEN training of class 49_33 before transform: 12
[INFOR]: SPE training of class 49_33 before transform: 20

[INFOR]: SEN training of class 49_33 after transform: 28
[INFOR]: SPE training of class 49_33 after transform: 20
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (68, 32, 32, 3)
[INFOR]: shape of y: (68, 1)
3/3 [==============================] - 0s 71ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :21.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :12.0
[INFOR]: SEN testing of class 49_34 before transform: 21
[INFOR]: SPE testing of class 49_34 before transform: 23

[INFOR]: SEN testing of class 49_34 after transform: 34
[INFOR]: SPE testing of class 49_34 after transform: 1
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name fgvc_aircraft --class_name_train 50_34 --class_name_test 50_33
2021-09-13 10:06:48.992682: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  fgvc_aircraft
class_name_train =  50_34
class_name_test =  50_33
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (68, 32, 32, 3)
[INFOR]: shape of y: (68, 1)
[INFOR]: get pretrained model
2021-09-13 10:06:51.470248: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 10:06:51.506063: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 10:06:51.511820: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 10:06:51.520065: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:06:51.522546: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:06:51.527716: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 10:06:51.531188: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 10:06:51.537762: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 10:06:51.542823: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 10:06:51.545853: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:06:51.548085: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 10:06:51.550200: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 10:06:51.562535: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x207b5f6f810 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 10:06:51.565795: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 10:06:51.568201: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 10:06:51.572561: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 10:06:51.574801: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:06:51.577078: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:06:51.579326: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 10:06:51.581530: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 10:06:51.583858: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 10:06:51.586212: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 10:06:51.588653: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:06:51.590867: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 10:06:52.048141: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 10:06:52.051278: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 10:06:52.052684: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 10:06:52.054268: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 10:06:52.060823: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x207e42b68a0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 10:06:52.063694: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 10:06:54.336769: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 10:06:55.530325: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:06:56.178858: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:06:56.184851: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:06:57.510597: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 10:06:57.560357: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 10:06:58.124986: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 227ms/step
[INFOR]: Index of most vote   :510
[INFOR]: Class of most vote   :container ship, containership, container vessel
[INFOR]: Number of most vote  :19.0


[INFOR]: Index of second most vote     :404
[INFOR]: Class of second most vote     :airliner
[INFOR]: Number of second most vote    :9.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 70ms/step
[INFOR]: Toltal norm before transform: 0.4413
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0179

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 63ms/step
[INFOR]: SEN training of class 50_34 before transform: 19
[INFOR]: SPE training of class 50_34 before transform: 23

[INFOR]: SEN training of class 50_34 after transform: 29
[INFOR]: SPE training of class 50_34 after transform: 23
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
3/3 [==============================] - 0s 63ms/step
[INFOR]: Index of most vote   :510
[INFOR]: Class of most vote   :container ship, containership, container vessel
[INFOR]: Number of most vote  :14.0


[INFOR]: Index of second most vote     :404
[INFOR]: Class of second most vote     :airliner
[INFOR]: Number of second most vote    :13.0
[INFOR]: SEN testing of class 50_33 before transform: 14
[INFOR]: SPE testing of class 50_33 before transform: 16

[INFOR]: SEN testing of class 50_33 after transform: 24
[INFOR]: SPE testing of class 50_33 after transform: 4
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name fgvc_aircraft --class_name_train 51_33 --class_name_test 51_33
2021-09-13 10:07:02.846866: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  fgvc_aircraft
class_name_train =  51_33
class_name_test =  51_33
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
[INFOR]: get pretrained model
2021-09-13 10:07:05.411867: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 10:07:05.435241: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 10:07:05.440431: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 10:07:05.448343: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:07:05.450559: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:07:05.455860: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 10:07:05.460007: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 10:07:05.466373: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 10:07:05.471370: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 10:07:05.474343: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:07:05.476584: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 10:07:05.478498: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 10:07:05.490497: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1afb9380170 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 10:07:05.493788: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 10:07:05.495879: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 10:07:05.500165: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 10:07:05.502404: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:07:05.504592: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:07:05.506798: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 10:07:05.508974: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 10:07:05.511356: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 10:07:05.513690: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 10:07:05.515933: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:07:05.518349: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 10:07:05.941963: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 10:07:05.944807: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 10:07:05.946286: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 10:07:05.947881: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 10:07:05.954582: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1afe8169a00 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 10:07:05.957775: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 10:07:08.255636: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 10:07:09.477039: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:07:10.129037: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:07:10.135497: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:07:11.466490: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 10:07:11.519922: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 10:07:12.082443: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 219ms/step
[INFOR]: Index of most vote   :510
[INFOR]: Class of most vote   :container ship, containership, container vessel
[INFOR]: Number of most vote  :13.0


[INFOR]: Index of second most vote     :404
[INFOR]: Class of second most vote     :airliner
[INFOR]: Number of second most vote    :12.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 62ms/step
[INFOR]: Toltal norm before transform: 0.6646
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1755

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 62ms/step
[INFOR]: SEN training of class 51_33 before transform: 13
[INFOR]: SPE training of class 51_33 before transform: 20

[INFOR]: SEN training of class 51_33 after transform: 29
[INFOR]: SPE training of class 51_33 after transform: 20
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
3/3 [==============================] - 0s 70ms/step
[INFOR]: Index of most vote   :510
[INFOR]: Class of most vote   :container ship, containership, container vessel
[INFOR]: Number of most vote  :16.0


[INFOR]: Index of second most vote     :404
[INFOR]: Class of second most vote     :airliner
[INFOR]: Number of second most vote    :14.0
[INFOR]: SEN testing of class 51_33 before transform: 16
[INFOR]: SPE testing of class 51_33 before transform: 20

[INFOR]: SEN testing of class 51_33 after transform: 30
[INFOR]: SPE testing of class 51_33 after transform: 0
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name fgvc_aircraft --class_name_train 52_33 --class_name_test 52_33
2021-09-13 10:07:16.540867: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  fgvc_aircraft
class_name_train =  52_33
class_name_test =  52_33
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
[INFOR]: get pretrained model
2021-09-13 10:07:19.070214: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 10:07:19.094146: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 10:07:19.099496: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 10:07:19.107489: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:07:19.109717: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:07:19.115307: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 10:07:19.118776: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 10:07:19.125079: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 10:07:19.130170: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 10:07:19.133452: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:07:19.135754: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 10:07:19.137738: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 10:07:19.149889: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x22cb9c05950 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 10:07:19.153165: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 10:07:19.155399: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 10:07:19.159933: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 10:07:19.162305: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:07:19.164553: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:07:19.166805: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 10:07:19.169208: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 10:07:19.171426: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 10:07:19.173784: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 10:07:19.176026: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:07:19.178388: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 10:07:19.595741: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 10:07:19.599011: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 10:07:19.600470: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 10:07:19.602035: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 10:07:19.608729: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x22ce57f2490 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 10:07:19.611600: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 10:07:21.861266: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 10:07:23.059423: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:07:23.706000: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:07:23.713505: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:07:25.059299: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 10:07:25.109000: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 10:07:25.700368: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 219ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :14.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :12.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 66ms/step
[INFOR]: Toltal norm before transform: 0.5195
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1255

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 64ms/step
[INFOR]: SEN training of class 52_33 before transform: 14
[INFOR]: SPE training of class 52_33 before transform: 25

[INFOR]: SEN training of class 52_33 after transform: 29
[INFOR]: SPE training of class 52_33 after transform: 25
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
3/3 [==============================] - 0s 63ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :12.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :10.0
[INFOR]: SEN testing of class 52_33 before transform: 12
[INFOR]: SPE testing of class 52_33 before transform: 22

[INFOR]: SEN testing of class 52_33 after transform: 33
[INFOR]: SPE testing of class 52_33 after transform: 0
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name fgvc_aircraft --class_name_train 53_33 --class_name_test 53_34
2021-09-13 10:07:30.097155: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  fgvc_aircraft
class_name_train =  53_33
class_name_test =  53_34
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
[INFOR]: get pretrained model
2021-09-13 10:07:32.672943: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 10:07:32.696707: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 10:07:32.702176: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 10:07:32.710198: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:07:32.712458: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:07:32.717698: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 10:07:32.721154: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 10:07:32.727520: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 10:07:32.732628: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 10:07:32.735634: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:07:32.737860: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 10:07:32.739977: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 10:07:32.751960: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x2713b0051d0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 10:07:32.755516: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 10:07:32.757629: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 10:07:32.762073: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 10:07:32.764313: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:07:32.766568: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:07:32.768815: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 10:07:32.771175: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 10:07:32.773590: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 10:07:32.775899: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 10:07:32.778195: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:07:32.780418: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 10:07:33.210477: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 10:07:33.212978: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 10:07:33.214414: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 10:07:33.216335: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 10:07:33.223490: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x2716624f070 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 10:07:33.226350: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 10:07:35.505441: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 10:07:36.716616: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:07:37.360662: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:07:37.368099: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:07:38.713929: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 10:07:38.761489: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 10:07:39.329558: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 232ms/step
[INFOR]: Index of most vote   :510
[INFOR]: Class of most vote   :container ship, containership, container vessel
[INFOR]: Number of most vote  :12.0


[INFOR]: Index of second most vote     :820
[INFOR]: Class of second most vote     :steam locomotive
[INFOR]: Number of second most vote    :4.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 58ms/step
[INFOR]: Toltal norm before transform: 0.5828
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1076

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 63ms/step
[INFOR]: SEN training of class 53_33 before transform: 12
[INFOR]: SPE training of class 53_33 before transform: 15

[INFOR]: SEN training of class 53_33 after transform: 33
[INFOR]: SPE training of class 53_33 after transform: 15
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (68, 32, 32, 3)
[INFOR]: shape of y: (68, 1)
3/3 [==============================] - 0s 62ms/step
[INFOR]: Index of most vote   :510
[INFOR]: Class of most vote   :container ship, containership, container vessel
[INFOR]: Number of most vote  :8.0


[INFOR]: Index of second most vote     :404
[INFOR]: Class of second most vote     :airliner
[INFOR]: Number of second most vote    :4.0
[INFOR]: SEN testing of class 53_34 before transform: 8
[INFOR]: SPE testing of class 53_34 before transform: 18

[INFOR]: SEN testing of class 53_34 after transform: 34
[INFOR]: SPE testing of class 53_34 after transform: 0
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name fgvc_aircraft --class_name_train 54_34 --class_name_test 54_33
2021-09-13 10:07:44.092849: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  fgvc_aircraft
class_name_train =  54_34
class_name_test =  54_33
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (68, 32, 32, 3)
[INFOR]: shape of y: (68, 1)
[INFOR]: get pretrained model
2021-09-13 10:07:46.594328: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 10:07:46.621088: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 10:07:46.626256: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 10:07:46.634544: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:07:46.636719: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:07:46.641819: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 10:07:46.645397: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 10:07:46.651799: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 10:07:46.656724: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 10:07:46.659837: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:07:46.662013: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 10:07:46.664005: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 10:07:46.675624: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x196398d7420 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 10:07:46.678947: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 10:07:46.681214: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 10:07:46.685718: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 10:07:46.687938: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:07:46.690121: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:07:46.692341: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 10:07:46.694528: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 10:07:46.697395: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 10:07:46.699825: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 10:07:46.702263: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:07:46.704547: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 10:07:47.145524: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 10:07:47.148766: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 10:07:47.150278: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 10:07:47.151812: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 10:07:47.158463: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x19668dfd2e0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 10:07:47.161405: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 10:07:49.475943: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 10:07:50.690429: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:07:51.370306: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:07:51.377968: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:07:52.720781: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 10:07:52.770202: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 10:07:53.344217: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 232ms/step
[INFOR]: Index of most vote   :510
[INFOR]: Class of most vote   :container ship, containership, container vessel
[INFOR]: Number of most vote  :19.0


[INFOR]: Index of second most vote     :404
[INFOR]: Class of second most vote     :airliner
[INFOR]: Number of second most vote    :4.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 70ms/step
[INFOR]: Toltal norm before transform: 0.3727
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0155

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 62ms/step
[INFOR]: SEN training of class 54_34 before transform: 19
[INFOR]: SPE training of class 54_34 before transform: 24

[INFOR]: SEN training of class 54_34 after transform: 33
[INFOR]: SPE training of class 54_34 after transform: 19
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
3/3 [==============================] - 0s 63ms/step
[INFOR]: Index of most vote   :510
[INFOR]: Class of most vote   :container ship, containership, container vessel
[INFOR]: Number of most vote  :18.0


[INFOR]: Index of second most vote     :725
[INFOR]: Class of second most vote     :pitcher, ewer
[INFOR]: Number of second most vote    :4.0
[INFOR]: SEN testing of class 54_33 before transform: 18
[INFOR]: SPE testing of class 54_33 before transform: 11

[INFOR]: SEN testing of class 54_33 after transform: 33
[INFOR]: SPE testing of class 54_33 after transform: 5
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name fgvc_aircraft --class_name_train 55_33 --class_name_test 55_33
2021-09-13 10:07:58.091389: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  fgvc_aircraft
class_name_train =  55_33
class_name_test =  55_33
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
[INFOR]: get pretrained model
2021-09-13 10:08:00.644441: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 10:08:00.671058: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 10:08:00.676095: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 10:08:00.684276: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:08:00.686620: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:08:00.691864: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 10:08:00.695291: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 10:08:00.716940: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 10:08:00.721933: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 10:08:00.724909: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:08:00.727122: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 10:08:00.729271: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 10:08:00.741382: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x20a33e37200 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 10:08:00.744622: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 10:08:00.746710: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 10:08:00.751300: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 10:08:00.753494: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:08:00.755714: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:08:00.757945: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 10:08:00.760134: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 10:08:00.762546: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 10:08:00.765191: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 10:08:00.767426: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:08:00.769822: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 10:08:01.199926: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 10:08:01.203334: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 10:08:01.204725: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 10:08:01.206262: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 10:08:01.212833: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x20a63792560 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 10:08:01.215821: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 10:08:03.581571: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 10:08:04.912584: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:08:05.576675: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:08:05.583905: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:08:06.943220: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 10:08:06.993450: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 10:08:07.566999: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 219ms/step
[INFOR]: Index of most vote   :510
[INFOR]: Class of most vote   :container ship, containership, container vessel
[INFOR]: Number of most vote  :11.0


[INFOR]: Index of second most vote     :404
[INFOR]: Class of second most vote     :airliner
[INFOR]: Number of second most vote    :7.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 63ms/step
[INFOR]: Toltal norm before transform: 0.6493
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1176

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 63ms/step
[INFOR]: SEN training of class 55_33 before transform: 11
[INFOR]: SPE training of class 55_33 before transform: 22

[INFOR]: SEN training of class 55_33 after transform: 30
[INFOR]: SPE training of class 55_33 after transform: 22
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
3/3 [==============================] - 0s 55ms/step
[INFOR]: Index of most vote   :510
[INFOR]: Class of most vote   :container ship, containership, container vessel
[INFOR]: Number of most vote  :12.0


[INFOR]: Index of second most vote     :404
[INFOR]: Class of second most vote     :airliner
[INFOR]: Number of second most vote    :10.0
[INFOR]: SEN testing of class 55_33 before transform: 12
[INFOR]: SPE testing of class 55_33 before transform: 18

[INFOR]: SEN testing of class 55_33 after transform: 30
[INFOR]: SPE testing of class 55_33 after transform: 5
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name fgvc_aircraft --class_name_train 56_33 --class_name_test 56_34
2021-09-13 10:08:11.893171: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  fgvc_aircraft
class_name_train =  56_33
class_name_test =  56_34
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
[INFOR]: get pretrained model
2021-09-13 10:08:14.448444: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 10:08:14.472615: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 10:08:14.477778: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 10:08:14.485912: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:08:14.488246: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:08:14.493642: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 10:08:14.497093: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 10:08:14.503487: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 10:08:14.508661: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 10:08:14.511666: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:08:14.514919: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 10:08:14.516826: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 10:08:14.529314: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1bebb274bf0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 10:08:14.532499: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 10:08:14.534596: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 10:08:14.538996: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 10:08:14.541186: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:08:14.543551: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:08:14.545846: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 10:08:14.548081: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 10:08:14.550282: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 10:08:14.552786: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 10:08:14.555060: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:08:14.557302: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 10:08:14.991046: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 10:08:14.994262: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 10:08:14.995804: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 10:08:14.997341: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 10:08:15.004303: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1bee5e9ab00 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 10:08:15.007142: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 10:08:17.287264: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 10:08:18.494663: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:08:19.145520: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:08:19.151942: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:08:20.494825: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 10:08:20.544851: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 10:08:21.106042: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 219ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :10.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :10.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 62ms/step
[INFOR]: Toltal norm before transform: 0.6609
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1877

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 63ms/step
[INFOR]: SEN training of class 56_33 before transform: 10
[INFOR]: SPE training of class 56_33 before transform: 23

[INFOR]: SEN training of class 56_33 after transform: 28
[INFOR]: SPE training of class 56_33 after transform: 23
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (68, 32, 32, 3)
[INFOR]: shape of y: (68, 1)
3/3 [==============================] - 0s 70ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :12.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :11.0
[INFOR]: SEN testing of class 56_34 before transform: 12
[INFOR]: SPE testing of class 56_34 before transform: 18

[INFOR]: SEN testing of class 56_34 after transform: 27
[INFOR]: SPE testing of class 56_34 after transform: 2
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name fgvc_aircraft --class_name_train 57_34 --class_name_test 57_33
2021-09-13 10:08:25.892718: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  fgvc_aircraft
class_name_train =  57_34
class_name_test =  57_33
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (68, 32, 32, 3)
[INFOR]: shape of y: (68, 1)
[INFOR]: get pretrained model
2021-09-13 10:08:28.360635: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 10:08:28.384559: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 10:08:28.389599: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 10:08:28.397625: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:08:28.399855: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:08:28.404954: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 10:08:28.408488: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 10:08:28.415026: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 10:08:28.419949: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 10:08:28.422937: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:08:28.425301: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 10:08:28.427355: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 10:08:28.439201: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x17e32fbb4f0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 10:08:28.442494: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 10:08:28.444804: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 10:08:28.449325: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 10:08:28.451570: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:08:28.453784: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:08:28.456351: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 10:08:28.458548: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 10:08:28.460766: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 10:08:28.463210: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 10:08:28.465454: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:08:28.467693: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 10:08:28.890011: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 10:08:28.893270: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 10:08:28.894697: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 10:08:28.896219: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 10:08:28.902981: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x17e61fa1060 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 10:08:28.906054: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 10:08:31.180384: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 10:08:32.383738: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:08:33.031564: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:08:33.038539: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:08:34.372070: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 10:08:34.420435: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 10:08:34.990840: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 227ms/step
[INFOR]: Index of most vote   :510
[INFOR]: Class of most vote   :container ship, containership, container vessel
[INFOR]: Number of most vote  :12.0


[INFOR]: Index of second most vote     :855
[INFOR]: Class of second most vote     :thimble
[INFOR]: Number of second most vote    :4.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 62ms/step
[INFOR]: Toltal norm before transform: 0.6282
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.2000

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 62ms/step
[INFOR]: SEN training of class 57_34 before transform: 12
[INFOR]: SPE training of class 57_34 before transform: 25

[INFOR]: SEN training of class 57_34 after transform: 34
[INFOR]: SPE training of class 57_34 after transform: 25
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
3/3 [==============================] - 0s 63ms/step
[INFOR]: Index of most vote   :510
[INFOR]: Class of most vote   :container ship, containership, container vessel
[INFOR]: Number of most vote  :17.0


[INFOR]: Index of second most vote     :855
[INFOR]: Class of second most vote     :thimble
[INFOR]: Number of second most vote    :5.0
[INFOR]: SEN testing of class 57_33 before transform: 17
[INFOR]: SPE testing of class 57_33 before transform: 21

[INFOR]: SEN testing of class 57_33 after transform: 33
[INFOR]: SPE testing of class 57_33 after transform: 4
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name fgvc_aircraft --class_name_train 58_33 --class_name_test 58_33
2021-09-13 10:08:39.724797: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  fgvc_aircraft
class_name_train =  58_33
class_name_test =  58_33
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
[INFOR]: get pretrained model
2021-09-13 10:08:42.327176: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 10:08:42.351615: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 10:08:42.356203: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 10:08:42.364115: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:08:42.366365: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:08:42.371552: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 10:08:42.374977: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 10:08:42.381228: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 10:08:42.386122: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 10:08:42.389048: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:08:42.391228: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 10:08:42.393125: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 10:08:42.405149: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x176343b7380 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 10:08:42.408266: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 10:08:42.410348: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 10:08:42.414791: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 10:08:42.417022: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:08:42.419241: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:08:42.421484: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 10:08:42.423691: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 10:08:42.426166: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 10:08:42.428436: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 10:08:42.430722: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:08:42.432925: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 10:08:42.881730: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 10:08:42.884439: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 10:08:42.885988: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 10:08:42.888357: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 10:08:42.896414: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1765f5cccc0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 10:08:42.899966: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 10:08:45.220754: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 10:08:46.463180: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:08:47.160288: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:08:47.167281: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:08:48.505716: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 10:08:48.556414: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 10:08:49.124160: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 211ms/step
[INFOR]: Index of most vote   :510
[INFOR]: Class of most vote   :container ship, containership, container vessel
[INFOR]: Number of most vote  :18.0


[INFOR]: Index of second most vote     :855
[INFOR]: Class of second most vote     :thimble
[INFOR]: Number of second most vote    :3.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 62ms/step
[INFOR]: Toltal norm before transform: 0.3880
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0064

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 72ms/step
[INFOR]: SEN training of class 58_33 before transform: 18
[INFOR]: SPE training of class 58_33 before transform: 20

[INFOR]: SEN training of class 58_33 after transform: 33
[INFOR]: SPE training of class 58_33 after transform: 20
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
3/3 [==============================] - 0s 70ms/step
[INFOR]: Index of most vote   :510
[INFOR]: Class of most vote   :container ship, containership, container vessel
[INFOR]: Number of most vote  :14.0


[INFOR]: Index of second most vote     :404
[INFOR]: Class of second most vote     :airliner
[INFOR]: Number of second most vote    :5.0
[INFOR]: SEN testing of class 58_33 before transform: 14
[INFOR]: SPE testing of class 58_33 before transform: 20

[INFOR]: SEN testing of class 58_33 after transform: 31
[INFOR]: SPE testing of class 58_33 after transform: 0
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name fgvc_aircraft --class_name_train 59_33 --class_name_test 59_34
2021-09-13 10:08:53.481016: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  fgvc_aircraft
class_name_train =  59_33
class_name_test =  59_34
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
[INFOR]: get pretrained model
2021-09-13 10:08:55.983132: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 10:08:56.007722: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 10:08:56.012991: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 10:08:56.021256: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:08:56.023439: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:08:56.028940: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 10:08:56.032631: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 10:08:56.039052: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 10:08:56.044234: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 10:08:56.047393: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:08:56.049790: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 10:08:56.051843: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 10:08:56.064373: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x27cb714d1f0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 10:08:56.068102: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 10:08:56.070218: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 10:08:56.074736: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 10:08:56.077126: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:08:56.079330: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:08:56.081567: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 10:08:56.083961: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 10:08:56.086233: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 10:08:56.088522: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 10:08:56.090758: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:08:56.093101: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 10:08:56.517566: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 10:08:56.520627: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 10:08:56.522022: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 10:08:56.523562: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 10:08:56.530357: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x27ce2b64960 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 10:08:56.533440: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 10:08:58.801251: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 10:08:59.986343: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:09:00.634841: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:09:00.642700: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:09:02.025566: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 10:09:02.080803: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 10:09:02.686676: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 236ms/step
[INFOR]: Index of most vote   :510
[INFOR]: Class of most vote   :container ship, containership, container vessel
[INFOR]: Number of most vote  :22.0


[INFOR]: Index of second most vote     :811
[INFOR]: Class of second most vote     :space heater
[INFOR]: Number of second most vote    :4.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 62ms/step
[INFOR]: Toltal norm before transform: 0.2369
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0244

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 63ms/step
[INFOR]: SEN training of class 59_33 before transform: 22
[INFOR]: SPE training of class 59_33 before transform: 17

[INFOR]: SEN training of class 59_33 after transform: 31
[INFOR]: SPE training of class 59_33 after transform: 17
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (68, 32, 32, 3)
[INFOR]: shape of y: (68, 1)
3/3 [==============================] - 0s 62ms/step
[INFOR]: Index of most vote   :510
[INFOR]: Class of most vote   :container ship, containership, container vessel
[INFOR]: Number of most vote  :15.0


[INFOR]: Index of second most vote     :404
[INFOR]: Class of second most vote     :airliner
[INFOR]: Number of second most vote    :5.0
[INFOR]: SEN testing of class 59_34 before transform: 15
[INFOR]: SPE testing of class 59_34 before transform: 17

[INFOR]: SEN testing of class 59_34 after transform: 34
[INFOR]: SPE testing of class 59_34 after transform: 7
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name fgvc_aircraft --class_name_train 60_34 --class_name_test 60_33
2021-09-13 10:09:07.460718: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  fgvc_aircraft
class_name_train =  60_34
class_name_test =  60_33
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (68, 32, 32, 3)
[INFOR]: shape of y: (68, 1)
[INFOR]: get pretrained model
2021-09-13 10:09:09.999368: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 10:09:10.025490: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 10:09:10.031141: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 10:09:10.039469: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:09:10.041646: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:09:10.046820: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 10:09:10.050238: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 10:09:10.056783: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 10:09:10.061742: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 10:09:10.064714: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:09:10.067086: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 10:09:10.069440: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 10:09:10.081374: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x173336484d0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 10:09:10.084967: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 10:09:10.088280: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 10:09:10.092772: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 10:09:10.094992: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:09:10.097181: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:09:10.099474: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 10:09:10.101657: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 10:09:10.104139: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 10:09:10.106356: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 10:09:10.108612: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:09:10.110783: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 10:09:10.546648: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 10:09:10.549884: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 10:09:10.551257: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 10:09:10.552831: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 10:09:10.559387: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1735ea4e110 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 10:09:10.562257: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 10:09:12.832723: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 10:09:14.027641: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:09:14.670661: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:09:14.678585: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:09:15.997795: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 10:09:16.046981: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 10:09:16.610265: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 224ms/step
[INFOR]: Index of most vote   :510
[INFOR]: Class of most vote   :container ship, containership, container vessel
[INFOR]: Number of most vote  :12.0


[INFOR]: Index of second most vote     :404
[INFOR]: Class of second most vote     :airliner
[INFOR]: Number of second most vote    :6.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 70ms/step
[INFOR]: Toltal norm before transform: 0.6344
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0963

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 63ms/step
[INFOR]: SEN training of class 60_34 before transform: 12
[INFOR]: SPE training of class 60_34 before transform: 22

[INFOR]: SEN training of class 60_34 after transform: 32
[INFOR]: SPE training of class 60_34 after transform: 22
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
3/3 [==============================] - 0s 63ms/step
[INFOR]: Index of most vote   :510
[INFOR]: Class of most vote   :container ship, containership, container vessel
[INFOR]: Number of most vote  :19.0


[INFOR]: Index of second most vote     :811
[INFOR]: Class of second most vote     :space heater
[INFOR]: Number of second most vote    :7.0
[INFOR]: SEN testing of class 60_33 before transform: 19
[INFOR]: SPE testing of class 60_33 before transform: 20

[INFOR]: SEN testing of class 60_33 after transform: 33
[INFOR]: SPE testing of class 60_33 after transform: 0
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name fgvc_aircraft --class_name_train 61_33 --class_name_test 61_33
2021-09-13 10:09:21.440844: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  fgvc_aircraft
class_name_train =  61_33
class_name_test =  61_33
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
[INFOR]: get pretrained model
2021-09-13 10:09:23.984318: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 10:09:24.011683: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 10:09:24.016636: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 10:09:24.024739: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:09:24.026933: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:09:24.032139: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 10:09:24.035544: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 10:09:24.042005: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 10:09:24.046937: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 10:09:24.049928: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:09:24.052180: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 10:09:24.054087: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 10:09:24.065773: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x2013b2af640 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 10:09:24.069171: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 10:09:24.071292: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 10:09:24.075609: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 10:09:24.077820: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:09:24.080008: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:09:24.082325: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 10:09:24.084524: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 10:09:24.086795: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 10:09:24.089034: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 10:09:24.091462: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:09:24.093710: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 10:09:24.538249: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 10:09:24.541465: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 10:09:24.542888: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 10:09:24.544457: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 10:09:24.551124: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x2015c257850 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 10:09:24.554092: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 10:09:26.831318: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 10:09:28.001742: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:09:28.647042: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:09:28.654294: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:09:29.972194: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 10:09:30.019403: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 10:09:30.579323: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 227ms/step
[INFOR]: Index of most vote   :510
[INFOR]: Class of most vote   :container ship, containership, container vessel
[INFOR]: Number of most vote  :21.0


[INFOR]: Index of second most vote     :404
[INFOR]: Class of second most vote     :airliner
[INFOR]: Number of second most vote    :9.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 70ms/step
[INFOR]: Toltal norm before transform: 0.4451
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0362

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 67ms/step
[INFOR]: SEN training of class 61_33 before transform: 21
[INFOR]: SPE training of class 61_33 before transform: 21

[INFOR]: SEN training of class 61_33 after transform: 29
[INFOR]: SPE training of class 61_33 after transform: 21
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
3/3 [==============================] - 0s 63ms/step
[INFOR]: Index of most vote   :510
[INFOR]: Class of most vote   :container ship, containership, container vessel
[INFOR]: Number of most vote  :21.0


[INFOR]: Index of second most vote     :404
[INFOR]: Class of second most vote     :airliner
[INFOR]: Number of second most vote    :7.0
[INFOR]: SEN testing of class 61_33 before transform: 21
[INFOR]: SPE testing of class 61_33 before transform: 19

[INFOR]: SEN testing of class 61_33 after transform: 33
[INFOR]: SPE testing of class 61_33 after transform: 5
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name fgvc_aircraft --class_name_train 62_34 --class_name_test 62_33
2021-09-13 10:09:34.846869: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  fgvc_aircraft
class_name_train =  62_34
class_name_test =  62_33
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (68, 32, 32, 3)
[INFOR]: shape of y: (68, 1)
[INFOR]: get pretrained model
2021-09-13 10:09:37.379111: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 10:09:37.405721: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 10:09:37.411020: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 10:09:37.419046: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:09:37.421219: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:09:37.426733: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 10:09:37.430372: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 10:09:37.436600: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 10:09:37.441507: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 10:09:37.444638: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:09:37.446781: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 10:09:37.448625: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 10:09:37.460706: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1ee37d6b100 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 10:09:37.464106: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 10:09:37.466233: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 10:09:37.470577: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 10:09:37.472846: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:09:37.475407: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:09:37.477651: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 10:09:37.479887: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 10:09:37.482158: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 10:09:37.484403: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 10:09:37.486642: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:09:37.488836: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 10:09:37.914649: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 10:09:37.917983: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 10:09:37.919399: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 10:09:37.920936: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 10:09:37.927971: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1ee6317ede0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 10:09:37.930952: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 10:09:40.258491: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 10:09:41.436270: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:09:42.079993: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:09:42.087228: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:09:43.432564: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 10:09:43.483495: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 10:09:44.079890: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 227ms/step
[INFOR]: Index of most vote   :510
[INFOR]: Class of most vote   :container ship, containership, container vessel
[INFOR]: Number of most vote  :19.0


[INFOR]: Index of second most vote     :404
[INFOR]: Class of second most vote     :airliner
[INFOR]: Number of second most vote    :11.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 63ms/step
[INFOR]: Toltal norm before transform: 0.4786
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1607

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 63ms/step
[INFOR]: SEN training of class 62_34 before transform: 19
[INFOR]: SPE training of class 62_34 before transform: 17

[INFOR]: SEN training of class 62_34 after transform: 29
[INFOR]: SPE training of class 62_34 after transform: 17
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
3/3 [==============================] - 0s 55ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :16.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :10.0
[INFOR]: SEN testing of class 62_33 before transform: 16
[INFOR]: SPE testing of class 62_33 before transform: 18

[INFOR]: SEN testing of class 62_33 after transform: 32
[INFOR]: SPE testing of class 62_33 after transform: 0
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name fgvc_aircraft --class_name_train 63_33 --class_name_test 63_34
2021-09-13 10:09:48.836644: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  fgvc_aircraft
class_name_train =  63_33
class_name_test =  63_34
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
[INFOR]: get pretrained model
2021-09-13 10:09:51.471407: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 10:09:51.494575: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 10:09:51.499074: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 10:09:51.507024: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:09:51.509134: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:09:51.514228: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 10:09:51.517603: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 10:09:51.523796: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 10:09:51.528831: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 10:09:51.531774: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:09:51.534079: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 10:09:51.535939: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 10:09:51.547629: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1c13a6581e0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 10:09:51.550754: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 10:09:51.552750: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 10:09:51.556877: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 10:09:51.559231: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:09:51.561473: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:09:51.563781: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 10:09:51.565858: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 10:09:51.568013: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 10:09:51.570137: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 10:09:51.572260: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:09:51.574347: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 10:09:51.999533: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 10:09:52.002658: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 10:09:52.004386: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 10:09:52.006090: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 10:09:52.013003: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1c16279f720 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 10:09:52.016079: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 10:09:54.322540: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 10:09:55.547920: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:09:56.191714: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:09:56.200117: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:09:57.556459: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 10:09:57.604152: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 10:09:58.165212: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 215ms/step
[INFOR]: Index of most vote   :510
[INFOR]: Class of most vote   :container ship, containership, container vessel
[INFOR]: Number of most vote  :17.0


[INFOR]: Index of second most vote     :781
[INFOR]: Class of second most vote     :scoreboard
[INFOR]: Number of second most vote    :4.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 63ms/step
[INFOR]: Toltal norm before transform: 0.4279
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.2031

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 63ms/step
[INFOR]: SEN training of class 63_33 before transform: 17
[INFOR]: SPE training of class 63_33 before transform: 20

[INFOR]: SEN training of class 63_33 after transform: 33
[INFOR]: SPE training of class 63_33 after transform: 20
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (68, 32, 32, 3)
[INFOR]: shape of y: (68, 1)
3/3 [==============================] - 0s 70ms/step
[INFOR]: Index of most vote   :510
[INFOR]: Class of most vote   :container ship, containership, container vessel
[INFOR]: Number of most vote  :14.0


[INFOR]: Index of second most vote     :659
[INFOR]: Class of second most vote     :mixing bowl
[INFOR]: Number of second most vote    :3.0
[INFOR]: SEN testing of class 63_34 before transform: 14
[INFOR]: SPE testing of class 63_34 before transform: 17

[INFOR]: SEN testing of class 63_34 after transform: 34
[INFOR]: SPE testing of class 63_34 after transform: 0
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name fgvc_aircraft --class_name_train 64_33 --class_name_test 64_33
2021-09-13 10:10:02.839801: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  fgvc_aircraft
class_name_train =  64_33
class_name_test =  64_33
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
[INFOR]: get pretrained model
2021-09-13 10:10:05.377680: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 10:10:05.403668: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 10:10:05.407964: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 10:10:05.415664: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:10:05.417894: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:10:05.422786: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 10:10:05.426075: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 10:10:05.432038: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 10:10:05.436885: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 10:10:05.439887: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:10:05.442161: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 10:10:05.443991: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 10:10:05.456071: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1fa3750bf80 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 10:10:05.459643: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 10:10:05.461655: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 10:10:05.465786: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 10:10:05.467856: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:10:05.469951: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:10:05.472215: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 10:10:05.474359: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 10:10:05.476464: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 10:10:05.478543: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 10:10:05.480625: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:10:05.482662: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 10:10:05.913834: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 10:10:05.917108: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 10:10:05.918494: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 10:10:05.919996: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 10:10:05.926705: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1fa65aac870 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 10:10:05.929476: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 10:10:08.224693: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 10:10:09.458095: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:10:10.100747: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:10:10.107929: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:10:11.455115: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 10:10:11.501342: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 10:10:12.062670: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 212ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :16.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :14.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 55ms/step
[INFOR]: Toltal norm before transform: 0.4312
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1216

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 64ms/step
[INFOR]: SEN training of class 64_33 before transform: 16
[INFOR]: SPE training of class 64_33 before transform: 22

[INFOR]: SEN training of class 64_33 after transform: 26
[INFOR]: SPE training of class 64_33 after transform: 22
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
3/3 [==============================] - 0s 62ms/step
[INFOR]: Index of most vote   :510
[INFOR]: Class of most vote   :container ship, containership, container vessel
[INFOR]: Number of most vote  :19.0


[INFOR]: Index of second most vote     :404
[INFOR]: Class of second most vote     :airliner
[INFOR]: Number of second most vote    :9.0
[INFOR]: SEN testing of class 64_33 before transform: 19
[INFOR]: SPE testing of class 64_33 before transform: 16

[INFOR]: SEN testing of class 64_33 after transform: 33
[INFOR]: SPE testing of class 64_33 after transform: 0
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name fgvc_aircraft --class_name_train 65_33 --class_name_test 65_34
2021-09-13 10:10:16.361747: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  fgvc_aircraft
class_name_train =  65_33
class_name_test =  65_34
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
[INFOR]: get pretrained model
2021-09-13 10:10:18.869118: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 10:10:18.893158: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 10:10:18.897460: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 10:10:18.905187: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:10:18.907213: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:10:18.912176: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 10:10:18.915362: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 10:10:18.921313: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 10:10:18.926124: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 10:10:18.928890: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:10:18.930956: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 10:10:18.932812: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 10:10:18.944854: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x20d36bda350 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 10:10:18.947972: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 10:10:18.949963: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 10:10:18.954129: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 10:10:18.956314: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:10:18.958387: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:10:18.960482: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 10:10:18.962641: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 10:10:18.965028: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 10:10:18.967133: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 10:10:18.969241: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:10:18.971305: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 10:10:19.398827: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 10:10:19.402127: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 10:10:19.403475: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 10:10:19.404901: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 10:10:19.411349: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x20d61d82600 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 10:10:19.415048: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 10:10:21.715203: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 10:10:22.914197: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:10:23.558639: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:10:23.565543: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:10:24.896345: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 10:10:24.945537: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 10:10:25.512821: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 251ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :15.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :13.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 61ms/step
[INFOR]: Toltal norm before transform: 0.4175
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0363

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 63ms/step
[INFOR]: SEN training of class 65_33 before transform: 15
[INFOR]: SPE training of class 65_33 before transform: 22

[INFOR]: SEN training of class 65_33 after transform: 26
[INFOR]: SPE training of class 65_33 after transform: 22
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (68, 32, 32, 3)
[INFOR]: shape of y: (68, 1)
3/3 [==============================] - 0s 63ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :24.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :8.0
[INFOR]: SEN testing of class 65_34 before transform: 24
[INFOR]: SPE testing of class 65_34 before transform: 19

[INFOR]: SEN testing of class 65_34 after transform: 34
[INFOR]: SPE testing of class 65_34 after transform: 0
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name fgvc_aircraft --class_name_train 66_34 --class_name_test 66_33
2021-09-13 10:10:30.290215: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  fgvc_aircraft
class_name_train =  66_34
class_name_test =  66_33
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (68, 32, 32, 3)
[INFOR]: shape of y: (68, 1)
[INFOR]: get pretrained model
2021-09-13 10:10:32.869464: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 10:10:32.895983: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 10:10:32.900442: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 10:10:32.908497: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:10:32.910620: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:10:32.915660: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 10:10:32.918931: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 10:10:32.925339: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 10:10:32.930114: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 10:10:32.933001: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:10:32.935128: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 10:10:32.937204: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 10:10:32.948901: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x2a1b34b1c50 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 10:10:32.952777: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 10:10:32.954841: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 10:10:32.959145: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 10:10:32.961245: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:10:32.963338: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:10:32.965455: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 10:10:32.967581: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 10:10:32.969723: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 10:10:32.971972: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 10:10:32.974145: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:10:32.976421: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 10:10:33.411001: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 10:10:33.413745: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 10:10:33.415205: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 10:10:33.416673: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 10:10:33.423357: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x2a1e1ff7d00 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 10:10:33.426110: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 10:10:35.729231: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 10:10:36.950169: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:10:37.607421: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:10:37.614337: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:10:38.941833: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 10:10:38.992953: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 10:10:39.610743: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 252ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :17.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :14.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 71ms/step
[INFOR]: Toltal norm before transform: 0.4366
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1027

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 78ms/step
[INFOR]: SEN training of class 66_34 before transform: 17
[INFOR]: SPE training of class 66_34 before transform: 20

[INFOR]: SEN training of class 66_34 after transform: 27
[INFOR]: SPE training of class 66_34 after transform: 20
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
3/3 [==============================] - 0s 64ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :15.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :12.0
[INFOR]: SEN testing of class 66_33 before transform: 15
[INFOR]: SPE testing of class 66_33 before transform: 21

[INFOR]: SEN testing of class 66_33 after transform: 30
[INFOR]: SPE testing of class 66_33 after transform: 3
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name fgvc_aircraft --class_name_train 67_33 --class_name_test 67_33
2021-09-13 10:10:44.590137: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  fgvc_aircraft
class_name_train =  67_33
class_name_test =  67_33
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
[INFOR]: get pretrained model
2021-09-13 10:10:47.133580: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 10:10:47.159728: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 10:10:47.165727: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 10:10:47.173463: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:10:47.175556: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:10:47.180659: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 10:10:47.184122: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 10:10:47.190261: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 10:10:47.194997: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 10:10:47.197864: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:10:47.199914: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 10:10:47.201742: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 10:10:47.213703: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x154baa8d860 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 10:10:47.217302: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 10:10:47.219261: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 10:10:47.223334: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 10:10:47.225386: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:10:47.227471: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:10:47.229737: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 10:10:47.231868: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 10:10:47.233945: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 10:10:47.236048: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 10:10:47.238156: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:10:47.240224: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 10:10:47.672121: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 10:10:47.674860: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 10:10:47.676197: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 10:10:47.677655: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 10:10:47.684544: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x154e5b701f0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 10:10:47.687850: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 10:10:49.973596: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 10:10:51.164461: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:10:51.806745: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:10:51.813739: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:10:53.140993: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 10:10:53.191915: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 10:10:53.754214: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 220ms/step
[INFOR]: Index of most vote   :510
[INFOR]: Class of most vote   :container ship, containership, container vessel
[INFOR]: Number of most vote  :23.0


[INFOR]: Index of second most vote     :404
[INFOR]: Class of second most vote     :airliner
[INFOR]: Number of second most vote    :8.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 55ms/step
[INFOR]: Toltal norm before transform: 0.3005
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0189

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 63ms/step
[INFOR]: SEN training of class 67_33 before transform: 23
[INFOR]: SPE training of class 67_33 before transform: 25

[INFOR]: SEN training of class 67_33 after transform: 31
[INFOR]: SPE training of class 67_33 after transform: 24
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
3/3 [==============================] - 0s 63ms/step
[INFOR]: Index of most vote   :510
[INFOR]: Class of most vote   :container ship, containership, container vessel
[INFOR]: Number of most vote  :18.0


[INFOR]: Index of second most vote     :404
[INFOR]: Class of second most vote     :airliner
[INFOR]: Number of second most vote    :8.0
[INFOR]: SEN testing of class 67_33 before transform: 18
[INFOR]: SPE testing of class 67_33 before transform: 17

[INFOR]: SEN testing of class 67_33 after transform: 33
[INFOR]: SPE testing of class 67_33 after transform: 0
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name fgvc_aircraft --class_name_train 68_33 --class_name_test 68_33
2021-09-13 10:10:58.166204: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  fgvc_aircraft
class_name_train =  68_33
class_name_test =  68_33
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
[INFOR]: get pretrained model
2021-09-13 10:11:00.737677: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 10:11:00.761967: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 10:11:00.766853: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 10:11:00.774743: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:11:00.776849: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:11:00.781904: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 10:11:00.785236: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 10:11:00.791563: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 10:11:00.796476: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 10:11:00.799338: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:11:00.801452: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 10:11:00.803315: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 10:11:00.815085: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x20ebab66260 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 10:11:00.818231: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 10:11:00.820228: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 10:11:00.824403: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 10:11:00.826526: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:11:00.828744: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:11:00.830880: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 10:11:00.832972: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 10:11:00.835169: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 10:11:00.837474: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 10:11:00.839587: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:11:00.841664: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 10:11:01.258185: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 10:11:01.261502: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 10:11:01.262861: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 10:11:01.264295: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 10:11:01.270822: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x20ee29b9430 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 10:11:01.273575: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 10:11:03.561291: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 10:11:04.761774: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:11:05.408355: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:11:05.415689: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:11:06.753166: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 10:11:06.802624: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 10:11:07.411605: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 228ms/step
[INFOR]: Index of most vote   :510
[INFOR]: Class of most vote   :container ship, containership, container vessel
[INFOR]: Number of most vote  :16.0


[INFOR]: Index of second most vote     :404
[INFOR]: Class of second most vote     :airliner
[INFOR]: Number of second most vote    :14.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 63ms/step
[INFOR]: Toltal norm before transform: 0.6395
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0412

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 62ms/step
[INFOR]: SEN training of class 68_33 before transform: 16
[INFOR]: SPE training of class 68_33 before transform: 21

[INFOR]: SEN training of class 68_33 after transform: 30
[INFOR]: SPE training of class 68_33 after transform: 21
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
3/3 [==============================] - 0s 55ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :14.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :14.0
[INFOR]: SEN testing of class 68_33 before transform: 14
[INFOR]: SPE testing of class 68_33 before transform: 17

[INFOR]: SEN testing of class 68_33 after transform: 29
[INFOR]: SPE testing of class 68_33 after transform: 1
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name fgvc_aircraft --class_name_train 69_33 --class_name_test 69_34
2021-09-13 10:11:11.812197: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  fgvc_aircraft
class_name_train =  69_33
class_name_test =  69_34
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
[INFOR]: get pretrained model
2021-09-13 10:11:14.384573: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 10:11:14.410526: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 10:11:14.415420: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 10:11:14.423155: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:11:14.425460: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:11:14.430685: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 10:11:14.434005: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 10:11:14.440095: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 10:11:14.445419: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 10:11:14.448268: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:11:14.450399: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 10:11:14.452434: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 10:11:14.464417: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x2aab39b1c40 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 10:11:14.467518: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 10:11:14.469490: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 10:11:14.473820: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 10:11:14.475921: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:11:14.478004: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:11:14.480116: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 10:11:14.482182: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 10:11:14.484370: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 10:11:14.486674: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 10:11:14.488904: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:11:14.491005: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 10:11:14.927708: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 10:11:14.930504: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 10:11:14.931882: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 10:11:14.933373: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 10:11:14.939902: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x2aadf84da90 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 10:11:14.942753: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 10:11:17.231357: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 10:11:18.501221: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:11:19.165923: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:11:19.174081: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:11:20.551204: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 10:11:20.601871: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 10:11:21.183176: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 222ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :15.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :14.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 63ms/step
[INFOR]: Toltal norm before transform: 0.5764
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.2237

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 63ms/step
[INFOR]: SEN training of class 69_33 before transform: 15
[INFOR]: SPE training of class 69_33 before transform: 21

[INFOR]: SEN training of class 69_33 after transform: 27
[INFOR]: SPE training of class 69_33 after transform: 20
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (68, 32, 32, 3)
[INFOR]: shape of y: (68, 1)
3/3 [==============================] - 0s 70ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :18.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :14.0
[INFOR]: SEN testing of class 69_34 before transform: 18
[INFOR]: SPE testing of class 69_34 before transform: 22

[INFOR]: SEN testing of class 69_34 after transform: 33
[INFOR]: SPE testing of class 69_34 after transform: 2
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name fgvc_aircraft --class_name_train 70_34 --class_name_test 70_33
2021-09-13 10:11:25.931132: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  fgvc_aircraft
class_name_train =  70_34
class_name_test =  70_33
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (68, 32, 32, 3)
[INFOR]: shape of y: (68, 1)
[INFOR]: get pretrained model
2021-09-13 10:11:28.515827: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 10:11:28.541460: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 10:11:28.546206: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 10:11:28.554672: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:11:28.556871: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:11:28.562287: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 10:11:28.566562: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 10:11:28.573024: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 10:11:28.577904: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 10:11:28.581763: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:11:28.583932: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 10:11:28.585995: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 10:11:28.598372: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x23333a0f140 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 10:11:28.601495: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 10:11:28.603517: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 10:11:28.607705: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 10:11:28.609838: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:11:28.613118: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:11:28.615549: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 10:11:28.617739: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 10:11:28.620090: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 10:11:28.622397: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 10:11:28.624507: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:11:28.626603: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 10:11:29.072855: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 10:11:29.075831: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 10:11:29.077193: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 10:11:29.078722: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 10:11:29.085458: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x2335e43ea70 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 10:11:29.088279: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 10:11:31.432915: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 10:11:32.661909: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:11:33.338640: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:11:33.345776: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:11:34.720464: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 10:11:34.770513: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 10:11:35.334540: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 235ms/step
[INFOR]: Index of most vote   :510
[INFOR]: Class of most vote   :container ship, containership, container vessel
[INFOR]: Number of most vote  :15.0


[INFOR]: Index of second most vote     :404
[INFOR]: Class of second most vote     :airliner
[INFOR]: Number of second most vote    :14.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 63ms/step
[INFOR]: Toltal norm before transform: 0.5405
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1897

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 63ms/step
[INFOR]: SEN training of class 70_34 before transform: 15
[INFOR]: SPE training of class 70_34 before transform: 21

[INFOR]: SEN training of class 70_34 after transform: 30
[INFOR]: SPE training of class 70_34 after transform: 21
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
3/3 [==============================] - 0s 63ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :15.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :11.0
[INFOR]: SEN testing of class 70_33 before transform: 15
[INFOR]: SPE testing of class 70_33 before transform: 23

[INFOR]: SEN testing of class 70_33 after transform: 32
[INFOR]: SPE testing of class 70_33 after transform: 2
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name fgvc_aircraft --class_name_train 71_33 --class_name_test 71_34
2021-09-13 10:11:40.128697: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  fgvc_aircraft
class_name_train =  71_33
class_name_test =  71_34
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
[INFOR]: get pretrained model
2021-09-13 10:11:42.606782: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 10:11:42.632457: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 10:11:42.636956: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 10:11:42.644958: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:11:42.647103: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:11:42.652207: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 10:11:42.655577: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 10:11:42.661998: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 10:11:42.667547: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 10:11:42.670667: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:11:42.672816: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 10:11:42.674681: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 10:11:42.686442: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x16d332d4240 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 10:11:42.689646: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 10:11:42.691690: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 10:11:42.695849: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 10:11:42.697966: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:11:42.700136: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:11:42.702394: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 10:11:42.704410: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 10:11:42.706506: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 10:11:42.708783: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 10:11:42.711053: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:11:42.713088: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 10:11:43.133158: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 10:11:43.136434: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 10:11:43.137793: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 10:11:43.139245: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 10:11:43.145596: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x16d616a95a0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 10:11:43.148596: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 10:11:45.391938: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 10:11:46.598025: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:11:47.244809: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:11:47.251699: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:11:48.582277: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 10:11:48.631468: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 10:11:49.198585: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 219ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :9.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :9.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 70ms/step
[INFOR]: Toltal norm before transform: 0.7184
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1103

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 70ms/step
[INFOR]: SEN training of class 71_33 before transform: 9
[INFOR]: SPE training of class 71_33 before transform: 23

[INFOR]: SEN training of class 71_33 after transform: 31
[INFOR]: SPE training of class 71_33 after transform: 23
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (68, 32, 32, 3)
[INFOR]: shape of y: (68, 1)
3/3 [==============================] - 0s 62ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :14.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :9.0
[INFOR]: SEN testing of class 71_34 before transform: 14
[INFOR]: SPE testing of class 71_34 before transform: 15

[INFOR]: SEN testing of class 71_34 after transform: 32
[INFOR]: SPE testing of class 71_34 after transform: 0
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name fgvc_aircraft --class_name_train 72_33 --class_name_test 72_33
2021-09-13 10:11:53.877379: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  fgvc_aircraft
class_name_train =  72_33
class_name_test =  72_33
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
[INFOR]: get pretrained model
2021-09-13 10:11:56.459020: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 10:11:56.483859: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 10:11:56.489606: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 10:11:56.497428: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:11:56.499627: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:11:56.504592: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 10:11:56.508142: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 10:11:56.514065: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 10:11:56.518945: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 10:11:56.521796: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:11:56.523896: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 10:11:56.525891: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 10:11:56.538477: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1ff38e64460 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 10:11:56.542056: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 10:11:56.544172: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 10:11:56.548497: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 10:11:56.550742: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:11:56.553353: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:11:56.555423: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 10:11:56.557443: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 10:11:56.559532: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 10:11:56.561591: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 10:11:56.563699: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:11:56.565959: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 10:11:56.987646: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 10:11:56.990689: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 10:11:56.993238: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 10:11:56.995181: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 10:11:57.001804: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1ff68cae1b0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 10:11:57.004903: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 10:11:59.272562: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 10:12:00.472957: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:12:01.122001: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:12:01.129292: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:12:02.473144: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 10:12:02.522315: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 10:12:03.085917: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 231ms/step
[INFOR]: Index of most vote   :510
[INFOR]: Class of most vote   :container ship, containership, container vessel
[INFOR]: Number of most vote  :12.0


[INFOR]: Index of second most vote     :404
[INFOR]: Class of second most vote     :airliner
[INFOR]: Number of second most vote    :6.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 63ms/step
[INFOR]: Toltal norm before transform: 0.6554
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0201

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 63ms/step
[INFOR]: SEN training of class 72_33 before transform: 12
[INFOR]: SPE training of class 72_33 before transform: 20

[INFOR]: SEN training of class 72_33 after transform: 29
[INFOR]: SPE training of class 72_33 after transform: 20
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
3/3 [==============================] - 0s 63ms/step
[INFOR]: Index of most vote   :510
[INFOR]: Class of most vote   :container ship, containership, container vessel
[INFOR]: Number of most vote  :10.0


[INFOR]: Index of second most vote     :404
[INFOR]: Class of second most vote     :airliner
[INFOR]: Number of second most vote    :9.0
[INFOR]: SEN testing of class 72_33 before transform: 10
[INFOR]: SPE testing of class 72_33 before transform: 20

[INFOR]: SEN testing of class 72_33 after transform: 33
[INFOR]: SPE testing of class 72_33 after transform: 0
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name fgvc_aircraft --class_name_train 73_34 --class_name_test 73_33
2021-09-13 10:12:07.479135: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  fgvc_aircraft
class_name_train =  73_34
class_name_test =  73_33
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (68, 32, 32, 3)
[INFOR]: shape of y: (68, 1)
[INFOR]: get pretrained model
2021-09-13 10:12:10.101415: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 10:12:10.125365: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 10:12:10.131397: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 10:12:10.139566: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:12:10.141675: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:12:10.146777: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 10:12:10.150441: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 10:12:10.156573: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 10:12:10.161687: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 10:12:10.164769: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:12:10.167321: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 10:12:10.169384: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 10:12:10.181238: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x2fbb91ec5a0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 10:12:10.184337: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 10:12:10.186332: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 10:12:10.190448: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 10:12:10.192560: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:12:10.194655: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:12:10.197088: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 10:12:10.199516: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 10:12:10.201870: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 10:12:10.204079: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 10:12:10.206210: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:12:10.208308: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 10:12:10.654371: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 10:12:10.657608: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 10:12:10.658935: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 10:12:10.660728: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 10:12:10.667548: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x2fbe791a480 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 10:12:10.670303: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 10:12:13.058671: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 10:12:14.273355: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:12:14.943792: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:12:14.951496: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:12:16.287082: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 10:12:16.335770: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 10:12:16.895496: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 227ms/step
[INFOR]: Index of most vote   :510
[INFOR]: Class of most vote   :container ship, containership, container vessel
[INFOR]: Number of most vote  :15.0


[INFOR]: Index of second most vote     :404
[INFOR]: Class of second most vote     :airliner
[INFOR]: Number of second most vote    :9.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 66ms/step
[INFOR]: Toltal norm before transform: 0.6391
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1864

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 63ms/step
[INFOR]: SEN training of class 73_34 before transform: 15
[INFOR]: SPE training of class 73_34 before transform: 17

[INFOR]: SEN training of class 73_34 after transform: 30
[INFOR]: SPE training of class 73_34 after transform: 17
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
3/3 [==============================] - 0s 64ms/step
[INFOR]: Index of most vote   :510
[INFOR]: Class of most vote   :container ship, containership, container vessel
[INFOR]: Number of most vote  :16.0


[INFOR]: Index of second most vote     :404
[INFOR]: Class of second most vote     :airliner
[INFOR]: Number of second most vote    :6.0
[INFOR]: SEN testing of class 73_33 before transform: 16
[INFOR]: SPE testing of class 73_33 before transform: 22

[INFOR]: SEN testing of class 73_33 after transform: 33
[INFOR]: SPE testing of class 73_33 after transform: 5
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name fgvc_aircraft --class_name_train 74_33 --class_name_test 74_34
2021-09-13 10:12:21.618077: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  fgvc_aircraft
class_name_train =  74_33
class_name_test =  74_34
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
[INFOR]: get pretrained model
2021-09-13 10:12:24.196397: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 10:12:24.220565: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 10:12:24.226658: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 10:12:24.234780: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:12:24.236900: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:12:24.242036: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 10:12:24.245299: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 10:12:24.251517: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 10:12:24.256362: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 10:12:24.259219: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:12:24.261300: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 10:12:24.263156: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 10:12:24.275855: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1b036c7c1d0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 10:12:24.279468: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 10:12:24.281486: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 10:12:24.285531: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 10:12:24.287670: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:12:24.289765: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:12:24.292040: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 10:12:24.294084: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 10:12:24.296372: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 10:12:24.298458: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 10:12:24.300544: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:12:24.302585: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 10:12:24.728727: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 10:12:24.731217: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 10:12:24.732534: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 10:12:24.734090: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 10:12:24.740525: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1b061721ce0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 10:12:24.743284: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 10:12:27.045611: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 10:12:28.279866: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:12:28.964736: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:12:28.971605: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:12:30.339691: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 10:12:30.391130: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 10:12:30.972661: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 219ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :15.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :8.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 63ms/step
[INFOR]: Toltal norm before transform: 0.4242
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1187

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 63ms/step
[INFOR]: SEN training of class 74_33 before transform: 15
[INFOR]: SPE training of class 74_33 before transform: 21

[INFOR]: SEN training of class 74_33 after transform: 29
[INFOR]: SPE training of class 74_33 after transform: 21
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (68, 32, 32, 3)
[INFOR]: shape of y: (68, 1)
3/3 [==============================] - 0s 62ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :15.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :14.0
[INFOR]: SEN testing of class 74_34 before transform: 15
[INFOR]: SPE testing of class 74_34 before transform: 22

[INFOR]: SEN testing of class 74_34 after transform: 28
[INFOR]: SPE testing of class 74_34 after transform: 5
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name fgvc_aircraft --class_name_train 75_34 --class_name_test 75_33
2021-09-13 10:12:35.683572: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  fgvc_aircraft
class_name_train =  75_34
class_name_test =  75_33
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (68, 32, 32, 3)
[INFOR]: shape of y: (68, 1)
[INFOR]: get pretrained model
2021-09-13 10:12:38.293784: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 10:12:38.319816: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 10:12:38.324463: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 10:12:38.332267: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:12:38.334501: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:12:38.339766: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 10:12:38.343024: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 10:12:38.349119: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 10:12:38.354056: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 10:12:38.356940: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:12:38.359183: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 10:12:38.361012: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 10:12:38.373065: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x24e363691a0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 10:12:38.376152: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 10:12:38.378145: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 10:12:38.382245: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 10:12:38.384592: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:12:38.386990: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:12:38.389258: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 10:12:38.391291: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 10:12:38.393403: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 10:12:38.395485: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 10:12:38.397569: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:12:38.399987: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 10:12:38.867853: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 10:12:38.870347: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 10:12:38.871706: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 10:12:38.873182: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 10:12:38.879805: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x24e5acffbe0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 10:12:38.882906: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 10:12:41.221246: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 10:12:42.486334: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:12:43.154985: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:12:43.162027: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:12:44.516701: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 10:12:44.565604: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 10:12:45.170454: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 234ms/step
[INFOR]: Index of most vote   :510
[INFOR]: Class of most vote   :container ship, containership, container vessel
[INFOR]: Number of most vote  :15.0


[INFOR]: Index of second most vote     :404
[INFOR]: Class of second most vote     :airliner
[INFOR]: Number of second most vote    :12.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 71ms/step
[INFOR]: Toltal norm before transform: 0.5757
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1008

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 63ms/step
[INFOR]: SEN training of class 75_34 before transform: 15
[INFOR]: SPE training of class 75_34 before transform: 23

[INFOR]: SEN training of class 75_34 after transform: 29
[INFOR]: SPE training of class 75_34 after transform: 23
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
3/3 [==============================] - 0s 64ms/step
[INFOR]: Index of most vote   :510
[INFOR]: Class of most vote   :container ship, containership, container vessel
[INFOR]: Number of most vote  :20.0


[INFOR]: Index of second most vote     :404
[INFOR]: Class of second most vote     :airliner
[INFOR]: Number of second most vote    :9.0
[INFOR]: SEN testing of class 75_33 before transform: 20
[INFOR]: SPE testing of class 75_33 before transform: 15

[INFOR]: SEN testing of class 75_33 after transform: 33
[INFOR]: SPE testing of class 75_33 after transform: 1
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name fgvc_aircraft --class_name_train 76_33 --class_name_test 76_33
2021-09-13 10:12:50.028041: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  fgvc_aircraft
class_name_train =  76_33
class_name_test =  76_33
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
[INFOR]: get pretrained model
2021-09-13 10:12:52.563589: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 10:12:52.588365: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 10:12:52.592754: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 10:12:52.600599: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:12:52.602826: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:12:52.607885: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 10:12:52.611169: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 10:12:52.617470: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 10:12:52.622421: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 10:12:52.625476: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:12:52.627587: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 10:12:52.629462: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 10:12:52.642110: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x2173942d1a0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 10:12:52.645657: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 10:12:52.647663: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 10:12:52.652030: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 10:12:52.654098: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:12:52.656152: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:12:52.658232: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 10:12:52.660272: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 10:12:52.662423: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 10:12:52.664829: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 10:12:52.666914: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:12:52.668952: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 10:12:53.101067: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 10:12:53.103424: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 10:12:53.104800: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 10:12:53.106287: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 10:12:53.113209: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x21768300c90 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 10:12:53.116045: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 10:12:55.447387: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 10:12:56.642789: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:12:57.292295: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:12:57.298832: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:12:58.631633: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 10:12:58.680590: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 10:12:59.246610: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 219ms/step
[INFOR]: Index of most vote   :510
[INFOR]: Class of most vote   :container ship, containership, container vessel
[INFOR]: Number of most vote  :17.0


[INFOR]: Index of second most vote     :404
[INFOR]: Class of second most vote     :airliner
[INFOR]: Number of second most vote    :11.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 63ms/step
[INFOR]: Toltal norm before transform: 0.4614
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1969

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 62ms/step
[INFOR]: SEN training of class 76_33 before transform: 17
[INFOR]: SPE training of class 76_33 before transform: 23

[INFOR]: SEN training of class 76_33 after transform: 28
[INFOR]: SPE training of class 76_33 after transform: 19
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
3/3 [==============================] - 0s 63ms/step
[INFOR]: Index of most vote   :510
[INFOR]: Class of most vote   :container ship, containership, container vessel
[INFOR]: Number of most vote  :19.0


[INFOR]: Index of second most vote     :404
[INFOR]: Class of second most vote     :airliner
[INFOR]: Number of second most vote    :12.0
[INFOR]: SEN testing of class 76_33 before transform: 19
[INFOR]: SPE testing of class 76_33 before transform: 21

[INFOR]: SEN testing of class 76_33 after transform: 32
[INFOR]: SPE testing of class 76_33 after transform: 0
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name fgvc_aircraft --class_name_train 77_33 --class_name_test 77_34
2021-09-13 10:13:03.627342: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  fgvc_aircraft
class_name_train =  77_33
class_name_test =  77_34
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
[INFOR]: get pretrained model
2021-09-13 10:13:06.191015: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 10:13:06.216571: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 10:13:06.221054: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 10:13:06.228857: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:13:06.230919: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:13:06.235960: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 10:13:06.239166: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 10:13:06.245321: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 10:13:06.250113: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 10:13:06.253131: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:13:06.255197: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 10:13:06.257008: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 10:13:06.269363: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1c737216020 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 10:13:06.272887: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 10:13:06.274989: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 10:13:06.279075: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 10:13:06.281168: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:13:06.283389: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:13:06.285452: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 10:13:06.287465: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 10:13:06.289555: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 10:13:06.292372: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 10:13:06.294875: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:13:06.297027: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 10:13:06.731607: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 10:13:06.734618: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 10:13:06.736121: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 10:13:06.737793: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 10:13:06.745120: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1c75b641aa0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 10:13:06.747921: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 10:13:09.016116: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 10:13:10.219470: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:13:10.870423: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:13:10.877579: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:13:12.221838: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 10:13:12.270475: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 10:13:12.850141: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 219ms/step
[INFOR]: Index of most vote   :510
[INFOR]: Class of most vote   :container ship, containership, container vessel
[INFOR]: Number of most vote  :24.0


[INFOR]: Index of second most vote     :404
[INFOR]: Class of second most vote     :airliner
[INFOR]: Number of second most vote    :3.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 63ms/step
[INFOR]: Toltal norm before transform: 0.2416
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0013

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 63ms/step
[INFOR]: SEN training of class 77_33 before transform: 24
[INFOR]: SPE training of class 77_33 before transform: 17

[INFOR]: SEN training of class 77_33 after transform: 33
[INFOR]: SPE training of class 77_33 after transform: 17
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (68, 32, 32, 3)
[INFOR]: shape of y: (68, 1)
3/3 [==============================] - 0s 64ms/step
[INFOR]: Index of most vote   :510
[INFOR]: Class of most vote   :container ship, containership, container vessel
[INFOR]: Number of most vote  :24.0


[INFOR]: Index of second most vote     :811
[INFOR]: Class of second most vote     :space heater
[INFOR]: Number of second most vote    :7.0
[INFOR]: SEN testing of class 77_34 before transform: 24
[INFOR]: SPE testing of class 77_34 before transform: 22

[INFOR]: SEN testing of class 77_34 after transform: 33
[INFOR]: SPE testing of class 77_34 after transform: 0
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name fgvc_aircraft --class_name_train 78_34 --class_name_test 78_33
2021-09-13 10:13:17.654412: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  fgvc_aircraft
class_name_train =  78_34
class_name_test =  78_33
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (68, 32, 32, 3)
[INFOR]: shape of y: (68, 1)
[INFOR]: get pretrained model
2021-09-13 10:13:20.149659: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 10:13:20.173544: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 10:13:20.177866: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 10:13:20.185544: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:13:20.187555: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:13:20.192502: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 10:13:20.195663: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 10:13:20.201753: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 10:13:20.206461: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 10:13:20.209187: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:13:20.211190: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 10:13:20.212929: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 10:13:20.224715: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x25c37521790 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 10:13:20.227655: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 10:13:20.229536: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 10:13:20.233740: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 10:13:20.235754: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:13:20.237714: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:13:20.239728: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 10:13:20.241676: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 10:13:20.243726: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 10:13:20.245714: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 10:13:20.247798: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:13:20.249766: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 10:13:20.670762: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 10:13:20.673619: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 10:13:20.674865: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 10:13:20.676237: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 10:13:20.682443: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x25c634b8ae0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 10:13:20.685157: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 10:13:22.937330: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 10:13:24.112715: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:13:24.754645: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:13:24.761406: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:13:26.090211: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 10:13:26.139153: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 10:13:26.704242: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 227ms/step
[INFOR]: Index of most vote   :510
[INFOR]: Class of most vote   :container ship, containership, container vessel
[INFOR]: Number of most vote  :16.0


[INFOR]: Index of second most vote     :404
[INFOR]: Class of second most vote     :airliner
[INFOR]: Number of second most vote    :15.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 63ms/step
[INFOR]: Toltal norm before transform: 0.5452
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1699

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 63ms/step
[INFOR]: SEN training of class 78_34 before transform: 16
[INFOR]: SPE training of class 78_34 before transform: 17

[INFOR]: SEN training of class 78_34 after transform: 25
[INFOR]: SPE training of class 78_34 after transform: 17
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
3/3 [==============================] - 0s 62ms/step
[INFOR]: Index of most vote   :510
[INFOR]: Class of most vote   :container ship, containership, container vessel
[INFOR]: Number of most vote  :17.0


[INFOR]: Index of second most vote     :404
[INFOR]: Class of second most vote     :airliner
[INFOR]: Number of second most vote    :14.0
[INFOR]: SEN testing of class 78_33 before transform: 17
[INFOR]: SPE testing of class 78_33 before transform: 16

[INFOR]: SEN testing of class 78_33 after transform: 27
[INFOR]: SPE testing of class 78_33 after transform: 9
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name fgvc_aircraft --class_name_train 79_33 --class_name_test 79_33
2021-09-13 10:13:31.375628: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  fgvc_aircraft
class_name_train =  79_33
class_name_test =  79_33
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
[INFOR]: get pretrained model
2021-09-13 10:13:33.897156: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 10:13:33.924000: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 10:13:33.928668: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 10:13:33.936357: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:13:33.938408: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:13:33.943363: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 10:13:33.946673: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 10:13:33.952961: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 10:13:33.957789: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 10:13:33.960609: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:13:33.962674: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 10:13:33.964493: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 10:13:33.976601: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1a839715710 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 10:13:33.980224: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 10:13:33.982205: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 10:13:33.986555: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 10:13:33.989160: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:13:33.991199: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:13:33.993269: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 10:13:33.995291: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 10:13:33.997334: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 10:13:33.999507: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 10:13:34.001769: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:13:34.004388: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 10:13:34.425333: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 10:13:34.428616: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 10:13:34.429932: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 10:13:34.431362: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 10:13:34.438018: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1a868d82fc0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 10:13:34.440761: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 10:13:36.714105: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 10:13:37.901499: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:13:38.542255: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:13:38.548670: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:13:39.868072: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 10:13:39.916433: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 10:13:40.477437: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 219ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :18.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :10.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 63ms/step
[INFOR]: Toltal norm before transform: 0.2147
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0076

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 63ms/step
[INFOR]: SEN training of class 79_33 before transform: 18
[INFOR]: SPE training of class 79_33 before transform: 23

[INFOR]: SEN training of class 79_33 after transform: 29
[INFOR]: SPE training of class 79_33 after transform: 23
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
3/3 [==============================] - 0s 63ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :19.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :14.0
[INFOR]: SEN testing of class 79_33 before transform: 19
[INFOR]: SPE testing of class 79_33 before transform: 19

[INFOR]: SEN testing of class 79_33 after transform: 30
[INFOR]: SPE testing of class 79_33 after transform: 6
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name fgvc_aircraft --class_name_train 80_33 --class_name_test 80_34
2021-09-13 10:13:44.758759: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  fgvc_aircraft
class_name_train =  80_33
class_name_test =  80_34
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
[INFOR]: get pretrained model
2021-09-13 10:13:47.265366: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 10:13:47.293066: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 10:13:47.298958: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 10:13:47.306585: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:13:47.308847: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:13:47.313906: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 10:13:47.317100: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 10:13:47.323045: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 10:13:47.328233: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 10:13:47.331023: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:13:47.333150: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 10:13:47.335193: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 10:13:47.346997: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x293b8d709c0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 10:13:47.349998: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 10:13:47.351998: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 10:13:47.356325: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 10:13:47.358450: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:13:47.360554: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:13:47.362683: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 10:13:47.364765: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 10:13:47.366918: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 10:13:47.369096: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 10:13:47.371496: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:13:47.373589: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 10:13:47.802497: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 10:13:47.805669: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 10:13:47.807034: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 10:13:47.808475: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 10:13:47.814982: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x293e4618910 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 10:13:47.817919: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 10:13:50.093072: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 10:13:51.309147: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:13:51.951378: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:13:51.958146: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:13:53.294015: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 10:13:53.343225: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 10:13:53.908698: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 213ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :17.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :12.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 55ms/step
[INFOR]: Toltal norm before transform: 0.4315
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0871

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 63ms/step
[INFOR]: SEN training of class 80_33 before transform: 17
[INFOR]: SPE training of class 80_33 before transform: 22

[INFOR]: SEN training of class 80_33 after transform: 23
[INFOR]: SPE training of class 80_33 after transform: 21
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (68, 32, 32, 3)
[INFOR]: shape of y: (68, 1)
3/3 [==============================] - 0s 63ms/step
[INFOR]: Index of most vote   :510
[INFOR]: Class of most vote   :container ship, containership, container vessel
[INFOR]: Number of most vote  :17.0


[INFOR]: Index of second most vote     :404
[INFOR]: Class of second most vote     :airliner
[INFOR]: Number of second most vote    :12.0
[INFOR]: SEN testing of class 80_34 before transform: 17
[INFOR]: SPE testing of class 80_34 before transform: 24

[INFOR]: SEN testing of class 80_34 after transform: 34
[INFOR]: SPE testing of class 80_34 after transform: 0
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name fgvc_aircraft --class_name_train 81_34 --class_name_test 81_33
2021-09-13 10:13:58.612859: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  fgvc_aircraft
class_name_train =  81_34
class_name_test =  81_33
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (68, 32, 32, 3)
[INFOR]: shape of y: (68, 1)
[INFOR]: get pretrained model
2021-09-13 10:14:01.128236: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 10:14:01.152161: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 10:14:01.156768: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 10:14:01.164760: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:14:01.167004: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:14:01.172165: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 10:14:01.175463: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 10:14:01.181570: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 10:14:01.186816: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 10:14:01.189868: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:14:01.192155: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 10:14:01.194156: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 10:14:01.206671: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1cd3510cfa0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 10:14:01.209746: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 10:14:01.211721: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 10:14:01.216153: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 10:14:01.218442: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:14:01.220526: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:14:01.222634: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 10:14:01.224695: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 10:14:01.226829: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 10:14:01.228937: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 10:14:01.231424: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:14:01.233550: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 10:14:01.649703: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 10:14:01.652989: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 10:14:01.654308: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 10:14:01.655728: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 10:14:01.662126: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1cd5feb3060 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 10:14:01.664868: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 10:14:03.929821: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 10:14:05.113464: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:14:05.757367: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:14:05.764505: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:14:07.090148: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 10:14:07.146295: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 10:14:07.709350: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 223ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :19.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :11.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 62ms/step
[INFOR]: Toltal norm before transform: 0.2332
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0278

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 63ms/step
[INFOR]: SEN training of class 81_34 before transform: 19
[INFOR]: SPE training of class 81_34 before transform: 22

[INFOR]: SEN training of class 81_34 after transform: 26
[INFOR]: SPE training of class 81_34 after transform: 22
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
3/3 [==============================] - 0s 63ms/step
[INFOR]: Index of most vote   :510
[INFOR]: Class of most vote   :container ship, containership, container vessel
[INFOR]: Number of most vote  :18.0


[INFOR]: Index of second most vote     :404
[INFOR]: Class of second most vote     :airliner
[INFOR]: Number of second most vote    :11.0
[INFOR]: SEN testing of class 81_33 before transform: 18
[INFOR]: SPE testing of class 81_33 before transform: 20

[INFOR]: SEN testing of class 81_33 after transform: 33
[INFOR]: SPE testing of class 81_33 after transform: 2
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name fgvc_aircraft --class_name_train 82_33 --class_name_test 82_33
2021-09-13 10:14:12.412023: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  fgvc_aircraft
class_name_train =  82_33
class_name_test =  82_33
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
[INFOR]: get pretrained model
2021-09-13 10:14:14.972312: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 10:14:14.996203: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 10:14:15.000397: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 10:14:15.008380: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:14:15.010476: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:14:15.015564: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 10:14:15.018800: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 10:14:15.025002: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 10:14:15.029841: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 10:14:15.032856: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:14:15.034924: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 10:14:15.036755: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 10:14:15.049224: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1c9b422ba00 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 10:14:15.052614: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 10:14:15.054726: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 10:14:15.058846: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 10:14:15.060937: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:14:15.063002: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:14:15.065093: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 10:14:15.067183: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 10:14:15.069805: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 10:14:15.071893: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 10:14:15.073988: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:14:15.076081: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 10:14:15.505363: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 10:14:15.508053: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 10:14:15.509546: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 10:14:15.511007: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 10:14:15.517623: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1c9e27e25e0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 10:14:15.520411: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 10:14:17.808001: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 10:14:19.006935: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:14:19.654761: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:14:19.661230: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:14:20.986293: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 10:14:21.033038: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 10:14:21.594178: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 211ms/step
[INFOR]: Index of most vote   :510
[INFOR]: Class of most vote   :container ship, containership, container vessel
[INFOR]: Number of most vote  :16.0


[INFOR]: Index of second most vote     :404
[INFOR]: Class of second most vote     :airliner
[INFOR]: Number of second most vote    :6.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 63ms/step
[INFOR]: Toltal norm before transform: 0.5024
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.2242

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 69ms/step
[INFOR]: SEN training of class 82_33 before transform: 16
[INFOR]: SPE training of class 82_33 before transform: 19

[INFOR]: SEN training of class 82_33 after transform: 32
[INFOR]: SPE training of class 82_33 after transform: 19
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
3/3 [==============================] - 0s 62ms/step
[INFOR]: Index of most vote   :510
[INFOR]: Class of most vote   :container ship, containership, container vessel
[INFOR]: Number of most vote  :16.0


[INFOR]: Index of second most vote     :404
[INFOR]: Class of second most vote     :airliner
[INFOR]: Number of second most vote    :8.0
[INFOR]: SEN testing of class 82_33 before transform: 16
[INFOR]: SPE testing of class 82_33 before transform: 20

[INFOR]: SEN testing of class 82_33 after transform: 32
[INFOR]: SPE testing of class 82_33 after transform: 8
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name fgvc_aircraft --class_name_train 83_33 --class_name_test 83_34
2021-09-13 10:14:25.894795: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  fgvc_aircraft
class_name_train =  83_33
class_name_test =  83_34
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
[INFOR]: get pretrained model
2021-09-13 10:14:28.374502: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 10:14:28.398306: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 10:14:28.403264: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 10:14:28.411151: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:14:28.413240: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:14:28.418369: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 10:14:28.421571: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 10:14:28.427737: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 10:14:28.432541: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 10:14:28.435458: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:14:28.437550: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 10:14:28.439393: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 10:14:28.451300: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1beb4dbd380 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 10:14:28.454303: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 10:14:28.456428: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 10:14:28.460506: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 10:14:28.462628: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:14:28.464863: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:14:28.466945: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 10:14:28.468985: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 10:14:28.471423: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 10:14:28.473566: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 10:14:28.475847: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:14:28.477901: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 10:14:28.896636: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 10:14:28.899829: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 10:14:28.901181: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 10:14:28.902620: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 10:14:28.909065: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1bee01fac00 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 10:14:28.911777: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 10:14:31.155230: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 10:14:32.350806: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:14:32.997180: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:14:33.003418: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:14:34.335152: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 10:14:34.383126: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 10:14:34.972624: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 211ms/step
[INFOR]: Index of most vote   :510
[INFOR]: Class of most vote   :container ship, containership, container vessel
[INFOR]: Number of most vote  :21.0


[INFOR]: Index of second most vote     :404
[INFOR]: Class of second most vote     :airliner
[INFOR]: Number of second most vote    :8.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 63ms/step
[INFOR]: Toltal norm before transform: 0.3849
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0044

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 63ms/step
[INFOR]: SEN training of class 83_33 before transform: 21
[INFOR]: SPE training of class 83_33 before transform: 17

[INFOR]: SEN training of class 83_33 after transform: 28
[INFOR]: SPE training of class 83_33 after transform: 17
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (68, 32, 32, 3)
[INFOR]: shape of y: (68, 1)
3/3 [==============================] - 0s 63ms/step
[INFOR]: Index of most vote   :510
[INFOR]: Class of most vote   :container ship, containership, container vessel
[INFOR]: Number of most vote  :18.0


[INFOR]: Index of second most vote     :404
[INFOR]: Class of second most vote     :airliner
[INFOR]: Number of second most vote    :12.0
[INFOR]: SEN testing of class 83_34 before transform: 18
[INFOR]: SPE testing of class 83_34 before transform: 23

[INFOR]: SEN testing of class 83_34 after transform: 33
[INFOR]: SPE testing of class 83_34 after transform: 0
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name fgvc_aircraft --class_name_train 84_34 --class_name_test 84_33
2021-09-13 10:14:39.596723: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  fgvc_aircraft
class_name_train =  84_34
class_name_test =  84_33
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (68, 32, 32, 3)
[INFOR]: shape of y: (68, 1)
[INFOR]: get pretrained model
2021-09-13 10:14:42.089647: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 10:14:42.113571: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 10:14:42.118858: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 10:14:42.126570: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:14:42.128659: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:14:42.133858: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 10:14:42.137066: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 10:14:42.143053: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 10:14:42.147885: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 10:14:42.151067: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:14:42.153131: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 10:14:42.154948: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 10:14:42.166911: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x189b4ff39c0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 10:14:42.170700: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 10:14:42.172664: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 10:14:42.176990: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 10:14:42.179332: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:14:42.181503: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:14:42.183568: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 10:14:42.185588: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 10:14:42.187779: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 10:14:42.189837: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 10:14:42.191945: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:14:42.194156: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 10:14:42.617395: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 10:14:42.620420: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 10:14:42.621848: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 10:14:42.623308: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 10:14:42.629963: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x189e4e7b990 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 10:14:42.632717: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 10:14:44.874240: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 10:14:46.058773: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:14:46.701625: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:14:46.709305: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:14:48.034449: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 10:14:48.082181: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 10:14:48.644833: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 221ms/step
[INFOR]: Index of most vote   :510
[INFOR]: Class of most vote   :container ship, containership, container vessel
[INFOR]: Number of most vote  :14.0


[INFOR]: Index of second most vote     :404
[INFOR]: Class of second most vote     :airliner
[INFOR]: Number of second most vote    :9.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 63ms/step
[INFOR]: Toltal norm before transform: 0.5256
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1837

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 63ms/step
[INFOR]: SEN training of class 84_34 before transform: 14
[INFOR]: SPE training of class 84_34 before transform: 18

[INFOR]: SEN training of class 84_34 after transform: 30
[INFOR]: SPE training of class 84_34 after transform: 18
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
3/3 [==============================] - 0s 63ms/step
[INFOR]: Index of most vote   :510
[INFOR]: Class of most vote   :container ship, containership, container vessel
[INFOR]: Number of most vote  :16.0


[INFOR]: Index of second most vote     :404
[INFOR]: Class of second most vote     :airliner
[INFOR]: Number of second most vote    :11.0
[INFOR]: SEN testing of class 84_33 before transform: 16
[INFOR]: SPE testing of class 84_33 before transform: 19

[INFOR]: SEN testing of class 84_33 after transform: 30
[INFOR]: SPE testing of class 84_33 after transform: 2
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name fgvc_aircraft --class_name_train 85_33 --class_name_test 85_33
2021-09-13 10:14:53.322352: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  fgvc_aircraft
class_name_train =  85_33
class_name_test =  85_33
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
[INFOR]: get pretrained model
2021-09-13 10:14:55.826557: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 10:14:55.850116: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 10:14:55.854307: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 10:14:55.862014: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:14:55.864237: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:14:55.869111: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 10:14:55.872591: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 10:14:55.878521: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 10:14:55.883199: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 10:14:55.886007: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:14:55.888456: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 10:14:55.890487: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 10:14:55.903009: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1fd368b1d10 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 10:14:55.906477: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 10:14:55.908444: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 10:14:55.912533: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 10:14:55.914592: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:14:55.916616: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:14:55.918663: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 10:14:55.920895: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 10:14:55.923195: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 10:14:55.925240: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 10:14:55.927295: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:14:55.929374: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 10:14:56.358394: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 10:14:56.361628: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 10:14:56.363012: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 10:14:56.364461: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 10:14:56.371252: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1fd62cb31f0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 10:14:56.374042: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 10:14:58.635258: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 10:14:59.829911: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:15:00.478989: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:15:00.486430: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:15:01.836960: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 10:15:01.892487: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 10:15:02.458433: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 219ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :20.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :12.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 62ms/step
[INFOR]: Toltal norm before transform: 0.3845
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1294

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 63ms/step
[INFOR]: SEN training of class 85_33 before transform: 20
[INFOR]: SPE training of class 85_33 before transform: 20

[INFOR]: SEN training of class 85_33 after transform: 27
[INFOR]: SPE training of class 85_33 after transform: 20
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
3/3 [==============================] - 0s 63ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :16.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :13.0
[INFOR]: SEN testing of class 85_33 before transform: 16
[INFOR]: SPE testing of class 85_33 before transform: 20

[INFOR]: SEN testing of class 85_33 after transform: 29
[INFOR]: SPE testing of class 85_33 after transform: 4
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name fgvc_aircraft --class_name_train 86_33 --class_name_test 86_34
2021-09-13 10:15:06.747719: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  fgvc_aircraft
class_name_train =  86_33
class_name_test =  86_34
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
[INFOR]: get pretrained model
2021-09-13 10:15:09.253971: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 10:15:09.277693: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 10:15:09.282060: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 10:15:09.289771: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:15:09.291827: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:15:09.296874: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 10:15:09.300136: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 10:15:09.306315: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 10:15:09.311217: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 10:15:09.314047: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:15:09.316396: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 10:15:09.318214: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 10:15:09.330269: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x20c37dc0b50 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 10:15:09.333811: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 10:15:09.335793: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 10:15:09.340306: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 10:15:09.342597: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:15:09.344868: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:15:09.347148: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 10:15:09.349244: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 10:15:09.351559: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 10:15:09.353645: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 10:15:09.355867: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:15:09.357979: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 10:15:09.776224: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 10:15:09.779560: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 10:15:09.780876: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 10:15:09.782315: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 10:15:09.788684: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x20c65f74670 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 10:15:09.791425: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 10:15:12.047757: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 10:15:13.231513: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:15:13.876071: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:15:13.883530: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:15:15.226146: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 10:15:15.273703: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 10:15:15.895288: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 242ms/step
[INFOR]: Index of most vote   :510
[INFOR]: Class of most vote   :container ship, containership, container vessel
[INFOR]: Number of most vote  :16.0


[INFOR]: Index of second most vote     :404
[INFOR]: Class of second most vote     :airliner
[INFOR]: Number of second most vote    :12.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 63ms/step
[INFOR]: Toltal norm before transform: 0.4872
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0555

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 55ms/step
[INFOR]: SEN training of class 86_33 before transform: 16
[INFOR]: SPE training of class 86_33 before transform: 19

[INFOR]: SEN training of class 86_33 after transform: 29
[INFOR]: SPE training of class 86_33 after transform: 19
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (68, 32, 32, 3)
[INFOR]: shape of y: (68, 1)
3/3 [==============================] - 0s 63ms/step
[INFOR]: Index of most vote   :510
[INFOR]: Class of most vote   :container ship, containership, container vessel
[INFOR]: Number of most vote  :13.0


[INFOR]: Index of second most vote     :404
[INFOR]: Class of second most vote     :airliner
[INFOR]: Number of second most vote    :10.0
[INFOR]: SEN testing of class 86_34 before transform: 13
[INFOR]: SPE testing of class 86_34 before transform: 17

[INFOR]: SEN testing of class 86_34 after transform: 29
[INFOR]: SPE testing of class 86_34 after transform: 1
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name fgvc_aircraft --class_name_train 87_34 --class_name_test 87_33
2021-09-13 10:15:20.749500: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  fgvc_aircraft
class_name_train =  87_34
class_name_test =  87_33
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (68, 32, 32, 3)
[INFOR]: shape of y: (68, 1)
[INFOR]: get pretrained model
2021-09-13 10:15:23.282433: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 10:15:23.307113: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 10:15:23.311598: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 10:15:23.319345: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:15:23.321424: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:15:23.326356: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 10:15:23.329567: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 10:15:23.335804: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 10:15:23.340645: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 10:15:23.343505: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:15:23.345584: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 10:15:23.347419: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 10:15:23.359582: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x2d9b7a08690 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 10:15:23.363171: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 10:15:23.365664: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 10:15:23.369784: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 10:15:23.371897: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:15:23.373961: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:15:23.376049: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 10:15:23.378144: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 10:15:23.380533: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 10:15:23.382856: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 10:15:23.384945: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:15:23.386998: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 10:15:23.810713: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 10:15:23.813352: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 10:15:23.814691: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 10:15:23.816141: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 10:15:23.823163: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x2d9e64c12e0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 10:15:23.826064: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 10:15:26.127716: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 10:15:27.322065: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:15:27.967087: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:15:27.974083: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:15:29.315774: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 10:15:29.364804: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 10:15:29.926291: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 250ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :18.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :12.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 63ms/step
[INFOR]: Toltal norm before transform: 0.3416
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0206

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 70ms/step
[INFOR]: SEN training of class 87_34 before transform: 18
[INFOR]: SPE training of class 87_34 before transform: 27

[INFOR]: SEN training of class 87_34 after transform: 29
[INFOR]: SPE training of class 87_34 after transform: 27
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
3/3 [==============================] - 0s 61ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :19.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :12.0
[INFOR]: SEN testing of class 87_33 before transform: 19
[INFOR]: SPE testing of class 87_33 before transform: 21

[INFOR]: SEN testing of class 87_33 after transform: 26
[INFOR]: SPE testing of class 87_33 after transform: 6
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name fgvc_aircraft --class_name_train 88_33 --class_name_test 88_33
2021-09-13 10:15:34.723862: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  fgvc_aircraft
class_name_train =  88_33
class_name_test =  88_33
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
[INFOR]: get pretrained model
2021-09-13 10:15:37.186990: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 10:15:37.211666: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 10:15:37.217801: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 10:15:37.225847: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:15:37.227933: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:15:37.232927: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 10:15:37.236270: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 10:15:37.242508: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 10:15:37.247364: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 10:15:37.250246: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:15:37.252787: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 10:15:37.254633: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 10:15:37.266373: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x231b41b4780 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 10:15:37.269651: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 10:15:37.271854: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 10:15:37.275984: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 10:15:37.278076: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:15:37.280157: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:15:37.282264: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 10:15:37.284638: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 10:15:37.286765: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 10:15:37.288869: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 10:15:37.290968: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:15:37.293070: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 10:15:37.713225: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 10:15:37.716526: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 10:15:37.718013: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 10:15:37.719563: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 10:15:37.726293: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x231df847f40 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 10:15:37.729179: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 10:15:39.975558: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 10:15:41.160964: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:15:41.804461: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:15:41.811604: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:15:43.144883: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 10:15:43.191396: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 10:15:43.780469: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 214ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :13.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :13.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 63ms/step
[INFOR]: Toltal norm before transform: 0.5589
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0451

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 63ms/step
[INFOR]: SEN training of class 88_33 before transform: 13
[INFOR]: SPE training of class 88_33 before transform: 26

[INFOR]: SEN training of class 88_33 after transform: 30
[INFOR]: SPE training of class 88_33 after transform: 26
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
3/3 [==============================] - 0s 62ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :14.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :11.0
[INFOR]: SEN testing of class 88_33 before transform: 14
[INFOR]: SPE testing of class 88_33 before transform: 22

[INFOR]: SEN testing of class 88_33 after transform: 32
[INFOR]: SPE testing of class 88_33 after transform: 2
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name fgvc_aircraft --class_name_train 89_33 --class_name_test 89_34
2021-09-13 10:15:48.080035: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  fgvc_aircraft
class_name_train =  89_33
class_name_test =  89_34
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
[INFOR]: get pretrained model
2021-09-13 10:15:50.569216: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 10:15:50.596324: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 10:15:50.602224: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 10:15:50.610030: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:15:50.612049: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:15:50.616927: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 10:15:50.620101: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 10:15:50.626508: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 10:15:50.631243: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 10:15:50.634181: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:15:50.636203: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 10:15:50.638230: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 10:15:50.650202: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1d337957b50 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 10:15:50.653759: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 10:15:50.655730: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 10:15:50.659769: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 10:15:50.661833: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:15:50.663923: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:15:50.666193: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 10:15:50.668386: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 10:15:50.670488: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 10:15:50.672617: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 10:15:50.674890: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:15:50.676920: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 10:15:51.101186: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 10:15:51.104178: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 10:15:51.105718: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 10:15:51.107159: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 10:15:51.113687: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1d358515990 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 10:15:51.116428: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 10:15:53.375144: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 10:15:54.549447: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:15:55.209826: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:15:55.216436: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:15:56.551720: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 10:15:56.601134: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 10:15:57.166648: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 219ms/step
[INFOR]: Index of most vote   :510
[INFOR]: Class of most vote   :container ship, containership, container vessel
[INFOR]: Number of most vote  :19.0


[INFOR]: Index of second most vote     :404
[INFOR]: Class of second most vote     :airliner
[INFOR]: Number of second most vote    :10.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 63ms/step
[INFOR]: Toltal norm before transform: 0.4081
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0040

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 63ms/step
[INFOR]: SEN training of class 89_33 before transform: 19
[INFOR]: SPE training of class 89_33 before transform: 21

[INFOR]: SEN training of class 89_33 after transform: 29
[INFOR]: SPE training of class 89_33 after transform: 21
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (68, 32, 32, 3)
[INFOR]: shape of y: (68, 1)
3/3 [==============================] - 0s 63ms/step
[INFOR]: Index of most vote   :510
[INFOR]: Class of most vote   :container ship, containership, container vessel
[INFOR]: Number of most vote  :17.0


[INFOR]: Index of second most vote     :404
[INFOR]: Class of second most vote     :airliner
[INFOR]: Number of second most vote    :10.0
[INFOR]: SEN testing of class 89_34 before transform: 17
[INFOR]: SPE testing of class 89_34 before transform: 20

[INFOR]: SEN testing of class 89_34 after transform: 30
[INFOR]: SPE testing of class 89_34 after transform: 5
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name fgvc_aircraft --class_name_train 90_34 --class_name_test 90_33
2021-09-13 10:16:01.833946: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  fgvc_aircraft
class_name_train =  90_34
class_name_test =  90_33
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (68, 32, 32, 3)
[INFOR]: shape of y: (68, 1)
[INFOR]: get pretrained model
2021-09-13 10:16:04.374079: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 10:16:04.397340: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 10:16:04.402364: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 10:16:04.410422: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:16:04.412608: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:16:04.417778: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 10:16:04.421301: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 10:16:04.427731: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 10:16:04.432743: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 10:16:04.435766: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:16:04.438028: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 10:16:04.439960: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 10:16:04.451558: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1693a6c47e0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 10:16:04.454639: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 10:16:04.456607: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 10:16:04.460884: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 10:16:04.462984: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:16:04.465068: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:16:04.467341: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 10:16:04.469410: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 10:16:04.471740: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 10:16:04.474438: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 10:16:04.476575: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:16:04.478627: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 10:16:04.910027: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 10:16:04.913244: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 10:16:04.915053: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 10:16:04.916640: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 10:16:04.923309: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x16962a197e0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 10:16:04.926041: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 10:16:07.222408: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 10:16:08.418203: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:16:09.074713: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:16:09.082029: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:16:10.404176: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 10:16:10.459414: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 10:16:11.019952: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 219ms/step
[INFOR]: Index of most vote   :510
[INFOR]: Class of most vote   :container ship, containership, container vessel
[INFOR]: Number of most vote  :13.0


[INFOR]: Index of second most vote     :404
[INFOR]: Class of second most vote     :airliner
[INFOR]: Number of second most vote    :12.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 63ms/step
[INFOR]: Toltal norm before transform: 0.6454
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1356

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 63ms/step
[INFOR]: SEN training of class 90_34 before transform: 13
[INFOR]: SPE training of class 90_34 before transform: 22

[INFOR]: SEN training of class 90_34 after transform: 29
[INFOR]: SPE training of class 90_34 after transform: 22
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
3/3 [==============================] - 0s 62ms/step
[INFOR]: Index of most vote   :510
[INFOR]: Class of most vote   :container ship, containership, container vessel
[INFOR]: Number of most vote  :17.0


[INFOR]: Index of second most vote     :404
[INFOR]: Class of second most vote     :airliner
[INFOR]: Number of second most vote    :10.0
[INFOR]: SEN testing of class 90_33 before transform: 17
[INFOR]: SPE testing of class 90_33 before transform: 20

[INFOR]: SEN testing of class 90_33 after transform: 31
[INFOR]: SPE testing of class 90_33 after transform: 0
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name fgvc_aircraft --class_name_train 91_33 --class_name_test 91_33
2021-09-13 10:16:15.723205: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  fgvc_aircraft
class_name_train =  91_33
class_name_test =  91_33
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
[INFOR]: get pretrained model
2021-09-13 10:16:18.237989: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 10:16:18.261404: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 10:16:18.265798: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 10:16:18.273652: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:16:18.275705: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:16:18.280591: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 10:16:18.283845: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 10:16:18.290560: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 10:16:18.295314: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 10:16:18.298182: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:16:18.300539: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 10:16:18.302379: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 10:16:18.314495: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x246b44ce400 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 10:16:18.318273: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 10:16:18.320260: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 10:16:18.324278: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 10:16:18.326407: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:16:18.328439: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:16:18.330497: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 10:16:18.332669: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 10:16:18.334877: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 10:16:18.336934: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 10:16:18.339018: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:16:18.341083: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 10:16:18.765329: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 10:16:18.768605: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 10:16:18.769962: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 10:16:18.771384: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 10:16:18.777995: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x246df2cd660 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 10:16:18.780697: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 10:16:21.022690: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 10:16:22.193614: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:16:22.830273: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:16:22.836535: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:16:24.165945: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 10:16:24.213897: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 10:16:24.775523: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 211ms/step
[INFOR]: Index of most vote   :510
[INFOR]: Class of most vote   :container ship, containership, container vessel
[INFOR]: Number of most vote  :20.0


[INFOR]: Index of second most vote     :404
[INFOR]: Class of second most vote     :airliner
[INFOR]: Number of second most vote    :4.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 63ms/step
[INFOR]: Toltal norm before transform: 0.3631
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0086

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 63ms/step
[INFOR]: SEN training of class 91_33 before transform: 20
[INFOR]: SPE training of class 91_33 before transform: 13

[INFOR]: SEN training of class 91_33 after transform: 32
[INFOR]: SPE training of class 91_33 after transform: 13
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
3/3 [==============================] - 0s 63ms/step
[INFOR]: Index of most vote   :510
[INFOR]: Class of most vote   :container ship, containership, container vessel
[INFOR]: Number of most vote  :21.0


[INFOR]: Index of second most vote     :404
[INFOR]: Class of second most vote     :airliner
[INFOR]: Number of second most vote    :3.0
[INFOR]: SEN testing of class 91_33 before transform: 21
[INFOR]: SPE testing of class 91_33 before transform: 17

[INFOR]: SEN testing of class 91_33 after transform: 32
[INFOR]: SPE testing of class 91_33 after transform: 3
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name fgvc_aircraft --class_name_train 92_34 --class_name_test 92_33
2021-09-13 10:16:29.069447: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  fgvc_aircraft
class_name_train =  92_34
class_name_test =  92_33
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (68, 32, 32, 3)
[INFOR]: shape of y: (68, 1)
[INFOR]: get pretrained model
2021-09-13 10:16:31.579857: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 10:16:31.603371: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 10:16:31.608878: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 10:16:31.616653: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:16:31.618698: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:16:31.623784: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 10:16:31.627049: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 10:16:31.633283: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 10:16:31.638023: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 10:16:31.641407: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:16:31.643453: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 10:16:31.645262: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 10:16:31.657488: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x17cbab92f50 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 10:16:31.661295: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 10:16:31.663422: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 10:16:31.667926: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 10:16:31.670375: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:16:31.672552: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:16:31.674748: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 10:16:31.676926: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 10:16:31.679206: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 10:16:31.681523: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 10:16:31.683768: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:16:31.686028: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 10:16:32.111487: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 10:16:32.114599: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 10:16:32.115952: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 10:16:32.117367: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 10:16:32.124004: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x17ceaab0090 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 10:16:32.126705: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 10:16:34.394846: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 10:16:35.588944: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:16:36.228203: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:16:36.235011: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:16:37.561131: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 10:16:37.615211: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 10:16:38.173831: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 223ms/step
[INFOR]: Index of most vote   :510
[INFOR]: Class of most vote   :container ship, containership, container vessel
[INFOR]: Number of most vote  :15.0


[INFOR]: Index of second most vote     :404
[INFOR]: Class of second most vote     :airliner
[INFOR]: Number of second most vote    :14.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 63ms/step
[INFOR]: Toltal norm before transform: 0.5609
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1201

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 63ms/step
[INFOR]: SEN training of class 92_34 before transform: 15
[INFOR]: SPE training of class 92_34 before transform: 24

[INFOR]: SEN training of class 92_34 after transform: 31
[INFOR]: SPE training of class 92_34 after transform: 24
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
3/3 [==============================] - 0s 63ms/step
[INFOR]: Index of most vote   :510
[INFOR]: Class of most vote   :container ship, containership, container vessel
[INFOR]: Number of most vote  :16.0


[INFOR]: Index of second most vote     :404
[INFOR]: Class of second most vote     :airliner
[INFOR]: Number of second most vote    :11.0
[INFOR]: SEN testing of class 92_33 before transform: 16
[INFOR]: SPE testing of class 92_33 before transform: 23

[INFOR]: SEN testing of class 92_33 after transform: 30
[INFOR]: SPE testing of class 92_33 after transform: 6
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name fgvc_aircraft --class_name_train 93_33 --class_name_test 93_33
2021-09-13 10:16:42.861644: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  fgvc_aircraft
class_name_train =  93_33
class_name_test =  93_33
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
[INFOR]: get pretrained model
2021-09-13 10:16:45.381523: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 10:16:45.405891: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 10:16:45.410319: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 10:16:45.418284: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:16:45.420387: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:16:45.425405: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 10:16:45.429020: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 10:16:45.435203: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 10:16:45.440011: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 10:16:45.442879: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:16:45.445145: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 10:16:45.447137: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 10:16:45.459501: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x24d33666aa0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 10:16:45.462646: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 10:16:45.464619: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 10:16:45.468735: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 10:16:45.470819: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:16:45.472864: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:16:45.475043: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 10:16:45.477069: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 10:16:45.479284: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 10:16:45.481531: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 10:16:45.483595: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:16:45.485625: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 10:16:45.909024: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 10:16:45.911919: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 10:16:45.913228: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 10:16:45.914907: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 10:16:45.921387: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x24d62301b40 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 10:16:45.924097: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 10:16:48.208733: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 10:16:49.411056: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:16:50.055898: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:16:50.062922: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:16:51.398364: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 10:16:51.455188: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 10:16:52.021746: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 212ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :15.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :11.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 63ms/step
[INFOR]: Toltal norm before transform: 0.4778
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0202

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 64ms/step
[INFOR]: SEN training of class 93_33 before transform: 15
[INFOR]: SPE training of class 93_33 before transform: 21

[INFOR]: SEN training of class 93_33 after transform: 30
[INFOR]: SPE training of class 93_33 after transform: 21
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
3/3 [==============================] - 0s 63ms/step
[INFOR]: Index of most vote   :510
[INFOR]: Class of most vote   :container ship, containership, container vessel
[INFOR]: Number of most vote  :23.0


[INFOR]: Index of second most vote     :404
[INFOR]: Class of second most vote     :airliner
[INFOR]: Number of second most vote    :6.0
[INFOR]: SEN testing of class 93_33 before transform: 23
[INFOR]: SPE testing of class 93_33 before transform: 15

[INFOR]: SEN testing of class 93_33 after transform: 33
[INFOR]: SPE testing of class 93_33 after transform: 0
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name fgvc_aircraft --class_name_train 94_33 --class_name_test 94_34
2021-09-13 10:16:56.279259: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  fgvc_aircraft
class_name_train =  94_33
class_name_test =  94_34
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
[INFOR]: get pretrained model
2021-09-13 10:16:58.773891: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 10:16:58.799980: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 10:16:58.804464: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 10:16:58.812186: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:16:58.814198: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:16:58.819099: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 10:16:58.822254: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 10:16:58.828305: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 10:16:58.832980: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 10:16:58.835740: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:16:58.837748: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 10:16:58.839532: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 10:16:58.851789: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1af3353de90 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 10:16:58.855425: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 10:16:58.857351: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 10:16:58.861771: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 10:16:58.863827: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:16:58.865866: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:16:58.867934: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 10:16:58.869961: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 10:16:58.872102: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 10:16:58.874408: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 10:16:58.876474: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:16:58.878496: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 10:16:59.304946: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 10:16:59.308147: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 10:16:59.309517: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 10:16:59.310948: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 10:16:59.317564: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1af62508c60 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 10:16:59.320482: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 10:17:01.587401: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 10:17:02.749641: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:17:03.392596: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:17:03.399422: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:17:04.739199: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 10:17:04.788430: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 10:17:05.352973: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 220ms/step
[INFOR]: Index of most vote   :510
[INFOR]: Class of most vote   :container ship, containership, container vessel
[INFOR]: Number of most vote  :14.0


[INFOR]: Index of second most vote     :404
[INFOR]: Class of second most vote     :airliner
[INFOR]: Number of second most vote    :4.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 63ms/step
[INFOR]: Toltal norm before transform: 0.5444
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0387

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 63ms/step
[INFOR]: SEN training of class 94_33 before transform: 14
[INFOR]: SPE training of class 94_33 before transform: 20

[INFOR]: SEN training of class 94_33 after transform: 33
[INFOR]: SPE training of class 94_33 after transform: 20
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (68, 32, 32, 3)
[INFOR]: shape of y: (68, 1)
3/3 [==============================] - 0s 63ms/step
[INFOR]: Index of most vote   :510
[INFOR]: Class of most vote   :container ship, containership, container vessel
[INFOR]: Number of most vote  :17.0


[INFOR]: Index of second most vote     :404
[INFOR]: Class of second most vote     :airliner
[INFOR]: Number of second most vote    :3.0
[INFOR]: SEN testing of class 94_34 before transform: 17
[INFOR]: SPE testing of class 94_34 before transform: 18

[INFOR]: SEN testing of class 94_34 after transform: 34
[INFOR]: SPE testing of class 94_34 after transform: 4
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name fgvc_aircraft --class_name_train 95_33 --class_name_test 95_34
2021-09-13 10:17:10.085461: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  fgvc_aircraft
class_name_train =  95_33
class_name_test =  95_34
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
[INFOR]: get pretrained model
2021-09-13 10:17:12.633417: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 10:17:12.660227: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 10:17:12.664992: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 10:17:12.673317: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:17:12.675547: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:17:12.680761: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 10:17:12.684435: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 10:17:12.690660: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 10:17:12.695516: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 10:17:12.698597: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:17:12.700714: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 10:17:12.702635: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 10:17:12.714379: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x263baf68090 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 10:17:12.717499: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 10:17:12.719537: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 10:17:12.723819: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 10:17:12.725912: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:17:12.727990: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:17:12.730218: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 10:17:12.732282: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 10:17:12.734463: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 10:17:12.736823: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 10:17:12.739109: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:17:12.741365: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 10:17:13.172843: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 10:17:13.175182: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 10:17:13.176533: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 10:17:13.178010: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 10:17:13.184678: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x263e9e472e0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 10:17:13.187540: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 10:17:15.486703: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 10:17:16.682165: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:17:17.360074: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:17:17.367580: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:17:18.692485: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 10:17:18.741704: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 10:17:19.301749: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 213ms/step
[INFOR]: Index of most vote   :510
[INFOR]: Class of most vote   :container ship, containership, container vessel
[INFOR]: Number of most vote  :14.0


[INFOR]: Index of second most vote     :811
[INFOR]: Class of second most vote     :space heater
[INFOR]: Number of second most vote    :5.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 63ms/step
[INFOR]: Toltal norm before transform: 0.5695
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1312

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 63ms/step
[INFOR]: SEN training of class 95_33 before transform: 14
[INFOR]: SPE training of class 95_33 before transform: 24

[INFOR]: SEN training of class 95_33 after transform: 33
[INFOR]: SPE training of class 95_33 after transform: 24
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (68, 32, 32, 3)
[INFOR]: shape of y: (68, 1)
3/3 [==============================] - 0s 63ms/step
[INFOR]: Index of most vote   :510
[INFOR]: Class of most vote   :container ship, containership, container vessel
[INFOR]: Number of most vote  :18.0


[INFOR]: Index of second most vote     :659
[INFOR]: Class of second most vote     :mixing bowl
[INFOR]: Number of second most vote    :3.0
[INFOR]: SEN testing of class 95_34 before transform: 18
[INFOR]: SPE testing of class 95_34 before transform: 19

[INFOR]: SEN testing of class 95_34 after transform: 34
[INFOR]: SPE testing of class 95_34 after transform: 2
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name fgvc_aircraft --class_name_train 96_34 --class_name_test 96_33
2021-09-13 10:17:23.941704: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  fgvc_aircraft
class_name_train =  96_34
class_name_test =  96_33
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (68, 32, 32, 3)
[INFOR]: shape of y: (68, 1)
[INFOR]: get pretrained model
2021-09-13 10:17:26.422816: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 10:17:26.448470: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 10:17:26.453182: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 10:17:26.460957: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:17:26.463205: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:17:26.468377: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 10:17:26.471780: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 10:17:26.478077: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 10:17:26.483049: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 10:17:26.486055: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:17:26.488296: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 10:17:26.490250: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 10:17:26.502861: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1e4340d46b0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 10:17:26.506572: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 10:17:26.508974: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 10:17:26.513310: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 10:17:26.515544: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:17:26.517574: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:17:26.519634: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 10:17:26.521646: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 10:17:26.523793: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 10:17:26.525893: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 10:17:26.527984: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:17:26.530183: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 10:17:26.954903: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 10:17:26.958103: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 10:17:26.959449: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 10:17:26.960865: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 10:17:26.967664: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1e45e78ec60 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 10:17:26.970358: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 10:17:29.216588: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 10:17:30.378624: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:17:31.019245: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:17:31.026304: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:17:32.355192: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 10:17:32.410033: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 10:17:32.972504: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 222ms/step
[INFOR]: Index of most vote   :510
[INFOR]: Class of most vote   :container ship, containership, container vessel
[INFOR]: Number of most vote  :12.0


[INFOR]: Index of second most vote     :404
[INFOR]: Class of second most vote     :airliner
[INFOR]: Number of second most vote    :7.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 63ms/step
[INFOR]: Toltal norm before transform: 0.5693
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0315

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 63ms/step
[INFOR]: SEN training of class 96_34 before transform: 12
[INFOR]: SPE training of class 96_34 before transform: 19

[INFOR]: SEN training of class 96_34 after transform: 30
[INFOR]: SPE training of class 96_34 after transform: 19
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
3/3 [==============================] - 0s 63ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :12.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :12.0
[INFOR]: SEN testing of class 96_33 before transform: 12
[INFOR]: SPE testing of class 96_33 before transform: 22

[INFOR]: SEN testing of class 96_33 after transform: 33
[INFOR]: SPE testing of class 96_33 after transform: 0
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name fgvc_aircraft --class_name_train 97_33 --class_name_test 97_33
2021-09-13 10:17:37.707658: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  fgvc_aircraft
class_name_train =  97_33
class_name_test =  97_33
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
[INFOR]: get pretrained model
2021-09-13 10:17:40.216481: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 10:17:40.244094: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 10:17:40.248716: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 10:17:40.256481: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:17:40.258984: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:17:40.264111: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 10:17:40.267363: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 10:17:40.273553: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 10:17:40.278382: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 10:17:40.281361: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:17:40.283426: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 10:17:40.285246: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 10:17:40.297326: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1ba340520e0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 10:17:40.301057: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 10:17:40.302999: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 10:17:40.307327: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 10:17:40.309452: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:17:40.311676: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:17:40.313747: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 10:17:40.315784: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 10:17:40.317842: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 10:17:40.319927: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 10:17:40.322450: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:17:40.324498: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 10:17:40.742468: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 10:17:40.745265: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 10:17:40.746581: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 10:17:40.748020: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 10:17:40.754379: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1ba5f55e430 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 10:17:40.757134: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 10:17:43.008027: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 10:17:44.199769: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:17:44.840869: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:17:44.848444: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:17:46.171845: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 10:17:46.220806: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 10:17:46.781802: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 217ms/step
[INFOR]: Index of most vote   :510
[INFOR]: Class of most vote   :container ship, containership, container vessel
[INFOR]: Number of most vote  :17.0


[INFOR]: Index of second most vote     :404
[INFOR]: Class of second most vote     :airliner
[INFOR]: Number of second most vote    :9.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 63ms/step
[INFOR]: Toltal norm before transform: 0.4640
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1078

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 63ms/step
[INFOR]: SEN training of class 97_33 before transform: 17
[INFOR]: SPE training of class 97_33 before transform: 24

[INFOR]: SEN training of class 97_33 after transform: 32
[INFOR]: SPE training of class 97_33 after transform: 24
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
3/3 [==============================] - 0s 63ms/step
[INFOR]: Index of most vote   :510
[INFOR]: Class of most vote   :container ship, containership, container vessel
[INFOR]: Number of most vote  :13.0


[INFOR]: Index of second most vote     :404
[INFOR]: Class of second most vote     :airliner
[INFOR]: Number of second most vote    :8.0
[INFOR]: SEN testing of class 97_33 before transform: 13
[INFOR]: SPE testing of class 97_33 before transform: 21

[INFOR]: SEN testing of class 97_33 after transform: 31
[INFOR]: SPE testing of class 97_33 after transform: 5
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name fgvc_aircraft --class_name_train 98_33 --class_name_test 98_34
2021-09-13 10:17:51.082364: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  fgvc_aircraft
class_name_train =  98_33
class_name_test =  98_34
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
[INFOR]: get pretrained model
2021-09-13 10:17:53.699170: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 10:17:53.723787: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 10:17:53.728591: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 10:17:53.736915: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:17:53.739117: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:17:53.744334: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 10:17:53.748143: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 10:17:53.754616: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 10:17:53.759693: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 10:17:53.762744: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:17:53.764948: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 10:17:53.766830: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 10:17:53.779003: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x22a333d4c30 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 10:17:53.782101: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 10:17:53.784370: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 10:17:53.788821: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 10:17:53.791045: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:17:53.793589: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:17:53.795799: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 10:17:53.798099: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 10:17:53.800498: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 10:17:53.802638: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 10:17:53.804777: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:17:53.806884: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 10:17:54.233324: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 10:17:54.235843: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 10:17:54.237409: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 10:17:54.238904: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 10:17:54.245395: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x22a62956ec0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 10:17:54.248150: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 10:17:56.569564: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 10:17:57.777970: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:17:58.423563: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:17:58.430186: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:17:59.777244: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 10:17:59.826616: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 10:18:00.448362: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 228ms/step
[INFOR]: Index of most vote   :510
[INFOR]: Class of most vote   :container ship, containership, container vessel
[INFOR]: Number of most vote  :15.0


[INFOR]: Index of second most vote     :404
[INFOR]: Class of second most vote     :airliner
[INFOR]: Number of second most vote    :10.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 63ms/step
[INFOR]: Toltal norm before transform: 0.6029
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0807

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 63ms/step
[INFOR]: SEN training of class 98_33 before transform: 15
[INFOR]: SPE training of class 98_33 before transform: 21

[INFOR]: SEN training of class 98_33 after transform: 33
[INFOR]: SPE training of class 98_33 after transform: 21
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (68, 32, 32, 3)
[INFOR]: shape of y: (68, 1)
3/3 [==============================] - 0s 63ms/step
[INFOR]: Index of most vote   :510
[INFOR]: Class of most vote   :container ship, containership, container vessel
[INFOR]: Number of most vote  :19.0


[INFOR]: Index of second most vote     :404
[INFOR]: Class of second most vote     :airliner
[INFOR]: Number of second most vote    :11.0
[INFOR]: SEN testing of class 98_34 before transform: 19
[INFOR]: SPE testing of class 98_34 before transform: 24

[INFOR]: SEN testing of class 98_34 after transform: 30
[INFOR]: SPE testing of class 98_34 after transform: 3
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name fgvc_aircraft --class_name_train 99_34 --class_name_test 99_33
2021-09-13 10:18:05.125275: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  fgvc_aircraft
class_name_train =  99_34
class_name_test =  99_33
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (68, 32, 32, 3)
[INFOR]: shape of y: (68, 1)
[INFOR]: get pretrained model
2021-09-13 10:18:07.691146: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 10:18:07.715194: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 10:18:07.719578: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 10:18:07.727475: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:18:07.729526: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:18:07.734587: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 10:18:07.737850: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 10:18:07.744103: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 10:18:07.749160: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 10:18:07.751932: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:18:07.754010: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 10:18:07.755993: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 10:18:07.768333: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x23a34c81390 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 10:18:07.771611: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 10:18:07.773537: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 10:18:07.777871: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 10:18:07.779915: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:18:07.781946: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:18:07.784034: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 10:18:07.786033: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 10:18:07.788115: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 10:18:07.790168: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 10:18:07.792301: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:18:07.794799: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 10:18:08.231109: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 10:18:08.233747: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 10:18:08.235089: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 10:18:08.236498: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 10:18:08.242802: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x23a5c888e50 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 10:18:08.245518: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 10:18:10.569681: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 10:18:11.831396: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 10:18:12.479595: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 10:18:12.486041: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 10:18:13.824166: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 10:18:13.873245: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 10:18:14.450353: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 223ms/step
[INFOR]: Index of most vote   :510
[INFOR]: Class of most vote   :container ship, containership, container vessel
[INFOR]: Number of most vote  :18.0


[INFOR]: Index of second most vote     :404
[INFOR]: Class of second most vote     :airliner
[INFOR]: Number of second most vote    :10.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 63ms/step
[INFOR]: Toltal norm before transform: 0.4545
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0837

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 62ms/step
[INFOR]: SEN training of class 99_34 before transform: 18
[INFOR]: SPE training of class 99_34 before transform: 17

[INFOR]: SEN training of class 99_34 after transform: 27
[INFOR]: SPE training of class 99_34 after transform: 17
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
3/3 [==============================] - 0s 63ms/step
[INFOR]: Index of most vote   :510
[INFOR]: Class of most vote   :container ship, containership, container vessel
[INFOR]: Number of most vote  :15.0


[INFOR]: Index of second most vote     :404
[INFOR]: Class of second most vote     :airliner
[INFOR]: Number of second most vote    :13.0
[INFOR]: SEN testing of class 99_33 before transform: 15
[INFOR]: SPE testing of class 99_33 before transform: 18

[INFOR]: SEN testing of class 99_33 after transform: 31
[INFOR]: SPE testing of class 99_33 after transform: 1
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>