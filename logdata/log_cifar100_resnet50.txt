

[INFOR]: Index of second most vote     :685
[INFOR]: Class of second most vote     :odometer, hodometer, mileometer, milometer
[INFOR]: Number of second most vote    :77.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 1s 26ms/step
[INFOR]: Toltal norm before transform: 0.7640
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0808

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 1s 26ms/step
[INFOR]: SEN training of class 16_500 before transform: 112
[INFOR]: SPE training of class 16_500 before transform: 498

[INFOR]: SEN training of class 16_500 after transform: 422
[INFOR]: SPE training of class 16_500 after transform: 373
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 27ms/step
[INFOR]: Index of most vote   :585
[INFOR]: Class of most vote   :hair spray
[INFOR]: Number of most vote  :16.0


[INFOR]: Index of second most vote     :630
[INFOR]: Class of second most vote     :Loafer
[INFOR]: Number of second most vote    :15.0
[INFOR]: SEN testing of class 16_100 before transform: 16
[INFOR]: SPE testing of class 16_100 before transform: 100

[INFOR]: SEN testing of class 16_100 after transform: 62
[INFOR]: SPE testing of class 16_100 after transform: 6
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name ResNet50  --model_shape 224 224 --dataset_name cifar_100 --class_name_train 17_500 --class_name_test 17_100
2021-09-08 13:33:43.258236: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  ResNet50
dataset_name =  cifar_100
class_name_train =  17_500
class_name_test =  17_100
data_shape =  (32, 32, 3)
model_shape =  [224, 224]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 13:33:46.018283: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 13:33:46.042632: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 13:33:46.048546: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 13:33:46.057080: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:33:46.059581: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:33:46.065290: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 13:33:46.069053: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 13:33:46.075786: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 13:33:46.081235: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 13:33:46.084438: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:33:46.086738: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 13:33:46.088741: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 13:33:46.101078: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x255394f2d20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 13:33:46.104115: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 13:33:46.106427: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 13:33:46.111038: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 13:33:46.113398: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:33:46.116317: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:33:46.118601: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 13:33:46.120974: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 13:33:46.123858: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 13:33:46.126148: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 13:33:46.128738: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:33:46.131003: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 13:33:46.570477: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 13:33:46.572766: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 13:33:46.574244: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 13:33:46.575919: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 13:33:46.583455: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x25567bb7160 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 13:33:46.586342: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 13:33:48.249102: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 13:33:48.759106: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:33:49.419479: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:33:49.426083: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:33:50.802961: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 13:33:50.853182: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 13:33:51.169343: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 4s 32ms/step
[INFOR]: Index of most vote   :510
[INFOR]: Class of most vote   :container ship, containership, container vessel
[INFOR]: Number of most vote  :64.0


[INFOR]: Index of second most vote     :674
[INFOR]: Class of second most vote     :mousetrap
[INFOR]: Number of second most vote    :52.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 1s 26ms/step
[INFOR]: Toltal norm before transform: 0.8463
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0657

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 1s 25ms/step
[INFOR]: SEN training of class 17_500 before transform: 64
[INFOR]: SPE training of class 17_500 before transform: 496

[INFOR]: SEN training of class 17_500 after transform: 421
[INFOR]: SPE training of class 17_500 after transform: 351
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 29ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :14.0


[INFOR]: Index of second most vote     :510
[INFOR]: Class of second most vote     :container ship, containership, container vessel
[INFOR]: Number of second most vote    :8.0
[INFOR]: SEN testing of class 17_100 before transform: 14
[INFOR]: SPE testing of class 17_100 before transform: 99

[INFOR]: SEN testing of class 17_100 after transform: 87
[INFOR]: SPE testing of class 17_100 after transform: 21
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name ResNet50  --model_shape 224 224 --dataset_name cifar_100 --class_name_train 18_500 --class_name_test 18_100
2021-09-08 13:33:58.543533: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  ResNet50
dataset_name =  cifar_100
class_name_train =  18_500
class_name_test =  18_100
data_shape =  (32, 32, 3)
model_shape =  [224, 224]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 13:34:01.285634: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 13:34:01.310138: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 13:34:01.315009: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 13:34:01.322981: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:34:01.325166: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:34:01.330390: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 13:34:01.334237: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 13:34:01.340567: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 13:34:01.345590: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 13:34:01.348978: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:34:01.351386: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 13:34:01.353364: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 13:34:01.365980: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x198b4698c70 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 13:34:01.369247: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 13:34:01.371394: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 13:34:01.375754: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 13:34:01.378022: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:34:01.380317: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:34:01.382836: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 13:34:01.385039: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 13:34:01.387201: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 13:34:01.389451: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 13:34:01.391893: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:34:01.394104: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 13:34:01.838648: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 13:34:01.841814: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 13:34:01.843297: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 13:34:01.844885: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 13:34:01.851637: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x198e01ae090 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 13:34:01.854723: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 13:34:03.505288: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 13:34:04.011729: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:34:04.683103: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:34:04.689405: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:34:06.074580: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 13:34:06.127148: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 13:34:06.448540: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 4s 32ms/step
[INFOR]: Index of most vote   :111
[INFOR]: Class of most vote   :nematode, nematode worm, roundworm
[INFOR]: Number of most vote  :39.0


[INFOR]: Index of second most vote     :59
[INFOR]: Class of second most vote     :vine snake
[INFOR]: Number of second most vote    :31.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 1s 26ms/step
[INFOR]: Toltal norm before transform: 0.9386
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0242

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 1s 26ms/step
[INFOR]: SEN training of class 18_500 before transform: 39
[INFOR]: SPE training of class 18_500 before transform: 494

[INFOR]: SEN training of class 18_500 after transform: 395
[INFOR]: SPE training of class 18_500 after transform: 327
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 26ms/step
[INFOR]: Index of most vote   :392
[INFOR]: Class of most vote   :rock beauty, Holocanthus tricolor
[INFOR]: Number of most vote  :11.0


[INFOR]: Index of second most vote     :59
[INFOR]: Class of second most vote     :vine snake
[INFOR]: Number of second most vote    :10.0
[INFOR]: SEN testing of class 18_100 before transform: 11
[INFOR]: SPE testing of class 18_100 before transform: 99

[INFOR]: SEN testing of class 18_100 after transform: 76
[INFOR]: SPE testing of class 18_100 after transform: 27
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name ResNet50  --model_shape 224 224 --dataset_name cifar_100 --class_name_train 19_500 --class_name_test 19_100
2021-09-08 13:34:13.726024: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  ResNet50
dataset_name =  cifar_100
class_name_train =  19_500
class_name_test =  19_100
data_shape =  (32, 32, 3)
model_shape =  [224, 224]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 13:34:16.404161: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 13:34:16.430123: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 13:34:16.434739: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 13:34:16.442940: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:34:16.445211: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:34:16.451125: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 13:34:16.454858: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 13:34:16.461208: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 13:34:16.466250: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 13:34:16.469429: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:34:16.471680: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 13:34:16.473736: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 13:34:16.486086: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x179b4468190 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 13:34:16.489429: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 13:34:16.491699: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 13:34:16.496436: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 13:34:16.498662: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:34:16.500837: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:34:16.503327: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 13:34:16.505531: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 13:34:16.507718: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 13:34:16.509922: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 13:34:16.512340: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:34:16.514850: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 13:34:16.945582: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 13:34:16.948404: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 13:34:16.949846: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 13:34:16.951526: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 13:34:16.960185: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x179e20148b0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 13:34:16.963990: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 13:34:18.631294: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 13:34:19.134042: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:34:19.798253: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:34:19.804337: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:34:21.180289: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 13:34:21.230476: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 13:34:21.542356: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 4s 31ms/step
[INFOR]: Index of most vote   :341
[INFOR]: Class of most vote   :hog, pig, grunter, squealer, Sus scrofa
[INFOR]: Number of most vote  :35.0


[INFOR]: Index of second most vote     :652
[INFOR]: Class of second most vote     :military uniform
[INFOR]: Number of second most vote    :30.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 1s 26ms/step
[INFOR]: Toltal norm before transform: 0.9092
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0363

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 1s 26ms/step
[INFOR]: SEN training of class 19_500 before transform: 35
[INFOR]: SPE training of class 19_500 before transform: 500

[INFOR]: SEN training of class 19_500 after transform: 371
[INFOR]: SPE training of class 19_500 after transform: 342
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 26ms/step
[INFOR]: Index of most vote   :341
[INFOR]: Class of most vote   :hog, pig, grunter, squealer, Sus scrofa
[INFOR]: Number of most vote  :8.0


[INFOR]: Index of second most vote     :689
[INFOR]: Class of second most vote     :overskirt
[INFOR]: Number of second most vote    :6.0
[INFOR]: SEN testing of class 19_100 before transform: 8
[INFOR]: SPE testing of class 19_100 before transform: 99

[INFOR]: SEN testing of class 19_100 after transform: 61
[INFOR]: SPE testing of class 19_100 after transform: 20
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name ResNet50  --model_shape 224 224 --dataset_name cifar_100 --class_name_train 20_500 --class_name_test 20_100
2021-09-08 13:34:28.789659: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  ResNet50
dataset_name =  cifar_100
class_name_train =  20_500
class_name_test =  20_100
data_shape =  (32, 32, 3)
model_shape =  [224, 224]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 13:34:31.480319: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 13:34:31.504348: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 13:34:31.509151: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 13:34:31.517038: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:34:31.519316: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:34:31.524481: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 13:34:31.528134: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 13:34:31.534474: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 13:34:31.539389: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 13:34:31.542486: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:34:31.544888: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 13:34:31.546807: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 13:34:31.559054: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1413aa20860 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 13:34:31.562597: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 13:34:31.564753: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 13:34:31.569220: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 13:34:31.571424: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:34:31.573662: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:34:31.576007: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 13:34:31.578212: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 13:34:31.580553: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 13:34:31.582830: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 13:34:31.585167: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:34:31.587514: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 13:34:32.018408: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 13:34:32.021169: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 13:34:32.022884: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 13:34:32.024500: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 13:34:32.031140: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1416a3be310 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 13:34:32.034133: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 13:34:33.701130: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 13:34:34.211898: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:34:34.879760: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:34:34.886317: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:34:36.256787: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 13:34:36.306289: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 13:34:36.619596: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 4s 32ms/step
[INFOR]: Index of most vote   :559
[INFOR]: Class of most vote   :folding chair
[INFOR]: Number of most vote  :157.0


[INFOR]: Index of second most vote     :532
[INFOR]: Class of second most vote     :dining table, board
[INFOR]: Number of second most vote    :58.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 1s 26ms/step
[INFOR]: Toltal norm before transform: 0.6734
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1366

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 1s 26ms/step
[INFOR]: SEN training of class 20_500 before transform: 157
[INFOR]: SPE training of class 20_500 before transform: 500

[INFOR]: SEN training of class 20_500 after transform: 481
[INFOR]: SPE training of class 20_500 after transform: 419
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 26ms/step
[INFOR]: Index of most vote   :559
[INFOR]: Class of most vote   :folding chair
[INFOR]: Number of most vote  :31.0


[INFOR]: Index of second most vote     :532
[INFOR]: Class of second most vote     :dining table, board
[INFOR]: Number of second most vote    :12.0
[INFOR]: SEN testing of class 20_100 before transform: 31
[INFOR]: SPE testing of class 20_100 before transform: 100

[INFOR]: SEN testing of class 20_100 after transform: 98
[INFOR]: SPE testing of class 20_100 after transform: 28
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name ResNet50  --model_shape 224 224 --dataset_name cifar_100 --class_name_train 21_500 --class_name_test 21_100
2021-09-08 13:34:43.859607: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  ResNet50
dataset_name =  cifar_100
class_name_train =  21_500
class_name_test =  21_100
data_shape =  (32, 32, 3)
model_shape =  [224, 224]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 13:34:46.532436: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 13:34:46.556490: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 13:34:46.561266: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 13:34:46.569511: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:34:46.571696: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:34:46.577052: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 13:34:46.580499: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 13:34:46.586764: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 13:34:46.591653: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 13:34:46.594815: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:34:46.596969: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 13:34:46.598928: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 13:34:46.611014: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x2a3b75a0a50 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 13:34:46.614861: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 13:34:46.617109: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 13:34:46.621793: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 13:34:46.624156: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:34:46.626406: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:34:46.628645: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 13:34:46.631033: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 13:34:46.633645: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 13:34:46.635913: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 13:34:46.638198: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:34:46.640370: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 13:34:47.069509: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 13:34:47.072230: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 13:34:47.074079: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 13:34:47.075846: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 13:34:47.082620: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x2a3e648d6e0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 13:34:47.085568: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 13:34:48.742327: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 13:34:49.247633: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:34:49.902584: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:34:49.909086: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:34:51.293070: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 13:34:51.342501: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 13:34:51.655072: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 4s 32ms/step
[INFOR]: Index of most vote   :369
[INFOR]: Class of most vote   :siamang, Hylobates syndactylus, Symphalangus syndactylus
[INFOR]: Number of most vote  :86.0


[INFOR]: Index of second most vote     :365
[INFOR]: Class of second most vote     :orangutan, orang, orangutang, Pongo pygmaeus
[INFOR]: Number of second most vote    :74.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 1s 26ms/step
[INFOR]: Toltal norm before transform: 0.8087
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0802

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 1s 26ms/step
[INFOR]: SEN training of class 21_500 before transform: 86
[INFOR]: SPE training of class 21_500 before transform: 498

[INFOR]: SEN training of class 21_500 after transform: 411
[INFOR]: SPE training of class 21_500 after transform: 356
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 26ms/step
[INFOR]: Index of most vote   :367
[INFOR]: Class of most vote   :chimpanzee, chimp, Pan troglodytes
[INFOR]: Number of most vote  :13.0


[INFOR]: Index of second most vote     :368
[INFOR]: Class of second most vote     :gibbon, Hylobates lar
[INFOR]: Number of second most vote    :11.0
[INFOR]: SEN testing of class 21_100 before transform: 13
[INFOR]: SPE testing of class 21_100 before transform: 100

[INFOR]: SEN testing of class 21_100 after transform: 80
[INFOR]: SPE testing of class 21_100 after transform: 0
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name ResNet50  --model_shape 224 224 --dataset_name cifar_100 --class_name_train 22_500 --class_name_test 22_100
2021-09-08 13:34:58.924595: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  ResNet50
dataset_name =  cifar_100
class_name_train =  22_500
class_name_test =  22_100
data_shape =  (32, 32, 3)
model_shape =  [224, 224]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 13:35:01.642539: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 13:35:01.666115: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 13:35:01.670655: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 13:35:01.678881: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:35:01.681052: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:35:01.686430: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 13:35:01.689837: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 13:35:01.696332: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 13:35:01.701294: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 13:35:01.704676: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:35:01.706834: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 13:35:01.709011: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 13:35:01.721256: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x25d3778fce0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 13:35:01.724782: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 13:35:01.727054: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 13:35:01.731479: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 13:35:01.734008: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:35:01.736194: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:35:01.738471: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 13:35:01.740743: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 13:35:01.743121: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 13:35:01.745415: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 13:35:01.747784: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:35:01.750001: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 13:35:02.182057: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 13:35:02.184533: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 13:35:02.186008: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 13:35:02.187811: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 13:35:02.194626: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x25d67458e60 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 13:35:02.197612: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 13:35:03.905118: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 13:35:04.418645: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:35:05.089027: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:35:05.095414: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:35:06.467126: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 13:35:06.516876: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 13:35:06.829533: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 4s 32ms/step
[INFOR]: Index of most vote   :409
[INFOR]: Class of most vote   :analog clock
[INFOR]: Number of most vote  :199.0


[INFOR]: Index of second most vote     :425
[INFOR]: Class of second most vote     :barn
[INFOR]: Number of second most vote    :39.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 1s 27ms/step
[INFOR]: Toltal norm before transform: 0.5288
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0256

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 1s 27ms/step
[INFOR]: SEN training of class 22_500 before transform: 199
[INFOR]: SPE training of class 22_500 before transform: 498

[INFOR]: SEN training of class 22_500 after transform: 467
[INFOR]: SPE training of class 22_500 after transform: 379
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 28ms/step
[INFOR]: Index of most vote   :409
[INFOR]: Class of most vote   :analog clock
[INFOR]: Number of most vote  :34.0


[INFOR]: Index of second most vote     :634
[INFOR]: Class of second most vote     :lumbermill, sawmill
[INFOR]: Number of second most vote    :8.0
[INFOR]: SEN testing of class 22_100 before transform: 34
[INFOR]: SPE testing of class 22_100 before transform: 99

[INFOR]: SEN testing of class 22_100 after transform: 96
[INFOR]: SPE testing of class 22_100 after transform: 43
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name ResNet50  --model_shape 224 224 --dataset_name cifar_100 --class_name_train 23_500 --class_name_test 23_100
2021-09-08 13:35:14.230694: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  ResNet50
dataset_name =  cifar_100
class_name_train =  23_500
class_name_test =  23_100
data_shape =  (32, 32, 3)
model_shape =  [224, 224]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 13:35:16.914203: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 13:35:16.938344: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 13:35:16.943791: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 13:35:16.951760: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:35:16.953995: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:35:16.959221: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 13:35:16.962665: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 13:35:16.969369: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 13:35:16.975782: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 13:35:16.979064: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:35:16.981271: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 13:35:16.983322: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 13:35:16.995587: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x28734dec1b0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 13:35:16.998803: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 13:35:17.001034: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 13:35:17.005539: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 13:35:17.007943: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:35:17.010217: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:35:17.012509: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 13:35:17.014788: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 13:35:17.017106: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 13:35:17.019448: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 13:35:17.021832: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:35:17.024089: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 13:35:17.449688: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 13:35:17.452788: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 13:35:17.454447: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 13:35:17.456047: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 13:35:17.462729: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x287648ffb50 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 13:35:17.465650: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 13:35:19.104236: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 13:35:19.609064: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:35:20.310146: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:35:20.316661: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:35:21.699919: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 13:35:21.748885: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 13:35:22.070085: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 4s 31ms/step
[INFOR]: Index of most vote   :103
[INFOR]: Class of most vote   :platypus, duckbill, duckbilled platypus, duck-billed platypus, Ornithorhynchus anatinus
[INFOR]: Number of most vote  :27.0


[INFOR]: Index of second most vote     :968
[INFOR]: Class of second most vote     :cup
[INFOR]: Number of second most vote    :25.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 1s 26ms/step
[INFOR]: Toltal norm before transform: 0.9405
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.5146

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 1s 25ms/step
[INFOR]: SEN training of class 23_500 before transform: 27
[INFOR]: SPE training of class 23_500 before transform: 484

[INFOR]: SEN training of class 23_500 after transform: 448
[INFOR]: SPE training of class 23_500 after transform: 372
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 26ms/step
[INFOR]: Index of most vote   :969
[INFOR]: Class of most vote   :eggnog
[INFOR]: Number of most vote  :8.0


[INFOR]: Index of second most vote     :812
[INFOR]: Class of second most vote     :space shuttle
[INFOR]: Number of second most vote    :5.0
[INFOR]: SEN testing of class 23_100 before transform: 8
[INFOR]: SPE testing of class 23_100 before transform: 100

[INFOR]: SEN testing of class 23_100 after transform: 97
[INFOR]: SPE testing of class 23_100 after transform: 37
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name ResNet50  --model_shape 224 224 --dataset_name cifar_100 --class_name_train 24_500 --class_name_test 24_100
2021-09-08 13:35:29.241036: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  ResNet50
dataset_name =  cifar_100
class_name_train =  24_500
class_name_test =  24_100
data_shape =  (32, 32, 3)
model_shape =  [224, 224]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 13:35:31.893649: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 13:35:31.919432: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 13:35:31.924829: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 13:35:31.932949: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:35:31.935245: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:35:31.940618: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 13:35:31.944165: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 13:35:31.950826: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 13:35:31.955838: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 13:35:31.958853: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:35:31.961317: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 13:35:31.963259: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 13:35:31.976036: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1b63818e8e0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 13:35:31.979304: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 13:35:31.981477: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 13:35:31.986244: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 13:35:31.988464: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:35:31.990706: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:35:31.993044: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 13:35:31.995384: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 13:35:31.997624: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 13:35:31.999959: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 13:35:32.002276: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:35:32.004665: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 13:35:32.436664: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 13:35:32.439306: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 13:35:32.440855: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 13:35:32.442381: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 13:35:32.449119: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1b6631fb7f0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 13:35:32.451970: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 13:35:34.107424: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 13:35:34.614487: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:35:35.284602: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:35:35.290811: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:35:36.667609: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 13:35:36.717986: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 13:35:37.029332: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 4s 32ms/step
[INFOR]: Index of most vote   :310
[INFOR]: Class of most vote   :ant, emmet, pismire
[INFOR]: Number of most vote  :123.0


[INFOR]: Index of second most vote     :126
[INFOR]: Class of second most vote     :isopod
[INFOR]: Number of second most vote    :47.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 1s 26ms/step
[INFOR]: Toltal norm before transform: 0.7504
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1376

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 1s 26ms/step
[INFOR]: SEN training of class 24_500 before transform: 123
[INFOR]: SPE training of class 24_500 before transform: 494

[INFOR]: SEN training of class 24_500 after transform: 433
[INFOR]: SPE training of class 24_500 after transform: 366
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 26ms/step
[INFOR]: Index of most vote   :310
[INFOR]: Class of most vote   :ant, emmet, pismire
[INFOR]: Number of most vote  :18.0


[INFOR]: Index of second most vote     :126
[INFOR]: Class of second most vote     :isopod
[INFOR]: Number of second most vote    :10.0
[INFOR]: SEN testing of class 24_100 before transform: 18
[INFOR]: SPE testing of class 24_100 before transform: 100

[INFOR]: SEN testing of class 24_100 after transform: 77
[INFOR]: SPE testing of class 24_100 after transform: 34
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name ResNet50  --model_shape 224 224 --dataset_name cifar_100 --class_name_train 25_500 --class_name_test 25_100
2021-09-08 13:35:44.358789: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  ResNet50
dataset_name =  cifar_100
class_name_train =  25_500
class_name_test =  25_100
data_shape =  (32, 32, 3)
model_shape =  [224, 224]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 13:35:47.056586: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 13:35:47.081362: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 13:35:47.086743: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 13:35:47.095042: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:35:47.097279: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:35:47.102505: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 13:35:47.106518: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 13:35:47.113513: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 13:35:47.118999: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 13:35:47.122429: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:35:47.125086: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 13:35:47.127367: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 13:35:47.140175: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x2da331679d0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 13:35:47.143181: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 13:35:47.145380: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 13:35:47.149779: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 13:35:47.152030: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:35:47.154330: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:35:47.156649: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 13:35:47.158925: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 13:35:47.161150: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 13:35:47.163527: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 13:35:47.165972: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:35:47.168214: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 13:35:47.597235: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 13:35:47.600095: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 13:35:47.601566: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 13:35:47.603126: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 13:35:47.610107: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x2da5f321750 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 13:35:47.612984: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 13:35:49.284178: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 13:35:49.808677: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:35:50.485586: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:35:50.491897: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:35:51.853276: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 13:35:51.903762: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 13:35:52.216633: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 4s 31ms/step
[INFOR]: Index of most vote   :831
[INFOR]: Class of most vote   :studio couch, day bed
[INFOR]: Number of most vote  :119.0


[INFOR]: Index of second most vote     :653
[INFOR]: Class of second most vote     :milk can
[INFOR]: Number of second most vote    :20.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 1s 26ms/step
[INFOR]: Toltal norm before transform: 0.7650
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0259

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 1s 26ms/step
[INFOR]: SEN training of class 25_500 before transform: 119
[INFOR]: SPE training of class 25_500 before transform: 500

[INFOR]: SEN training of class 25_500 after transform: 352
[INFOR]: SPE training of class 25_500 after transform: 315
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 26ms/step
[INFOR]: Index of most vote   :831
[INFOR]: Class of most vote   :studio couch, day bed
[INFOR]: Number of most vote  :23.0


[INFOR]: Index of second most vote     :729
[INFOR]: Class of second most vote     :plate rack
[INFOR]: Number of second most vote    :6.0
[INFOR]: SEN testing of class 25_100 before transform: 23
[INFOR]: SPE testing of class 25_100 before transform: 100

[INFOR]: SEN testing of class 25_100 after transform: 74
[INFOR]: SPE testing of class 25_100 after transform: 2
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name ResNet50  --model_shape 224 224 --dataset_name cifar_100 --class_name_train 26_500 --class_name_test 26_100
2021-09-08 13:35:59.458354: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  ResNet50
dataset_name =  cifar_100
class_name_train =  26_500
class_name_test =  26_100
data_shape =  (32, 32, 3)
model_shape =  [224, 224]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 13:36:02.143319: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 13:36:02.171164: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 13:36:02.176851: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 13:36:02.185029: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:36:02.187543: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:36:02.193141: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 13:36:02.197062: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 13:36:02.203427: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 13:36:02.208523: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 13:36:02.211538: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:36:02.213707: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 13:36:02.215868: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 13:36:02.228916: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x21ab3972640 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 13:36:02.232239: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 13:36:02.234413: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 13:36:02.239046: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 13:36:02.241207: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:36:02.243386: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:36:02.245787: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 13:36:02.248012: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 13:36:02.250522: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 13:36:02.253029: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 13:36:02.256303: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:36:02.258611: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 13:36:02.703078: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 13:36:02.706085: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 13:36:02.707645: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 13:36:02.709196: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 13:36:02.716026: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x21ae211f5f0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 13:36:02.718908: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 13:36:04.373324: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 13:36:04.877432: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:36:05.557381: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:36:05.563768: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:36:06.936364: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 13:36:06.986367: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 13:36:07.304462: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 4s 31ms/step
[INFOR]: Index of most vote   :680
[INFOR]: Class of most vote   :nipple
[INFOR]: Number of most vote  :33.0


[INFOR]: Index of second most vote     :73
[INFOR]: Class of second most vote     :barn spider, Araneus cavaticus
[INFOR]: Number of second most vote    :32.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 1s 26ms/step
[INFOR]: Toltal norm before transform: 0.9326
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.3099

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 1s 26ms/step
[INFOR]: SEN training of class 26_500 before transform: 33
[INFOR]: SPE training of class 26_500 before transform: 488

[INFOR]: SEN training of class 26_500 after transform: 385
[INFOR]: SPE training of class 26_500 after transform: 345
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 26ms/step
[INFOR]: Index of most vote   :714
[INFOR]: Class of most vote   :pick, plectrum, plectron
[INFOR]: Number of most vote  :9.0


[INFOR]: Index of second most vote     :794
[INFOR]: Class of second most vote     :shower curtain
[INFOR]: Number of second most vote    :7.0
[INFOR]: SEN testing of class 26_100 before transform: 9
[INFOR]: SPE testing of class 26_100 before transform: 99

[INFOR]: SEN testing of class 26_100 after transform: 99
[INFOR]: SPE testing of class 26_100 after transform: 3
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name ResNet50  --model_shape 224 224 --dataset_name cifar_100 --class_name_train 27_500 --class_name_test 27_100
2021-09-08 13:36:14.515951: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  ResNet50
dataset_name =  cifar_100
class_name_train =  27_500
class_name_test =  27_100
data_shape =  (32, 32, 3)
model_shape =  [224, 224]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 13:36:17.186535: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 13:36:17.210598: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 13:36:17.215137: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 13:36:17.223436: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:36:17.225695: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:36:17.230888: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 13:36:17.234283: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 13:36:17.240683: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 13:36:17.245802: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 13:36:17.248916: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:36:17.251078: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 13:36:17.253000: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 13:36:17.264970: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x18236af8e50 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 13:36:17.268520: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 13:36:17.270747: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 13:36:17.275156: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 13:36:17.277417: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:36:17.279612: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:36:17.282027: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 13:36:17.284227: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 13:36:17.286594: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 13:36:17.288811: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 13:36:17.291099: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:36:17.293425: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 13:36:17.725338: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 13:36:17.727797: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 13:36:17.729250: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 13:36:17.730794: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 13:36:17.737851: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x18260bbc1b0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 13:36:17.740703: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 13:36:19.386367: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 13:36:19.891186: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:36:20.547664: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:36:20.553921: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:36:21.926613: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 13:36:21.977545: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 13:36:22.295495: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 4s 31ms/step
[INFOR]: Index of most vote   :103
[INFOR]: Class of most vote   :platypus, duckbill, duckbilled platypus, duck-billed platypus, Ornithorhynchus anatinus
[INFOR]: Number of most vote  :100.0


[INFOR]: Index of second most vote     :148
[INFOR]: Class of second most vote     :killer whale, killer, orca, grampus, sea wolf, Orcinus orca
[INFOR]: Number of second most vote    :49.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 1s 26ms/step
[INFOR]: Toltal norm before transform: 0.7717
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.3209

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 1s 29ms/step
[INFOR]: SEN training of class 27_500 before transform: 100
[INFOR]: SPE training of class 27_500 before transform: 491

[INFOR]: SEN training of class 27_500 after transform: 339
[INFOR]: SPE training of class 27_500 after transform: 296
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 28ms/step
[INFOR]: Index of most vote   :103
[INFOR]: Class of most vote   :platypus, duckbill, duckbilled platypus, duck-billed platypus, Ornithorhynchus anatinus
[INFOR]: Number of most vote  :20.0


[INFOR]: Index of second most vote     :146
[INFOR]: Class of second most vote     :albatross, mollymawk
[INFOR]: Number of second most vote    :7.0
[INFOR]: SEN testing of class 27_100 before transform: 20
[INFOR]: SPE testing of class 27_100 before transform: 98

[INFOR]: SEN testing of class 27_100 after transform: 62
[INFOR]: SPE testing of class 27_100 after transform: 40
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name ResNet50  --model_shape 224 224 --dataset_name cifar_100 --class_name_train 28_500 --class_name_test 28_100
2021-09-08 13:36:29.755097: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  ResNet50
dataset_name =  cifar_100
class_name_train =  28_500
class_name_test =  28_100
data_shape =  (32, 32, 3)
model_shape =  [224, 224]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 13:36:32.549662: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 13:36:32.574393: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 13:36:32.579465: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 13:36:32.587603: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:36:32.589931: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:36:32.595284: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 13:36:32.598774: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 13:36:32.604891: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 13:36:32.610073: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 13:36:32.613159: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:36:32.615497: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 13:36:32.617419: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 13:36:32.630259: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1f8baa6b410 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 13:36:32.633551: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 13:36:32.635724: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 13:36:32.640157: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 13:36:32.642389: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:36:32.644715: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:36:32.647037: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 13:36:32.650218: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 13:36:32.652589: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 13:36:32.654814: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 13:36:32.657306: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:36:32.659875: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 13:36:33.120927: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 13:36:33.124087: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 13:36:33.127730: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 13:36:33.129731: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 13:36:33.136686: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1f8e5243890 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 13:36:33.139940: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 13:36:34.830266: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 13:36:35.337433: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:36:36.005908: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:36:36.012483: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:36:37.393119: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 13:36:37.441095: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 13:36:37.755048: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 4s 32ms/step
[INFOR]: Index of most vote   :901
[INFOR]: Class of most vote   :whiskey jug
[INFOR]: Number of most vote  :75.0


[INFOR]: Index of second most vote     :604
[INFOR]: Class of second most vote     :hourglass
[INFOR]: Number of second most vote    :65.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 1s 27ms/step
[INFOR]: Toltal norm before transform: 0.8597
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0053

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 1s 28ms/step
[INFOR]: SEN training of class 28_500 before transform: 75
[INFOR]: SPE training of class 28_500 before transform: 494

[INFOR]: SEN training of class 28_500 after transform: 484
[INFOR]: SPE training of class 28_500 after transform: 373
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 28ms/step
[INFOR]: Index of most vote   :901
[INFOR]: Class of most vote   :whiskey jug
[INFOR]: Number of most vote  :12.0


[INFOR]: Index of second most vote     :604
[INFOR]: Class of second most vote     :hourglass
[INFOR]: Number of second most vote    :11.0
[INFOR]: SEN testing of class 28_100 before transform: 12
[INFOR]: SPE testing of class 28_100 before transform: 99

[INFOR]: SEN testing of class 28_100 after transform: 40
[INFOR]: SPE testing of class 28_100 after transform: 7
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name ResNet50  --model_shape 224 224 --dataset_name cifar_100 --class_name_train 29_500 --class_name_test 29_100
2021-09-08 13:36:45.216862: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  ResNet50
dataset_name =  cifar_100
class_name_train =  29_500
class_name_test =  29_100
data_shape =  (32, 32, 3)
model_shape =  [224, 224]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 13:36:47.951116: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 13:36:47.975416: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 13:36:47.980759: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 13:36:47.988903: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:36:47.991165: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:36:47.996588: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 13:36:48.000423: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 13:36:48.006883: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 13:36:48.012357: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 13:36:48.015411: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:36:48.017675: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 13:36:48.019686: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 13:36:48.031788: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x20eb9dfd160 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 13:36:48.034959: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 13:36:48.037277: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 13:36:48.042434: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 13:36:48.044729: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:36:48.046976: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:36:48.049361: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 13:36:48.051587: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 13:36:48.053991: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 13:36:48.057698: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 13:36:48.060171: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:36:48.062617: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 13:36:48.506501: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 13:36:48.509034: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 13:36:48.510518: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 13:36:48.512172: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 13:36:48.518840: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x20eda9269e0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 13:36:48.521732: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 13:36:50.212954: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 13:36:50.734932: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:36:51.416642: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:36:51.423408: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:36:52.796196: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 13:36:52.846216: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 13:36:53.180685: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 4s 33ms/step
[INFOR]: Index of most vote   :51
[INFOR]: Class of most vote   :triceratops
[INFOR]: Number of most vote  :186.0


[INFOR]: Index of second most vote     :794
[INFOR]: Class of second most vote     :shower curtain
[INFOR]: Number of second most vote    :21.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 1s 26ms/step
[INFOR]: Toltal norm before transform: 0.5596
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0461

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 1s 26ms/step
[INFOR]: SEN training of class 29_500 before transform: 186
[INFOR]: SPE training of class 29_500 before transform: 497

[INFOR]: SEN training of class 29_500 after transform: 415
[INFOR]: SPE training of class 29_500 after transform: 355
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 26ms/step
[INFOR]: Index of most vote   :51
[INFOR]: Class of most vote   :triceratops
[INFOR]: Number of most vote  :31.0


[INFOR]: Index of second most vote     :472
[INFOR]: Class of second most vote     :canoe
[INFOR]: Number of second most vote    :5.0
[INFOR]: SEN testing of class 29_100 before transform: 31
[INFOR]: SPE testing of class 29_100 before transform: 100

[INFOR]: SEN testing of class 29_100 after transform: 94
[INFOR]: SPE testing of class 29_100 after transform: 17
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name ResNet50  --model_shape 224 224 --dataset_name cifar_100 --class_name_train 30_500 --class_name_test 30_100
2021-09-08 13:37:00.525232: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  ResNet50
dataset_name =  cifar_100
class_name_train =  30_500
class_name_test =  30_100
data_shape =  (32, 32, 3)
model_shape =  [224, 224]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 13:37:03.197722: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 13:37:03.221089: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 13:37:03.225935: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 13:37:03.234064: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:37:03.236256: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:37:03.241855: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 13:37:03.245338: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 13:37:03.251717: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 13:37:03.256733: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 13:37:03.260019: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:37:03.262293: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 13:37:03.264276: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 13:37:03.276249: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x26c3a5ca300 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 13:37:03.279888: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 13:37:03.282078: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 13:37:03.286561: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 13:37:03.288814: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:37:03.291027: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:37:03.293302: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 13:37:03.295582: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 13:37:03.297816: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 13:37:03.300363: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 13:37:03.302769: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:37:03.304987: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 13:37:03.770473: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 13:37:03.773078: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 13:37:03.774646: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 13:37:03.776328: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 13:37:03.783397: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x26c693a5bf0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 13:37:03.786374: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 13:37:05.437102: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 13:37:05.942984: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:37:06.619585: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:37:06.625862: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:37:08.041980: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 13:37:08.089873: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 13:37:08.412713: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 4s 32ms/step
[INFOR]: Index of most vote   :103
[INFOR]: Class of most vote   :platypus, duckbill, duckbilled platypus, duck-billed platypus, Ornithorhynchus anatinus
[INFOR]: Number of most vote  :96.0


[INFOR]: Index of second most vote     :98
[INFOR]: Class of second most vote     :red-breasted merganser, Mergus serrator
[INFOR]: Number of second most vote    :50.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 1s 26ms/step
[INFOR]: Toltal norm before transform: 0.7892
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0138

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 1s 27ms/step
[INFOR]: SEN training of class 30_500 before transform: 96
[INFOR]: SPE training of class 30_500 before transform: 493

[INFOR]: SEN training of class 30_500 after transform: 451
[INFOR]: SPE training of class 30_500 after transform: 366
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 27ms/step
[INFOR]: Index of most vote   :103
[INFOR]: Class of most vote   :platypus, duckbill, duckbilled platypus, duck-billed platypus, Ornithorhynchus anatinus
[INFOR]: Number of most vote  :16.0


[INFOR]: Index of second most vote     :725
[INFOR]: Class of second most vote     :pitcher, ewer
[INFOR]: Number of second most vote    :5.0
[INFOR]: SEN testing of class 30_100 before transform: 16
[INFOR]: SPE testing of class 30_100 before transform: 97

[INFOR]: SEN testing of class 30_100 after transform: 100
[INFOR]: SPE testing of class 30_100 after transform: 0
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name ResNet50  --model_shape 224 224 --dataset_name cifar_100 --class_name_train 31_500 --class_name_test 31_100
2021-09-08 13:37:15.843786: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  ResNet50
dataset_name =  cifar_100
class_name_train =  31_500
class_name_test =  31_100
data_shape =  (32, 32, 3)
model_shape =  [224, 224]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 13:37:18.563039: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 13:37:18.587019: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 13:37:18.592255: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 13:37:18.600661: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:37:18.603119: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:37:18.608313: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 13:37:18.611945: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 13:37:18.618573: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 13:37:18.623954: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 13:37:18.626891: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:37:18.629148: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 13:37:18.631372: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 13:37:18.643585: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x148b7bbb6a0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 13:37:18.646809: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 13:37:18.648974: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 13:37:18.653894: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 13:37:18.656156: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:37:18.658357: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:37:18.660721: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 13:37:18.662911: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 13:37:18.665121: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 13:37:18.667418: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 13:37:18.669792: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:37:18.672054: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 13:37:19.173559: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 13:37:19.175889: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 13:37:19.177424: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 13:37:19.179065: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 13:37:19.185757: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x148e76749f0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 13:37:19.188651: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 13:37:20.867953: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 13:37:21.385694: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:37:22.133863: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:37:22.140292: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:37:23.508543: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 13:37:23.558116: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 13:37:23.873177: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 4s 32ms/step
[INFOR]: Index of most vote   :385
[INFOR]: Class of most vote   :Indian elephant, Elephas maximus
[INFOR]: Number of most vote  :202.0


[INFOR]: Index of second most vote     :101
[INFOR]: Class of second most vote     :tusker
[INFOR]: Number of second most vote    :55.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 1s 27ms/step
[INFOR]: Toltal norm before transform: 0.5411
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.2164

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 1s 27ms/step
[INFOR]: SEN training of class 31_500 before transform: 202
[INFOR]: SPE training of class 31_500 before transform: 500

[INFOR]: SEN training of class 31_500 after transform: 385
[INFOR]: SPE training of class 31_500 after transform: 368
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 26ms/step
[INFOR]: Index of most vote   :385
[INFOR]: Class of most vote   :Indian elephant, Elephas maximus
[INFOR]: Number of most vote  :32.0


[INFOR]: Index of second most vote     :101
[INFOR]: Class of second most vote     :tusker
[INFOR]: Number of second most vote    :10.0
[INFOR]: SEN testing of class 31_100 before transform: 32
[INFOR]: SPE testing of class 31_100 before transform: 100

[INFOR]: SEN testing of class 31_100 after transform: 78
[INFOR]: SPE testing of class 31_100 after transform: 42
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name ResNet50  --model_shape 224 224 --dataset_name cifar_100 --class_name_train 32_500 --class_name_test 32_100
2021-09-08 13:37:31.338195: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  ResNet50
dataset_name =  cifar_100
class_name_train =  32_500
class_name_test =  32_100
data_shape =  (32, 32, 3)
model_shape =  [224, 224]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 13:37:34.043062: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 13:37:34.067805: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 13:37:34.072785: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 13:37:34.081434: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:37:34.083634: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:37:34.088995: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 13:37:34.092896: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 13:37:34.099192: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 13:37:34.104234: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 13:37:34.107166: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:37:34.109353: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 13:37:34.111454: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 13:37:34.124457: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x18db36a90a0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 13:37:34.127436: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 13:37:34.129645: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 13:37:34.134025: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 13:37:34.136181: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:37:34.138328: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:37:34.140739: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 13:37:34.143024: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 13:37:34.145180: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 13:37:34.147367: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 13:37:34.149644: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:37:34.152094: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 13:37:34.584639: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 13:37:34.587404: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 13:37:34.588933: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 13:37:34.590649: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 13:37:34.597359: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x18de3a094e0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 13:37:34.600315: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 13:37:36.248314: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 13:37:36.760895: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:37:37.441104: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:37:37.447081: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:37:38.826960: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 13:37:38.876772: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 13:37:39.199844: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 4s 31ms/step
[INFOR]: Index of most vote   :906
[INFOR]: Class of most vote   :Windsor tie
[INFOR]: Number of most vote  :38.0


[INFOR]: Index of second most vote     :450
[INFOR]: Class of second most vote     :bobsled, bobsleigh, bob
[INFOR]: Number of second most vote    :32.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 1s 26ms/step
[INFOR]: Toltal norm before transform: 0.9092
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1485

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 1s 26ms/step
[INFOR]: SEN training of class 32_500 before transform: 38
[INFOR]: SPE training of class 32_500 before transform: 492

[INFOR]: SEN training of class 32_500 after transform: 332
[INFOR]: SPE training of class 32_500 after transform: 299
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 26ms/step
[INFOR]: Index of most vote   :51
[INFOR]: Class of most vote   :triceratops
[INFOR]: Number of most vote  :6.0


[INFOR]: Index of second most vote     :905
[INFOR]: Class of second most vote     :window shade
[INFOR]: Number of second most vote    :6.0
[INFOR]: SEN testing of class 32_100 before transform: 6
[INFOR]: SPE testing of class 32_100 before transform: 99

[INFOR]: SEN testing of class 32_100 after transform: 86
[INFOR]: SPE testing of class 32_100 after transform: 19
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name ResNet50  --model_shape 224 224 --dataset_name cifar_100 --class_name_train 33_500 --class_name_test 33_100
2021-09-08 13:37:46.439405: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  ResNet50
dataset_name =  cifar_100
class_name_train =  33_500
class_name_test =  33_100
data_shape =  (32, 32, 3)
model_shape =  [224, 224]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 13:37:49.157983: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 13:37:49.184549: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 13:37:49.189295: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 13:37:49.197586: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:37:49.199892: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:37:49.205405: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 13:37:49.209311: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 13:37:49.215837: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 13:37:49.221069: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 13:37:49.224169: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:37:49.226375: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 13:37:49.228335: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 13:37:49.240232: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x22a3667f310 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 13:37:49.243217: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 13:37:49.245342: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 13:37:49.249781: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 13:37:49.252050: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:37:49.254396: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:37:49.256678: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 13:37:49.258913: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 13:37:49.261363: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 13:37:49.263654: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 13:37:49.266000: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:37:49.268229: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 13:37:49.689526: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 13:37:49.692190: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 13:37:49.693642: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 13:37:49.695191: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 13:37:49.702277: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x22a6039a960 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 13:37:49.705151: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 13:37:51.361819: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 13:37:51.871167: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:37:52.547979: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:37:52.554167: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:37:53.943506: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 13:37:53.994896: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 13:37:54.311796: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 4s 32ms/step
[INFOR]: Index of most vote   :149
[INFOR]: Class of most vote   :dugong, Dugong dugon
[INFOR]: Number of most vote  :39.0


[INFOR]: Index of second most vote     :391
[INFOR]: Class of second most vote     :coho, cohoe, coho salmon, blue jack, silver salmon, Oncorhynchus kisutch
[INFOR]: Number of second most vote    :36.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 1s 26ms/step
[INFOR]: Toltal norm before transform: 0.8908
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1013

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 1s 26ms/step
[INFOR]: SEN training of class 33_500 before transform: 39
[INFOR]: SPE training of class 33_500 before transform: 490

[INFOR]: SEN training of class 33_500 after transform: 438
[INFOR]: SPE training of class 33_500 after transform: 387
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 26ms/step
[INFOR]: Index of most vote   :149
[INFOR]: Class of most vote   :dugong, Dugong dugon
[INFOR]: Number of most vote  :13.0


[INFOR]: Index of second most vote     :334
[INFOR]: Class of second most vote     :porcupine, hedgehog
[INFOR]: Number of second most vote    :7.0
[INFOR]: SEN testing of class 33_100 before transform: 13
[INFOR]: SPE testing of class 33_100 before transform: 100

[INFOR]: SEN testing of class 33_100 after transform: 92
[INFOR]: SPE testing of class 33_100 after transform: 65
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name ResNet50  --model_shape 224 224 --dataset_name cifar_100 --class_name_train 34_500 --class_name_test 34_100
2021-09-08 13:38:01.622185: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  ResNet50
dataset_name =  cifar_100
class_name_train =  34_500
class_name_test =  34_100
data_shape =  (32, 32, 3)
model_shape =  [224, 224]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 13:38:04.322686: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 13:38:04.347820: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 13:38:04.352785: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 13:38:04.360906: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:38:04.363200: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:38:04.368400: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 13:38:04.372103: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 13:38:04.378347: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 13:38:04.383273: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 13:38:04.386237: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:38:04.388562: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 13:38:04.390531: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 13:38:04.402543: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x27033ee7630 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 13:38:04.405604: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 13:38:04.407683: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 13:38:04.412305: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 13:38:04.414512: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:38:04.416694: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:38:04.419011: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 13:38:04.421505: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 13:38:04.423876: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 13:38:04.426175: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 13:38:04.428525: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:38:04.430842: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 13:38:04.862573: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 13:38:04.865393: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 13:38:04.866880: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 13:38:04.868462: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 13:38:04.875322: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x2705f79c610 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 13:38:04.878225: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 13:38:06.537089: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 13:38:07.044181: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:38:07.705979: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:38:07.712241: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:38:09.081753: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 13:38:09.131782: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 13:38:09.444952: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 4s 31ms/step
[INFOR]: Index of most vote   :280
[INFOR]: Class of most vote   :grey fox, gray fox, Urocyon cinereoargenteus
[INFOR]: Number of most vote  :72.0


[INFOR]: Index of second most vote     :334
[INFOR]: Class of second most vote     :porcupine, hedgehog
[INFOR]: Number of second most vote    :48.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 1s 26ms/step
[INFOR]: Toltal norm before transform: 0.8602
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.3477

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 1s 26ms/step
[INFOR]: SEN training of class 34_500 before transform: 72
[INFOR]: SPE training of class 34_500 before transform: 499

[INFOR]: SEN training of class 34_500 after transform: 382
[INFOR]: SPE training of class 34_500 after transform: 349
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 26ms/step
[INFOR]: Index of most vote   :280
[INFOR]: Class of most vote   :grey fox, gray fox, Urocyon cinereoargenteus
[INFOR]: Number of most vote  :19.0


[INFOR]: Index of second most vote     :279
[INFOR]: Class of second most vote     :Arctic fox, white fox, Alopex lagopus
[INFOR]: Number of second most vote    :6.0
[INFOR]: SEN testing of class 34_100 before transform: 19
[INFOR]: SPE testing of class 34_100 before transform: 100

[INFOR]: SEN testing of class 34_100 after transform: 87
[INFOR]: SPE testing of class 34_100 after transform: 2
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name ResNet50  --model_shape 224 224 --dataset_name cifar_100 --class_name_train 35_500 --class_name_test 35_100
2021-09-08 13:38:16.690959: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  ResNet50
dataset_name =  cifar_100
class_name_train =  35_500
class_name_test =  35_100
data_shape =  (32, 32, 3)
model_shape =  [224, 224]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 13:38:19.359784: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 13:38:19.385822: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 13:38:19.390378: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 13:38:19.398352: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:38:19.400521: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:38:19.407019: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 13:38:19.410909: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 13:38:19.417325: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 13:38:19.422406: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 13:38:19.425388: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:38:19.427574: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 13:38:19.429546: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 13:38:19.442349: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1d73319b960 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 13:38:19.445664: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 13:38:19.447781: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 13:38:19.452153: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 13:38:19.454332: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:38:19.456630: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:38:19.458908: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 13:38:19.461070: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 13:38:19.463358: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 13:38:19.465715: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 13:38:19.468055: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:38:19.470474: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 13:38:19.920958: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 13:38:19.923682: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 13:38:19.925145: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 13:38:19.926695: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 13:38:19.933738: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1d75c6c6890 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 13:38:19.936581: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 13:38:21.588542: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 13:38:22.090830: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:38:22.750403: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:38:22.756484: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:38:24.136443: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 13:38:24.185769: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 13:38:24.503732: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 4s 32ms/step
[INFOR]: Index of most vote   :906
[INFOR]: Class of most vote   :Windsor tie
[INFOR]: Number of most vote  :37.0


[INFOR]: Index of second most vote     :795
[INFOR]: Class of second most vote     :ski
[INFOR]: Number of second most vote    :33.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 1s 26ms/step
[INFOR]: Toltal norm before transform: 0.9100
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.5235

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 1s 26ms/step
[INFOR]: SEN training of class 35_500 before transform: 37
[INFOR]: SPE training of class 35_500 before transform: 489

[INFOR]: SEN training of class 35_500 after transform: 360
[INFOR]: SPE training of class 35_500 after transform: 309
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 26ms/step
[INFOR]: Index of most vote   :795
[INFOR]: Class of most vote   :ski
[INFOR]: Number of most vote  :11.0


[INFOR]: Index of second most vote     :450
[INFOR]: Class of second most vote     :bobsled, bobsleigh, bob
[INFOR]: Number of second most vote    :8.0
[INFOR]: SEN testing of class 35_100 before transform: 11
[INFOR]: SPE testing of class 35_100 before transform: 98

[INFOR]: SEN testing of class 35_100 after transform: 77
[INFOR]: SPE testing of class 35_100 after transform: 14
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name ResNet50  --model_shape 224 224 --dataset_name cifar_100 --class_name_train 36_500 --class_name_test 36_100
2021-09-08 13:38:31.782895: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  ResNet50
dataset_name =  cifar_100
class_name_train =  36_500
class_name_test =  36_100
data_shape =  (32, 32, 3)
model_shape =  [224, 224]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 13:38:34.502288: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 13:38:34.525853: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 13:38:34.530371: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 13:38:34.538504: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:38:34.540714: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:38:34.546290: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 13:38:34.549743: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 13:38:34.556279: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 13:38:34.561308: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 13:38:34.564422: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:38:34.566666: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 13:38:34.568591: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 13:38:34.581276: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x15a354fee20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 13:38:34.584771: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 13:38:34.586893: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 13:38:34.592819: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 13:38:34.595154: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:38:34.597708: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:38:34.600112: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 13:38:34.602462: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 13:38:34.604712: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 13:38:34.607071: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 13:38:34.609375: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:38:34.611963: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 13:38:35.062538: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 13:38:35.064832: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 13:38:35.066436: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 13:38:35.068036: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 13:38:35.075191: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x15a5ff04ef0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 13:38:35.078385: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 13:38:36.752267: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 13:38:37.270657: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:38:37.949424: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:38:37.955344: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:38:39.329305: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 13:38:39.379490: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 13:38:39.699187: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 4s 32ms/step
[INFOR]: Index of most vote   :680
[INFOR]: Class of most vote   :nipple
[INFOR]: Number of most vote  :75.0


[INFOR]: Index of second most vote     :683
[INFOR]: Class of second most vote     :oboe, hautboy, hautbois
[INFOR]: Number of second most vote    :48.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 1s 26ms/step
[INFOR]: Toltal norm before transform: 0.8210
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1368

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 1s 26ms/step
[INFOR]: SEN training of class 36_500 before transform: 75
[INFOR]: SPE training of class 36_500 before transform: 485

[INFOR]: SEN training of class 36_500 after transform: 413
[INFOR]: SPE training of class 36_500 after transform: 330
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 27ms/step
[INFOR]: Index of most vote   :680
[INFOR]: Class of most vote   :nipple
[INFOR]: Number of most vote  :20.0


[INFOR]: Index of second most vote     :683
[INFOR]: Class of second most vote     :oboe, hautboy, hautbois
[INFOR]: Number of second most vote    :9.0
[INFOR]: SEN testing of class 36_100 before transform: 20
[INFOR]: SPE testing of class 36_100 before transform: 97

[INFOR]: SEN testing of class 36_100 after transform: 80
[INFOR]: SPE testing of class 36_100 after transform: 24
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name ResNet50  --model_shape 224 224 --dataset_name cifar_100 --class_name_train 37_500 --class_name_test 37_100
2021-09-08 13:38:47.040028: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  ResNet50
dataset_name =  cifar_100
class_name_train =  37_500
class_name_test =  37_100
data_shape =  (32, 32, 3)
model_shape =  [224, 224]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 13:38:49.729022: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 13:38:49.753089: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 13:38:49.757925: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 13:38:49.766035: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:38:49.768254: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:38:49.773511: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 13:38:49.776957: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 13:38:49.783422: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 13:38:49.788414: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 13:38:49.791342: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:38:49.793873: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 13:38:49.795809: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 13:38:49.807970: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x22135ea6700 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 13:38:49.811150: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 13:38:49.813541: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 13:38:49.817944: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 13:38:49.820251: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:38:49.822449: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:38:49.824677: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 13:38:49.827013: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 13:38:49.829188: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 13:38:49.831403: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 13:38:49.833864: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:38:49.836088: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 13:38:50.263973: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 13:38:50.266956: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 13:38:50.268446: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 13:38:50.270007: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 13:38:50.277011: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x2216020c1e0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 13:38:50.280008: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 13:38:51.933495: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 13:38:52.439399: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:38:53.098322: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:38:53.104330: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:38:54.473096: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 13:38:54.528796: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 13:38:54.860235: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 4s 31ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :116.0


[INFOR]: Index of second most vote     :794
[INFOR]: Class of second most vote     :shower curtain
[INFOR]: Number of second most vote    :51.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 1s 26ms/step
[INFOR]: Toltal norm before transform: 0.7163
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1553

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 1s 26ms/step
[INFOR]: SEN training of class 37_500 before transform: 116
[INFOR]: SPE training of class 37_500 before transform: 489

[INFOR]: SEN training of class 37_500 after transform: 368
[INFOR]: SPE training of class 37_500 after transform: 316
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 26ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :16.0


[INFOR]: Index of second most vote     :855
[INFOR]: Class of second most vote     :thimble
[INFOR]: Number of second most vote    :11.0
[INFOR]: SEN testing of class 37_100 before transform: 16
[INFOR]: SPE testing of class 37_100 before transform: 97

[INFOR]: SEN testing of class 37_100 after transform: 95
[INFOR]: SPE testing of class 37_100 after transform: 14
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name ResNet50  --model_shape 224 224 --dataset_name cifar_100 --class_name_train 38_500 --class_name_test 38_100
2021-09-08 13:39:02.117046: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  ResNet50
dataset_name =  cifar_100
class_name_train =  38_500
class_name_test =  38_100
data_shape =  (32, 32, 3)
model_shape =  [224, 224]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 13:39:04.800513: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 13:39:04.824953: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 13:39:04.829966: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 13:39:04.838347: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:39:04.840547: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:39:04.846030: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 13:39:04.849556: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 13:39:04.856018: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 13:39:04.861230: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 13:39:04.864553: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:39:04.866821: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 13:39:04.868774: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 13:39:04.881448: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x221b7906190 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 13:39:04.884942: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 13:39:04.887118: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 13:39:04.891750: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 13:39:04.894195: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:39:04.896413: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:39:04.898683: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 13:39:04.900957: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 13:39:04.903233: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 13:39:04.905474: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 13:39:04.907764: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:39:04.910030: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 13:39:05.338952: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 13:39:05.342291: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 13:39:05.343821: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 13:39:05.345525: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 13:39:05.352271: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x221e153fa70 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 13:39:05.355254: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 13:39:07.014568: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 13:39:07.529661: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:39:08.192755: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:39:08.199089: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:39:09.572126: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 13:39:09.623585: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 13:39:09.937114: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 4s 32ms/step
[INFOR]: Index of most vote   :335
[INFOR]: Class of most vote   :fox squirrel, eastern fox squirrel, Sciurus niger
[INFOR]: Number of most vote  :57.0


[INFOR]: Index of second most vote     :382
[INFOR]: Class of second most vote     :squirrel monkey, Saimiri sciureus
[INFOR]: Number of second most vote    :29.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 1s 26ms/step
[INFOR]: Toltal norm before transform: 0.8554
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0302

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 1s 26ms/step
[INFOR]: SEN training of class 38_500 before transform: 57
[INFOR]: SPE training of class 38_500 before transform: 485

[INFOR]: SEN training of class 38_500 after transform: 382
[INFOR]: SPE training of class 38_500 after transform: 342
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 26ms/step
[INFOR]: Index of most vote   :335
[INFOR]: Class of most vote   :fox squirrel, eastern fox squirrel, Sciurus niger
[INFOR]: Number of most vote  :12.0


[INFOR]: Index of second most vote     :382
[INFOR]: Class of second most vote     :squirrel monkey, Saimiri sciureus
[INFOR]: Number of second most vote    :11.0
[INFOR]: SEN testing of class 38_100 before transform: 12
[INFOR]: SPE testing of class 38_100 before transform: 98

[INFOR]: SEN testing of class 38_100 after transform: 97
[INFOR]: SPE testing of class 38_100 after transform: 15
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name ResNet50  --model_shape 224 224 --dataset_name cifar_100 --class_name_train 39_500 --class_name_test 39_100
2021-09-08 13:39:17.242859: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  ResNet50
dataset_name =  cifar_100
class_name_train =  39_500
class_name_test =  39_100
data_shape =  (32, 32, 3)
model_shape =  [224, 224]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 13:39:19.980622: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 13:39:20.006494: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 13:39:20.011627: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 13:39:20.019692: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:39:20.022390: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:39:20.028990: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 13:39:20.032604: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 13:39:20.039076: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 13:39:20.044044: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 13:39:20.047115: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:39:20.049294: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 13:39:20.051348: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 13:39:20.063933: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x19fb4203b60 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 13:39:20.067010: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 13:39:20.069192: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 13:39:20.073774: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 13:39:20.076328: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:39:20.078570: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:39:20.080838: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 13:39:20.083200: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 13:39:20.085469: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 13:39:20.087745: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 13:39:20.090157: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:39:20.092543: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 13:39:20.531618: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 13:39:20.534426: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 13:39:20.535909: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 13:39:20.537654: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 13:39:20.544776: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x19fe3af44e0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 13:39:20.547680: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 13:39:22.221431: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 13:39:22.735342: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:39:23.405365: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:39:23.411103: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:39:24.806100: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 13:39:24.857184: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 13:39:25.175750: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 4s 32ms/step
[INFOR]: Index of most vote   :810
[INFOR]: Class of most vote   :space bar
[INFOR]: Number of most vote  :198.0


[INFOR]: Index of second most vote     :812
[INFOR]: Class of second most vote     :space shuttle
[INFOR]: Number of second most vote    :36.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 1s 26ms/step
[INFOR]: Toltal norm before transform: 0.6557
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0375

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 1s 26ms/step
[INFOR]: SEN training of class 39_500 before transform: 198
[INFOR]: SPE training of class 39_500 before transform: 499

[INFOR]: SEN training of class 39_500 after transform: 451
[INFOR]: SPE training of class 39_500 after transform: 432
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 27ms/step
[INFOR]: Index of most vote   :810
[INFOR]: Class of most vote   :space bar
[INFOR]: Number of most vote  :51.0


[INFOR]: Index of second most vote     :905
[INFOR]: Class of second most vote     :window shade
[INFOR]: Number of second most vote    :5.0
[INFOR]: SEN testing of class 39_100 before transform: 51
[INFOR]: SPE testing of class 39_100 before transform: 100

[INFOR]: SEN testing of class 39_100 after transform: 97
[INFOR]: SPE testing of class 39_100 after transform: 52
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name ResNet50  --model_shape 224 224 --dataset_name cifar_100 --class_name_train 40_500 --class_name_test 40_100
2021-09-08 13:39:32.509213: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  ResNet50
dataset_name =  cifar_100
class_name_train =  40_500
class_name_test =  40_100
data_shape =  (32, 32, 3)
model_shape =  [224, 224]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 13:39:35.166064: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 13:39:35.193607: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 13:39:35.199109: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 13:39:35.207376: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:39:35.209590: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:39:35.215101: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 13:39:35.218619: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 13:39:35.224950: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 13:39:35.230010: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 13:39:35.233001: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:39:35.235380: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 13:39:35.237430: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 13:39:35.249450: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x193367a8460 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 13:39:35.252663: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 13:39:35.254792: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 13:39:35.259225: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 13:39:35.261423: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:39:35.263810: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:39:35.266114: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 13:39:35.268279: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 13:39:35.270464: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 13:39:35.272681: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 13:39:35.275152: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:39:35.277359: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 13:39:35.702148: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 13:39:35.705154: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 13:39:35.706603: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 13:39:35.708192: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 13:39:35.714890: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x193612b6b90 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 13:39:35.717869: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 13:39:37.349798: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 13:39:37.848900: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:39:38.504604: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:39:38.510410: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:39:39.871517: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 13:39:39.922471: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 13:39:40.251626: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 4s 32ms/step
[INFOR]: Index of most vote   :846
[INFOR]: Class of most vote   :table lamp
[INFOR]: Number of most vote  :133.0


[INFOR]: Index of second most vote     :550
[INFOR]: Class of second most vote     :espresso maker
[INFOR]: Number of second most vote    :22.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 1s 26ms/step
[INFOR]: Toltal norm before transform: 0.7356
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1596

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 1s 26ms/step
[INFOR]: SEN training of class 40_500 before transform: 133
[INFOR]: SPE training of class 40_500 before transform: 500

[INFOR]: SEN training of class 40_500 after transform: 386
[INFOR]: SPE training of class 40_500 after transform: 378
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 26ms/step
[INFOR]: Index of most vote   :846
[INFOR]: Class of most vote   :table lamp
[INFOR]: Number of most vote  :30.0


[INFOR]: Index of second most vote     :619
[INFOR]: Class of second most vote     :lampshade, lamp shade
[INFOR]: Number of second most vote    :4.0
[INFOR]: SEN testing of class 40_100 before transform: 30
[INFOR]: SPE testing of class 40_100 before transform: 100

[INFOR]: SEN testing of class 40_100 after transform: 95
[INFOR]: SPE testing of class 40_100 after transform: 34
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name ResNet50  --model_shape 224 224 --dataset_name cifar_100 --class_name_train 41_500 --class_name_test 41_100
2021-09-08 13:39:47.566839: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  ResNet50
dataset_name =  cifar_100
class_name_train =  41_500
class_name_test =  41_100
data_shape =  (32, 32, 3)
model_shape =  [224, 224]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 13:39:50.273455: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 13:39:50.297644: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 13:39:50.302145: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 13:39:50.310435: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:39:50.312886: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:39:50.318107: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 13:39:50.321651: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 13:39:50.328062: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 13:39:50.332978: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 13:39:50.336211: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:39:50.338470: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 13:39:50.340509: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 13:39:50.352710: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x2873b47c440 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 13:39:50.356150: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 13:39:50.358322: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 13:39:50.362871: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 13:39:50.365168: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:39:50.367456: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:39:50.369708: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 13:39:50.372092: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 13:39:50.374525: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 13:39:50.376739: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 13:39:50.379120: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:39:50.381389: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 13:39:50.819690: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 13:39:50.821983: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 13:39:50.823652: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 13:39:50.825253: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 13:39:50.832655: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x2876a8e1d10 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 13:39:50.835671: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 13:39:52.494151: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 13:39:53.000796: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:39:53.671399: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:39:53.677174: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:39:55.086498: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 13:39:55.137585: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 13:39:55.457575: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 4s 32ms/step
[INFOR]: Index of most vote   :856
[INFOR]: Class of most vote   :thresher, thrasher, threshing machine
[INFOR]: Number of most vote  :67.0


[INFOR]: Index of second most vote     :795
[INFOR]: Class of second most vote     :ski
[INFOR]: Number of second most vote    :60.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 1s 27ms/step
[INFOR]: Toltal norm before transform: 0.9023
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1172

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 1s 27ms/step
[INFOR]: SEN training of class 41_500 before transform: 67
[INFOR]: SPE training of class 41_500 before transform: 488

[INFOR]: SEN training of class 41_500 after transform: 438
[INFOR]: SPE training of class 41_500 after transform: 369
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 26ms/step
[INFOR]: Index of most vote   :795
[INFOR]: Class of most vote   :ski
[INFOR]: Number of most vote  :17.0


[INFOR]: Index of second most vote     :621
[INFOR]: Class of second most vote     :lawn mower, mower
[INFOR]: Number of second most vote    :14.0
[INFOR]: SEN testing of class 41_100 before transform: 17
[INFOR]: SPE testing of class 41_100 before transform: 92

[INFOR]: SEN testing of class 41_100 after transform: 92
[INFOR]: SPE testing of class 41_100 after transform: 32
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name ResNet50  --model_shape 224 224 --dataset_name cifar_100 --class_name_train 42_500 --class_name_test 42_100
2021-09-08 13:40:02.883789: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  ResNet50
dataset_name =  cifar_100
class_name_train =  42_500
class_name_test =  42_100
data_shape =  (32, 32, 3)
model_shape =  [224, 224]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 13:40:05.579105: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 13:40:05.604313: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 13:40:05.609139: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 13:40:05.616950: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:40:05.619074: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:40:05.624165: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 13:40:05.627650: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 13:40:05.633976: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 13:40:05.638956: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 13:40:05.642001: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:40:05.644196: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 13:40:05.646100: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 13:40:05.658179: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x244385631d0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 13:40:05.661248: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 13:40:05.663494: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 13:40:05.667927: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 13:40:05.670090: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:40:05.672243: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:40:05.674826: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 13:40:05.677076: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 13:40:05.679282: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 13:40:05.681610: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 13:40:05.683862: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:40:05.686074: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 13:40:06.119752: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 13:40:06.122679: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 13:40:06.124199: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 13:40:06.125775: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 13:40:06.132586: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x24467de57e0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 13:40:06.135561: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 13:40:07.780057: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 13:40:08.278746: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:40:08.939495: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:40:08.946211: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:40:10.318494: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 13:40:10.368279: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 13:40:10.680363: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 4s 31ms/step
[INFOR]: Index of most vote   :335
[INFOR]: Class of most vote   :fox squirrel, eastern fox squirrel, Sciurus niger
[INFOR]: Number of most vote  :97.0


[INFOR]: Index of second most vote     :289
[INFOR]: Class of second most vote     :snow leopard, ounce, Panthera uncia
[INFOR]: Number of second most vote    :63.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 1s 26ms/step
[INFOR]: Toltal norm before transform: 0.7623
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.3437

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 1s 26ms/step
[INFOR]: SEN training of class 42_500 before transform: 97
[INFOR]: SPE training of class 42_500 before transform: 489

[INFOR]: SEN training of class 42_500 after transform: 391
[INFOR]: SPE training of class 42_500 after transform: 359
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 26ms/step
[INFOR]: Index of most vote   :335
[INFOR]: Class of most vote   :fox squirrel, eastern fox squirrel, Sciurus niger
[INFOR]: Number of most vote  :29.0


[INFOR]: Index of second most vote     :289
[INFOR]: Class of second most vote     :snow leopard, ounce, Panthera uncia
[INFOR]: Number of second most vote    :9.0
[INFOR]: SEN testing of class 42_100 before transform: 29
[INFOR]: SPE testing of class 42_100 before transform: 98

[INFOR]: SEN testing of class 42_100 after transform: 88
[INFOR]: SPE testing of class 42_100 after transform: 3
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name ResNet50  --model_shape 224 224 --dataset_name cifar_100 --class_name_train 43_500 --class_name_test 43_100
2021-09-08 13:40:17.927165: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  ResNet50
dataset_name =  cifar_100
class_name_train =  43_500
class_name_test =  43_100
data_shape =  (32, 32, 3)
model_shape =  [224, 224]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 13:40:20.587285: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 13:40:20.610767: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 13:40:20.615835: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 13:40:20.623761: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:40:20.626033: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:40:20.631364: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 13:40:20.634969: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 13:40:20.641596: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 13:40:20.646847: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 13:40:20.650087: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:40:20.652408: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 13:40:20.654669: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 13:40:20.667347: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x27d3b5631b0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 13:40:20.670535: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 13:40:20.672689: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 13:40:20.677533: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 13:40:20.679817: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:40:20.682062: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:40:20.684425: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 13:40:20.686727: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 13:40:20.688916: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 13:40:20.691118: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 13:40:20.693488: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:40:20.695807: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 13:40:21.127728: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 13:40:21.130283: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 13:40:21.131871: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 13:40:21.133419: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 13:40:21.140045: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x27d6aec5160 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 13:40:21.142918: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 13:40:22.811633: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 13:40:23.322610: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:40:23.979658: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:40:23.985846: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:40:25.358397: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 13:40:25.412300: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 13:40:25.725708: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 4s 31ms/step
[INFOR]: Index of most vote   :369
[INFOR]: Class of most vote   :siamang, Hylobates syndactylus, Symphalangus syndactylus
[INFOR]: Number of most vote  :48.0


[INFOR]: Index of second most vote     :335
[INFOR]: Class of second most vote     :fox squirrel, eastern fox squirrel, Sciurus niger
[INFOR]: Number of second most vote    :34.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 1s 25ms/step
[INFOR]: Toltal norm before transform: 0.8864
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1068

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 1s 27ms/step
[INFOR]: SEN training of class 43_500 before transform: 48
[INFOR]: SPE training of class 43_500 before transform: 496

[INFOR]: SEN training of class 43_500 after transform: 371
[INFOR]: SPE training of class 43_500 after transform: 327
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 26ms/step
[INFOR]: Index of most vote   :369
[INFOR]: Class of most vote   :siamang, Hylobates syndactylus, Symphalangus syndactylus
[INFOR]: Number of most vote  :9.0


[INFOR]: Index of second most vote     :335
[INFOR]: Class of second most vote     :fox squirrel, eastern fox squirrel, Sciurus niger
[INFOR]: Number of second most vote    :8.0
[INFOR]: SEN testing of class 43_100 before transform: 9
[INFOR]: SPE testing of class 43_100 before transform: 99

[INFOR]: SEN testing of class 43_100 after transform: 89
[INFOR]: SPE testing of class 43_100 after transform: 12
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name ResNet50  --model_shape 224 224 --dataset_name cifar_100 --class_name_train 44_500 --class_name_test 44_100
2021-09-08 13:40:33.026120: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  ResNet50
dataset_name =  cifar_100
class_name_train =  44_500
class_name_test =  44_100
data_shape =  (32, 32, 3)
model_shape =  [224, 224]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 13:40:35.747308: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 13:40:35.775005: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 13:40:35.780070: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 13:40:35.788224: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:40:35.790465: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:40:35.795886: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 13:40:35.799398: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 13:40:35.805834: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 13:40:35.810826: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 13:40:35.813853: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:40:35.816269: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 13:40:35.818202: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 13:40:35.830446: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x275365d7950 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 13:40:35.833657: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 13:40:35.835822: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 13:40:35.840208: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 13:40:35.842428: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:40:35.844749: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:40:35.847222: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 13:40:35.849518: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 13:40:35.852886: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 13:40:35.855610: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 13:40:35.858093: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:40:35.860339: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 13:40:36.305803: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 13:40:36.308923: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 13:40:36.310404: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 13:40:36.312116: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 13:40:36.319174: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x275615a4ae0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 13:40:36.321993: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 13:40:38.009390: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 13:40:38.521389: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:40:39.202861: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:40:39.208662: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:40:40.611440: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 13:40:40.660157: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 13:40:40.977889: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 4s 32ms/step
[INFOR]: Index of most vote   :38
[INFOR]: Class of most vote   :banded gecko
[INFOR]: Number of most vote  :33.0


[INFOR]: Index of second most vote     :110
[INFOR]: Class of second most vote     :flatworm, platyhelminth
[INFOR]: Number of second most vote    :31.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 1s 26ms/step
[INFOR]: Toltal norm before transform: 0.9492
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.2463

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 1s 26ms/step
[INFOR]: SEN training of class 44_500 before transform: 33
[INFOR]: SPE training of class 44_500 before transform: 500

[INFOR]: SEN training of class 44_500 after transform: 364
[INFOR]: SPE training of class 44_500 after transform: 342
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 26ms/step
[INFOR]: Index of most vote   :38
[INFOR]: Class of most vote   :banded gecko
[INFOR]: Number of most vote  :9.0


[INFOR]: Index of second most vote     :110
[INFOR]: Class of second most vote     :flatworm, platyhelminth
[INFOR]: Number of second most vote    :8.0
[INFOR]: SEN testing of class 44_100 before transform: 9
[INFOR]: SPE testing of class 44_100 before transform: 100

[INFOR]: SEN testing of class 44_100 after transform: 86
[INFOR]: SPE testing of class 44_100 after transform: 10
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name ResNet50  --model_shape 224 224 --dataset_name cifar_100 --class_name_train 45_500 --class_name_test 45_100
2021-09-08 13:40:48.265515: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  ResNet50
dataset_name =  cifar_100
class_name_train =  45_500
class_name_test =  45_100
data_shape =  (32, 32, 3)
model_shape =  [224, 224]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 13:40:50.953187: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 13:40:50.978568: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 13:40:50.983673: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 13:40:50.991833: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:40:50.994022: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:40:50.999171: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 13:40:51.002557: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 13:40:51.008939: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 13:40:51.013892: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 13:40:51.016880: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:40:51.019400: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 13:40:51.021571: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 13:40:51.034172: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1f8b4fbb740 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 13:40:51.037391: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 13:40:51.039639: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 13:40:51.044285: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 13:40:51.046904: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:40:51.049094: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:40:51.051358: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 13:40:51.053705: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 13:40:51.055989: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 13:40:51.058207: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 13:40:51.060557: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:40:51.062757: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 13:40:51.490543: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 13:40:51.493113: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 13:40:51.494655: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 13:40:51.496584: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 13:40:51.503434: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1f8dfdd5b00 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 13:40:51.506445: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 13:40:53.190757: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 13:40:53.708620: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:40:54.381395: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:40:54.387531: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:40:55.763993: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 13:40:55.813351: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 13:40:56.138886: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 4s 32ms/step
[INFOR]: Index of most vote   :714
[INFOR]: Class of most vote   :pick, plectrum, plectron
[INFOR]: Number of most vote  :45.0


[INFOR]: Index of second most vote     :392
[INFOR]: Class of second most vote     :rock beauty, Holocanthus tricolor
[INFOR]: Number of second most vote    :35.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 1s 26ms/step
[INFOR]: Toltal norm before transform: 0.9007
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0200

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 1s 26ms/step
[INFOR]: SEN training of class 45_500 before transform: 45
[INFOR]: SPE training of class 45_500 before transform: 487

[INFOR]: SEN training of class 45_500 after transform: 373
[INFOR]: SPE training of class 45_500 after transform: 344
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 26ms/step
[INFOR]: Index of most vote   :714
[INFOR]: Class of most vote   :pick, plectrum, plectron
[INFOR]: Number of most vote  :6.0


[INFOR]: Index of second most vote     :905
[INFOR]: Class of second most vote     :window shade
[INFOR]: Number of second most vote    :6.0
[INFOR]: SEN testing of class 45_100 before transform: 6
[INFOR]: SPE testing of class 45_100 before transform: 97

[INFOR]: SEN testing of class 45_100 after transform: 78
[INFOR]: SPE testing of class 45_100 after transform: 44
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name ResNet50  --model_shape 224 224 --dataset_name cifar_100 --class_name_train 46_500 --class_name_test 46_100
2021-09-08 13:41:03.441916: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  ResNet50
dataset_name =  cifar_100
class_name_train =  46_500
class_name_test =  46_100
data_shape =  (32, 32, 3)
model_shape =  [224, 224]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 13:41:06.108451: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 13:41:06.132254: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 13:41:06.137102: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 13:41:06.145095: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:41:06.147664: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:41:06.152816: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 13:41:06.156261: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 13:41:06.162715: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 13:41:06.167654: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 13:41:06.170664: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:41:06.172819: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 13:41:06.174970: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 13:41:06.187841: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x122bb56cf90 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 13:41:06.190823: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 13:41:06.192964: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 13:41:06.197843: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 13:41:06.200071: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:41:06.202265: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:41:06.204589: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 13:41:06.206870: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 13:41:06.209084: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 13:41:06.211303: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 13:41:06.213667: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:41:06.216128: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 13:41:06.660519: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 13:41:06.663591: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 13:41:06.665158: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 13:41:06.666800: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 13:41:06.673386: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x122e5b47870 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 13:41:06.676526: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 13:41:08.356679: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 13:41:08.865664: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:41:09.532787: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:41:09.539265: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:41:10.911050: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 13:41:10.974078: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 13:41:11.289721: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 4s 32ms/step
[INFOR]: Index of most vote   :906
[INFOR]: Class of most vote   :Windsor tie
[INFOR]: Number of most vote  :107.0


[INFOR]: Index of second most vote     :714
[INFOR]: Class of second most vote     :pick, plectrum, plectron
[INFOR]: Number of second most vote    :33.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 1s 26ms/step
[INFOR]: Toltal norm before transform: 0.7258
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1396

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 1s 26ms/step
[INFOR]: SEN training of class 46_500 before transform: 107
[INFOR]: SPE training of class 46_500 before transform: 491

[INFOR]: SEN training of class 46_500 after transform: 365
[INFOR]: SPE training of class 46_500 after transform: 312
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 26ms/step
[INFOR]: Index of most vote   :906
[INFOR]: Class of most vote   :Windsor tie
[INFOR]: Number of most vote  :18.0


[INFOR]: Index of second most vote     :795
[INFOR]: Class of second most vote     :ski
[INFOR]: Number of second most vote    :6.0
[INFOR]: SEN testing of class 46_100 before transform: 18
[INFOR]: SPE testing of class 46_100 before transform: 96

[INFOR]: SEN testing of class 46_100 after transform: 83
[INFOR]: SPE testing of class 46_100 after transform: 32
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name ResNet50  --model_shape 224 224 --dataset_name cifar_100 --class_name_train 47_500 --class_name_test 47_100
2021-09-08 13:41:18.630266: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  ResNet50
dataset_name =  cifar_100
class_name_train =  47_500
class_name_test =  47_100
data_shape =  (32, 32, 3)
model_shape =  [224, 224]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 13:41:21.377124: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 13:41:21.400667: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 13:41:21.405191: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 13:41:21.413563: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:41:21.415777: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:41:21.421186: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 13:41:21.424900: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 13:41:21.431188: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 13:41:21.436332: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 13:41:21.439514: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:41:21.441759: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 13:41:21.443702: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 13:41:21.456130: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x26f3a463ad0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 13:41:21.459327: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 13:41:21.461527: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 13:41:21.466178: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 13:41:21.469141: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:41:21.471535: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:41:21.473953: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 13:41:21.476358: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 13:41:21.478621: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 13:41:21.481112: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 13:41:21.483412: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:41:21.485751: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 13:41:21.924804: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 13:41:21.927419: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 13:41:21.928908: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 13:41:21.930499: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 13:41:21.937608: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x26f63e3a690 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 13:41:21.940682: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 13:41:23.618134: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 13:41:24.127501: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:41:24.805100: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:41:24.811736: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:41:26.184580: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 13:41:26.234808: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 13:41:26.550588: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 4s 32ms/step
[INFOR]: Index of most vote   :103
[INFOR]: Class of most vote   :platypus, duckbill, duckbilled platypus, duck-billed platypus, Ornithorhynchus anatinus
[INFOR]: Number of most vote  :46.0


[INFOR]: Index of second most vote     :146
[INFOR]: Class of second most vote     :albatross, mollymawk
[INFOR]: Number of second most vote    :36.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 1s 26ms/step
[INFOR]: Toltal norm before transform: 0.8848
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.2145

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 1s 26ms/step
[INFOR]: SEN training of class 47_500 before transform: 46
[INFOR]: SPE training of class 47_500 before transform: 484

[INFOR]: SEN training of class 47_500 after transform: 458
[INFOR]: SPE training of class 47_500 after transform: 352
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 26ms/step
[INFOR]: Index of most vote   :103
[INFOR]: Class of most vote   :platypus, duckbill, duckbilled platypus, duck-billed platypus, Ornithorhynchus anatinus
[INFOR]: Number of most vote  :12.0


[INFOR]: Index of second most vote     :146
[INFOR]: Class of second most vote     :albatross, mollymawk
[INFOR]: Number of second most vote    :8.0
[INFOR]: SEN testing of class 47_100 before transform: 12
[INFOR]: SPE testing of class 47_100 before transform: 97

[INFOR]: SEN testing of class 47_100 after transform: 98
[INFOR]: SPE testing of class 47_100 after transform: 12
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name ResNet50  --model_shape 224 224 --dataset_name cifar_100 --class_name_train 48_500 --class_name_test 48_100
2021-09-08 13:41:33.919761: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  ResNet50
dataset_name =  cifar_100
class_name_train =  48_500
class_name_test =  48_100
data_shape =  (32, 32, 3)
model_shape =  [224, 224]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 13:41:36.652468: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 13:41:36.675599: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 13:41:36.680410: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 13:41:36.688328: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:41:36.690996: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:41:36.696181: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 13:41:36.699577: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 13:41:36.705892: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 13:41:36.711236: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 13:41:36.714359: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:41:36.716596: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 13:41:36.718667: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 13:41:36.730828: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x2a3382c78f0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 13:41:36.733987: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 13:41:36.736086: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 13:41:36.740716: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 13:41:36.743052: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:41:36.745329: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:41:36.747933: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 13:41:36.750155: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 13:41:36.752448: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 13:41:36.754677: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 13:41:36.757129: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:41:36.759537: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 13:41:37.197439: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 13:41:37.200201: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 13:41:37.201935: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 13:41:37.203852: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 13:41:37.211595: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x2a360959de0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 13:41:37.214729: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 13:41:38.882082: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 13:41:39.394900: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:41:40.067388: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:41:40.073922: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:41:41.463091: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 13:41:41.513563: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 13:41:41.834385: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 4s 32ms/step
[INFOR]: Index of most vote   :665
[INFOR]: Class of most vote   :moped
[INFOR]: Number of most vote  :110.0


[INFOR]: Index of second most vote     :794
[INFOR]: Class of second most vote     :shower curtain
[INFOR]: Number of second most vote    :68.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 1s 28ms/step
[INFOR]: Toltal norm before transform: 0.7502
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.2280

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 1s 26ms/step
[INFOR]: SEN training of class 48_500 before transform: 110
[INFOR]: SPE training of class 48_500 before transform: 500

[INFOR]: SEN training of class 48_500 after transform: 452
[INFOR]: SPE training of class 48_500 after transform: 406
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 27ms/step
[INFOR]: Index of most vote   :665
[INFOR]: Class of most vote   :moped
[INFOR]: Number of most vote  :19.0


[INFOR]: Index of second most vote     :794
[INFOR]: Class of second most vote     :shower curtain
[INFOR]: Number of second most vote    :18.0
[INFOR]: SEN testing of class 48_100 before transform: 19
[INFOR]: SPE testing of class 48_100 before transform: 100

[INFOR]: SEN testing of class 48_100 after transform: 94
[INFOR]: SPE testing of class 48_100 after transform: 60
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name ResNet50  --model_shape 224 224 --dataset_name cifar_100 --class_name_train 49_500 --class_name_test 49_100
2021-09-08 13:41:49.283603: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  ResNet50
dataset_name =  cifar_100
class_name_train =  49_500
class_name_test =  49_100
data_shape =  (32, 32, 3)
model_shape =  [224, 224]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 13:41:51.978681: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 13:41:52.002344: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 13:41:52.007399: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 13:41:52.015484: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:41:52.017736: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:41:52.023158: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 13:41:52.026530: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 13:41:52.036391: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 13:41:52.041425: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 13:41:52.044331: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:41:52.046499: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 13:41:52.048698: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 13:41:52.060764: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x22b36b767c0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 13:41:52.064278: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 13:41:52.066510: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 13:41:52.071030: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 13:41:52.073458: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:41:52.075646: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:41:52.077909: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 13:41:52.080206: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 13:41:52.082429: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 13:41:52.084719: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 13:41:52.086997: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:41:52.089266: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 13:41:52.537145: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 13:41:52.540072: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 13:41:52.541509: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 13:41:52.543084: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 13:41:52.549841: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x22b3c7b5db0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 13:41:52.552667: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 13:41:54.212864: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 13:41:54.724079: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:41:55.398356: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:41:55.403991: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:41:56.806617: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 13:41:56.857191: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 13:41:57.173053: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 4s 33ms/step
[INFOR]: Index of most vote   :80
[INFOR]: Class of most vote   :black grouse
[INFOR]: Number of most vote  :43.0


[INFOR]: Index of second most vote     :102
[INFOR]: Class of second most vote     :echidna, spiny anteater, anteater
[INFOR]: Number of second most vote    :24.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 1s 26ms/step
[INFOR]: Toltal norm before transform: 0.9050
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.2162

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 1s 28ms/step
[INFOR]: SEN training of class 49_500 before transform: 43
[INFOR]: SPE training of class 49_500 before transform: 498

[INFOR]: SEN training of class 49_500 after transform: 424
[INFOR]: SPE training of class 49_500 after transform: 350
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 26ms/step
[INFOR]: Index of most vote   :51
[INFOR]: Class of most vote   :triceratops
[INFOR]: Number of most vote  :8.0


[INFOR]: Index of second most vote     :148
[INFOR]: Class of second most vote     :killer whale, killer, orca, grampus, sea wolf, Orcinus orca
[INFOR]: Number of second most vote    :6.0
[INFOR]: SEN testing of class 49_100 before transform: 8
[INFOR]: SPE testing of class 49_100 before transform: 99

[INFOR]: SEN testing of class 49_100 after transform: 99
[INFOR]: SPE testing of class 49_100 after transform: 29
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name ResNet50  --model_shape 224 224 --dataset_name cifar_100 --class_name_train 50_500 --class_name_test 50_100
2021-09-08 13:42:04.552131: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  ResNet50
dataset_name =  cifar_100
class_name_train =  50_500
class_name_test =  50_100
data_shape =  (32, 32, 3)
model_shape =  [224, 224]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 13:42:07.289450: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 13:42:07.314226: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 13:42:07.318966: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 13:42:07.327194: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:42:07.329613: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:42:07.334839: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 13:42:07.338274: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 13:42:07.344885: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 13:42:07.349858: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 13:42:07.352882: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:42:07.355105: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 13:42:07.357114: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 13:42:07.369593: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x21e3716fb80 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 13:42:07.372745: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 13:42:07.374856: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 13:42:07.379427: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 13:42:07.381723: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:42:07.384139: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:42:07.386572: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 13:42:07.388831: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 13:42:07.391074: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 13:42:07.393323: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 13:42:07.395677: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:42:07.398224: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 13:42:07.823752: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 13:42:07.826316: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 13:42:07.827893: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 13:42:07.829547: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 13:42:07.836623: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x21e60f69470 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 13:42:07.839752: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 13:42:09.489244: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 13:42:10.002770: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:42:10.654446: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:42:10.660612: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:42:12.055577: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 13:42:12.104707: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 13:42:12.430290: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 4s 32ms/step
[INFOR]: Index of most vote   :335
[INFOR]: Class of most vote   :fox squirrel, eastern fox squirrel, Sciurus niger
[INFOR]: Number of most vote  :81.0


[INFOR]: Index of second most vote     :679
[INFOR]: Class of second most vote     :necklace
[INFOR]: Number of second most vote    :34.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 1s 28ms/step
[INFOR]: Toltal norm before transform: 0.8204
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0224

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 1s 26ms/step
[INFOR]: SEN training of class 50_500 before transform: 81
[INFOR]: SPE training of class 50_500 before transform: 484

[INFOR]: SEN training of class 50_500 after transform: 300
[INFOR]: SPE training of class 50_500 after transform: 299
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 27ms/step
[INFOR]: Index of most vote   :335
[INFOR]: Class of most vote   :fox squirrel, eastern fox squirrel, Sciurus niger
[INFOR]: Number of most vote  :16.0


[INFOR]: Index of second most vote     :679
[INFOR]: Class of second most vote     :necklace
[INFOR]: Number of second most vote    :7.0
[INFOR]: SEN testing of class 50_100 before transform: 16
[INFOR]: SPE testing of class 50_100 before transform: 97

[INFOR]: SEN testing of class 50_100 after transform: 89
[INFOR]: SPE testing of class 50_100 after transform: 13
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name ResNet50  --model_shape 224 224 --dataset_name cifar_100 --class_name_train 51_500 --class_name_test 51_100
2021-09-08 13:42:19.861576: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  ResNet50
dataset_name =  cifar_100
class_name_train =  51_500
class_name_test =  51_100
data_shape =  (32, 32, 3)
model_shape =  [224, 224]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 13:42:22.594503: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 13:42:22.619186: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 13:42:22.624019: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 13:42:22.632111: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:42:22.634269: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:42:22.639434: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 13:42:22.642898: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 13:42:22.649307: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 13:42:22.654385: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 13:42:22.657375: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:42:22.659616: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 13:42:22.661540: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 13:42:22.673550: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x2ab37ad2ea0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 13:42:22.676909: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 13:42:22.679061: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 13:42:22.683638: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 13:42:22.685869: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:42:22.688335: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:42:22.690583: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 13:42:22.692867: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 13:42:22.695138: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 13:42:22.697365: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 13:42:22.699874: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:42:22.702051: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 13:42:23.130355: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 13:42:23.133033: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 13:42:23.134493: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 13:42:23.136051: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 13:42:23.143002: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x2ab63d0d4f0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 13:42:23.145879: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 13:42:24.790959: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 13:42:25.306518: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:42:25.972738: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:42:25.979793: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:42:27.367009: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 13:42:27.417358: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 13:42:27.740924: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 4s 32ms/step
[INFOR]: Index of most vote   :995
[INFOR]: Class of most vote   :earthstar
[INFOR]: Number of most vote  :45.0


[INFOR]: Index of second most vote     :392
[INFOR]: Class of second most vote     :rock beauty, Holocanthus tricolor
[INFOR]: Number of second most vote    :32.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 1s 27ms/step
[INFOR]: Toltal norm before transform: 0.8948
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.3914

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 1s 26ms/step
[INFOR]: SEN training of class 51_500 before transform: 45
[INFOR]: SPE training of class 51_500 before transform: 500

[INFOR]: SEN training of class 51_500 after transform: 391
[INFOR]: SPE training of class 51_500 after transform: 335
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 26ms/step
[INFOR]: Index of most vote   :795
[INFOR]: Class of most vote   :ski
[INFOR]: Number of most vote  :8.0


[INFOR]: Index of second most vote     :994
[INFOR]: Class of second most vote     :stinkhorn, carrion fungus
[INFOR]: Number of second most vote    :8.0
[INFOR]: SEN testing of class 51_100 before transform: 8
[INFOR]: SPE testing of class 51_100 before transform: 96

[INFOR]: SEN testing of class 51_100 after transform: 87
[INFOR]: SPE testing of class 51_100 after transform: 21
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name ResNet50  --model_shape 224 224 --dataset_name cifar_100 --class_name_train 52_500 --class_name_test 52_100
2021-09-08 13:42:35.067790: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  ResNet50
dataset_name =  cifar_100
class_name_train =  52_500
class_name_test =  52_100
data_shape =  (32, 32, 3)
model_shape =  [224, 224]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 13:42:37.787048: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 13:42:37.813477: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 13:42:37.819357: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 13:42:37.828044: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:42:37.830546: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:42:37.836202: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 13:42:37.839800: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 13:42:37.846206: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 13:42:37.851393: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 13:42:37.854415: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:42:37.856626: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 13:42:37.858750: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 13:42:37.871106: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x23033d21800 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 13:42:37.874045: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 13:42:37.876200: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 13:42:37.880517: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 13:42:37.882693: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:42:37.884906: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:42:37.887153: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 13:42:37.889472: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 13:42:37.891708: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 13:42:37.894026: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 13:42:37.896310: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:42:37.898495: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 13:42:38.342260: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 13:42:38.345107: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 13:42:38.346549: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 13:42:38.348256: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 13:42:38.355041: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x2305f917d60 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 13:42:38.357852: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 13:42:40.019205: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 13:42:40.529116: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:42:41.196587: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:42:41.202830: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:42:42.619308: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 13:42:42.675934: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 13:42:42.998361: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 4s 33ms/step
[INFOR]: Index of most vote   :183
[INFOR]: Class of most vote   :Kerry blue terrier
[INFOR]: Number of most vote  :59.0


[INFOR]: Index of second most vote     :820
[INFOR]: Class of second most vote     :steam locomotive
[INFOR]: Number of second most vote    :43.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 1s 26ms/step
[INFOR]: Toltal norm before transform: 0.8702
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1294

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 1s 28ms/step
[INFOR]: SEN training of class 52_500 before transform: 59
[INFOR]: SPE training of class 52_500 before transform: 498

[INFOR]: SEN training of class 52_500 after transform: 482
[INFOR]: SPE training of class 52_500 after transform: 399
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 29ms/step
[INFOR]: Index of most vote   :183
[INFOR]: Class of most vote   :Kerry blue terrier
[INFOR]: Number of most vote  :8.0


[INFOR]: Index of second most vote     :820
[INFOR]: Class of second most vote     :steam locomotive
[INFOR]: Number of second most vote    :8.0
[INFOR]: SEN testing of class 52_100 before transform: 8
[INFOR]: SPE testing of class 52_100 before transform: 99

[INFOR]: SEN testing of class 52_100 after transform: 99
[INFOR]: SPE testing of class 52_100 after transform: 18
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name ResNet50  --model_shape 224 224 --dataset_name cifar_100 --class_name_train 53_500 --class_name_test 53_100
2021-09-08 13:42:50.483208: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  ResNet50
dataset_name =  cifar_100
class_name_train =  53_500
class_name_test =  53_100
data_shape =  (32, 32, 3)
model_shape =  [224, 224]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 13:42:53.136322: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 13:42:53.160426: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 13:42:53.165193: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 13:42:53.173393: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:42:53.176108: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:42:53.181558: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 13:42:53.185206: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 13:42:53.191702: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 13:42:53.196677: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 13:42:53.199742: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:42:53.202168: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 13:42:53.204432: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 13:42:53.217844: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x178b3f8e6c0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 13:42:53.221144: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 13:42:53.223536: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 13:42:53.228360: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 13:42:53.230772: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:42:53.233164: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:42:53.235416: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 13:42:53.237625: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 13:42:53.239987: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 13:42:53.242262: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 13:42:53.244615: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:42:53.247009: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 13:42:53.717924: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 13:42:53.720839: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 13:42:53.722946: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 13:42:53.724674: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 13:42:53.731666: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x178e3061370 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 13:42:53.734582: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 13:42:55.404458: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 13:42:55.909172: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:42:56.600719: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:42:56.607065: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:42:58.024623: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 13:42:58.075109: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 13:42:58.405422: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 4s 33ms/step
[INFOR]: Index of most vote   :722
[INFOR]: Class of most vote   :ping-pong ball
[INFOR]: Number of most vote  :72.0


[INFOR]: Index of second most vote     :680
[INFOR]: Class of second most vote     :nipple
[INFOR]: Number of second most vote    :41.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 1s 26ms/step
[INFOR]: Toltal norm before transform: 0.8648
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.2539

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 1s 26ms/step
[INFOR]: SEN training of class 53_500 before transform: 72
[INFOR]: SPE training of class 53_500 before transform: 498

[INFOR]: SEN training of class 53_500 after transform: 490
[INFOR]: SPE training of class 53_500 after transform: 411
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 27ms/step
[INFOR]: Index of most vote   :722
[INFOR]: Class of most vote   :ping-pong ball
[INFOR]: Number of most vote  :10.0


[INFOR]: Index of second most vote     :746
[INFOR]: Class of second most vote     :puck, hockey puck
[INFOR]: Number of second most vote    :8.0
[INFOR]: SEN testing of class 53_100 before transform: 10
[INFOR]: SPE testing of class 53_100 before transform: 100

[INFOR]: SEN testing of class 53_100 after transform: 100
[INFOR]: SPE testing of class 53_100 after transform: 65
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name ResNet50  --model_shape 224 224 --dataset_name cifar_100 --class_name_train 54_500 --class_name_test 54_100
2021-09-08 13:43:05.743192: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  ResNet50
dataset_name =  cifar_100
class_name_train =  54_500
class_name_test =  54_100
data_shape =  (32, 32, 3)
model_shape =  [224, 224]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 13:43:08.426517: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 13:43:08.450614: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 13:43:08.455376: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 13:43:08.463297: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:43:08.465605: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:43:08.470780: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 13:43:08.474361: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 13:43:08.480736: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 13:43:08.485673: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 13:43:08.489333: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:43:08.492360: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 13:43:08.494442: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 13:43:08.506742: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1e6b68ba0c0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 13:43:08.509930: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 13:43:08.512121: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 13:43:08.516636: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 13:43:08.518923: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:43:08.521468: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:43:08.523827: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 13:43:08.526029: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 13:43:08.528275: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 13:43:08.530611: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 13:43:08.533343: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:43:08.535575: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 13:43:08.971287: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 13:43:08.973942: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 13:43:08.975392: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 13:43:08.976954: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 13:43:08.984058: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1e6e1cd0e90 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 13:43:08.986960: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 13:43:10.644541: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 13:43:11.156819: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:43:11.823601: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:43:11.829286: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:43:13.269278: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 13:43:13.317421: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 13:43:13.641202: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 4s 31ms/step
[INFOR]: Index of most vote   :714
[INFOR]: Class of most vote   :pick, plectrum, plectron
[INFOR]: Number of most vote  :68.0


[INFOR]: Index of second most vote     :722
[INFOR]: Class of second most vote     :ping-pong ball
[INFOR]: Number of second most vote    :55.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 1s 26ms/step
[INFOR]: Toltal norm before transform: 0.8534
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.2459

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 1s 26ms/step
[INFOR]: SEN training of class 54_500 before transform: 68
[INFOR]: SPE training of class 54_500 before transform: 491

[INFOR]: SEN training of class 54_500 after transform: 444
[INFOR]: SPE training of class 54_500 after transform: 381
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 26ms/step
[INFOR]: Index of most vote   :714
[INFOR]: Class of most vote   :pick, plectrum, plectron
[INFOR]: Number of most vote  :18.0


[INFOR]: Index of second most vote     :794
[INFOR]: Class of second most vote     :shower curtain
[INFOR]: Number of second most vote    :8.0
[INFOR]: SEN testing of class 54_100 before transform: 18
[INFOR]: SPE testing of class 54_100 before transform: 99

[INFOR]: SEN testing of class 54_100 after transform: 97
[INFOR]: SPE testing of class 54_100 after transform: 33
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name ResNet50  --model_shape 224 224 --dataset_name cifar_100 --class_name_train 55_500 --class_name_test 55_100
2021-09-08 13:43:20.961033: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  ResNet50
dataset_name =  cifar_100
class_name_train =  55_500
class_name_test =  55_100
data_shape =  (32, 32, 3)
model_shape =  [224, 224]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 13:43:23.675500: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 13:43:23.701636: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 13:43:23.706581: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 13:43:23.714538: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:43:23.716768: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:43:23.721963: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 13:43:23.725371: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 13:43:23.731834: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 13:43:23.736948: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 13:43:23.739971: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:43:23.742195: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 13:43:23.744184: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 13:43:23.756772: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x28eb38446a0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 13:43:23.759984: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 13:43:23.762290: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 13:43:23.766673: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 13:43:23.768959: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:43:23.771484: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:43:23.773960: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 13:43:23.776156: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 13:43:23.778381: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 13:43:23.780780: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 13:43:23.783306: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:43:23.785603: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 13:43:24.274618: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 13:43:24.277899: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 13:43:24.279453: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 13:43:24.281392: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 13:43:24.288314: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x28edd91ae20 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 13:43:24.291491: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 13:43:25.984255: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 13:43:26.499585: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:43:27.224162: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:43:27.230268: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:43:28.613900: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 13:43:28.670424: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 13:43:28.985705: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 4s 32ms/step
[INFOR]: Index of most vote   :103
[INFOR]: Class of most vote   :platypus, duckbill, duckbilled platypus, duck-billed platypus, Ornithorhynchus anatinus
[INFOR]: Number of most vote  :59.0


[INFOR]: Index of second most vote     :334
[INFOR]: Class of second most vote     :porcupine, hedgehog
[INFOR]: Number of second most vote    :29.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 1s 26ms/step
[INFOR]: Toltal norm before transform: 0.8956
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.4196

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 1s 27ms/step
[INFOR]: SEN training of class 55_500 before transform: 59
[INFOR]: SPE training of class 55_500 before transform: 489

[INFOR]: SEN training of class 55_500 after transform: 304
[INFOR]: SPE training of class 55_500 after transform: 275
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 28ms/step
[INFOR]: Index of most vote   :103
[INFOR]: Class of most vote   :platypus, duckbill, duckbilled platypus, duck-billed platypus, Ornithorhynchus anatinus
[INFOR]: Number of most vote  :12.0


[INFOR]: Index of second most vote     :148
[INFOR]: Class of second most vote     :killer whale, killer, orca, grampus, sea wolf, Orcinus orca
[INFOR]: Number of second most vote    :12.0
[INFOR]: SEN testing of class 55_100 before transform: 12
[INFOR]: SPE testing of class 55_100 before transform: 97

[INFOR]: SEN testing of class 55_100 after transform: 89
[INFOR]: SPE testing of class 55_100 after transform: 12
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name ResNet50  --model_shape 224 224 --dataset_name cifar_100 --class_name_train 56_500 --class_name_test 56_100
2021-09-08 13:43:36.310018: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  ResNet50
dataset_name =  cifar_100
class_name_train =  56_500
class_name_test =  56_100
data_shape =  (32, 32, 3)
model_shape =  [224, 224]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 13:43:38.972316: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 13:43:38.998313: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 13:43:39.003131: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 13:43:39.011101: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:43:39.013324: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:43:39.018452: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 13:43:39.021828: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 13:43:39.028222: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 13:43:39.033131: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 13:43:39.036313: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:43:39.038551: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 13:43:39.040495: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 13:43:39.052862: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x29336eed650 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 13:43:39.056026: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 13:43:39.058170: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 13:43:39.062612: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 13:43:39.064893: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:43:39.067035: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:43:39.069275: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 13:43:39.071760: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 13:43:39.073985: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 13:43:39.076196: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 13:43:39.078507: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:43:39.080804: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 13:43:39.526840: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 13:43:39.530172: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 13:43:39.531672: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 13:43:39.533349: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 13:43:39.540180: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x293620baa10 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 13:43:39.543352: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 13:43:41.192939: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 13:43:41.698388: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:43:42.368576: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:43:42.375181: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:43:43.758923: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 13:43:43.809515: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 13:43:44.146037: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 4s 32ms/step
[INFOR]: Index of most vote   :73
[INFOR]: Class of most vote   :barn spider, Araneus cavaticus
[INFOR]: Number of most vote  :24.0


[INFOR]: Index of second most vote     :251
[INFOR]: Class of second most vote     :dalmatian, coach dog, carriage dog
[INFOR]: Number of second most vote    :22.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 1s 27ms/step
[INFOR]: Toltal norm before transform: 0.9654
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.2994

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 1s 26ms/step
[INFOR]: SEN training of class 56_500 before transform: 24
[INFOR]: SPE training of class 56_500 before transform: 497

[INFOR]: SEN training of class 56_500 after transform: 424
[INFOR]: SPE training of class 56_500 after transform: 391
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 27ms/step
[INFOR]: Index of most vote   :653
[INFOR]: Class of most vote   :milk can
[INFOR]: Number of most vote  :8.0


[INFOR]: Index of second most vote     :73
[INFOR]: Class of second most vote     :barn spider, Araneus cavaticus
[INFOR]: Number of second most vote    :7.0
[INFOR]: SEN testing of class 56_100 before transform: 8
[INFOR]: SPE testing of class 56_100 before transform: 96

[INFOR]: SEN testing of class 56_100 after transform: 97
[INFOR]: SPE testing of class 56_100 after transform: 29
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name ResNet50  --model_shape 224 224 --dataset_name cifar_100 --class_name_train 57_500 --class_name_test 57_100
2021-09-08 13:43:51.489553: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  ResNet50
dataset_name =  cifar_100
class_name_train =  57_500
class_name_test =  57_100
data_shape =  (32, 32, 3)
model_shape =  [224, 224]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 13:43:54.134188: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 13:43:54.161519: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 13:43:54.166817: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 13:43:54.176371: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:43:54.178886: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:43:54.185303: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 13:43:54.188765: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 13:43:54.196169: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 13:43:54.203158: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 13:43:54.206530: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:43:54.209580: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 13:43:54.211997: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 13:43:54.226027: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1fab603ccb0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 13:43:54.229464: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 13:43:54.231797: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 13:43:54.238715: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 13:43:54.241268: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:43:54.243813: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:43:54.247137: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 13:43:54.249735: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 13:43:54.252127: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 13:43:54.255191: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 13:43:54.257705: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:43:54.260094: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 13:43:54.697485: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 13:43:54.701851: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 13:43:54.703512: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 13:43:54.705238: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 13:43:54.713325: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1fae494a370 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 13:43:54.716996: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 13:43:56.393401: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 13:43:56.910872: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:43:57.582796: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:43:57.589492: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:43:58.975789: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 13:43:59.025989: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 13:43:59.341199: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 4s 32ms/step
[INFOR]: Index of most vote   :680
[INFOR]: Class of most vote   :nipple
[INFOR]: Number of most vote  :108.0


[INFOR]: Index of second most vote     :746
[INFOR]: Class of second most vote     :puck, hockey puck
[INFOR]: Number of second most vote    :44.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 1s 26ms/step
[INFOR]: Toltal norm before transform: 0.7093
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0733

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 1s 26ms/step
[INFOR]: SEN training of class 57_500 before transform: 108
[INFOR]: SPE training of class 57_500 before transform: 484

[INFOR]: SEN training of class 57_500 after transform: 437
[INFOR]: SPE training of class 57_500 after transform: 379
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 26ms/step
[INFOR]: Index of most vote   :680
[INFOR]: Class of most vote   :nipple
[INFOR]: Number of most vote  :23.0


[INFOR]: Index of second most vote     :746
[INFOR]: Class of second most vote     :puck, hockey puck
[INFOR]: Number of second most vote    :9.0
[INFOR]: SEN testing of class 57_100 before transform: 23
[INFOR]: SPE testing of class 57_100 before transform: 98

[INFOR]: SEN testing of class 57_100 after transform: 81
[INFOR]: SPE testing of class 57_100 after transform: 12
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name ResNet50  --model_shape 224 224 --dataset_name cifar_100 --class_name_train 58_500 --class_name_test 58_100
2021-09-08 13:44:06.634591: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  ResNet50
dataset_name =  cifar_100
class_name_train =  58_500
class_name_test =  58_100
data_shape =  (32, 32, 3)
model_shape =  [224, 224]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 13:44:09.376575: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 13:44:09.399532: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 13:44:09.404329: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 13:44:09.412702: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:44:09.414979: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:44:09.420490: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 13:44:09.423956: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 13:44:09.430472: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 13:44:09.435683: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 13:44:09.438796: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:44:09.441011: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 13:44:09.444021: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 13:44:09.456795: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1d43385b5b0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 13:44:09.459886: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 13:44:09.462339: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 13:44:09.466787: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 13:44:09.469023: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:44:09.471387: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:44:09.473864: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 13:44:09.476283: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 13:44:09.479195: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 13:44:09.481637: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 13:44:09.484180: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:44:09.486433: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 13:44:09.925764: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 13:44:09.928553: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 13:44:09.930043: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 13:44:09.931598: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 13:44:09.938571: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1d4639bb5a0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 13:44:09.941550: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 13:44:11.598596: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 13:44:12.107905: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:44:12.765569: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:44:12.771898: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:44:14.157211: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 13:44:14.206030: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 13:44:14.519679: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 4s 32ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :183.0


[INFOR]: Index of second most vote     :408
[INFOR]: Class of second most vote     :amphibian, amphibious vehicle
[INFOR]: Number of second most vote    :110.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 1s 26ms/step
[INFOR]: Toltal norm before transform: 0.5534
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1220

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 1s 26ms/step
[INFOR]: SEN training of class 58_500 before transform: 183
[INFOR]: SPE training of class 58_500 before transform: 484

[INFOR]: SEN training of class 58_500 after transform: 456
[INFOR]: SPE training of class 58_500 after transform: 384
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 26ms/step
[INFOR]: Index of most vote   :408
[INFOR]: Class of most vote   :amphibian, amphibious vehicle
[INFOR]: Number of most vote  :32.0


[INFOR]: Index of second most vote     :674
[INFOR]: Class of second most vote     :mousetrap
[INFOR]: Number of second most vote    :32.0
[INFOR]: SEN testing of class 58_100 before transform: 32
[INFOR]: SPE testing of class 58_100 before transform: 100

[INFOR]: SEN testing of class 58_100 after transform: 89
[INFOR]: SPE testing of class 58_100 after transform: 49
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name ResNet50  --model_shape 224 224 --dataset_name cifar_100 --class_name_train 59_500 --class_name_test 59_1005
2021-09-08 13:44:21.824901: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  ResNet50
dataset_name =  cifar_100
class_name_train =  59_500
class_name_test =  59_1005
data_shape =  (32, 32, 3)
model_shape =  [224, 224]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 13:44:24.496510: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 13:44:24.521787: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 13:44:24.527237: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 13:44:24.535563: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:44:24.537940: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:44:24.543375: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 13:44:24.546815: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 13:44:24.553217: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 13:44:24.558405: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 13:44:24.561500: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:44:24.563728: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 13:44:24.565680: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 13:44:24.577829: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1c2b7ac2490 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 13:44:24.581191: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 13:44:24.583398: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 13:44:24.587804: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 13:44:24.590035: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:44:24.592324: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:44:24.594668: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 13:44:24.596839: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 13:44:24.599028: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 13:44:24.601302: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 13:44:24.604089: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:44:24.606271: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 13:44:25.034176: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 13:44:25.037271: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 13:44:25.038769: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 13:44:25.040319: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 13:44:25.047691: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1c2e167f4c0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 13:44:25.050567: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 13:44:26.701495: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 13:44:27.206289: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:44:27.860182: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:44:27.866457: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:44:29.224468: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 13:44:29.274508: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 13:44:29.586877: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 4s 31ms/step
[INFOR]: Index of most vote   :183
[INFOR]: Class of most vote   :Kerry blue terrier
[INFOR]: Number of most vote  :33.0


[INFOR]: Index of second most vote     :251
[INFOR]: Class of second most vote     :dalmatian, coach dog, carriage dog
[INFOR]: Number of second most vote    :29.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 1s 26ms/step
[INFOR]: Toltal norm before transform: 0.9230
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0073

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 1s 26ms/step
[INFOR]: SEN training of class 59_500 before transform: 33
[INFOR]: SPE training of class 59_500 before transform: 496

[INFOR]: SEN training of class 59_500 after transform: 438
[INFOR]: SPE training of class 59_500 after transform: 321
[INFOR]

==================== TESTING STAGE ====================


Traceback (most recent call last):
  File "main.py", line 252, in <module>
    main(FLAGS)
  File "main.py", line 113, in main
    x_test, y_test = get_data(FLAGS.dataset_name, 'test', FLAGS.class_name_test)
  File "C:\Users\LauNT\Desktop\topology\generate\utils.py", line 59, in get_data
    else: raise ValueError('[ERROR]: path to data not found')
ValueError: [ERROR]: path to data not found

C:\Users\LauNT\Desktop\topology>python main.py --model_name ResNet50  --model_shape 224 224 --dataset_name cifar_100 --class_name_train 60_500 --class_name_test 60_100
2021-09-08 13:44:36.413399: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  ResNet50
dataset_name =  cifar_100
class_name_train =  60_500
class_name_test =  60_100
data_shape =  (32, 32, 3)
model_shape =  [224, 224]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 13:44:39.101579: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 13:44:39.126229: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 13:44:39.131492: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 13:44:39.140026: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:44:39.142238: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:44:39.147761: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 13:44:39.151405: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 13:44:39.157865: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 13:44:39.163176: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 13:44:39.166249: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:44:39.168480: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 13:44:39.170480: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 13:44:39.182664: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x22d36d2fac0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 13:44:39.185851: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 13:44:39.188149: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 13:44:39.192810: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 13:44:39.195173: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:44:39.197389: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:44:39.199676: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 13:44:39.201852: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 13:44:39.204506: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 13:44:39.206816: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 13:44:39.209167: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:44:39.211663: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 13:44:39.717199: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 13:44:39.720400: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 13:44:39.722131: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 13:44:39.723791: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 13:44:39.730924: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x22d64c5abe0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 13:44:39.733949: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 13:44:41.402192: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 13:44:41.912048: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:44:42.650764: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:44:42.657448: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:44:44.026856: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 13:44:44.081281: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 13:44:44.395467: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 4s 33ms/step
[INFOR]: Index of most vote   :499
[INFOR]: Class of most vote   :cleaver, meat cleaver, chopper
[INFOR]: Number of most vote  :54.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :47.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 1s 26ms/step
[INFOR]: Toltal norm before transform: 0.8745
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.2375

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 1s 27ms/step
[INFOR]: SEN training of class 60_500 before transform: 54
[INFOR]: SPE training of class 60_500 before transform: 499

[INFOR]: SEN training of class 60_500 after transform: 466
[INFOR]: SPE training of class 60_500 after transform: 375
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 26ms/step
[INFOR]: Index of most vote   :147
[INFOR]: Class of most vote   :grey whale, gray whale, devilfish, Eschrichtius gibbosus, Eschrichtius robustus
[INFOR]: Number of most vote  :11.0


[INFOR]: Index of second most vote     :622
[INFOR]: Class of second most vote     :lens cap, lens cover
[INFOR]: Number of second most vote    :10.0
[INFOR]: SEN testing of class 60_100 before transform: 11
[INFOR]: SPE testing of class 60_100 before transform: 100

[INFOR]: SEN testing of class 60_100 after transform: 93
[INFOR]: SPE testing of class 60_100 after transform: 40
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name ResNet50  --model_shape 224 224 --dataset_name cifar_100 --class_name_train 61_500 --class_name_test 61_100
2021-09-08 13:44:51.833311: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  ResNet50
dataset_name =  cifar_100
class_name_train =  61_500
class_name_test =  61_100
data_shape =  (32, 32, 3)
model_shape =  [224, 224]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 13:44:54.491175: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 13:44:54.516754: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 13:44:54.521958: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 13:44:54.530078: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:44:54.532327: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:44:54.537894: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 13:44:54.542028: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 13:44:54.548708: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 13:44:54.553709: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 13:44:54.556808: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:44:54.559102: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 13:44:54.561097: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 13:44:54.574186: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1b3b60e1600 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 13:44:54.577423: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 13:44:54.579600: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 13:44:54.584315: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 13:44:54.586560: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:44:54.588783: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:44:54.590987: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 13:44:54.593277: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 13:44:54.595638: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 13:44:54.597882: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 13:44:54.600196: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:44:54.602603: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 13:44:55.071512: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 13:44:55.074149: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 13:44:55.075698: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 13:44:55.077323: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 13:44:55.085168: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1b3e44cf6e0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 13:44:55.088171: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 13:44:56.757723: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 13:44:57.276163: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:44:57.973149: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:44:57.979493: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:44:59.377180: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 13:44:59.427583: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 13:44:59.738600: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 4s 32ms/step
[INFOR]: Index of most vote   :680
[INFOR]: Class of most vote   :nipple
[INFOR]: Number of most vote  :82.0


[INFOR]: Index of second most vote     :551
[INFOR]: Class of second most vote     :face powder
[INFOR]: Number of second most vote    :78.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 1s 27ms/step
[INFOR]: Toltal norm before transform: 0.8214
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1592

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 1s 27ms/step
[INFOR]: SEN training of class 61_500 before transform: 82
[INFOR]: SPE training of class 61_500 before transform: 485

[INFOR]: SEN training of class 61_500 after transform: 492
[INFOR]: SPE training of class 61_500 after transform: 409
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 27ms/step
[INFOR]: Index of most vote   :551
[INFOR]: Class of most vote   :face powder
[INFOR]: Number of most vote  :17.0


[INFOR]: Index of second most vote     :728
[INFOR]: Class of second most vote     :plastic bag
[INFOR]: Number of second most vote    :13.0
[INFOR]: SEN testing of class 61_100 before transform: 17
[INFOR]: SPE testing of class 61_100 before transform: 98

[INFOR]: SEN testing of class 61_100 after transform: 98
[INFOR]: SPE testing of class 61_100 after transform: 55
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name ResNet50  --model_shape 224 224 --dataset_name cifar_100 --class_name_train 62_500 --class_name_test 62_100
2021-09-08 13:45:07.155518: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  ResNet50
dataset_name =  cifar_100
class_name_train =  62_500
class_name_test =  62_100
data_shape =  (32, 32, 3)
model_shape =  [224, 224]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 13:45:09.864598: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 13:45:09.890846: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 13:45:09.895559: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 13:45:09.903777: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:45:09.906039: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:45:09.911290: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 13:45:09.914756: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 13:45:09.921109: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 13:45:09.926264: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 13:45:09.929238: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:45:09.931414: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 13:45:09.933915: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 13:45:09.946290: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x29033e77c00 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 13:45:09.949425: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 13:45:09.951597: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 13:45:09.956538: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 13:45:09.958760: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:45:09.961016: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:45:09.963581: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 13:45:09.965965: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 13:45:09.968394: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 13:45:09.970613: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 13:45:09.973202: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:45:09.975416: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 13:45:10.407593: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 13:45:10.410521: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 13:45:10.412000: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 13:45:10.413902: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 13:45:10.420686: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x2905ccbd410 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 13:45:10.423618: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 13:45:12.112830: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 13:45:12.646431: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:45:13.329354: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:45:13.335161: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:45:14.741345: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 13:45:14.789937: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 13:45:15.125283: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 4s 34ms/step
[INFOR]: Index of most vote   :714
[INFOR]: Class of most vote   :pick, plectrum, plectron
[INFOR]: Number of most vote  :127.0


[INFOR]: Index of second most vote     :392
[INFOR]: Class of second most vote     :rock beauty, Holocanthus tricolor
[INFOR]: Number of second most vote    :118.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 1s 26ms/step
[INFOR]: Toltal norm before transform: 0.7037
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1441

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 1s 26ms/step
[INFOR]: SEN training of class 62_500 before transform: 127
[INFOR]: SPE training of class 62_500 before transform: 488

[INFOR]: SEN training of class 62_500 after transform: 482
[INFOR]: SPE training of class 62_500 after transform: 388
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 27ms/step
[INFOR]: Index of most vote   :714
[INFOR]: Class of most vote   :pick, plectrum, plectron
[INFOR]: Number of most vote  :26.0


[INFOR]: Index of second most vote     :392
[INFOR]: Class of second most vote     :rock beauty, Holocanthus tricolor
[INFOR]: Number of second most vote    :18.0
[INFOR]: SEN testing of class 62_100 before transform: 26
[INFOR]: SPE testing of class 62_100 before transform: 97

[INFOR]: SEN testing of class 62_100 after transform: 95
[INFOR]: SPE testing of class 62_100 after transform: 42
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name ResNet50  --model_shape 224 224 --dataset_name cifar_100 --class_name_train 63_500 --class_name_test 63_100
2021-09-08 13:45:22.498839: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  ResNet50
dataset_name =  cifar_100
class_name_train =  63_500
class_name_test =  63_100
data_shape =  (32, 32, 3)
model_shape =  [224, 224]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 13:45:25.198938: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 13:45:25.224774: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 13:45:25.229717: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 13:45:25.238240: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:45:25.241338: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:45:25.247117: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 13:45:25.250889: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 13:45:25.257692: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 13:45:25.265192: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 13:45:25.268575: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:45:25.270929: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 13:45:25.272951: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 13:45:25.285278: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1bcb3720850 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 13:45:25.288498: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 13:45:25.290660: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 13:45:25.295592: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 13:45:25.297848: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:45:25.300149: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:45:25.302573: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 13:45:25.304860: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 13:45:25.307117: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 13:45:25.309340: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 13:45:25.311867: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:45:25.314265: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 13:45:25.755074: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 13:45:25.757729: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 13:45:25.759196: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 13:45:25.760834: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 13:45:25.767778: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1bcdfa34fe0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 13:45:25.770634: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 13:45:27.442991: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 13:45:27.960373: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:45:28.639437: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:45:28.646953: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:45:30.091938: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 13:45:30.141677: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 13:45:30.467824: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 4s 31ms/step
[INFOR]: Index of most vote   :335
[INFOR]: Class of most vote   :fox squirrel, eastern fox squirrel, Sciurus niger
[INFOR]: Number of most vote  :92.0


[INFOR]: Index of second most vote     :103
[INFOR]: Class of second most vote     :platypus, duckbill, duckbilled platypus, duck-billed platypus, Ornithorhynchus anatinus
[INFOR]: Number of second most vote    :42.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 1s 27ms/step
[INFOR]: Toltal norm before transform: 0.7669
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0468

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 1s 26ms/step
[INFOR]: SEN training of class 63_500 before transform: 92
[INFOR]: SPE training of class 63_500 before transform: 483

[INFOR]: SEN training of class 63_500 after transform: 387
[INFOR]: SPE training of class 63_500 after transform: 349
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 26ms/step
[INFOR]: Index of most vote   :335
[INFOR]: Class of most vote   :fox squirrel, eastern fox squirrel, Sciurus niger
[INFOR]: Number of most vote  :26.0


[INFOR]: Index of second most vote     :330
[INFOR]: Class of second most vote     :wood rabbit, cottontail, cottontail rabbit
[INFOR]: Number of second most vote    :10.0
[INFOR]: SEN testing of class 63_100 before transform: 26
[INFOR]: SPE testing of class 63_100 before transform: 91

[INFOR]: SEN testing of class 63_100 after transform: 77
[INFOR]: SPE testing of class 63_100 after transform: 33
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name ResNet50  --model_shape 224 224 --dataset_name cifar_100 --class_name_train 64_500 --class_name_test 64_100
2021-09-08 13:45:37.776604: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  ResNet50
dataset_name =  cifar_100
class_name_train =  64_500
class_name_test =  64_100
data_shape =  (32, 32, 3)
model_shape =  [224, 224]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 13:45:40.438786: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 13:45:40.463431: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 13:45:40.468944: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 13:45:40.477171: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:45:40.479423: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:45:40.485139: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 13:45:40.488948: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 13:45:40.495308: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 13:45:40.500468: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 13:45:40.503528: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:45:40.505998: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 13:45:40.507984: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 13:45:40.520214: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x29833043f60 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 13:45:40.523424: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 13:45:40.525674: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 13:45:40.530174: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 13:45:40.532392: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:45:40.534691: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:45:40.537187: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 13:45:40.539383: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 13:45:40.541565: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 13:45:40.543890: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 13:45:40.546687: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:45:40.548934: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 13:45:40.976534: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 13:45:40.979078: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 13:45:40.980526: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 13:45:40.982147: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 13:45:40.988988: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x29863412b30 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 13:45:40.991819: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 13:45:42.651239: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 13:45:43.162746: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:45:43.848976: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:45:43.855435: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:45:45.264729: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 13:45:45.314179: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 13:45:45.629223: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 4s 32ms/step
[INFOR]: Index of most vote   :358
[INFOR]: Class of most vote   :polecat, fitch, foulmart, foumart, Mustela putorius
[INFOR]: Number of most vote  :45.0


[INFOR]: Index of second most vote     :335
[INFOR]: Class of second most vote     :fox squirrel, eastern fox squirrel, Sciurus niger
[INFOR]: Number of second most vote    :43.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 1s 26ms/step
[INFOR]: Toltal norm before transform: 0.8970
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.2622

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 1s 26ms/step
[INFOR]: SEN training of class 64_500 before transform: 45
[INFOR]: SPE training of class 64_500 before transform: 496

[INFOR]: SEN training of class 64_500 after transform: 362
[INFOR]: SPE training of class 64_500 after transform: 312
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 27ms/step
[INFOR]: Index of most vote   :358
[INFOR]: Class of most vote   :polecat, fitch, foulmart, foumart, Mustela putorius
[INFOR]: Number of most vote  :15.0


[INFOR]: Index of second most vote     :335
[INFOR]: Class of second most vote     :fox squirrel, eastern fox squirrel, Sciurus niger
[INFOR]: Number of second most vote    :12.0
[INFOR]: SEN testing of class 64_100 before transform: 15
[INFOR]: SPE testing of class 64_100 before transform: 100

[INFOR]: SEN testing of class 64_100 after transform: 93
[INFOR]: SPE testing of class 64_100 after transform: 17
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name ResNet50  --model_shape 224 224 --dataset_name cifar_100 --class_name_train 65_500 --class_name_test 65_100
2021-09-08 13:45:52.925969: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  ResNet50
dataset_name =  cifar_100
class_name_train =  65_500
class_name_test =  65_100
data_shape =  (32, 32, 3)
model_shape =  [224, 224]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 13:45:55.627981: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 13:45:55.652030: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 13:45:55.656982: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 13:45:55.664941: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:45:55.667366: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:45:55.672568: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 13:45:55.676288: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 13:45:55.682683: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 13:45:55.687574: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 13:45:55.690470: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:45:55.692720: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 13:45:55.694798: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 13:45:55.706806: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1baba048d10 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 13:45:55.709989: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 13:45:55.712057: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 13:45:55.716713: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 13:45:55.718883: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:45:55.721056: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:45:55.723276: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 13:45:55.725499: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 13:45:55.727754: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 13:45:55.729990: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 13:45:55.732265: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:45:55.734572: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 13:45:56.162974: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 13:45:56.166214: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 13:45:56.167661: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 13:45:56.169226: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 13:45:56.176091: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1badf5ca300 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 13:45:56.179144: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 13:45:57.829087: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 13:45:58.336222: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:45:59.017612: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:45:59.024243: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:46:00.418271: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 13:46:00.466990: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 13:46:00.781750: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 4s 31ms/step
[INFOR]: Index of most vote   :330
[INFOR]: Class of most vote   :wood rabbit, cottontail, cottontail rabbit
[INFOR]: Number of most vote  :50.0


[INFOR]: Index of second most vote     :334
[INFOR]: Class of second most vote     :porcupine, hedgehog
[INFOR]: Number of second most vote    :40.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 1s 26ms/step
[INFOR]: Toltal norm before transform: 0.9039
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.3765

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 1s 26ms/step
[INFOR]: SEN training of class 65_500 before transform: 50
[INFOR]: SPE training of class 65_500 before transform: 500

[INFOR]: SEN training of class 65_500 after transform: 366
[INFOR]: SPE training of class 65_500 after transform: 308
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 26ms/step
[INFOR]: Index of most vote   :330
[INFOR]: Class of most vote   :wood rabbit, cottontail, cottontail rabbit
[INFOR]: Number of most vote  :13.0


[INFOR]: Index of second most vote     :330
[INFOR]: Class of second most vote     :wood rabbit, cottontail, cottontail rabbit
[INFOR]: Number of second most vote    :9.0
[INFOR]: SEN testing of class 65_100 before transform: 13
[INFOR]: SPE testing of class 65_100 before transform: 100

[INFOR]: SEN testing of class 65_100 after transform: 83
[INFOR]: SPE testing of class 65_100 after transform: 20
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name ResNet50  --model_shape 224 224 --dataset_name cifar_100 --class_name_train 66_500 --class_name_test 66_100
2021-09-08 13:46:08.030506: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  ResNet50
dataset_name =  cifar_100
class_name_train =  66_500
class_name_test =  66_100
data_shape =  (32, 32, 3)
model_shape =  [224, 224]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 13:46:10.706246: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 13:46:10.732272: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 13:46:10.737513: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 13:46:10.745399: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:46:10.747773: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:46:10.752868: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 13:46:10.756488: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 13:46:10.762958: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 13:46:10.767810: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 13:46:10.770723: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:46:10.772948: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 13:46:10.774971: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 13:46:10.787485: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x212340bfe60 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 13:46:10.790537: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 13:46:10.792723: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 13:46:10.797163: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 13:46:10.799360: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:46:10.801556: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:46:10.804063: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 13:46:10.806396: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 13:46:10.808639: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 13:46:10.810864: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 13:46:10.813172: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:46:10.815571: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 13:46:11.243932: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 13:46:11.247114: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 13:46:11.248719: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 13:46:11.250578: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 13:46:11.257904: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x21262dfac10 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 13:46:11.261117: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 13:46:12.925944: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 13:46:13.433167: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:46:14.085033: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:46:14.091223: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:46:15.446764: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 13:46:15.496168: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 13:46:15.810114: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 4s 31ms/step
[INFOR]: Index of most vote   :383
[INFOR]: Class of most vote   :Madagascar cat, ring-tailed lemur, Lemur catta
[INFOR]: Number of most vote  :78.0


[INFOR]: Index of second most vote     :335
[INFOR]: Class of second most vote     :fox squirrel, eastern fox squirrel, Sciurus niger
[INFOR]: Number of second most vote    :36.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 1s 26ms/step
[INFOR]: Toltal norm before transform: 0.8473
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.2657

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 1s 26ms/step
[INFOR]: SEN training of class 66_500 before transform: 78
[INFOR]: SPE training of class 66_500 before transform: 496

[INFOR]: SEN training of class 66_500 after transform: 348
[INFOR]: SPE training of class 66_500 after transform: 333
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 27ms/step
[INFOR]: Index of most vote   :383
[INFOR]: Class of most vote   :Madagascar cat, ring-tailed lemur, Lemur catta
[INFOR]: Number of most vote  :8.0


[INFOR]: Index of second most vote     :297
[INFOR]: Class of second most vote     :sloth bear, Melursus ursinus, Ursus ursinus
[INFOR]: Number of second most vote    :7.0
[INFOR]: SEN testing of class 66_100 before transform: 8
[INFOR]: SPE testing of class 66_100 before transform: 100

[INFOR]: SEN testing of class 66_100 after transform: 74
[INFOR]: SPE testing of class 66_100 after transform: 29
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name ResNet50  --model_shape 224 224 --dataset_name cifar_100 --class_name_train 67_500 --class_name_test 67_100
2021-09-08 13:46:23.076192: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  ResNet50
dataset_name =  cifar_100
class_name_train =  67_500
class_name_test =  67_100
data_shape =  (32, 32, 3)
model_shape =  [224, 224]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 13:46:25.761998: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 13:46:25.787912: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 13:46:25.792720: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 13:46:25.800864: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:46:25.803157: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:46:25.808457: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 13:46:25.811889: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 13:46:25.818246: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 13:46:25.823146: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 13:46:25.826138: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:46:25.828395: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 13:46:25.830315: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 13:46:25.842484: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1bab667c640 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 13:46:25.845724: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 13:46:25.847958: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 13:46:25.852450: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 13:46:25.854709: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:46:25.857026: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:46:25.859259: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 13:46:25.861705: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 13:46:25.863921: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 13:46:25.866170: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 13:46:25.868502: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:46:25.870708: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 13:46:26.302584: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 13:46:26.305208: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 13:46:26.306787: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 13:46:26.308361: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 13:46:26.315211: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1bae037d0a0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 13:46:26.318221: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 13:46:27.971843: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 13:46:28.477886: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:46:29.140525: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:46:29.147059: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:46:30.517797: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 13:46:30.566675: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 13:46:30.876475: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 4s 31ms/step
[INFOR]: Index of most vote   :392
[INFOR]: Class of most vote   :rock beauty, Holocanthus tricolor
[INFOR]: Number of most vote  :60.0


[INFOR]: Index of second most vote     :149
[INFOR]: Class of second most vote     :dugong, Dugong dugon
[INFOR]: Number of second most vote    :43.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 1s 25ms/step
[INFOR]: Toltal norm before transform: 0.8803
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1023

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 1s 25ms/step
[INFOR]: SEN training of class 67_500 before transform: 60
[INFOR]: SPE training of class 67_500 before transform: 487

[INFOR]: SEN training of class 67_500 after transform: 369
[INFOR]: SPE training of class 67_500 after transform: 361
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 26ms/step
[INFOR]: Index of most vote   :392
[INFOR]: Class of most vote   :rock beauty, Holocanthus tricolor
[INFOR]: Number of most vote  :15.0


[INFOR]: Index of second most vote     :149
[INFOR]: Class of second most vote     :dugong, Dugong dugon
[INFOR]: Number of second most vote    :8.0
[INFOR]: SEN testing of class 67_100 before transform: 15
[INFOR]: SPE testing of class 67_100 before transform: 98

[INFOR]: SEN testing of class 67_100 after transform: 87
[INFOR]: SPE testing of class 67_100 after transform: 36
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name ResNet50  --model_shape 224 224 --dataset_name cifar_100 --class_name_train 68_500 --class_name_test 68_100
2021-09-08 13:46:38.040817: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  ResNet50
dataset_name =  cifar_100
class_name_train =  68_500
class_name_test =  68_100
data_shape =  (32, 32, 3)
model_shape =  [224, 224]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 13:46:40.705577: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 13:46:40.729828: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 13:46:40.734729: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 13:46:40.742837: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:46:40.744984: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:46:40.750428: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 13:46:40.753828: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 13:46:40.760171: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 13:46:40.765099: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 13:46:40.768399: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:46:40.770679: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 13:46:40.772608: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 13:46:40.784603: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x10d36f4dcd0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 13:46:40.788287: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 13:46:40.790367: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 13:46:40.794735: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 13:46:40.797009: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:46:40.799181: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:46:40.801442: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 13:46:40.803619: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 13:46:40.805790: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 13:46:40.808196: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 13:46:40.810487: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:46:40.812725: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 13:46:41.250558: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 13:46:41.253518: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 13:46:41.254966: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 13:46:41.256870: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 13:46:41.263765: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x10d5f01efe0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 13:46:41.266613: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 13:46:42.891124: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 13:46:43.396369: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:46:44.054244: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:46:44.060915: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:46:45.428430: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 13:46:45.480783: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 13:46:45.792282: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 4s 31ms/step
[INFOR]: Index of most vote   :906
[INFOR]: Class of most vote   :Windsor tie
[INFOR]: Number of most vote  :39.0


[INFOR]: Index of second most vote     :149
[INFOR]: Class of second most vote     :dugong, Dugong dugon
[INFOR]: Number of second most vote    :29.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 1s 26ms/step
[INFOR]: Toltal norm before transform: 0.9212
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1122

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 1s 26ms/step
[INFOR]: SEN training of class 68_500 before transform: 39
[INFOR]: SPE training of class 68_500 before transform: 489

[INFOR]: SEN training of class 68_500 after transform: 402
[INFOR]: SPE training of class 68_500 after transform: 324
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 26ms/step
[INFOR]: Index of most vote   :906
[INFOR]: Class of most vote   :Windsor tie
[INFOR]: Number of most vote  :11.0


[INFOR]: Index of second most vote     :149
[INFOR]: Class of second most vote     :dugong, Dugong dugon
[INFOR]: Number of second most vote    :8.0
[INFOR]: SEN testing of class 68_100 before transform: 11
[INFOR]: SPE testing of class 68_100 before transform: 97

[INFOR]: SEN testing of class 68_100 after transform: 57
[INFOR]: SPE testing of class 68_100 after transform: 5
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name ResNet50  --model_shape 224 224 --dataset_name cifar_100 --class_name_train 69_500 --class_name_test 69_100
2021-09-08 13:46:53.006346: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  ResNet50
dataset_name =  cifar_100
class_name_train =  69_500
class_name_test =  69_100
data_shape =  (32, 32, 3)
model_shape =  [224, 224]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 13:46:55.700135: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 13:46:55.733088: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 13:46:55.738027: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 13:46:55.746200: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:46:55.748533: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:46:55.753795: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 13:46:55.757286: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 13:46:55.763816: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 13:46:55.768928: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 13:46:55.771890: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:46:55.774059: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 13:46:55.776200: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 13:46:55.788708: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x14bb5d84a00 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 13:46:55.791824: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 13:46:55.794215: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 13:46:55.798760: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 13:46:55.800942: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:46:55.803112: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:46:55.805591: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 13:46:55.807891: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 13:46:55.810288: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 13:46:55.812635: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 13:46:55.815024: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:46:55.817428: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 13:46:56.278536: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 13:46:56.281383: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 13:46:56.282850: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 13:46:56.284537: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 13:46:56.291580: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x14be1d9c790 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 13:46:56.294613: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 13:46:57.957159: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 13:46:58.463267: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:46:59.130910: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:46:59.137056: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:47:00.499983: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 13:47:00.549786: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 13:47:00.860295: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 4s 31ms/step
[INFOR]: Index of most vote   :680
[INFOR]: Class of most vote   :nipple
[INFOR]: Number of most vote  :34.0


[INFOR]: Index of second most vote     :623
[INFOR]: Class of second most vote     :letter opener, paper knife, paperknife
[INFOR]: Number of second most vote    :23.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 1s 26ms/step
[INFOR]: Toltal norm before transform: 0.9229
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1033

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 1s 26ms/step
[INFOR]: SEN training of class 69_500 before transform: 34
[INFOR]: SPE training of class 69_500 before transform: 491

[INFOR]: SEN training of class 69_500 after transform: 336
[INFOR]: SPE training of class 69_500 after transform: 300
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 26ms/step
[INFOR]: Index of most vote   :683
[INFOR]: Class of most vote   :oboe, hautboy, hautbois
[INFOR]: Number of most vote  :8.0


[INFOR]: Index of second most vote     :811
[INFOR]: Class of second most vote     :space heater
[INFOR]: Number of second most vote    :6.0
[INFOR]: SEN testing of class 69_100 before transform: 8
[INFOR]: SPE testing of class 69_100 before transform: 100

[INFOR]: SEN testing of class 69_100 after transform: 88
[INFOR]: SPE testing of class 69_100 after transform: 4
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name ResNet50  --model_shape 224 224 --dataset_name cifar_100 --class_name_train 70_500 --class_name_test 70_100
2021-09-08 13:47:08.137166: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  ResNet50
dataset_name =  cifar_100
class_name_train =  70_500
class_name_test =  70_100
data_shape =  (32, 32, 3)
model_shape =  [224, 224]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 13:47:10.801816: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 13:47:10.825360: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 13:47:10.829854: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 13:47:10.837693: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:47:10.839861: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:47:10.845003: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 13:47:10.848449: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 13:47:10.854753: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 13:47:10.860076: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 13:47:10.863244: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:47:10.865440: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 13:47:10.867361: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 13:47:10.879194: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x22ab78d7050 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 13:47:10.882234: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 13:47:10.884395: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 13:47:10.888997: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 13:47:10.891196: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:47:10.893426: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:47:10.895694: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 13:47:10.897899: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 13:47:10.900102: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 13:47:10.902515: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 13:47:10.904778: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:47:10.907318: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 13:47:11.332349: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 13:47:11.334940: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 13:47:11.336575: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 13:47:11.338177: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 13:47:11.344827: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x22adf889b60 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 13:47:11.347787: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 13:47:12.995281: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 13:47:13.498537: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:47:14.157073: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:47:14.163260: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:47:15.684605: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 13:47:15.735562: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 13:47:16.060932: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 4s 32ms/step
[INFOR]: Index of most vote   :714
[INFOR]: Class of most vote   :pick, plectrum, plectron
[INFOR]: Number of most vote  :146.0


[INFOR]: Index of second most vote     :392
[INFOR]: Class of second most vote     :rock beauty, Holocanthus tricolor
[INFOR]: Number of second most vote    :53.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 1s 26ms/step
[INFOR]: Toltal norm before transform: 0.6517
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.4174

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 1s 26ms/step
[INFOR]: SEN training of class 70_500 before transform: 146
[INFOR]: SPE training of class 70_500 before transform: 483

[INFOR]: SEN training of class 70_500 after transform: 444
[INFOR]: SPE training of class 70_500 after transform: 375
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 26ms/step
[INFOR]: Index of most vote   :714
[INFOR]: Class of most vote   :pick, plectrum, plectron
[INFOR]: Number of most vote  :30.0


[INFOR]: Index of second most vote     :392
[INFOR]: Class of second most vote     :rock beauty, Holocanthus tricolor
[INFOR]: Number of second most vote    :13.0
[INFOR]: SEN testing of class 70_100 before transform: 30
[INFOR]: SPE testing of class 70_100 before transform: 98

[INFOR]: SEN testing of class 70_100 after transform: 99
[INFOR]: SPE testing of class 70_100 after transform: 11
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name ResNet50  --model_shape 224 224 --dataset_name cifar_100 --class_name_train 71_500 --class_name_test 71_100
2021-09-08 13:47:23.412240: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  ResNet50
dataset_name =  cifar_100
class_name_train =  71_500
class_name_test =  71_100
data_shape =  (32, 32, 3)
model_shape =  [224, 224]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 13:47:26.104324: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 13:47:26.128027: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 13:47:26.132683: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 13:47:26.140658: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:47:26.143063: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:47:26.148419: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 13:47:26.152118: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 13:47:26.159254: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 13:47:26.164402: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 13:47:26.167749: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:47:26.170146: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 13:47:26.172604: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 13:47:26.185188: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x254b96807d0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 13:47:26.188669: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 13:47:26.190881: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 13:47:26.195650: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 13:47:26.197925: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:47:26.200425: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:47:26.202647: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 13:47:26.204829: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 13:47:26.207122: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 13:47:26.209918: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 13:47:26.212390: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:47:26.214644: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 13:47:26.654077: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 13:47:26.656813: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 13:47:26.658630: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 13:47:26.660382: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 13:47:26.667933: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x254e95662e0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 13:47:26.670853: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 13:47:28.361645: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 13:47:28.875340: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:47:29.549405: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:47:29.555636: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:47:30.950559: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 13:47:31.006448: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 13:47:31.343519: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 4s 33ms/step
[INFOR]: Index of most vote   :623
[INFOR]: Class of most vote   :letter opener, paper knife, paperknife
[INFOR]: Number of most vote  :44.0


[INFOR]: Index of second most vote     :900
[INFOR]: Class of second most vote     :water tower
[INFOR]: Number of second most vote    :37.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 1s 26ms/step
[INFOR]: Toltal norm before transform: 0.8928
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.2452

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 1s 27ms/step
[INFOR]: SEN training of class 71_500 before transform: 44
[INFOR]: SPE training of class 71_500 before transform: 497

[INFOR]: SEN training of class 71_500 after transform: 444
[INFOR]: SPE training of class 71_500 after transform: 385
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 28ms/step
[INFOR]: Index of most vote   :901
[INFOR]: Class of most vote   :whiskey jug
[INFOR]: Number of most vote  :11.0


[INFOR]: Index of second most vote     :499
[INFOR]: Class of second most vote     :cleaver, meat cleaver, chopper
[INFOR]: Number of second most vote    :10.0
[INFOR]: SEN testing of class 71_100 before transform: 11
[INFOR]: SPE testing of class 71_100 before transform: 100

[INFOR]: SEN testing of class 71_100 after transform: 97
[INFOR]: SPE testing of class 71_100 after transform: 40
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name ResNet50  --model_shape 224 224 --dataset_name cifar_100 --class_name_train 72_500 --class_name_test 72_100
2021-09-08 13:47:38.735201: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  ResNet50
dataset_name =  cifar_100
class_name_train =  72_500
class_name_test =  72_100
data_shape =  (32, 32, 3)
model_shape =  [224, 224]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 13:47:41.433176: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 13:47:41.458758: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 13:47:41.463566: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 13:47:41.471832: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:47:41.474374: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:47:41.479843: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 13:47:41.483394: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 13:47:41.490288: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 13:47:41.495551: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 13:47:41.499104: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:47:41.501470: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 13:47:41.503769: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 13:47:41.516654: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x271387d67c0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 13:47:41.519844: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 13:47:41.522115: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 13:47:41.526812: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 13:47:41.529185: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:47:41.531467: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:47:41.533768: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 13:47:41.536246: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 13:47:41.538646: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 13:47:41.541000: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 13:47:41.543382: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:47:41.545676: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 13:47:42.002493: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 13:47:42.004965: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 13:47:42.007010: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 13:47:42.008803: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 13:47:42.017307: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x27167d77f60 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 13:47:42.020523: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 13:47:43.879511: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 13:47:44.706624: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:47:45.419070: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:47:45.424831: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:47:46.920345: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 13:47:46.971539: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 13:47:47.336293: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 5s 35ms/step
[INFOR]: Index of most vote   :103
[INFOR]: Class of most vote   :platypus, duckbill, duckbilled platypus, duck-billed platypus, Ornithorhynchus anatinus
[INFOR]: Number of most vote  :43.0


[INFOR]: Index of second most vote     :148
[INFOR]: Class of second most vote     :killer whale, killer, orca, grampus, sea wolf, Orcinus orca
[INFOR]: Number of second most vote    :43.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 2s 27ms/step
[INFOR]: Toltal norm before transform: 0.9159
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.3332

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 1s 26ms/step
[INFOR]: SEN training of class 72_500 before transform: 43
[INFOR]: SPE training of class 72_500 before transform: 484

[INFOR]: SEN training of class 72_500 after transform: 365
[INFOR]: SPE training of class 72_500 after transform: 306
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 27ms/step
[INFOR]: Index of most vote   :103
[INFOR]: Class of most vote   :platypus, duckbill, duckbilled platypus, duck-billed platypus, Ornithorhynchus anatinus
[INFOR]: Number of most vote  :7.0


[INFOR]: Index of second most vote     :148
[INFOR]: Class of second most vote     :killer whale, killer, orca, grampus, sea wolf, Orcinus orca
[INFOR]: Number of second most vote    :7.0
[INFOR]: SEN testing of class 72_100 before transform: 7
[INFOR]: SPE testing of class 72_100 before transform: 97

[INFOR]: SEN testing of class 72_100 after transform: 83
[INFOR]: SPE testing of class 72_100 after transform: 13
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name ResNet50  --model_shape 224 224 --dataset_name cifar_100 --class_name_train 73_500 --class_name_test 73_100
2021-09-08 13:47:55.197120: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  ResNet50
dataset_name =  cifar_100
class_name_train =  73_500
class_name_test =  73_100
data_shape =  (32, 32, 3)
model_shape =  [224, 224]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 13:47:58.605980: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 13:47:58.640391: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 13:47:58.645578: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 13:47:58.653941: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:47:58.656164: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:47:58.661581: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 13:47:58.665264: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 13:47:58.671673: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 13:47:58.676745: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 13:47:58.679963: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:47:58.682184: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 13:47:58.684325: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 13:47:58.696743: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1f63587aa90 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 13:47:58.699899: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 13:47:58.702077: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 13:47:58.706614: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 13:47:58.708839: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:47:58.711090: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:47:58.713426: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 13:47:58.715637: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 13:47:58.717924: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 13:47:58.720363: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 13:47:58.722828: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:47:58.725097: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 13:47:59.177452: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 13:47:59.180220: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 13:47:59.181717: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 13:47:59.183325: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 13:47:59.190328: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1f6651dee00 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 13:47:59.193371: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 13:48:00.890760: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 13:48:01.413494: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:48:02.088495: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:48:02.095120: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:48:03.884478: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 13:48:03.936782: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 13:48:04.267058: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 4s 33ms/step
[INFOR]: Index of most vote   :103
[INFOR]: Class of most vote   :platypus, duckbill, duckbilled platypus, duck-billed platypus, Ornithorhynchus anatinus
[INFOR]: Number of most vote  :67.0


[INFOR]: Index of second most vote     :683
[INFOR]: Class of second most vote     :oboe, hautboy, hautbois
[INFOR]: Number of second most vote    :34.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 1s 27ms/step
[INFOR]: Toltal norm before transform: 0.8577
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1068

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 1s 27ms/step
[INFOR]: SEN training of class 73_500 before transform: 67
[INFOR]: SPE training of class 73_500 before transform: 490

[INFOR]: SEN training of class 73_500 after transform: 422
[INFOR]: SPE training of class 73_500 after transform: 372
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 27ms/step
[INFOR]: Index of most vote   :103
[INFOR]: Class of most vote   :platypus, duckbill, duckbilled platypus, duck-billed platypus, Ornithorhynchus anatinus
[INFOR]: Number of most vote  :15.0


[INFOR]: Index of second most vote     :683
[INFOR]: Class of second most vote     :oboe, hautboy, hautbois
[INFOR]: Number of second most vote    :9.0
[INFOR]: SEN testing of class 73_100 before transform: 15
[INFOR]: SPE testing of class 73_100 before transform: 96

[INFOR]: SEN testing of class 73_100 after transform: 96
[INFOR]: SPE testing of class 73_100 after transform: 11
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name ResNet50  --model_shape 224 224 --dataset_name cifar_100 --class_name_train 74_500 --class_name_test 74_100
2021-09-08 13:48:11.798780: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  ResNet50
dataset_name =  cifar_100
class_name_train =  74_500
class_name_test =  74_100
data_shape =  (32, 32, 3)
model_shape =  [224, 224]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 13:48:14.549973: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 13:48:14.578174: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 13:48:14.582833: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 13:48:14.590898: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:48:14.593157: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:48:14.598651: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 13:48:14.602309: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 13:48:14.608729: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 13:48:14.613698: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 13:48:14.616847: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:48:14.619182: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 13:48:14.621151: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 13:48:14.633418: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x27a3aba5550 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 13:48:14.636582: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 13:48:14.638794: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 13:48:14.643488: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 13:48:14.645787: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:48:14.648093: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:48:14.650469: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 13:48:14.653011: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 13:48:14.655318: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 13:48:14.657625: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 13:48:14.659969: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:48:14.662497: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 13:48:15.103135: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 13:48:15.105660: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 13:48:15.107219: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 13:48:15.108886: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 13:48:15.115971: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x27a62dc6cb0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 13:48:15.118961: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 13:48:16.823647: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 13:48:17.352177: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:48:18.081246: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:48:18.087673: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:48:19.607939: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 13:48:19.661077: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 13:48:20.014206: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 4s 35ms/step
[INFOR]: Index of most vote   :335
[INFOR]: Class of most vote   :fox squirrel, eastern fox squirrel, Sciurus niger
[INFOR]: Number of most vote  :102.0


[INFOR]: Index of second most vote     :103
[INFOR]: Class of second most vote     :platypus, duckbill, duckbilled platypus, duck-billed platypus, Ornithorhynchus anatinus
[INFOR]: Number of second most vote    :52.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 1s 28ms/step
[INFOR]: Toltal norm before transform: 0.7613
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0611

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 1s 27ms/step
[INFOR]: SEN training of class 74_500 before transform: 102
[INFOR]: SPE training of class 74_500 before transform: 482

[INFOR]: SEN training of class 74_500 after transform: 351
[INFOR]: SPE training of class 74_500 after transform: 313
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 28ms/step
[INFOR]: Index of most vote   :335
[INFOR]: Class of most vote   :fox squirrel, eastern fox squirrel, Sciurus niger
[INFOR]: Number of most vote  :20.0


[INFOR]: Index of second most vote     :103
[INFOR]: Class of second most vote     :platypus, duckbill, duckbilled platypus, duck-billed platypus, Ornithorhynchus anatinus
[INFOR]: Number of second most vote    :10.0
[INFOR]: SEN testing of class 74_100 before transform: 20
[INFOR]: SPE testing of class 74_100 before transform: 98

[INFOR]: SEN testing of class 74_100 after transform: 84
[INFOR]: SPE testing of class 74_100 after transform: 16
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name ResNet50  --model_shape 224 224 --dataset_name cifar_100 --class_name_train 75_500 --class_name_test 75_100
2021-09-08 13:48:27.851824: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  ResNet50
dataset_name =  cifar_100
class_name_train =  75_500
class_name_test =  75_100
data_shape =  (32, 32, 3)
model_shape =  [224, 224]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 13:48:31.264956: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 13:48:31.292756: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 13:48:31.298056: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 13:48:31.306718: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:48:31.309424: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:48:31.315157: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 13:48:31.319184: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 13:48:31.331942: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 13:48:31.337524: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 13:48:31.340847: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:48:31.343221: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 13:48:31.345242: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 13:48:31.359134: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x207331b4130 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 13:48:31.362582: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 13:48:31.365447: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 13:48:31.370312: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 13:48:31.372673: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:48:31.374980: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:48:31.377327: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 13:48:31.379754: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 13:48:31.382283: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 13:48:31.384686: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 13:48:31.387787: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:48:31.390254: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 13:48:31.837676: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 13:48:31.840197: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 13:48:31.841715: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 13:48:31.843335: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 13:48:31.850226: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x2075e4c23e0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 13:48:31.853360: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 13:48:33.545035: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 13:48:34.059965: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:48:34.735647: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:48:34.742406: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:48:36.133322: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 13:48:36.184877: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 13:48:36.515498: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 4s 32ms/step
[INFOR]: Index of most vote   :361
[INFOR]: Class of most vote   :skunk, polecat, wood pussy
[INFOR]: Number of most vote  :196.0


[INFOR]: Index of second most vote     :361
[INFOR]: Class of second most vote     :skunk, polecat, wood pussy
[INFOR]: Number of second most vote    :61.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 1s 26ms/step
[INFOR]: Toltal norm before transform: 0.5541
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0488

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 1s 26ms/step
[INFOR]: SEN training of class 75_500 before transform: 196
[INFOR]: SPE training of class 75_500 before transform: 499

[INFOR]: SEN training of class 75_500 after transform: 392
[INFOR]: SPE training of class 75_500 after transform: 404
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 28ms/step
[INFOR]: Index of most vote   :361
[INFOR]: Class of most vote   :skunk, polecat, wood pussy
[INFOR]: Number of most vote  :33.0


[INFOR]: Index of second most vote     :361
[INFOR]: Class of second most vote     :skunk, polecat, wood pussy
[INFOR]: Number of second most vote    :13.0
[INFOR]: SEN testing of class 75_100 before transform: 33
[INFOR]: SPE testing of class 75_100 before transform: 100

[INFOR]: SEN testing of class 75_100 after transform: 89
[INFOR]: SPE testing of class 75_100 after transform: 33
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name ResNet50  --model_shape 224 224 --dataset_name cifar_100 --class_name_train 76_500 --class_name_test 76_100
2021-09-08 13:48:43.927692: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  ResNet50
dataset_name =  cifar_100
class_name_train =  76_500
class_name_test =  76_100
data_shape =  (32, 32, 3)
model_shape =  [224, 224]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 13:48:47.335507: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 13:48:47.366845: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 13:48:47.374161: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 13:48:47.393205: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:48:47.396442: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:48:47.403980: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 13:48:47.408753: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 13:48:47.416223: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 13:48:47.421649: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 13:48:47.424952: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:48:47.427356: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 13:48:47.429633: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 13:48:47.443093: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x27aba4c81e0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 13:48:47.446299: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 13:48:47.448738: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 13:48:47.453447: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 13:48:47.455925: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:48:47.458509: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:48:47.461118: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 13:48:47.463469: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 13:48:47.465866: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 13:48:47.468300: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 13:48:47.470653: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:48:47.472995: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 13:48:47.999900: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 13:48:48.002658: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 13:48:48.004257: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 13:48:48.005958: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 13:48:48.013468: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x27ae4fe9860 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 13:48:48.016746: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 13:48:49.993520: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 13:48:50.555310: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:48:51.355088: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:48:51.366315: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:48:53.215771: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 13:48:53.295208: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 13:48:53.672295: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 5s 34ms/step
[INFOR]: Index of most vote   :906
[INFOR]: Class of most vote   :Windsor tie
[INFOR]: Number of most vote  :101.0


[INFOR]: Index of second most vote     :708
[INFOR]: Class of second most vote     :pedestal, plinth, footstall
[INFOR]: Number of second most vote    :29.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 1s 28ms/step
[INFOR]: Toltal norm before transform: 0.7649
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0936

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 1s 27ms/step
[INFOR]: SEN training of class 76_500 before transform: 101
[INFOR]: SPE training of class 76_500 before transform: 492

[INFOR]: SEN training of class 76_500 after transform: 423
[INFOR]: SPE training of class 76_500 after transform: 379
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 28ms/step
[INFOR]: Index of most vote   :906
[INFOR]: Class of most vote   :Windsor tie
[INFOR]: Number of most vote  :20.0


[INFOR]: Index of second most vote     :708
[INFOR]: Class of second most vote     :pedestal, plinth, footstall
[INFOR]: Number of second most vote    :6.0
[INFOR]: SEN testing of class 76_100 before transform: 20
[INFOR]: SPE testing of class 76_100 before transform: 100

[INFOR]: SEN testing of class 76_100 after transform: 88
[INFOR]: SPE testing of class 76_100 after transform: 39
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name ResNet50  --model_shape 224 224 --dataset_name cifar_100 --class_name_train 77_500 --class_name_test 77_100
2021-09-08 13:49:01.661256: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  ResNet50
dataset_name =  cifar_100
class_name_train =  77_500
class_name_test =  77_100
data_shape =  (32, 32, 3)
model_shape =  [224, 224]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 13:49:05.470550: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 13:49:05.495380: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 13:49:05.500284: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 13:49:05.515415: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:49:05.517675: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:49:05.523861: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 13:49:05.527441: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 13:49:05.533900: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 13:49:05.539417: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 13:49:05.542781: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:49:05.544989: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 13:49:05.547005: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 13:49:05.559486: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x201b4d716e0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 13:49:05.562771: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 13:49:05.565007: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 13:49:05.569673: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 13:49:05.572325: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:49:05.574635: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:49:05.576888: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 13:49:05.579170: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 13:49:05.581804: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 13:49:05.584185: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 13:49:05.586618: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:49:05.589009: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 13:49:06.032497: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 13:49:06.035038: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 13:49:06.036538: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 13:49:06.038164: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 13:49:06.045350: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x201ddd36e80 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 13:49:06.048255: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 13:49:07.763555: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 13:49:08.294156: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:49:08.981366: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:49:08.987378: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:49:10.444158: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 13:49:10.493407: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 13:49:10.814750: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 4s 32ms/step
[INFOR]: Index of most vote   :149
[INFOR]: Class of most vote   :dugong, Dugong dugon
[INFOR]: Number of most vote  :58.0


[INFOR]: Index of second most vote     :113
[INFOR]: Class of second most vote     :snail
[INFOR]: Number of second most vote    :27.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 1s 26ms/step
[INFOR]: Toltal norm before transform: 0.8748
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.2042

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 1s 26ms/step
[INFOR]: SEN training of class 77_500 before transform: 58
[INFOR]: SPE training of class 77_500 before transform: 487

[INFOR]: SEN training of class 77_500 after transform: 321
[INFOR]: SPE training of class 77_500 after transform: 301
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 26ms/step
[INFOR]: Index of most vote   :149
[INFOR]: Class of most vote   :dugong, Dugong dugon
[INFOR]: Number of most vote  :13.0


[INFOR]: Index of second most vote     :334
[INFOR]: Class of second most vote     :porcupine, hedgehog
[INFOR]: Number of second most vote    :4.0
[INFOR]: SEN testing of class 77_100 before transform: 13
[INFOR]: SPE testing of class 77_100 before transform: 99

[INFOR]: SEN testing of class 77_100 after transform: 77
[INFOR]: SPE testing of class 77_100 after transform: 11
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name ResNet50  --model_shape 224 224 --dataset_name cifar_100 --class_name_train 78_500 --class_name_test 78_100
2021-09-08 13:49:18.184673: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  ResNet50
dataset_name =  cifar_100
class_name_train =  78_500
class_name_test =  78_100
data_shape =  (32, 32, 3)
model_shape =  [224, 224]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 13:49:20.931005: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 13:49:20.956324: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 13:49:20.961209: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 13:49:20.976151: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:49:20.978407: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:49:20.983900: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 13:49:20.987364: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 13:49:20.993845: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 13:49:20.999490: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 13:49:21.002516: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:49:21.004718: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 13:49:21.006715: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 13:49:21.018941: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x286b6f3c6a0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 13:49:21.022234: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 13:49:21.024406: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 13:49:21.028942: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 13:49:21.031574: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:49:21.033792: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:49:21.036057: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 13:49:21.038359: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 13:49:21.040615: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 13:49:21.042977: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 13:49:21.045254: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:49:21.047542: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 13:49:21.482134: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 13:49:21.484609: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 13:49:21.486098: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 13:49:21.487691: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 13:49:21.494502: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x286e2b4d5e0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 13:49:21.497400: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 13:49:23.161556: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 13:49:23.672293: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:49:24.341859: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:49:24.348553: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:49:25.765788: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 13:49:25.816655: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 13:49:26.165320: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 4s 32ms/step
[INFOR]: Index of most vote   :111
[INFOR]: Class of most vote   :nematode, nematode worm, roundworm
[INFOR]: Number of most vote  :93.0


[INFOR]: Index of second most vote     :68
[INFOR]: Class of second most vote     :sidewinder, horned rattlesnake, Crotalus cerastes
[INFOR]: Number of second most vote    :42.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 1s 26ms/step
[INFOR]: Toltal norm before transform: 0.7980
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1428

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 1s 26ms/step
[INFOR]: SEN training of class 78_500 before transform: 93
[INFOR]: SPE training of class 78_500 before transform: 495

[INFOR]: SEN training of class 78_500 after transform: 433
[INFOR]: SPE training of class 78_500 after transform: 384
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 28ms/step
[INFOR]: Index of most vote   :111
[INFOR]: Class of most vote   :nematode, nematode worm, roundworm
[INFOR]: Number of most vote  :27.0


[INFOR]: Index of second most vote     :68
[INFOR]: Class of second most vote     :sidewinder, horned rattlesnake, Crotalus cerastes
[INFOR]: Number of second most vote    :12.0
[INFOR]: SEN testing of class 78_100 before transform: 27
[INFOR]: SPE testing of class 78_100 before transform: 99

[INFOR]: SEN testing of class 78_100 after transform: 90
[INFOR]: SPE testing of class 78_100 after transform: 33
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name ResNet50  --model_shape 224 224 --dataset_name cifar_100 --class_name_train 79_500 --class_name_test 79_100
2021-09-08 13:49:33.498457: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  ResNet50
dataset_name =  cifar_100
class_name_train =  79_500
class_name_test =  79_100
data_shape =  (32, 32, 3)
model_shape =  [224, 224]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 13:49:36.231461: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 13:49:36.256141: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 13:49:36.261680: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 13:49:36.270679: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:49:36.273543: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:49:36.279275: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 13:49:36.283449: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 13:49:36.289893: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 13:49:36.295994: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 13:49:36.299371: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:49:36.301985: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 13:49:36.304540: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 13:49:36.316963: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x111b459aa20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 13:49:36.320245: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 13:49:36.322491: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 13:49:36.327127: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 13:49:36.329539: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:49:36.332259: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:49:36.334811: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 13:49:36.337065: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 13:49:36.339428: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 13:49:36.341698: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 13:49:36.344040: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:49:36.346487: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 13:49:36.834340: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 13:49:36.836709: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 13:49:36.838325: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 13:49:36.839950: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 13:49:36.847075: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x111e2e86a50 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 13:49:36.850321: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 13:49:38.552560: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 13:49:39.069996: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:49:39.816987: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:49:39.823624: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:49:41.269954: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 13:49:41.321977: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 13:49:41.648636: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 4s 32ms/step
[INFOR]: Index of most vote   :73
[INFOR]: Class of most vote   :barn spider, Araneus cavaticus
[INFOR]: Number of most vote  :162.0


[INFOR]: Index of second most vote     :309
[INFOR]: Class of second most vote     :bee
[INFOR]: Number of second most vote    :25.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 1s 26ms/step
[INFOR]: Toltal norm before transform: 0.6854
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0862

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 1s 26ms/step
[INFOR]: SEN training of class 79_500 before transform: 162
[INFOR]: SPE training of class 79_500 before transform: 497

[INFOR]: SEN training of class 79_500 after transform: 384
[INFOR]: SPE training of class 79_500 after transform: 377
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 26ms/step
[INFOR]: Index of most vote   :73
[INFOR]: Class of most vote   :barn spider, Araneus cavaticus
[INFOR]: Number of most vote  :30.0


[INFOR]: Index of second most vote     :309
[INFOR]: Class of second most vote     :bee
[INFOR]: Number of second most vote    :8.0
[INFOR]: SEN testing of class 79_100 before transform: 30
[INFOR]: SPE testing of class 79_100 before transform: 99

[INFOR]: SEN testing of class 79_100 after transform: 93
[INFOR]: SPE testing of class 79_100 after transform: 26
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name ResNet50  --model_shape 224 224 --dataset_name cifar_100 --class_name_train 80_500 --class_name_test 80_100
2021-09-08 13:49:49.012135: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  ResNet50
dataset_name =  cifar_100
class_name_train =  80_500
class_name_test =  80_100
data_shape =  (32, 32, 3)
model_shape =  [224, 224]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 13:49:51.663479: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 13:49:51.687280: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 13:49:51.692255: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 13:49:51.700390: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:49:51.702765: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:49:51.708091: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 13:49:51.711684: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 13:49:51.718175: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 13:49:51.723367: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 13:49:51.726698: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:49:51.729000: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 13:49:51.731053: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 13:49:51.743288: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x255330ca960 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 13:49:51.746601: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 13:49:51.748808: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 13:49:51.753353: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 13:49:51.755641: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:49:51.757907: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:49:51.760138: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 13:49:51.762507: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 13:49:51.764681: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 13:49:51.767025: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 13:49:51.769362: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:49:51.771707: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 13:49:52.201069: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 13:49:52.203726: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 13:49:52.205178: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 13:49:52.206764: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 13:49:52.213774: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x2556211e400 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 13:49:52.216722: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 13:49:53.876050: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 13:49:54.384033: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:49:55.041153: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:49:55.047608: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:49:56.428284: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 13:49:56.477532: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 13:49:56.794240: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 4s 32ms/step
[INFOR]: Index of most vote   :335
[INFOR]: Class of most vote   :fox squirrel, eastern fox squirrel, Sciurus niger
[INFOR]: Number of most vote  :177.0


[INFOR]: Index of second most vote     :149
[INFOR]: Class of second most vote     :dugong, Dugong dugon
[INFOR]: Number of second most vote    :25.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 1s 28ms/step
[INFOR]: Toltal norm before transform: 0.5944
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0694

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 1s 26ms/step
[INFOR]: SEN training of class 80_500 before transform: 177
[INFOR]: SPE training of class 80_500 before transform: 489

[INFOR]: SEN training of class 80_500 after transform: 338
[INFOR]: SPE training of class 80_500 after transform: 328
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 26ms/step
[INFOR]: Index of most vote   :335
[INFOR]: Class of most vote   :fox squirrel, eastern fox squirrel, Sciurus niger
[INFOR]: Number of most vote  :36.0


[INFOR]: Index of second most vote     :149
[INFOR]: Class of second most vote     :dugong, Dugong dugon
[INFOR]: Number of second most vote    :8.0
[INFOR]: SEN testing of class 80_100 before transform: 36
[INFOR]: SPE testing of class 80_100 before transform: 94

[INFOR]: SEN testing of class 80_100 after transform: 89
[INFOR]: SPE testing of class 80_100 after transform: 21
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name ResNet50  --model_shape 224 224 --dataset_name cifar_100 --class_name_train 81_500 --class_name_test 81_100
2021-09-08 13:50:04.155033: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  ResNet50
dataset_name =  cifar_100
class_name_train =  81_500
class_name_test =  81_100
data_shape =  (32, 32, 3)
model_shape =  [224, 224]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 13:50:06.824009: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 13:50:06.851057: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 13:50:06.858112: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 13:50:06.869139: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:50:06.871370: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:50:06.877247: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 13:50:06.882172: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 13:50:06.889676: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 13:50:06.895935: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 13:50:06.900365: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:50:06.902533: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 13:50:06.904548: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 13:50:06.921889: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1243abaedc0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 13:50:06.925186: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 13:50:06.929759: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 13:50:06.937025: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 13:50:06.939484: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:50:06.941867: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:50:06.944537: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 13:50:06.950531: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 13:50:06.953119: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 13:50:06.955571: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 13:50:06.959874: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:50:06.962795: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 13:50:07.425156: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 13:50:07.428031: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 13:50:07.429743: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 13:50:07.431886: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 13:50:07.440365: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1246695b490 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 13:50:07.444720: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 13:50:09.106819: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 13:50:09.629203: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:50:10.311493: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:50:10.317411: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:50:11.731314: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 13:50:11.780231: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 13:50:12.094657: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 4s 32ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :175.0


[INFOR]: Index of second most vote     :794
[INFOR]: Class of second most vote     :shower curtain
[INFOR]: Number of second most vote    :46.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 1s 27ms/step
[INFOR]: Toltal norm before transform: 0.5886
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1493

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 1s 27ms/step
[INFOR]: SEN training of class 81_500 before transform: 175
[INFOR]: SPE training of class 81_500 before transform: 480

[INFOR]: SEN training of class 81_500 after transform: 378
[INFOR]: SPE training of class 81_500 after transform: 336
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 26ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :33.0


[INFOR]: Index of second most vote     :794
[INFOR]: Class of second most vote     :shower curtain
[INFOR]: Number of second most vote    :13.0
[INFOR]: SEN testing of class 81_100 before transform: 33
[INFOR]: SPE testing of class 81_100 before transform: 98

[INFOR]: SEN testing of class 81_100 after transform: 85
[INFOR]: SPE testing of class 81_100 after transform: 23
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name ResNet50  --model_shape 224 224 --dataset_name cifar_100 --class_name_train 82_500 --class_name_test 82_100
2021-09-08 13:50:19.441849: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  ResNet50
dataset_name =  cifar_100
class_name_train =  82_500
class_name_test =  82_100
data_shape =  (32, 32, 3)
model_shape =  [224, 224]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 13:50:22.116862: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 13:50:22.142148: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 13:50:22.147175: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 13:50:22.155904: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:50:22.158295: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:50:22.163808: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 13:50:22.167459: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 13:50:22.174108: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 13:50:22.179473: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 13:50:22.182799: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:50:22.185205: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 13:50:22.187324: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 13:50:22.200083: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x204b3977560 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 13:50:22.203278: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 13:50:22.205683: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 13:50:22.210433: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 13:50:22.212904: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:50:22.215331: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:50:22.217650: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 13:50:22.219897: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 13:50:22.222214: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 13:50:22.224867: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 13:50:22.227373: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:50:22.229813: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 13:50:22.653177: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 13:50:22.655598: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 13:50:22.657132: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 13:50:22.658915: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 13:50:22.666364: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x204e1438df0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 13:50:22.669406: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 13:50:24.341422: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 13:50:24.851245: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:50:25.520499: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:50:25.526563: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:50:26.923765: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 13:50:26.971187: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 13:50:27.288490: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 4s 32ms/step
[INFOR]: Index of most vote   :392
[INFOR]: Class of most vote   :rock beauty, Holocanthus tricolor
[INFOR]: Number of most vote  :99.0


[INFOR]: Index of second most vote     :984
[INFOR]: Class of second most vote     :rapeseed
[INFOR]: Number of second most vote    :57.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 1s 26ms/step
[INFOR]: Toltal norm before transform: 0.7651
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0256

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 1s 26ms/step
[INFOR]: SEN training of class 82_500 before transform: 99
[INFOR]: SPE training of class 82_500 before transform: 486

[INFOR]: SEN training of class 82_500 after transform: 472
[INFOR]: SPE training of class 82_500 after transform: 407
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 26ms/step
[INFOR]: Index of most vote   :392
[INFOR]: Class of most vote   :rock beauty, Holocanthus tricolor
[INFOR]: Number of most vote  :21.0


[INFOR]: Index of second most vote     :984
[INFOR]: Class of second most vote     :rapeseed
[INFOR]: Number of second most vote    :19.0
[INFOR]: SEN testing of class 82_100 before transform: 21
[INFOR]: SPE testing of class 82_100 before transform: 97

[INFOR]: SEN testing of class 82_100 after transform: 91
[INFOR]: SPE testing of class 82_100 after transform: 66
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name ResNet50  --model_shape 224 224 --dataset_name cifar_100 --class_name_train 83_500 --class_name_test 83_100
2021-09-08 13:50:34.590027: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  ResNet50
dataset_name =  cifar_100
class_name_train =  83_500
class_name_test =  83_100
data_shape =  (32, 32, 3)
model_shape =  [224, 224]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 13:50:37.252307: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 13:50:37.277809: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 13:50:37.283366: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 13:50:37.298484: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:50:37.301081: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:50:37.306824: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 13:50:37.313395: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 13:50:37.320016: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 13:50:37.325248: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 13:50:37.328593: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:50:37.331418: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 13:50:37.333678: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 13:50:37.346233: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x227b39287f0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 13:50:37.349539: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 13:50:37.351838: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 13:50:37.356519: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 13:50:37.358880: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:50:37.361145: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:50:37.363433: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 13:50:37.365720: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 13:50:37.368193: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 13:50:37.370496: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 13:50:37.372772: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:50:37.375021: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 13:50:37.830203: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 13:50:37.832952: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 13:50:37.834452: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 13:50:37.836151: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 13:50:37.843021: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x227dc41a3f0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 13:50:37.846172: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 13:50:39.509042: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 13:50:40.019286: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:50:40.696110: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:50:40.702075: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:50:42.077737: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 13:50:42.128056: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 13:50:42.444626: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 4s 32ms/step
[INFOR]: Index of most vote   :714
[INFOR]: Class of most vote   :pick, plectrum, plectron
[INFOR]: Number of most vote  :85.0


[INFOR]: Index of second most vote     :771
[INFOR]: Class of second most vote     :safe
[INFOR]: Number of second most vote    :39.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 1s 26ms/step
[INFOR]: Toltal norm before transform: 0.7866
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0604

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 1s 26ms/step
[INFOR]: SEN training of class 83_500 before transform: 85
[INFOR]: SPE training of class 83_500 before transform: 488

[INFOR]: SEN training of class 83_500 after transform: 479
[INFOR]: SPE training of class 83_500 after transform: 378
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 26ms/step
[INFOR]: Index of most vote   :714
[INFOR]: Class of most vote   :pick, plectrum, plectron
[INFOR]: Number of most vote  :17.0


[INFOR]: Index of second most vote     :781
[INFOR]: Class of second most vote     :scoreboard
[INFOR]: Number of second most vote    :8.0
[INFOR]: SEN testing of class 83_100 before transform: 17
[INFOR]: SPE testing of class 83_100 before transform: 96

[INFOR]: SEN testing of class 83_100 after transform: 90
[INFOR]: SPE testing of class 83_100 after transform: 1
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name ResNet50  --model_shape 224 224 --dataset_name cifar_100 --class_name_train 84_500 --class_name_test 84_100
2021-09-08 13:50:49.672183: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  ResNet50
dataset_name =  cifar_100
class_name_train =  84_500
class_name_test =  84_100
data_shape =  (32, 32, 3)
model_shape =  [224, 224]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 13:50:52.347381: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 13:50:52.372129: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 13:50:52.376552: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 13:50:52.391367: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:50:52.393714: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:50:52.399240: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 13:50:52.402766: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 13:50:52.409445: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 13:50:52.414726: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 13:50:52.417935: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:50:52.420271: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 13:50:52.422316: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 13:50:52.434964: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1a8b544bce0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 13:50:52.438074: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 13:50:52.440144: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 13:50:52.444590: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 13:50:52.446909: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:50:52.449106: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:50:52.451349: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 13:50:52.453718: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 13:50:52.456131: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 13:50:52.458368: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 13:50:52.460571: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:50:52.462872: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 13:50:52.887906: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 13:50:52.890536: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 13:50:52.891924: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 13:50:52.893474: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 13:50:52.900295: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1a8e3ab5410 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 13:50:52.903157: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 13:50:54.565635: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 13:50:55.070960: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:50:55.736536: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:50:55.742668: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:50:57.117730: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 13:50:57.167034: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 13:50:57.475620: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 4s 32ms/step
[INFOR]: Index of most vote   :708
[INFOR]: Class of most vote   :pedestal, plinth, footstall
[INFOR]: Number of most vote  :34.0


[INFOR]: Index of second most vote     :532
[INFOR]: Class of second most vote     :dining table, board
[INFOR]: Number of second most vote    :33.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 1s 26ms/step
[INFOR]: Toltal norm before transform: 0.9502
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.2693

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 1s 26ms/step
[INFOR]: SEN training of class 84_500 before transform: 34
[INFOR]: SPE training of class 84_500 before transform: 496

[INFOR]: SEN training of class 84_500 after transform: 364
[INFOR]: SPE training of class 84_500 after transform: 323
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 26ms/step
[INFOR]: Index of most vote   :653
[INFOR]: Class of most vote   :milk can
[INFOR]: Number of most vote  :10.0


[INFOR]: Index of second most vote     :532
[INFOR]: Class of second most vote     :dining table, board
[INFOR]: Number of second most vote    :6.0
[INFOR]: SEN testing of class 84_100 before transform: 10
[INFOR]: SPE testing of class 84_100 before transform: 98

[INFOR]: SEN testing of class 84_100 after transform: 100
[INFOR]: SPE testing of class 84_100 after transform: 6
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name ResNet50  --model_shape 224 224 --dataset_name cifar_100 --class_name_train 85_500 --class_name_test 85_100
2021-09-08 13:51:04.725482: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  ResNet50
dataset_name =  cifar_100
class_name_train =  85_500
class_name_test =  85_100
data_shape =  (32, 32, 3)
model_shape =  [224, 224]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 13:51:07.406955: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 13:51:07.430880: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 13:51:07.435531: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 13:51:07.443814: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:51:07.446007: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:51:07.451199: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 13:51:07.454677: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 13:51:07.461236: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 13:51:07.466582: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 13:51:07.469664: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:51:07.471902: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 13:51:07.473843: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 13:51:07.485950: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x182bad4dd00 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 13:51:07.489218: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 13:51:07.491318: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 13:51:07.495814: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 13:51:07.497999: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:51:07.500166: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:51:07.502413: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 13:51:07.504821: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 13:51:07.507154: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 13:51:07.509453: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 13:51:07.511663: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:51:07.513925: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 13:51:07.955903: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 13:51:07.958594: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 13:51:07.960017: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 13:51:07.961562: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 13:51:07.968563: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x182e8c86bf0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 13:51:07.971698: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 13:51:09.631733: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 13:51:10.140183: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:51:10.800686: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:51:10.806665: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:51:12.168714: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 13:51:12.218359: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 13:51:12.531900: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 4s 31ms/step
[INFOR]: Index of most vote   :408
[INFOR]: Class of most vote   :amphibian, amphibious vehicle
[INFOR]: Number of most vote  :122.0


[INFOR]: Index of second most vote     :855
[INFOR]: Class of second most vote     :thimble
[INFOR]: Number of second most vote    :66.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 1s 26ms/step
[INFOR]: Toltal norm before transform: 0.7018
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.2786

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 1s 26ms/step
[INFOR]: SEN training of class 85_500 before transform: 122
[INFOR]: SPE training of class 85_500 before transform: 497

[INFOR]: SEN training of class 85_500 after transform: 385
[INFOR]: SPE training of class 85_500 after transform: 330
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 26ms/step
[INFOR]: Index of most vote   :408
[INFOR]: Class of most vote   :amphibian, amphibious vehicle
[INFOR]: Number of most vote  :20.0


[INFOR]: Index of second most vote     :855
[INFOR]: Class of second most vote     :thimble
[INFOR]: Number of second most vote    :15.0
[INFOR]: SEN testing of class 85_100 before transform: 20
[INFOR]: SPE testing of class 85_100 before transform: 100

[INFOR]: SEN testing of class 85_100 after transform: 77
[INFOR]: SPE testing of class 85_100 after transform: 38
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name ResNet50  --model_shape 224 224 --dataset_name cifar_100 --class_name_train 86_500 --class_name_test 86_100
2021-09-08 13:51:19.714493: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  ResNet50
dataset_name =  cifar_100
class_name_train =  86_500
class_name_test =  86_100
data_shape =  (32, 32, 3)
model_shape =  [224, 224]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 13:51:22.402334: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 13:51:22.426598: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 13:51:22.431209: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 13:51:22.439130: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:51:22.441420: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:51:22.446462: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 13:51:22.449907: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 13:51:22.456245: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 13:51:22.461702: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 13:51:22.464805: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:51:22.466967: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 13:51:22.468907: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 13:51:22.480914: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x20d355add00 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 13:51:22.484184: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 13:51:22.486298: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 13:51:22.490531: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 13:51:22.492742: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:51:22.495171: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:51:22.497308: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 13:51:22.499429: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 13:51:22.501609: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 13:51:22.503788: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 13:51:22.506165: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:51:22.508352: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 13:51:22.939144: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 13:51:22.941879: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 13:51:22.943238: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 13:51:22.945171: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 13:51:22.952080: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x20d61be1f90 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 13:51:22.955178: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 13:51:24.605065: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 13:51:25.106596: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:51:25.763033: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:51:25.769229: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:51:27.133257: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 13:51:27.184062: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 13:51:27.498310: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 4s 31ms/step
[INFOR]: Index of most vote   :590
[INFOR]: Class of most vote   :hand-held computer, hand-held microcomputer
[INFOR]: Number of most vote  :44.0


[INFOR]: Index of second most vote     :482
[INFOR]: Class of second most vote     :cassette player
[INFOR]: Number of second most vote    :41.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 1s 26ms/step
[INFOR]: Toltal norm before transform: 0.8905
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.2112

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 1s 26ms/step
[INFOR]: SEN training of class 86_500 before transform: 44
[INFOR]: SPE training of class 86_500 before transform: 500

[INFOR]: SEN training of class 86_500 after transform: 429
[INFOR]: SPE training of class 86_500 after transform: 348
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 26ms/step
[INFOR]: Index of most vote   :590
[INFOR]: Class of most vote   :hand-held computer, hand-held microcomputer
[INFOR]: Number of most vote  :13.0


[INFOR]: Index of second most vote     :550
[INFOR]: Class of second most vote     :espresso maker
[INFOR]: Number of second most vote    :8.0
[INFOR]: SEN testing of class 86_100 before transform: 13
[INFOR]: SPE testing of class 86_100 before transform: 100

[INFOR]: SEN testing of class 86_100 after transform: 91
[INFOR]: SPE testing of class 86_100 after transform: 17
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name ResNet50  --model_shape 224 224 --dataset_name cifar_100 --class_name_train 87_500 --class_name_test 87_100
2021-09-08 13:51:34.709652: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  ResNet50
dataset_name =  cifar_100
class_name_train =  87_500
class_name_test =  87_100
data_shape =  (32, 32, 3)
model_shape =  [224, 224]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 13:51:37.316260: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 13:51:37.343374: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 13:51:37.348159: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 13:51:37.356416: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:51:37.358721: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:51:37.363884: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 13:51:37.367636: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 13:51:37.374142: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 13:51:37.379198: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 13:51:37.382308: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:51:37.384528: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 13:51:37.386871: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 13:51:37.399165: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x21e395d5400 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 13:51:37.402498: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 13:51:37.404545: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 13:51:37.409064: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 13:51:37.411238: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:51:37.413428: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:51:37.415875: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 13:51:37.418142: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 13:51:37.420384: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 13:51:37.422662: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 13:51:37.424928: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:51:37.427223: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 13:51:37.890579: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 13:51:37.893708: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 13:51:37.895343: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 13:51:37.896919: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 13:51:37.903858: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x21e63713270 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 13:51:37.907015: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 13:51:39.555610: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 13:51:40.057429: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:51:40.714147: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:51:40.720753: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:51:42.094434: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 13:51:42.144139: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 13:51:42.460969: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 4s 31ms/step
[INFOR]: Index of most vote   :782
[INFOR]: Class of most vote   :screen, CRT screen
[INFOR]: Number of most vote  :165.0


[INFOR]: Index of second most vote     :548
[INFOR]: Class of second most vote     :entertainment center
[INFOR]: Number of second most vote    :41.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 1s 26ms/step
[INFOR]: Toltal norm before transform: 0.6783
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1284

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 1s 26ms/step
[INFOR]: SEN training of class 87_500 before transform: 165
[INFOR]: SPE training of class 87_500 before transform: 494

[INFOR]: SEN training of class 87_500 after transform: 422
[INFOR]: SPE training of class 87_500 after transform: 345
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 26ms/step
[INFOR]: Index of most vote   :782
[INFOR]: Class of most vote   :screen, CRT screen
[INFOR]: Number of most vote  :36.0


[INFOR]: Index of second most vote     :548
[INFOR]: Class of second most vote     :entertainment center
[INFOR]: Number of second most vote    :10.0
[INFOR]: SEN testing of class 87_100 before transform: 36
[INFOR]: SPE testing of class 87_100 before transform: 98

[INFOR]: SEN testing of class 87_100 after transform: 69
[INFOR]: SPE testing of class 87_100 after transform: 3
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name ResNet50  --model_shape 224 224 --dataset_name cifar_100 --class_name_train 88_500 --class_name_test 88_100
2021-09-08 13:51:49.674403: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  ResNet50
dataset_name =  cifar_100
class_name_train =  88_500
class_name_test =  88_100
data_shape =  (32, 32, 3)
model_shape =  [224, 224]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 13:51:52.281786: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 13:51:52.305041: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 13:51:52.309482: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 13:51:52.317507: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:51:52.319967: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:51:52.325385: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 13:51:52.328871: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 13:51:52.335020: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 13:51:52.340184: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 13:51:52.343150: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:51:52.345375: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 13:51:52.347254: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 13:51:52.359220: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x14033d7c100 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 13:51:52.362555: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 13:51:52.364708: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 13:51:52.369163: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 13:51:52.371293: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:51:52.373397: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:51:52.375571: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 13:51:52.377713: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 13:51:52.379968: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 13:51:52.382098: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 13:51:52.384230: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:51:52.386840: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 13:51:52.820773: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 13:51:52.823511: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 13:51:52.825006: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 13:51:52.826607: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 13:51:52.833478: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x14061f02220 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 13:51:52.836626: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 13:51:54.490081: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 13:51:54.993436: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:51:55.653953: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:51:55.660200: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:51:57.016804: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 13:51:57.069000: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 13:51:57.386281: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 4s 31ms/step
[INFOR]: Index of most vote   :335
[INFOR]: Class of most vote   :fox squirrel, eastern fox squirrel, Sciurus niger
[INFOR]: Number of most vote  :46.0


[INFOR]: Index of second most vote     :794
[INFOR]: Class of second most vote     :shower curtain
[INFOR]: Number of second most vote    :30.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 1s 26ms/step
[INFOR]: Toltal norm before transform: 0.8884
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.4802

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 1s 26ms/step
[INFOR]: SEN training of class 88_500 before transform: 46
[INFOR]: SPE training of class 88_500 before transform: 492

[INFOR]: SEN training of class 88_500 after transform: 369
[INFOR]: SPE training of class 88_500 after transform: 361
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 26ms/step
[INFOR]: Index of most vote   :335
[INFOR]: Class of most vote   :fox squirrel, eastern fox squirrel, Sciurus niger
[INFOR]: Number of most vote  :9.0


[INFOR]: Index of second most vote     :794
[INFOR]: Class of second most vote     :shower curtain
[INFOR]: Number of second most vote    :7.0
[INFOR]: SEN testing of class 88_100 before transform: 9
[INFOR]: SPE testing of class 88_100 before transform: 97

[INFOR]: SEN testing of class 88_100 after transform: 55
[INFOR]: SPE testing of class 88_100 after transform: 18
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name ResNet50  --model_shape 224 224 --dataset_name cifar_100 --class_name_train 89_500 --class_name_test 89_100
2021-09-08 13:52:04.564515: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  ResNet50
dataset_name =  cifar_100
class_name_train =  89_500
class_name_test =  89_100
data_shape =  (32, 32, 3)
model_shape =  [224, 224]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 13:52:07.211183: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 13:52:07.235946: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 13:52:07.240677: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 13:52:07.248662: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:52:07.250940: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:52:07.256055: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 13:52:07.259614: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 13:52:07.265864: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 13:52:07.271029: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 13:52:07.274041: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:52:07.276510: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 13:52:07.278457: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 13:52:07.290367: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1da3a1eceb0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 13:52:07.293718: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 13:52:07.295760: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 13:52:07.300477: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 13:52:07.302729: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:52:07.305341: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:52:07.307749: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 13:52:07.310142: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 13:52:07.312487: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 13:52:07.314930: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 13:52:07.317497: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:52:07.319820: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 13:52:07.755585: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 13:52:07.758403: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 13:52:07.760046: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 13:52:07.761658: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 13:52:07.768465: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1da6192c2d0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 13:52:07.771653: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 13:52:09.444516: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 13:52:09.964788: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:52:10.629525: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:52:10.636137: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:52:11.991085: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 13:52:12.039959: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 13:52:12.356947: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 4s 32ms/step
[INFOR]: Index of most vote   :856
[INFOR]: Class of most vote   :thresher, thrasher, threshing machine
[INFOR]: Number of most vote  :255.0


[INFOR]: Index of second most vote     :675
[INFOR]: Class of second most vote     :moving van
[INFOR]: Number of second most vote    :31.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 1s 26ms/step
[INFOR]: Toltal norm before transform: 0.4333
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0215

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 1s 26ms/step
[INFOR]: SEN training of class 89_500 before transform: 255
[INFOR]: SPE training of class 89_500 before transform: 492

[INFOR]: SEN training of class 89_500 after transform: 380
[INFOR]: SPE training of class 89_500 after transform: 356
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 26ms/step
[INFOR]: Index of most vote   :856
[INFOR]: Class of most vote   :thresher, thrasher, threshing machine
[INFOR]: Number of most vote  :42.0


[INFOR]: Index of second most vote     :795
[INFOR]: Class of second most vote     :ski
[INFOR]: Number of second most vote    :11.0
[INFOR]: SEN testing of class 89_100 before transform: 42
[INFOR]: SPE testing of class 89_100 before transform: 99

[INFOR]: SEN testing of class 89_100 after transform: 100
[INFOR]: SPE testing of class 89_100 after transform: 1
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name ResNet50  --model_shape 224 224 --dataset_name cifar_100 --class_name_train 90_500 --class_name_test 90_100
2021-09-08 13:52:19.619389: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  ResNet50
dataset_name =  cifar_100
class_name_train =  90_500
class_name_test =  90_100
data_shape =  (32, 32, 3)
model_shape =  [224, 224]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 13:52:22.286500: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 13:52:22.309485: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 13:52:22.313926: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 13:52:22.321975: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:52:22.324314: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:52:22.329524: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 13:52:22.332857: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 13:52:22.339063: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 13:52:22.344319: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 13:52:22.347281: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:52:22.349506: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 13:52:22.351432: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 13:52:22.363209: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x202b80dda80 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 13:52:22.366652: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 13:52:22.368787: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 13:52:22.373270: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 13:52:22.375416: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:52:22.377626: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:52:22.379925: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 13:52:22.382085: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 13:52:22.384326: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 13:52:22.386726: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 13:52:22.388999: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:52:22.391161: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 13:52:22.825001: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 13:52:22.828041: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 13:52:22.829516: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 13:52:22.831119: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 13:52:22.837965: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x202e4004ba0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 13:52:22.840899: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 13:52:24.497861: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 13:52:25.005859: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:52:25.665961: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:52:25.672479: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:52:27.034101: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 13:52:27.083315: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 13:52:27.395780: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 4s 32ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :80.0


[INFOR]: Index of second most vote     :450
[INFOR]: Class of second most vote     :bobsled, bobsleigh, bob
[INFOR]: Number of second most vote    :31.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 1s 26ms/step
[INFOR]: Toltal norm before transform: 0.7835
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1147

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 1s 26ms/step
[INFOR]: SEN training of class 90_500 before transform: 80
[INFOR]: SPE training of class 90_500 before transform: 488

[INFOR]: SEN training of class 90_500 after transform: 345
[INFOR]: SPE training of class 90_500 after transform: 322
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 26ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :22.0


[INFOR]: Index of second most vote     :450
[INFOR]: Class of second most vote     :bobsled, bobsleigh, bob
[INFOR]: Number of second most vote    :8.0
[INFOR]: SEN testing of class 90_100 before transform: 22
[INFOR]: SPE testing of class 90_100 before transform: 98

[INFOR]: SEN testing of class 90_100 after transform: 57
[INFOR]: SPE testing of class 90_100 after transform: 15
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name ResNet50  --model_shape 224 224 --dataset_name cifar_100 --class_name_train 91_500 --class_name_test 91_100
2021-09-08 13:52:34.655731: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  ResNet50
dataset_name =  cifar_100
class_name_train =  91_500
class_name_test =  91_100
data_shape =  (32, 32, 3)
model_shape =  [224, 224]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 13:52:37.306111: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 13:52:37.340002: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 13:52:37.345197: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 13:52:37.353625: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:52:37.356116: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:52:37.362108: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 13:52:37.366300: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 13:52:37.373110: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 13:52:37.378675: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 13:52:37.381990: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:52:37.384339: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 13:52:37.386469: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 13:52:37.399053: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x2b3b90ce500 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 13:52:37.402351: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 13:52:37.404505: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 13:52:37.409190: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 13:52:37.411522: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:52:37.413753: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:52:37.416054: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 13:52:37.418359: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 13:52:37.420585: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 13:52:37.422931: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 13:52:37.425272: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:52:37.427435: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 13:52:37.860095: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 13:52:37.862592: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 13:52:37.864001: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 13:52:37.865559: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 13:52:37.872518: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x2b3e85392b0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 13:52:37.875486: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 13:52:39.538394: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 13:52:40.054372: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:52:40.719535: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:52:40.725814: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:52:42.115764: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 13:52:42.165051: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 13:52:42.487545: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 4s 31ms/step
[INFOR]: Index of most vote   :103
[INFOR]: Class of most vote   :platypus, duckbill, duckbilled platypus, duck-billed platypus, Ornithorhynchus anatinus
[INFOR]: Number of most vote  :49.0


[INFOR]: Index of second most vote     :679
[INFOR]: Class of second most vote     :necklace
[INFOR]: Number of second most vote    :29.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 1s 26ms/step
[INFOR]: Toltal norm before transform: 0.9025
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0586

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 1s 25ms/step
[INFOR]: SEN training of class 91_500 before transform: 49
[INFOR]: SPE training of class 91_500 before transform: 484

[INFOR]: SEN training of class 91_500 after transform: 346
[INFOR]: SPE training of class 91_500 after transform: 293
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 26ms/step
[INFOR]: Index of most vote   :680
[INFOR]: Class of most vote   :nipple
[INFOR]: Number of most vote  :8.0


[INFOR]: Index of second most vote     :51
[INFOR]: Class of second most vote     :triceratops
[INFOR]: Number of second most vote    :6.0
[INFOR]: SEN testing of class 91_100 before transform: 8
[INFOR]: SPE testing of class 91_100 before transform: 98

[INFOR]: SEN testing of class 91_100 after transform: 95
[INFOR]: SPE testing of class 91_100 after transform: 4
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name ResNet50  --model_shape 224 224 --dataset_name cifar_100 --class_name_train 92_500 --class_name_test 92_100
2021-09-08 13:52:49.639017: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  ResNet50
dataset_name =  cifar_100
class_name_train =  92_500
class_name_test =  92_100
data_shape =  (32, 32, 3)
model_shape =  [224, 224]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 13:52:52.257078: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 13:52:52.283530: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 13:52:52.288332: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 13:52:52.296278: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:52:52.299091: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:52:52.304446: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 13:52:52.307834: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 13:52:52.314223: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 13:52:52.319336: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 13:52:52.322407: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:52:52.324548: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 13:52:52.326452: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 13:52:52.338723: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1e1b5fe3050 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 13:52:52.341909: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 13:52:52.343925: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 13:52:52.348362: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 13:52:52.350553: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:52:52.352681: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:52:52.354954: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 13:52:52.357098: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 13:52:52.359259: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 13:52:52.361484: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 13:52:52.363791: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:52:52.365913: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 13:52:52.797849: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 13:52:52.801229: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 13:52:52.802637: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 13:52:52.804215: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 13:52:52.811370: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1e1e4fcfd80 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 13:52:52.814476: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 13:52:54.455048: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 13:52:54.959406: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:52:55.627161: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:52:55.633369: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:52:57.010472: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 13:52:57.061074: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 13:52:57.375011: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 4s 31ms/step
[INFOR]: Index of most vote   :714
[INFOR]: Class of most vote   :pick, plectrum, plectron
[INFOR]: Number of most vote  :77.0


[INFOR]: Index of second most vote     :392
[INFOR]: Class of second most vote     :rock beauty, Holocanthus tricolor
[INFOR]: Number of second most vote    :57.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 1s 26ms/step
[INFOR]: Toltal norm before transform: 0.8392
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0149

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 1s 26ms/step
[INFOR]: SEN training of class 92_500 before transform: 77
[INFOR]: SPE training of class 92_500 before transform: 494

[INFOR]: SEN training of class 92_500 after transform: 450
[INFOR]: SPE training of class 92_500 after transform: 407
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 26ms/step
[INFOR]: Index of most vote   :714
[INFOR]: Class of most vote   :pick, plectrum, plectron
[INFOR]: Number of most vote  :15.0


[INFOR]: Index of second most vote     :392
[INFOR]: Class of second most vote     :rock beauty, Holocanthus tricolor
[INFOR]: Number of second most vote    :13.0
[INFOR]: SEN testing of class 92_100 before transform: 15
[INFOR]: SPE testing of class 92_100 before transform: 98

[INFOR]: SEN testing of class 92_100 after transform: 96
[INFOR]: SPE testing of class 92_100 after transform: 33
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name ResNet50  --model_shape 224 224 --dataset_name cifar_100 --class_name_train 93_500 --class_name_test 93_100
2021-09-08 13:53:04.550335: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  ResNet50
dataset_name =  cifar_100
class_name_train =  93_500
class_name_test =  93_100
data_shape =  (32, 32, 3)
model_shape =  [224, 224]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 13:53:07.170845: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 13:53:07.196084: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 13:53:07.200960: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 13:53:07.209092: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:53:07.211507: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:53:07.216886: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 13:53:07.220339: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 13:53:07.226613: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 13:53:07.232329: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 13:53:07.235303: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:53:07.237547: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 13:53:07.239521: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 13:53:07.251354: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1dc399dd380 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 13:53:07.254476: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 13:53:07.256822: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 13:53:07.261133: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 13:53:07.263432: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:53:07.265568: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:53:07.267891: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 13:53:07.270010: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 13:53:07.272195: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 13:53:07.274458: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 13:53:07.276616: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:53:07.279031: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 13:53:07.709135: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 13:53:07.712313: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 13:53:07.713676: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 13:53:07.715151: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 13:53:07.722025: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1dc653d11b0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 13:53:07.724885: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 13:53:09.378336: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 13:53:09.884442: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:53:10.564551: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:53:10.570682: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:53:11.924050: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 13:53:11.973643: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 13:53:12.284455: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 4s 31ms/step
[INFOR]: Index of most vote   :103
[INFOR]: Class of most vote   :platypus, duckbill, duckbilled platypus, duck-billed platypus, Ornithorhynchus anatinus
[INFOR]: Number of most vote  :64.0


[INFOR]: Index of second most vote     :125
[INFOR]: Class of second most vote     :hermit crab
[INFOR]: Number of second most vote    :29.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 1s 26ms/step
[INFOR]: Toltal norm before transform: 0.8536
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1953

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 1s 26ms/step
[INFOR]: SEN training of class 93_500 before transform: 64
[INFOR]: SPE training of class 93_500 before transform: 485

[INFOR]: SEN training of class 93_500 after transform: 395
[INFOR]: SPE training of class 93_500 after transform: 360
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 26ms/step
[INFOR]: Index of most vote   :103
[INFOR]: Class of most vote   :platypus, duckbill, duckbilled platypus, duck-billed platypus, Ornithorhynchus anatinus
[INFOR]: Number of most vote  :9.0


[INFOR]: Index of second most vote     :357
[INFOR]: Class of second most vote     :mink
[INFOR]: Number of second most vote    :5.0
[INFOR]: SEN testing of class 93_100 before transform: 9
[INFOR]: SPE testing of class 93_100 before transform: 97

[INFOR]: SEN testing of class 93_100 after transform: 79
[INFOR]: SPE testing of class 93_100 after transform: 55
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name ResNet50  --model_shape 224 224 --dataset_name cifar_100 --class_name_train 94_500 --class_name_test 94_100
2021-09-08 13:53:19.476673: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  ResNet50
dataset_name =  cifar_100
class_name_train =  94_500
class_name_test =  94_100
data_shape =  (32, 32, 3)
model_shape =  [224, 224]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 13:53:22.147805: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 13:53:22.171790: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 13:53:22.176707: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 13:53:22.184917: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:53:22.187180: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:53:22.192399: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 13:53:22.195794: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 13:53:22.202145: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 13:53:22.207125: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 13:53:22.210420: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:53:22.213029: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 13:53:22.215064: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 13:53:22.227290: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x209b5adc4f0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 13:53:22.230886: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 13:53:22.233188: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 13:53:22.237922: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 13:53:22.240234: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:53:22.242409: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:53:22.244648: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 13:53:22.246811: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 13:53:22.249309: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 13:53:22.251695: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 13:53:22.254115: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:53:22.256303: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 13:53:22.697240: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 13:53:22.700416: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 13:53:22.701788: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 13:53:22.703322: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 13:53:22.710075: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x209e5878160 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 13:53:22.713121: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 13:53:24.385288: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 13:53:24.917841: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:53:25.589719: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:53:25.595589: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:53:26.974628: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 13:53:27.023790: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 13:53:27.346382: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 4s 32ms/step
[INFOR]: Index of most vote   :631
[INFOR]: Class of most vote   :lotion
[INFOR]: Number of most vote  :56.0


[INFOR]: Index of second most vote     :770
[INFOR]: Class of second most vote     :running shoe
[INFOR]: Number of second most vote    :53.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 1s 26ms/step
[INFOR]: Toltal norm before transform: 0.8826
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.3361

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 1s 26ms/step
[INFOR]: SEN training of class 94_500 before transform: 56
[INFOR]: SPE training of class 94_500 before transform: 495

[INFOR]: SEN training of class 94_500 after transform: 475
[INFOR]: SPE training of class 94_500 after transform: 388
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 27ms/step
[INFOR]: Index of most vote   :782
[INFOR]: Class of most vote   :screen, CRT screen
[INFOR]: Number of most vote  :8.0


[INFOR]: Index of second most vote     :585
[INFOR]: Class of second most vote     :hair spray
[INFOR]: Number of second most vote    :7.0
[INFOR]: SEN testing of class 94_100 before transform: 8
[INFOR]: SPE testing of class 94_100 before transform: 94

[INFOR]: SEN testing of class 94_100 after transform: 97
[INFOR]: SPE testing of class 94_100 after transform: 18
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name ResNet50  --model_shape 224 224 --dataset_name cifar_100 --class_name_train 95_500 --class_name_test 95_100
2021-09-08 13:53:34.589977: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  ResNet50
dataset_name =  cifar_100
class_name_train =  95_500
class_name_test =  95_100
data_shape =  (32, 32, 3)
model_shape =  [224, 224]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 13:53:37.223204: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 13:53:37.248388: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 13:53:37.253371: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 13:53:37.261372: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:53:37.263513: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:53:37.268521: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 13:53:37.271962: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 13:53:37.278195: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 13:53:37.283572: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 13:53:37.286488: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:53:37.288715: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 13:53:37.290594: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 13:53:37.302889: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1f333841090 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 13:53:37.306511: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 13:53:37.308608: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 13:53:37.312917: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 13:53:37.315088: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:53:37.317193: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:53:37.319551: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 13:53:37.321922: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 13:53:37.324078: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 13:53:37.326260: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 13:53:37.328918: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:53:37.331216: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 13:53:37.771254: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 13:53:37.774455: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 13:53:37.775921: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 13:53:37.777496: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 13:53:37.784376: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1f35e77e540 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 13:53:37.787275: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 13:53:39.444928: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 13:53:39.945154: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:53:40.605584: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:53:40.611830: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:53:42.006373: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 13:53:42.056244: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 13:53:42.364737: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 4s 32ms/step
[INFOR]: Index of most vote   :103
[INFOR]: Class of most vote   :platypus, duckbill, duckbilled platypus, duck-billed platypus, Ornithorhynchus anatinus
[INFOR]: Number of most vote  :48.0


[INFOR]: Index of second most vote     :725
[INFOR]: Class of second most vote     :pitcher, ewer
[INFOR]: Number of second most vote    :36.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 1s 26ms/step
[INFOR]: Toltal norm before transform: 0.8929
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.3523

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 1s 26ms/step
[INFOR]: SEN training of class 95_500 before transform: 48
[INFOR]: SPE training of class 95_500 before transform: 482

[INFOR]: SEN training of class 95_500 after transform: 447
[INFOR]: SPE training of class 95_500 after transform: 349
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 26ms/step
[INFOR]: Index of most vote   :103
[INFOR]: Class of most vote   :platypus, duckbill, duckbilled platypus, duck-billed platypus, Ornithorhynchus anatinus
[INFOR]: Number of most vote  :10.0


[INFOR]: Index of second most vote     :147
[INFOR]: Class of second most vote     :grey whale, gray whale, devilfish, Eschrichtius gibbosus, Eschrichtius robustus
[INFOR]: Number of second most vote    :10.0
[INFOR]: SEN testing of class 95_100 before transform: 10
[INFOR]: SPE testing of class 95_100 before transform: 97

[INFOR]: SEN testing of class 95_100 after transform: 98
[INFOR]: SPE testing of class 95_100 after transform: 32
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name ResNet50  --model_shape 224 224 --dataset_name cifar_100 --class_name_train 96_500 --class_name_test 96_100
2021-09-08 13:53:49.570179: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  ResNet50
dataset_name =  cifar_100
class_name_train =  96_500
class_name_test =  96_100
data_shape =  (32, 32, 3)
model_shape =  [224, 224]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 13:53:52.276204: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 13:53:52.300717: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 13:53:52.305197: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 13:53:52.313143: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:53:52.315398: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:53:52.320509: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 13:53:52.323908: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 13:53:52.330258: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 13:53:52.335301: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 13:53:52.338284: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:53:52.340616: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 13:53:52.342506: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 13:53:52.354554: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1b4abcef700 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 13:53:52.357781: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 13:53:52.359903: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 13:53:52.364166: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 13:53:52.366359: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:53:52.368726: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:53:52.370886: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 13:53:52.373027: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 13:53:52.375326: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 13:53:52.377520: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 13:53:52.379841: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:53:52.382051: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 13:53:52.818627: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 13:53:52.821968: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 13:53:52.823530: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 13:53:52.825096: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 13:53:52.832267: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1b4dd0cf960 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 13:53:52.835157: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 13:53:54.520579: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 13:53:55.035913: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:53:55.698570: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:53:55.704728: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:53:57.093993: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 13:53:57.143077: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 13:53:57.459813: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 4s 32ms/step
[INFOR]: Index of most vote   :149
[INFOR]: Class of most vote   :dugong, Dugong dugon
[INFOR]: Number of most vote  :73.0


[INFOR]: Index of second most vote     :391
[INFOR]: Class of second most vote     :coho, cohoe, coho salmon, blue jack, silver salmon, Oncorhynchus kisutch
[INFOR]: Number of second most vote    :31.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 1s 26ms/step
[INFOR]: Toltal norm before transform: 0.8159
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1582

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 1s 27ms/step
[INFOR]: SEN training of class 96_500 before transform: 73
[INFOR]: SPE training of class 96_500 before transform: 490

[INFOR]: SEN training of class 96_500 after transform: 421
[INFOR]: SPE training of class 96_500 after transform: 353
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 28ms/step
[INFOR]: Index of most vote   :149
[INFOR]: Class of most vote   :dugong, Dugong dugon
[INFOR]: Number of most vote  :16.0


[INFOR]: Index of second most vote     :147
[INFOR]: Class of second most vote     :grey whale, gray whale, devilfish, Eschrichtius gibbosus, Eschrichtius robustus
[INFOR]: Number of second most vote    :7.0
[INFOR]: SEN testing of class 96_100 before transform: 16
[INFOR]: SPE testing of class 96_100 before transform: 98

[INFOR]: SEN testing of class 96_100 after transform: 95
[INFOR]: SPE testing of class 96_100 after transform: 7
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name ResNet50  --model_shape 224 224 --dataset_name cifar_100 --class_name_train 97_500 --class_name_test 97_100
2021-09-08 13:54:04.734129: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  ResNet50
dataset_name =  cifar_100
class_name_train =  97_500
class_name_test =  97_100
data_shape =  (32, 32, 3)
model_shape =  [224, 224]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 13:54:07.371441: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 13:54:07.396248: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 13:54:07.400678: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 13:54:07.408553: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:54:07.410989: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:54:07.416080: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 13:54:07.419437: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 13:54:07.425783: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 13:54:07.430642: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 13:54:07.434118: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:54:07.436483: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 13:54:07.438631: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 13:54:07.451358: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x181337f1e20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 13:54:07.454687: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 13:54:07.457015: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 13:54:07.461702: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 13:54:07.464185: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:54:07.466377: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:54:07.468615: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 13:54:07.470786: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 13:54:07.473107: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 13:54:07.475287: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 13:54:07.477558: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:54:07.479776: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 13:54:07.906166: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 13:54:07.909065: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 13:54:07.910585: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 13:54:07.912159: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 13:54:07.918808: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1815d7bbf50 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 13:54:07.921655: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 13:54:09.563683: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 13:54:10.073710: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:54:10.746685: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:54:10.752653: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:54:12.120291: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 13:54:12.169675: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 13:54:12.482504: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 4s 32ms/step
[INFOR]: Index of most vote   :269
[INFOR]: Class of most vote   :timber wolf, grey wolf, gray wolf, Canis lupus
[INFOR]: Number of most vote  :67.0


[INFOR]: Index of second most vote     :271
[INFOR]: Class of second most vote     :red wolf, maned wolf, Canis rufus, Canis niger
[INFOR]: Number of second most vote    :39.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 1s 26ms/step
[INFOR]: Toltal norm before transform: 0.8380
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.2766

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 1s 26ms/step
[INFOR]: SEN training of class 97_500 before transform: 67
[INFOR]: SPE training of class 97_500 before transform: 499

[INFOR]: SEN training of class 97_500 after transform: 404
[INFOR]: SPE training of class 97_500 after transform: 373
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 26ms/step
[INFOR]: Index of most vote   :280
[INFOR]: Class of most vote   :grey fox, gray fox, Urocyon cinereoargenteus
[INFOR]: Number of most vote  :11.0


[INFOR]: Index of second most vote     :269
[INFOR]: Class of second most vote     :timber wolf, grey wolf, gray wolf, Canis lupus
[INFOR]: Number of second most vote    :10.0
[INFOR]: SEN testing of class 97_100 before transform: 11
[INFOR]: SPE testing of class 97_100 before transform: 100

[INFOR]: SEN testing of class 97_100 after transform: 78
[INFOR]: SPE testing of class 97_100 after transform: 1
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name ResNet50  --model_shape 224 224 --dataset_name cifar_100 --class_name_train 98_500 --class_name_test 98_100
2021-09-08 13:54:19.682991: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  ResNet50
dataset_name =  cifar_100
class_name_train =  98_500
class_name_test =  98_100
data_shape =  (32, 32, 3)
model_shape =  [224, 224]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 13:54:22.310874: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 13:54:22.334976: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 13:54:22.340301: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 13:54:22.348383: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:54:22.350897: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:54:22.356034: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 13:54:22.359567: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 13:54:22.365871: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 13:54:22.370872: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 13:54:22.373991: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:54:22.376201: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 13:54:22.378139: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 13:54:22.390326: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x251b9743e60 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 13:54:22.393542: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 13:54:22.395843: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 13:54:22.400691: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 13:54:22.402869: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:54:22.405033: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:54:22.407320: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 13:54:22.409702: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 13:54:22.412099: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 13:54:22.414396: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 13:54:22.416692: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:54:22.418821: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 13:54:22.850273: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 13:54:22.852912: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 13:54:22.854399: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 13:54:22.855875: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 13:54:22.863826: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x251e542f4e0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 13:54:22.866927: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 13:54:24.517027: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 13:54:25.016958: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:54:25.680034: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:54:25.686242: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:54:27.047815: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 13:54:27.097001: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 13:54:27.407168: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 4s 32ms/step
[INFOR]: Index of most vote   :906
[INFOR]: Class of most vote   :Windsor tie
[INFOR]: Number of most vote  :63.0


[INFOR]: Index of second most vote     :714
[INFOR]: Class of second most vote     :pick, plectrum, plectron
[INFOR]: Number of second most vote    :41.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 1s 26ms/step
[INFOR]: Toltal norm before transform: 0.8520
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1714

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 1s 26ms/step
[INFOR]: SEN training of class 98_500 before transform: 63
[INFOR]: SPE training of class 98_500 before transform: 489

[INFOR]: SEN training of class 98_500 after transform: 376
[INFOR]: SPE training of class 98_500 after transform: 339
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 26ms/step
[INFOR]: Index of most vote   :795
[INFOR]: Class of most vote   :ski
[INFOR]: Number of most vote  :12.0


[INFOR]: Index of second most vote     :905
[INFOR]: Class of second most vote     :window shade
[INFOR]: Number of second most vote    :9.0
[INFOR]: SEN testing of class 98_100 before transform: 12
[INFOR]: SPE testing of class 98_100 before transform: 97

[INFOR]: SEN testing of class 98_100 after transform: 94
[INFOR]: SPE testing of class 98_100 after transform: 8
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name ResNet50  --model_shape 224 224 --dataset_name cifar_100 --class_name_train 99_500 --class_name_test 99_100
2021-09-08 13:54:34.650231: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  ResNet50
dataset_name =  cifar_100
class_name_train =  99_500
class_name_test =  99_100
data_shape =  (32, 32, 3)
model_shape =  [224, 224]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 13:54:37.348869: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 13:54:37.374672: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 13:54:37.379553: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 13:54:37.387917: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:54:37.390257: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:54:37.395446: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 13:54:37.398918: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 13:54:37.405733: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 13:54:37.410818: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 13:54:37.413971: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:54:37.416137: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 13:54:37.418096: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 13:54:37.431281: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x252338dabb0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 13:54:37.434838: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 13:54:37.437064: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 13:54:37.442029: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 13:54:37.444555: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:54:37.447025: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:54:37.449525: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 13:54:37.451841: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 13:54:37.454196: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 13:54:37.456458: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 13:54:37.458687: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:54:37.460996: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 13:54:37.897143: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 13:54:37.899467: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 13:54:37.901299: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 13:54:37.902936: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 13:54:37.909700: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x2525e52fc00 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 13:54:37.912562: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 13:54:39.591009: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 13:54:40.109358: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 13:54:40.782651: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 13:54:40.787917: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 13:54:42.158121: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 13:54:42.206429: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 13:54:42.522849: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 4s 33ms/step
[INFOR]: Index of most vote   :111
[INFOR]: Class of most vote   :nematode, nematode worm, roundworm
[INFOR]: Number of most vote  :276.0


[INFOR]: Index of second most vote     :450
[INFOR]: Class of second most vote     :bobsled, bobsleigh, bob
[INFOR]: Number of second most vote    :12.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 1s 26ms/step
[INFOR]: Toltal norm before transform: 0.4242
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1809

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 1s 26ms/step
[INFOR]: SEN training of class 99_500 before transform: 276
[INFOR]: SPE training of class 99_500 before transform: 495

[INFOR]: SEN training of class 99_500 after transform: 456
[INFOR]: SPE training of class 99_500 after transform: 400
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 28ms/step
[INFOR]: Index of most vote   :111
[INFOR]: Class of most vote   :nematode, nematode worm, roundworm
[INFOR]: Number of most vote  :45.0


[INFOR]: Index of second most vote     :771
[INFOR]: Class of second most vote     :safe
[INFOR]: Number of second most vote    :9.0
[INFOR]: SEN testing of class 99_100 before transform: 45
[INFOR]: SPE testing of class 99_100 before transform: 99

[INFOR]: SEN testing of class 99_100 after transform: 91
[INFOR]: SPE testing of class 99_100 after transform: 56
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>