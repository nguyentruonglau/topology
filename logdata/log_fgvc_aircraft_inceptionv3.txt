model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
[INFOR]: get pretrained model
2021-09-13 09:24:59.813752: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 09:24:59.839880: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 09:24:59.845067: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 09:24:59.853014: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:24:59.855209: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:24:59.860951: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 09:24:59.864459: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 09:24:59.870736: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 09:24:59.876020: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 09:24:59.879903: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:24:59.882409: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 09:24:59.884622: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 09:24:59.897091: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x249b4a80fa0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 09:24:59.900468: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 09:24:59.902952: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 09:24:59.908320: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 09:24:59.910579: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:24:59.912795: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:24:59.915037: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 09:24:59.917238: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 09:24:59.919650: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 09:24:59.922035: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 09:24:59.924636: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:24:59.926910: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 09:25:00.365975: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 09:25:00.368327: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 09:25:00.369751: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 09:25:00.371358: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 09:25:00.377867: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x249e2da0660 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 09:25:00.380701: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 09:25:02.361483: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 09:25:03.062497: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:25:03.720026: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:25:03.726384: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:25:05.055890: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 09:25:05.103274: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 09:25:05.820410: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 258ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :22.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :8.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 31ms/step
[INFOR]: Toltal norm before transform: 0.2354
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0032

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 31ms/step
[INFOR]: SEN training of class 37_33 before transform: 22
[INFOR]: SPE training of class 37_33 before transform: 13

[INFOR]: SEN training of class 37_33 after transform: 28
[INFOR]: SPE training of class 37_33 after transform: 13
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
3/3 [==============================] - 0s 31ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :17.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :9.0
[INFOR]: SEN testing of class 37_33 before transform: 17
[INFOR]: SPE testing of class 37_33 before transform: 14

[INFOR]: SEN testing of class 37_33 after transform: 32
[INFOR]: SPE testing of class 37_33 after transform: 1
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name fgvc_aircraft --class_name_train 38_33 --class_name_test 38_34
2021-09-13 09:25:09.512303: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  fgvc_aircraft
class_name_train =  38_33
class_name_test =  38_34
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
[INFOR]: get pretrained model
2021-09-13 09:25:12.045779: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 09:25:12.068564: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 09:25:12.073500: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 09:25:12.081573: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:25:12.083852: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:25:12.089142: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 09:25:12.092655: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 09:25:12.099145: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 09:25:12.104265: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 09:25:12.107315: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:25:12.109555: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 09:25:12.111757: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 09:25:12.123931: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x247ba16f130 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 09:25:12.127615: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 09:25:12.129797: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 09:25:12.135081: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 09:25:12.137491: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:25:12.139958: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:25:12.142273: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 09:25:12.145148: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 09:25:12.147427: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 09:25:12.149750: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 09:25:12.152178: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:25:12.154624: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 09:25:12.583660: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 09:25:12.586939: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 09:25:12.588352: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 09:25:12.590209: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 09:25:12.597204: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x247e3715270 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 09:25:12.600286: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 09:25:14.595209: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 09:25:15.294059: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:25:15.941424: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:25:15.947624: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:25:17.279963: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 09:25:17.333539: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 09:25:18.054853: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 255ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :22.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :6.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 31ms/step
[INFOR]: Toltal norm before transform: 0.2752
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1205

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 32ms/step
[INFOR]: SEN training of class 38_33 before transform: 22
[INFOR]: SPE training of class 38_33 before transform: 17

[INFOR]: SEN training of class 38_33 after transform: 27
[INFOR]: SPE training of class 38_33 after transform: 17
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (68, 32, 32, 3)
[INFOR]: shape of y: (68, 1)
3/3 [==============================] - 0s 31ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :21.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :7.0
[INFOR]: SEN testing of class 38_34 before transform: 21
[INFOR]: SPE testing of class 38_34 before transform: 18

[INFOR]: SEN testing of class 38_34 after transform: 31
[INFOR]: SPE testing of class 38_34 after transform: 2
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name fgvc_aircraft --class_name_train 39_34 --class_name_test 39_33
2021-09-13 09:25:22.231156: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  fgvc_aircraft
class_name_train =  39_34
class_name_test =  39_33
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (68, 32, 32, 3)
[INFOR]: shape of y: (68, 1)
[INFOR]: get pretrained model
2021-09-13 09:25:24.804429: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 09:25:24.829120: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 09:25:24.834040: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 09:25:24.841821: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:25:24.844003: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:25:24.849283: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 09:25:24.852653: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 09:25:24.858840: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 09:25:24.864124: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 09:25:24.867129: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:25:24.869313: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 09:25:24.871253: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 09:25:24.883936: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x241334528b0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 09:25:24.887459: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 09:25:24.889587: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 09:25:24.894198: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 09:25:24.896416: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:25:24.898706: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:25:24.900954: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 09:25:24.903169: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 09:25:24.905421: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 09:25:24.907782: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 09:25:24.910063: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:25:24.912478: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 09:25:25.359122: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 09:25:25.362197: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 09:25:25.363612: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 09:25:25.365294: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 09:25:25.372235: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x24162bfa880 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 09:25:25.375068: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 09:25:27.379101: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 09:25:28.088607: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:25:28.742863: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:25:28.748831: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:25:30.084448: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 09:25:30.134249: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 09:25:30.860377: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 273ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :23.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :6.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 31ms/step
[INFOR]: Toltal norm before transform: 0.2501
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0398

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 31ms/step
[INFOR]: SEN training of class 39_34 before transform: 23
[INFOR]: SPE training of class 39_34 before transform: 16

[INFOR]: SEN training of class 39_34 after transform: 30
[INFOR]: SPE training of class 39_34 after transform: 16
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
3/3 [==============================] - 0s 31ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :25.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :5.0
[INFOR]: SEN testing of class 39_33 before transform: 25
[INFOR]: SPE testing of class 39_33 before transform: 15

[INFOR]: SEN testing of class 39_33 after transform: 33
[INFOR]: SPE testing of class 39_33 after transform: 2
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name fgvc_aircraft --class_name_train 40_33 --class_name_test 40_33
2021-09-13 09:25:35.039600: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  fgvc_aircraft
class_name_train =  40_33
class_name_test =  40_33
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
[INFOR]: get pretrained model
2021-09-13 09:25:37.556341: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 09:25:37.580222: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 09:25:37.585383: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 09:25:37.593363: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:25:37.595682: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:25:37.601308: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 09:25:37.604778: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 09:25:37.611417: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 09:25:37.616427: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 09:25:37.619422: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:25:37.621659: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 09:25:37.623792: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 09:25:37.635955: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x27cb7cb8c20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 09:25:37.639453: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 09:25:37.641881: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 09:25:37.646380: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 09:25:37.648616: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:25:37.650842: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:25:37.653094: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 09:25:37.655505: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 09:25:37.657813: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 09:25:37.660169: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 09:25:37.662416: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:25:37.664622: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 09:25:38.100037: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 09:25:38.103439: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 09:25:38.104824: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 09:25:38.106371: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 09:25:38.113156: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x27ce6bd1a60 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 09:25:38.116076: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 09:25:40.086518: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 09:25:40.787276: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:25:41.430376: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:25:41.435945: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:25:42.771293: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 09:25:42.825914: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 09:25:43.554568: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 260ms/step
[INFOR]: Index of most vote   :510
[INFOR]: Class of most vote   :container ship, containership, container vessel
[INFOR]: Number of most vote  :15.0


[INFOR]: Index of second most vote     :404
[INFOR]: Class of second most vote     :airliner
[INFOR]: Number of second most vote    :11.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 32ms/step
[INFOR]: Toltal norm before transform: 0.6007
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0752

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 32ms/step
[INFOR]: SEN training of class 40_33 before transform: 15
[INFOR]: SPE training of class 40_33 before transform: 27

[INFOR]: SEN training of class 40_33 after transform: 23
[INFOR]: SPE training of class 40_33 after transform: 24
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
3/3 [==============================] - 0s 31ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :14.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :10.0
[INFOR]: SEN testing of class 40_33 before transform: 14
[INFOR]: SPE testing of class 40_33 before transform: 15

[INFOR]: SEN testing of class 40_33 after transform: 33
[INFOR]: SPE testing of class 40_33 after transform: 0
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name fgvc_aircraft --class_name_train 41_33 --class_name_test 41_34
2021-09-13 09:25:47.273202: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  fgvc_aircraft
class_name_train =  41_33
class_name_test =  41_34
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
[INFOR]: get pretrained model
2021-09-13 09:25:49.825220: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 09:25:49.849754: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 09:25:49.856118: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 09:25:49.864689: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:25:49.867091: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:25:49.872556: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 09:25:49.876175: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 09:25:49.883132: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 09:25:49.889224: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 09:25:49.892486: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:25:49.894935: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 09:25:49.896947: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 09:25:49.909250: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x19235956ce0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 09:25:49.912717: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 09:25:49.915885: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 09:25:49.920844: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 09:25:49.923259: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:25:49.925812: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:25:49.928225: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 09:25:49.930606: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 09:25:49.932988: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 09:25:49.935466: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 09:25:49.937926: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:25:49.940898: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 09:25:50.378173: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 09:25:50.380954: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 09:25:50.382346: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 09:25:50.383899: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 09:25:50.390706: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x19260ae2340 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 09:25:50.393704: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 09:25:52.362709: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 09:25:53.092155: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:25:53.750603: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:25:53.756575: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:25:55.084683: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 09:25:55.132966: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 09:25:55.874300: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 273ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :16.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :11.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 31ms/step
[INFOR]: Toltal norm before transform: 0.4388
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0152

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 31ms/step
[INFOR]: SEN training of class 41_33 before transform: 16
[INFOR]: SPE training of class 41_33 before transform: 15

[INFOR]: SEN training of class 41_33 after transform: 30
[INFOR]: SPE training of class 41_33 after transform: 15
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (68, 32, 32, 3)
[INFOR]: shape of y: (68, 1)
3/3 [==============================] - 0s 31ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :15.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :13.0
[INFOR]: SEN testing of class 41_34 before transform: 15
[INFOR]: SPE testing of class 41_34 before transform: 16

[INFOR]: SEN testing of class 41_34 after transform: 24
[INFOR]: SPE testing of class 41_34 after transform: 6
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name fgvc_aircraft --class_name_train 42_34 --class_name_test 42_33
2021-09-13 09:26:00.061528: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  fgvc_aircraft
class_name_train =  42_34
class_name_test =  42_33
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (68, 32, 32, 3)
[INFOR]: shape of y: (68, 1)
[INFOR]: get pretrained model
2021-09-13 09:26:02.593712: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 09:26:02.617320: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 09:26:02.622446: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 09:26:02.630829: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:26:02.633037: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:26:02.638313: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 09:26:02.641723: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 09:26:02.647956: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 09:26:02.652928: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 09:26:02.655892: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:26:02.658086: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 09:26:02.660335: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 09:26:02.672473: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x20835d8df20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 09:26:02.675972: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 09:26:02.678100: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 09:26:02.682556: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 09:26:02.684833: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:26:02.687046: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:26:02.689292: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 09:26:02.691838: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 09:26:02.694063: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 09:26:02.696431: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 09:26:02.698692: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:26:02.700971: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 09:26:03.124992: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 09:26:03.128143: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 09:26:03.129700: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 09:26:03.131271: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 09:26:03.138212: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x20865558c60 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 09:26:03.141183: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 09:26:05.150903: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 09:26:05.848402: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:26:06.514213: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:26:06.520160: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:26:07.838866: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 09:26:07.885816: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 09:26:08.603192: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 269ms/step
[INFOR]: Index of most vote   :510
[INFOR]: Class of most vote   :container ship, containership, container vessel
[INFOR]: Number of most vote  :13.0


[INFOR]: Index of second most vote     :404
[INFOR]: Class of second most vote     :airliner
[INFOR]: Number of second most vote    :10.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 39ms/step
[INFOR]: Toltal norm before transform: 0.5756
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1749

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 31ms/step
[INFOR]: SEN training of class 42_34 before transform: 13
[INFOR]: SPE training of class 42_34 before transform: 24

[INFOR]: SEN training of class 42_34 after transform: 29
[INFOR]: SPE training of class 42_34 after transform: 23
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
3/3 [==============================] - 0s 31ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :14.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :9.0
[INFOR]: SEN testing of class 42_33 before transform: 14
[INFOR]: SPE testing of class 42_33 before transform: 18

[INFOR]: SEN testing of class 42_33 after transform: 31
[INFOR]: SPE testing of class 42_33 after transform: 0
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name fgvc_aircraft --class_name_train 43_33 --class_name_test 43_33
2021-09-13 09:26:12.761276: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  fgvc_aircraft
class_name_train =  43_33
class_name_test =  43_33
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
[INFOR]: get pretrained model
2021-09-13 09:26:15.259731: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 09:26:15.285739: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 09:26:15.291046: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 09:26:15.299211: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:26:15.301412: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:26:15.306780: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 09:26:15.310199: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 09:26:15.316603: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 09:26:15.321692: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 09:26:15.324675: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:26:15.327744: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 09:26:15.329786: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 09:26:15.342157: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x116b2d18380 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 09:26:15.345233: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 09:26:15.347456: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 09:26:15.352062: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 09:26:15.354308: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:26:15.356503: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:26:15.358929: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 09:26:15.361162: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 09:26:15.363365: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 09:26:15.365827: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 09:26:15.368625: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:26:15.370968: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 09:26:15.834403: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 09:26:15.837131: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 09:26:15.838689: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 09:26:15.840401: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 09:26:15.847341: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x116dc98b590 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 09:26:15.850417: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 09:26:17.809526: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 09:26:18.492645: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:26:19.157427: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:26:19.163638: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:26:20.503408: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 09:26:20.552788: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 09:26:21.275445: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 259ms/step
[INFOR]: Index of most vote   :510
[INFOR]: Class of most vote   :container ship, containership, container vessel
[INFOR]: Number of most vote  :9.0


[INFOR]: Index of second most vote     :404
[INFOR]: Class of second most vote     :airliner
[INFOR]: Number of second most vote    :6.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 32ms/step
[INFOR]: Toltal norm before transform: 0.6648
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.2238

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 31ms/step
[INFOR]: SEN training of class 43_33 before transform: 9
[INFOR]: SPE training of class 43_33 before transform: 23

[INFOR]: SEN training of class 43_33 after transform: 33
[INFOR]: SPE training of class 43_33 after transform: 23
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
3/3 [==============================] - 0s 31ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :10.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :7.0
[INFOR]: SEN testing of class 43_33 before transform: 10
[INFOR]: SPE testing of class 43_33 before transform: 14

[INFOR]: SEN testing of class 43_33 after transform: 33
[INFOR]: SPE testing of class 43_33 after transform: 0
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name fgvc_aircraft --class_name_train 44_33 --class_name_test 44_34
2021-09-13 09:26:24.917252: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  fgvc_aircraft
class_name_train =  44_33
class_name_test =  44_34
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
[INFOR]: get pretrained model
2021-09-13 09:26:27.475433: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 09:26:27.500680: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 09:26:27.505610: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 09:26:27.513614: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:26:27.515802: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:26:27.521328: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 09:26:27.524783: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 09:26:27.531027: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 09:26:27.535986: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 09:26:27.539357: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:26:27.541534: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 09:26:27.543432: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 09:26:27.555475: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x238332249f0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 09:26:27.558545: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 09:26:27.560609: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 09:26:27.564892: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 09:26:27.567143: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:26:27.569441: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:26:27.571637: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 09:26:27.573806: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 09:26:27.576183: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 09:26:27.578422: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 09:26:27.580764: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:26:27.582951: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 09:26:28.007748: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 09:26:28.010865: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 09:26:28.012272: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 09:26:28.013843: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 09:26:28.020340: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x2385e753250 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 09:26:28.023410: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 09:26:30.015508: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 09:26:30.712431: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:26:31.359830: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:26:31.366138: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:26:32.686112: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 09:26:32.734731: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 09:26:33.452134: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 258ms/step
[INFOR]: Index of most vote   :510
[INFOR]: Class of most vote   :container ship, containership, container vessel
[INFOR]: Number of most vote  :13.0


[INFOR]: Index of second most vote     :404
[INFOR]: Class of second most vote     :airliner
[INFOR]: Number of second most vote    :10.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 23ms/step
[INFOR]: Toltal norm before transform: 0.5599
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0631

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 31ms/step
[INFOR]: SEN training of class 44_33 before transform: 13
[INFOR]: SPE training of class 44_33 before transform: 27

[INFOR]: SEN training of class 44_33 after transform: 28
[INFOR]: SPE training of class 44_33 after transform: 27
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (68, 32, 32, 3)
[INFOR]: shape of y: (68, 1)
3/3 [==============================] - 0s 31ms/step
[INFOR]: Index of most vote   :510
[INFOR]: Class of most vote   :container ship, containership, container vessel
[INFOR]: Number of most vote  :17.0


[INFOR]: Index of second most vote     :404
[INFOR]: Class of second most vote     :airliner
[INFOR]: Number of second most vote    :10.0
[INFOR]: SEN testing of class 44_34 before transform: 17
[INFOR]: SPE testing of class 44_34 before transform: 27

[INFOR]: SEN testing of class 44_34 after transform: 30
[INFOR]: SPE testing of class 44_34 after transform: 11
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name fgvc_aircraft --class_name_train 45_34 --class_name_test 45_33
2021-09-13 09:26:37.593810: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  fgvc_aircraft
class_name_train =  45_34
class_name_test =  45_33
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (68, 32, 32, 3)
[INFOR]: shape of y: (68, 1)
[INFOR]: get pretrained model
2021-09-13 09:26:40.067470: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 09:26:40.091737: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 09:26:40.096692: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 09:26:40.104906: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:26:40.107196: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:26:40.112540: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 09:26:40.116178: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 09:26:40.122629: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 09:26:40.127977: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 09:26:40.131213: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:26:40.133683: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 09:26:40.135725: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 09:26:40.148067: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x274b2d8fb60 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 09:26:40.151541: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 09:26:40.153877: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 09:26:40.158319: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 09:26:40.160553: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:26:40.162923: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:26:40.165256: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 09:26:40.167410: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 09:26:40.169582: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 09:26:40.171977: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 09:26:40.174245: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:26:40.176444: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 09:26:40.597917: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 09:26:40.601105: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 09:26:40.602507: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 09:26:40.604198: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 09:26:40.611166: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x274dd81c0a0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 09:26:40.614033: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 09:26:42.572991: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 09:26:43.253973: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:26:43.902685: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:26:43.910074: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:26:45.228456: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 09:26:45.275352: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 09:26:45.999919: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 266ms/step
[INFOR]: Index of most vote   :510
[INFOR]: Class of most vote   :container ship, containership, container vessel
[INFOR]: Number of most vote  :12.0


[INFOR]: Index of second most vote     :404
[INFOR]: Class of second most vote     :airliner
[INFOR]: Number of second most vote    :10.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 39ms/step
[INFOR]: Toltal norm before transform: 0.5498
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0521

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 32ms/step
[INFOR]: SEN training of class 45_34 before transform: 12
[INFOR]: SPE training of class 45_34 before transform: 26

[INFOR]: SEN training of class 45_34 after transform: 30
[INFOR]: SPE training of class 45_34 after transform: 21
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
3/3 [==============================] - 0s 31ms/step
[INFOR]: Index of most vote   :510
[INFOR]: Class of most vote   :container ship, containership, container vessel
[INFOR]: Number of most vote  :17.0


[INFOR]: Index of second most vote     :404
[INFOR]: Class of second most vote     :airliner
[INFOR]: Number of second most vote    :5.0
[INFOR]: SEN testing of class 45_33 before transform: 17
[INFOR]: SPE testing of class 45_33 before transform: 21

[INFOR]: SEN testing of class 45_33 after transform: 31
[INFOR]: SPE testing of class 45_33 after transform: 0
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name fgvc_aircraft --class_name_train 46_33 --class_name_test 46_33
2021-09-13 09:26:50.118609: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  fgvc_aircraft
class_name_train =  46_33
class_name_test =  46_33
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
[INFOR]: get pretrained model
2021-09-13 09:26:52.562563: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 09:26:52.589067: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 09:26:52.594129: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 09:26:52.602240: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:26:52.604621: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:26:52.610020: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 09:26:52.613597: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 09:26:52.620061: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 09:26:52.625345: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 09:26:52.628513: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:26:52.630890: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 09:26:52.632940: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 09:26:52.645772: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x209334f16e0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 09:26:52.649660: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 09:26:52.651985: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 09:26:52.656780: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 09:26:52.659205: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:26:52.661595: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:26:52.664015: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 09:26:52.666409: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 09:26:52.668970: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 09:26:52.671361: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 09:26:52.673606: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:26:52.675797: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 09:26:53.094504: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 09:26:53.096974: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 09:26:53.098374: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 09:26:53.099936: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 09:26:53.106718: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x2095f8a5fe0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 09:26:53.109575: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 09:26:55.049502: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 09:26:55.745931: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:26:56.387858: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:26:56.393448: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:26:57.711709: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 09:26:57.766724: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 09:26:58.486694: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 256ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :19.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :11.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 31ms/step
[INFOR]: Toltal norm before transform: 0.3410
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0841

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 31ms/step
[INFOR]: SEN training of class 46_33 before transform: 19
[INFOR]: SPE training of class 46_33 before transform: 16

[INFOR]: SEN training of class 46_33 after transform: 24
[INFOR]: SPE training of class 46_33 after transform: 16
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
3/3 [==============================] - 0s 24ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :17.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :13.0
[INFOR]: SEN testing of class 46_33 before transform: 17
[INFOR]: SPE testing of class 46_33 before transform: 24

[INFOR]: SEN testing of class 46_33 after transform: 32
[INFOR]: SPE testing of class 46_33 after transform: 1
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name fgvc_aircraft --class_name_train 47_33 --class_name_test 47_34
2021-09-13 09:27:02.118842: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  fgvc_aircraft
class_name_train =  47_33
class_name_test =  47_34
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
[INFOR]: get pretrained model
2021-09-13 09:27:04.613603: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 09:27:04.638126: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 09:27:04.643466: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 09:27:04.651831: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:27:04.654042: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:27:04.659414: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 09:27:04.662890: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 09:27:04.669726: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 09:27:04.674646: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 09:27:04.677597: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:27:04.680204: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 09:27:04.682095: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 09:27:04.693897: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x2cbb9867ff0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 09:27:04.697729: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 09:27:04.700040: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 09:27:04.704323: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 09:27:04.706578: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:27:04.708779: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:27:04.711043: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 09:27:04.713450: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 09:27:04.715642: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 09:27:04.717965: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 09:27:04.720174: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:27:04.722348: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 09:27:05.150522: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 09:27:05.153677: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 09:27:05.155062: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 09:27:05.156748: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 09:27:05.163396: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x2cbe56a9ad0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 09:27:05.166441: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 09:27:07.164602: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 09:27:07.837834: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:27:08.493910: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:27:08.500964: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:27:09.819391: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 09:27:09.871841: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 09:27:10.587332: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 258ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :17.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :9.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 31ms/step
[INFOR]: Toltal norm before transform: 0.4174
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0625

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 32ms/step
[INFOR]: SEN training of class 47_33 before transform: 17
[INFOR]: SPE training of class 47_33 before transform: 12

[INFOR]: SEN training of class 47_33 after transform: 27
[INFOR]: SPE training of class 47_33 after transform: 12
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (68, 32, 32, 3)
[INFOR]: shape of y: (68, 1)
3/3 [==============================] - 0s 31ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :18.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :10.0
[INFOR]: SEN testing of class 47_34 before transform: 18
[INFOR]: SPE testing of class 47_34 before transform: 18

[INFOR]: SEN testing of class 47_34 after transform: 32
[INFOR]: SPE testing of class 47_34 after transform: 3
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name fgvc_aircraft --class_name_train 48_34 --class_name_test 48_33
2021-09-13 09:27:14.702114: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  fgvc_aircraft
class_name_train =  48_34
class_name_test =  48_33
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (68, 32, 32, 3)
[INFOR]: shape of y: (68, 1)
[INFOR]: get pretrained model
2021-09-13 09:27:17.188335: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 09:27:17.213499: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 09:27:17.218624: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 09:27:17.226761: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:27:17.229116: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:27:17.234349: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 09:27:17.237830: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 09:27:17.244228: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 09:27:17.249290: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 09:27:17.252324: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:27:17.254565: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 09:27:17.256499: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 09:27:17.268668: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x20db9597260 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 09:27:17.271789: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 09:27:17.273943: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 09:27:17.278486: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 09:27:17.280720: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:27:17.282964: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:27:17.285211: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 09:27:17.287614: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 09:27:17.289828: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 09:27:17.292154: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 09:27:17.294476: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:27:17.296685: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 09:27:17.712118: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 09:27:17.715469: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 09:27:17.717013: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 09:27:17.718710: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 09:27:17.725357: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x20de3e3a360 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 09:27:17.728212: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 09:27:19.680708: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 09:27:20.377121: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:27:21.015856: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:27:21.022537: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:27:22.346952: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 09:27:22.396926: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 09:27:23.118226: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 293ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :16.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :13.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 31ms/step
[INFOR]: Toltal norm before transform: 0.4121
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1231

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 31ms/step
[INFOR]: SEN training of class 48_34 before transform: 16
[INFOR]: SPE training of class 48_34 before transform: 16

[INFOR]: SEN training of class 48_34 after transform: 27
[INFOR]: SPE training of class 48_34 after transform: 16
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
3/3 [==============================] - 0s 39ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :15.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :13.0
[INFOR]: SEN testing of class 48_33 before transform: 15
[INFOR]: SPE testing of class 48_33 before transform: 16

[INFOR]: SEN testing of class 48_33 after transform: 27
[INFOR]: SPE testing of class 48_33 after transform: 4
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name fgvc_aircraft --class_name_train 49_33 --class_name_test 49_34
2021-09-13 09:27:27.303733: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  fgvc_aircraft
class_name_train =  49_33
class_name_test =  49_34
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
[INFOR]: get pretrained model
2021-09-13 09:27:29.808278: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 09:27:29.831917: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 09:27:29.836605: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 09:27:29.844470: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:27:29.846764: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:27:29.851959: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 09:27:29.855328: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 09:27:29.861669: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 09:27:29.867341: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 09:27:29.870297: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:27:29.872521: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 09:27:29.874599: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 09:27:29.887616: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x170398622f0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 09:27:29.890740: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 09:27:29.893074: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 09:27:29.897340: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 09:27:29.899718: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:27:29.901915: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:27:29.904226: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 09:27:29.906439: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 09:27:29.908754: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 09:27:29.910979: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 09:27:29.913268: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:27:29.915454: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 09:27:30.342073: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 09:27:30.344994: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 09:27:30.346445: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 09:27:30.347957: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 09:27:30.354604: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x170616be670 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 09:27:30.357428: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 09:27:32.320991: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 09:27:33.002745: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:27:33.646914: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:27:33.652998: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:27:34.982647: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 09:27:35.035697: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 09:27:35.756130: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 254ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :15.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :11.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 31ms/step
[INFOR]: Toltal norm before transform: 0.5396
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0899

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 31ms/step
[INFOR]: SEN training of class 49_33 before transform: 15
[INFOR]: SPE training of class 49_33 before transform: 15

[INFOR]: SEN training of class 49_33 after transform: 26
[INFOR]: SPE training of class 49_33 after transform: 15
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (68, 32, 32, 3)
[INFOR]: shape of y: (68, 1)
3/3 [==============================] - 0s 32ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :21.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :7.0
[INFOR]: SEN testing of class 49_34 before transform: 21
[INFOR]: SPE testing of class 49_34 before transform: 19

[INFOR]: SEN testing of class 49_34 after transform: 32
[INFOR]: SPE testing of class 49_34 after transform: 4
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name fgvc_aircraft --class_name_train 50_34 --class_name_test 50_33
2021-09-13 09:27:39.886506: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  fgvc_aircraft
class_name_train =  50_34
class_name_test =  50_33
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (68, 32, 32, 3)
[INFOR]: shape of y: (68, 1)
[INFOR]: get pretrained model
2021-09-13 09:27:42.388191: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 09:27:42.413818: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 09:27:42.418695: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 09:27:42.426835: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:27:42.429079: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:27:42.434318: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 09:27:42.438001: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 09:27:42.444467: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 09:27:42.449612: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 09:27:42.452806: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:27:42.455183: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 09:27:42.457229: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 09:27:42.469482: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x282376f5ae0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 09:27:42.472954: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 09:27:42.475253: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 09:27:42.479822: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 09:27:42.482290: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:27:42.484649: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:27:42.487016: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 09:27:42.489346: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 09:27:42.491694: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 09:27:42.494135: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 09:27:42.496945: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:27:42.499316: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 09:27:42.917943: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 09:27:42.921266: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 09:27:42.922660: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 09:27:42.924237: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 09:27:42.931006: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x2826729cc90 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 09:27:42.934093: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 09:27:44.892430: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 09:27:45.579575: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:27:46.220333: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:27:46.226468: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:27:47.539505: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 09:27:47.590170: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 09:27:48.307857: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 263ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :16.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :8.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 32ms/step
[INFOR]: Toltal norm before transform: 0.5147
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0182

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 31ms/step
[INFOR]: SEN training of class 50_34 before transform: 16
[INFOR]: SPE training of class 50_34 before transform: 18

[INFOR]: SEN training of class 50_34 after transform: 27
[INFOR]: SPE training of class 50_34 after transform: 18
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
3/3 [==============================] - 0s 31ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :16.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :9.0
[INFOR]: SEN testing of class 50_33 before transform: 16
[INFOR]: SPE testing of class 50_33 before transform: 18

[INFOR]: SEN testing of class 50_33 after transform: 33
[INFOR]: SPE testing of class 50_33 after transform: 0
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name fgvc_aircraft --class_name_train 51_33 --class_name_test 51_33
2021-09-13 09:27:52.431369: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  fgvc_aircraft
class_name_train =  51_33
class_name_test =  51_33
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
[INFOR]: get pretrained model
2021-09-13 09:27:54.952133: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 09:27:54.978801: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 09:27:54.984010: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 09:27:54.992234: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:27:54.994435: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:27:54.999601: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 09:27:55.003010: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 09:27:55.009447: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 09:27:55.014386: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 09:27:55.017315: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:27:55.019482: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 09:27:55.021426: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 09:27:55.033295: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x20735b1a1a0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 09:27:55.036619: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 09:27:55.038740: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 09:27:55.043039: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 09:27:55.045227: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:27:55.047410: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:27:55.049652: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 09:27:55.052160: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 09:27:55.054424: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 09:27:55.056853: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 09:27:55.059170: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:27:55.061416: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 09:27:55.484394: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 09:27:55.487480: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 09:27:55.488892: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 09:27:55.491126: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 09:27:55.498016: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x207639aff90 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 09:27:55.501056: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 09:27:57.491122: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 09:27:58.183248: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:27:58.829542: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:27:58.835458: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:28:00.157554: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 09:28:00.212911: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 09:28:00.949098: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 274ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :16.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :7.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 31ms/step
[INFOR]: Toltal norm before transform: 0.4249
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0230

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 31ms/step
[INFOR]: SEN training of class 51_33 before transform: 16
[INFOR]: SPE training of class 51_33 before transform: 12

[INFOR]: SEN training of class 51_33 after transform: 30
[INFOR]: SPE training of class 51_33 after transform: 12
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
3/3 [==============================] - 0s 31ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :14.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :12.0
[INFOR]: SEN testing of class 51_33 before transform: 14
[INFOR]: SPE testing of class 51_33 before transform: 14

[INFOR]: SEN testing of class 51_33 after transform: 31
[INFOR]: SPE testing of class 51_33 after transform: 4
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name fgvc_aircraft --class_name_train 52_33 --class_name_test 52_33
2021-09-13 09:28:04.617362: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  fgvc_aircraft
class_name_train =  52_33
class_name_test =  52_33
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
[INFOR]: get pretrained model
2021-09-13 09:28:07.085118: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 09:28:07.111733: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 09:28:07.117204: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 09:28:07.125309: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:28:07.127720: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:28:07.133099: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 09:28:07.136558: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 09:28:07.142939: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 09:28:07.147928: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 09:28:07.150930: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:28:07.153144: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 09:28:07.155060: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 09:28:07.167549: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x20cb2c88490 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 09:28:07.171363: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 09:28:07.173537: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 09:28:07.177942: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 09:28:07.180230: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:28:07.182444: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:28:07.184859: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 09:28:07.187207: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 09:28:07.189438: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 09:28:07.191881: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 09:28:07.194200: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:28:07.196446: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 09:28:07.618061: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 09:28:07.621325: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 09:28:07.622726: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 09:28:07.624265: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 09:28:07.631048: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x20ce2f66f60 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 09:28:07.633921: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 09:28:09.570970: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 09:28:10.254021: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:28:10.912340: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:28:10.918117: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:28:12.235160: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 09:28:12.283661: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 09:28:13.003528: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 259ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :18.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :7.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 31ms/step
[INFOR]: Toltal norm before transform: 0.3692
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0639

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 31ms/step
[INFOR]: SEN training of class 52_33 before transform: 18
[INFOR]: SPE training of class 52_33 before transform: 15

[INFOR]: SEN training of class 52_33 after transform: 31
[INFOR]: SPE training of class 52_33 after transform: 15
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
3/3 [==============================] - 0s 31ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :14.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :9.0
[INFOR]: SEN testing of class 52_33 before transform: 14
[INFOR]: SPE testing of class 52_33 before transform: 11

[INFOR]: SEN testing of class 52_33 after transform: 33
[INFOR]: SPE testing of class 52_33 after transform: 0
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name fgvc_aircraft --class_name_train 53_33 --class_name_test 53_34
2021-09-13 09:28:16.616658: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  fgvc_aircraft
class_name_train =  53_33
class_name_test =  53_34
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
[INFOR]: get pretrained model
2021-09-13 09:28:19.124424: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 09:28:19.148524: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 09:28:19.153576: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 09:28:19.161668: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:28:19.163959: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:28:19.169136: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 09:28:19.172514: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 09:28:19.178941: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 09:28:19.183847: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 09:28:19.186829: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:28:19.188999: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 09:28:19.190914: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 09:28:19.203263: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x157b7504fc0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 09:28:19.207088: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 09:28:19.209195: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 09:28:19.213774: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 09:28:19.215986: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:28:19.218237: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:28:19.220660: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 09:28:19.222853: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 09:28:19.225124: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 09:28:19.227468: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 09:28:19.229770: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:28:19.231971: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 09:28:19.649863: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 09:28:19.653003: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 09:28:19.654521: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 09:28:19.656054: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 09:28:19.662717: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x157e5a1dae0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 09:28:19.666030: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 09:28:21.620050: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 09:28:22.310682: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:28:22.970614: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:28:22.977421: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:28:24.290278: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 09:28:24.336685: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 09:28:25.053736: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 251ms/step
[INFOR]: Index of most vote   :510
[INFOR]: Class of most vote   :container ship, containership, container vessel
[INFOR]: Number of most vote  :10.0


[INFOR]: Index of second most vote     :404
[INFOR]: Class of second most vote     :airliner
[INFOR]: Number of second most vote    :7.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 31ms/step
[INFOR]: Toltal norm before transform: 0.6745
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1918

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 32ms/step
[INFOR]: SEN training of class 53_33 before transform: 10
[INFOR]: SPE training of class 53_33 before transform: 22

[INFOR]: SEN training of class 53_33 after transform: 30
[INFOR]: SPE training of class 53_33 after transform: 22
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (68, 32, 32, 3)
[INFOR]: shape of y: (68, 1)
3/3 [==============================] - 0s 31ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :7.0


[INFOR]: Index of second most vote     :403
[INFOR]: Class of second most vote     :aircraft carrier, carrier, flattop, attack aircraft carrier
[INFOR]: Number of second most vote    :6.0
[INFOR]: SEN testing of class 53_34 before transform: 7
[INFOR]: SPE testing of class 53_34 before transform: 19

[INFOR]: SEN testing of class 53_34 after transform: 34
[INFOR]: SPE testing of class 53_34 after transform: 1
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name fgvc_aircraft --class_name_train 54_34 --class_name_test 54_33
2021-09-13 09:28:29.214462: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  fgvc_aircraft
class_name_train =  54_34
class_name_test =  54_33
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (68, 32, 32, 3)
[INFOR]: shape of y: (68, 1)
[INFOR]: get pretrained model
2021-09-13 09:28:31.718862: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 09:28:31.743197: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 09:28:31.748316: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 09:28:31.756536: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:28:31.758709: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:28:31.763996: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 09:28:31.767547: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 09:28:31.774014: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 09:28:31.778902: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 09:28:31.782049: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:28:31.784378: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 09:28:31.786308: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 09:28:31.798679: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x196b558a5b0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 09:28:31.801925: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 09:28:31.804299: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 09:28:31.808686: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 09:28:31.810919: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:28:31.813201: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:28:31.815434: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 09:28:31.817664: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 09:28:31.819853: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 09:28:31.822134: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 09:28:31.824362: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:28:31.826548: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 09:28:32.266540: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 09:28:32.269702: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 09:28:32.271116: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 09:28:32.272670: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 09:28:32.279475: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x196e3a424e0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 09:28:32.282597: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 09:28:34.266579: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 09:28:34.965988: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:28:35.614989: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:28:35.621271: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:28:36.940531: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 09:28:36.988236: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 09:28:37.709478: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 267ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :11.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :10.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 31ms/step
[INFOR]: Toltal norm before transform: 0.6435
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0356

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 31ms/step
[INFOR]: SEN training of class 54_34 before transform: 11
[INFOR]: SPE training of class 54_34 before transform: 15

[INFOR]: SEN training of class 54_34 after transform: 29
[INFOR]: SPE training of class 54_34 after transform: 15
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
3/3 [==============================] - 0s 31ms/step
[INFOR]: Index of most vote   :510
[INFOR]: Class of most vote   :container ship, containership, container vessel
[INFOR]: Number of most vote  :10.0


[INFOR]: Index of second most vote     :404
[INFOR]: Class of second most vote     :airliner
[INFOR]: Number of second most vote    :4.0
[INFOR]: SEN testing of class 54_33 before transform: 10
[INFOR]: SPE testing of class 54_33 before transform: 14

[INFOR]: SEN testing of class 54_33 after transform: 30
[INFOR]: SPE testing of class 54_33 after transform: 0
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name fgvc_aircraft --class_name_train 55_33 --class_name_test 55_33
2021-09-13 09:28:41.803451: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  fgvc_aircraft
class_name_train =  55_33
class_name_test =  55_33
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
[INFOR]: get pretrained model
2021-09-13 09:28:44.239013: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 09:28:44.265669: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 09:28:44.270794: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 09:28:44.279957: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:28:44.282206: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:28:44.287567: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 09:28:44.291162: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 09:28:44.297722: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 09:28:44.302846: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 09:28:44.306128: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:28:44.308368: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 09:28:44.310289: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 09:28:44.322354: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1173b1f4900 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 09:28:44.325598: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 09:28:44.327851: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 09:28:44.332249: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 09:28:44.334740: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:28:44.336959: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:28:44.339248: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 09:28:44.341452: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 09:28:44.343672: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 09:28:44.345986: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 09:28:44.348234: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:28:44.350548: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 09:28:44.778695: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 09:28:44.781856: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 09:28:44.783397: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 09:28:44.784935: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 09:28:44.791681: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x117653584d0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 09:28:44.794555: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 09:28:46.755560: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 09:28:47.446701: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:28:48.089021: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:28:48.094621: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:28:49.420116: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 09:28:49.468121: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 09:28:50.187155: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 251ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :8.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :8.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 31ms/step
[INFOR]: Toltal norm before transform: 0.7447
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1721

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 31ms/step
[INFOR]: SEN training of class 55_33 before transform: 8
[INFOR]: SPE training of class 55_33 before transform: 16

[INFOR]: SEN training of class 55_33 after transform: 29
[INFOR]: SPE training of class 55_33 after transform: 16
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
3/3 [==============================] - 0s 31ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :13.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :9.0
[INFOR]: SEN testing of class 55_33 before transform: 13
[INFOR]: SPE testing of class 55_33 before transform: 15

[INFOR]: SEN testing of class 55_33 after transform: 32
[INFOR]: SPE testing of class 55_33 after transform: 3
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name fgvc_aircraft --class_name_train 56_33 --class_name_test 56_34
2021-09-13 09:28:53.852315: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  fgvc_aircraft
class_name_train =  56_33
class_name_test =  56_34
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
[INFOR]: get pretrained model
2021-09-13 09:28:56.348010: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 09:28:56.371459: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 09:28:56.376220: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 09:28:56.384172: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:28:56.386625: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:28:56.391839: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 09:28:56.395288: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 09:28:56.401643: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 09:28:56.406644: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 09:28:56.409591: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:28:56.411757: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 09:28:56.413683: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 09:28:56.426354: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x279395ba680 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 09:28:56.429636: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 09:28:56.432102: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 09:28:56.436506: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 09:28:56.438702: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:28:56.440919: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:28:56.443354: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 09:28:56.445578: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 09:28:56.447979: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 09:28:56.450246: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 09:28:56.452716: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:28:56.454941: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 09:28:56.876176: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 09:28:56.878521: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 09:28:56.879922: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 09:28:56.881473: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 09:28:56.888087: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x27961aa5560 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 09:28:56.891112: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 09:28:58.856283: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 09:28:59.540117: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:29:00.187434: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:29:00.193470: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:29:01.515002: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 09:29:01.565352: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 09:29:02.280963: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 252ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :12.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :7.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 29ms/step
[INFOR]: Toltal norm before transform: 0.6017
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0431

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 31ms/step
[INFOR]: SEN training of class 56_33 before transform: 12
[INFOR]: SPE training of class 56_33 before transform: 19

[INFOR]: SEN training of class 56_33 after transform: 28
[INFOR]: SPE training of class 56_33 after transform: 19
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (68, 32, 32, 3)
[INFOR]: shape of y: (68, 1)
3/3 [==============================] - 0s 31ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :13.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :10.0
[INFOR]: SEN testing of class 56_34 before transform: 13
[INFOR]: SPE testing of class 56_34 before transform: 12

[INFOR]: SEN testing of class 56_34 after transform: 31
[INFOR]: SPE testing of class 56_34 after transform: 2
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name fgvc_aircraft --class_name_train 57_34 --class_name_test 57_33
2021-09-13 09:29:06.394208: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  fgvc_aircraft
class_name_train =  57_34
class_name_test =  57_33
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (68, 32, 32, 3)
[INFOR]: shape of y: (68, 1)
[INFOR]: get pretrained model
2021-09-13 09:29:08.876160: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 09:29:08.901298: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 09:29:08.906497: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 09:29:08.914611: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:29:08.917030: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:29:08.922276: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 09:29:08.925857: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 09:29:08.932190: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 09:29:08.937221: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 09:29:08.940448: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:29:08.942690: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 09:29:08.944602: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 09:29:08.956685: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x290ba440b50 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 09:29:08.960415: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 09:29:08.962702: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 09:29:08.967245: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 09:29:08.969510: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:29:08.972241: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:29:08.974495: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 09:29:08.976884: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 09:29:08.979095: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 09:29:08.981384: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 09:29:08.983694: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:29:08.986015: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 09:29:09.407333: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 09:29:09.410610: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 09:29:09.412089: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 09:29:09.413625: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 09:29:09.420124: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x290e5ddb0f0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 09:29:09.422983: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 09:29:11.372234: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 09:29:12.054941: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:29:12.698095: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:29:12.704130: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:29:14.020618: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 09:29:14.069970: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 09:29:14.787121: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 266ms/step
[INFOR]: Index of most vote   :510
[INFOR]: Class of most vote   :container ship, containership, container vessel
[INFOR]: Number of most vote  :7.0


[INFOR]: Index of second most vote     :404
[INFOR]: Class of second most vote     :airliner
[INFOR]: Number of second most vote    :4.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 32ms/step
[INFOR]: Toltal norm before transform: 0.7622
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0546

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 24ms/step
[INFOR]: SEN training of class 57_34 before transform: 7
[INFOR]: SPE training of class 57_34 before transform: 25

[INFOR]: SEN training of class 57_34 after transform: 33
[INFOR]: SPE training of class 57_34 after transform: 24
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
3/3 [==============================] - 0s 31ms/step
[INFOR]: Index of most vote   :510
[INFOR]: Class of most vote   :container ship, containership, container vessel
[INFOR]: Number of most vote  :8.0


[INFOR]: Index of second most vote     :404
[INFOR]: Class of second most vote     :airliner
[INFOR]: Number of second most vote    :7.0
[INFOR]: SEN testing of class 57_33 before transform: 8
[INFOR]: SPE testing of class 57_33 before transform: 22

[INFOR]: SEN testing of class 57_33 after transform: 33
[INFOR]: SPE testing of class 57_33 after transform: 1
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name fgvc_aircraft --class_name_train 58_33 --class_name_test 58_33
2021-09-13 09:29:18.903559: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  fgvc_aircraft
class_name_train =  58_33
class_name_test =  58_33
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
[INFOR]: get pretrained model
2021-09-13 09:29:21.382063: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 09:29:21.406989: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 09:29:21.412457: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 09:29:21.420730: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:29:21.423117: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:29:21.428471: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 09:29:21.432145: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 09:29:21.438653: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 09:29:21.443789: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 09:29:21.447284: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:29:21.449668: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 09:29:21.451704: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 09:29:21.464542: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x211b422e9f0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 09:29:21.468389: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 09:29:21.470774: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 09:29:21.475508: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 09:29:21.478019: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:29:21.480434: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:29:21.482865: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 09:29:21.485250: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 09:29:21.487654: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 09:29:21.490085: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 09:29:21.492707: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:29:21.495103: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 09:29:21.918883: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 09:29:21.921635: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 09:29:21.923191: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 09:29:21.924741: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 09:29:21.931425: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x211dc11b780 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 09:29:21.934315: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 09:29:23.916362: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 09:29:24.600302: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:29:25.240881: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:29:25.247454: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:29:26.564550: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 09:29:26.613920: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 09:29:27.331615: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 259ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :10.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :10.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 23ms/step
[INFOR]: Toltal norm before transform: 0.6373
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1375

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 23ms/step
[INFOR]: SEN training of class 58_33 before transform: 10
[INFOR]: SPE training of class 58_33 before transform: 16

[INFOR]: SEN training of class 58_33 after transform: 28
[INFOR]: SPE training of class 58_33 after transform: 16
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
3/3 [==============================] - 0s 31ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :15.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :9.0
[INFOR]: SEN testing of class 58_33 before transform: 15
[INFOR]: SPE testing of class 58_33 before transform: 15

[INFOR]: SEN testing of class 58_33 after transform: 26
[INFOR]: SPE testing of class 58_33 after transform: 5
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name fgvc_aircraft --class_name_train 59_33 --class_name_test 59_34
2021-09-13 09:29:30.992644: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  fgvc_aircraft
class_name_train =  59_33
class_name_test =  59_34
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
[INFOR]: get pretrained model
2021-09-13 09:29:33.517774: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 09:29:33.541493: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 09:29:33.546695: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 09:29:33.554700: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:29:33.556878: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:29:33.562062: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 09:29:33.565556: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 09:29:33.571904: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 09:29:33.577035: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 09:29:33.580014: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:29:33.582335: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 09:29:33.584276: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 09:29:33.596797: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x25833a23060 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 09:29:33.599960: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 09:29:33.602105: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 09:29:33.606453: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 09:29:33.608861: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:29:33.611083: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:29:33.613414: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 09:29:33.615613: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 09:29:33.617832: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 09:29:33.620273: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 09:29:33.622587: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:29:33.624846: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 09:29:34.044584: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 09:29:34.047864: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 09:29:34.049284: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 09:29:34.050875: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 09:29:34.057926: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x2585ec9dfe0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 09:29:34.060799: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 09:29:36.038162: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 09:29:36.729009: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:29:37.371218: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:29:37.377350: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:29:38.697669: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 09:29:38.746062: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 09:29:39.465069: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 251ms/step
[INFOR]: Index of most vote   :510
[INFOR]: Class of most vote   :container ship, containership, container vessel
[INFOR]: Number of most vote  :16.0


[INFOR]: Index of second most vote     :404
[INFOR]: Class of second most vote     :airliner
[INFOR]: Number of second most vote    :6.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 31ms/step
[INFOR]: Toltal norm before transform: 0.4727
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0310

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 31ms/step
[INFOR]: SEN training of class 59_33 before transform: 16
[INFOR]: SPE training of class 59_33 before transform: 20

[INFOR]: SEN training of class 59_33 after transform: 28
[INFOR]: SPE training of class 59_33 after transform: 19
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (68, 32, 32, 3)
[INFOR]: shape of y: (68, 1)
3/3 [==============================] - 0s 31ms/step
[INFOR]: Index of most vote   :510
[INFOR]: Class of most vote   :container ship, containership, container vessel
[INFOR]: Number of most vote  :12.0


[INFOR]: Index of second most vote     :404
[INFOR]: Class of second most vote     :airliner
[INFOR]: Number of second most vote    :7.0
[INFOR]: SEN testing of class 59_34 before transform: 12
[INFOR]: SPE testing of class 59_34 before transform: 19

[INFOR]: SEN testing of class 59_34 after transform: 34
[INFOR]: SPE testing of class 59_34 after transform: 0
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name fgvc_aircraft --class_name_train 60_34 --class_name_test 60_33
2021-09-13 09:29:43.549202: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  fgvc_aircraft
class_name_train =  60_34
class_name_test =  60_33
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (68, 32, 32, 3)
[INFOR]: shape of y: (68, 1)
[INFOR]: get pretrained model
2021-09-13 09:29:46.017049: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 09:29:46.040599: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 09:29:46.045201: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 09:29:46.053198: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:29:46.055536: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:29:46.060736: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 09:29:46.064192: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 09:29:46.070577: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 09:29:46.075605: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 09:29:46.078632: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:29:46.080865: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 09:29:46.082955: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 09:29:46.095290: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1abb368b6f0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 09:29:46.098944: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 09:29:46.101123: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 09:29:46.105471: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 09:29:46.107898: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:29:46.110146: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:29:46.112422: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 09:29:46.114603: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 09:29:46.116926: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 09:29:46.119438: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 09:29:46.121692: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:29:46.123942: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 09:29:46.560794: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 09:29:46.564058: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 09:29:46.565466: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 09:29:46.567006: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 09:29:46.573768: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1abe2528190 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 09:29:46.576648: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 09:29:48.523598: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 09:29:49.209954: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:29:49.853950: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:29:49.861323: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:29:51.184192: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 09:29:51.233997: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 09:29:51.953341: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 269ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :12.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :9.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 31ms/step
[INFOR]: Toltal norm before transform: 0.5472
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0852

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 23ms/step
[INFOR]: SEN training of class 60_34 before transform: 12
[INFOR]: SPE training of class 60_34 before transform: 15

[INFOR]: SEN training of class 60_34 after transform: 30
[INFOR]: SPE training of class 60_34 after transform: 15
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
3/3 [==============================] - 0s 31ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :12.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :12.0
[INFOR]: SEN testing of class 60_33 before transform: 12
[INFOR]: SPE testing of class 60_33 before transform: 13

[INFOR]: SEN testing of class 60_33 after transform: 28
[INFOR]: SPE testing of class 60_33 after transform: 9
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name fgvc_aircraft --class_name_train 61_33 --class_name_test 61_33
2021-09-13 09:29:56.073784: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  fgvc_aircraft
class_name_train =  61_33
class_name_test =  61_33
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
[INFOR]: get pretrained model
2021-09-13 09:29:58.548222: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 09:29:58.573190: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 09:29:58.577985: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 09:29:58.586065: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:29:58.588270: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:29:58.593394: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 09:29:58.596931: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 09:29:58.603135: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 09:29:58.608186: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 09:29:58.611130: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:29:58.613305: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 09:29:58.615198: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 09:29:58.627161: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x19cb35e5a10 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 09:29:58.630345: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 09:29:58.632436: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 09:29:58.636835: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 09:29:58.639056: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:29:58.641263: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:29:58.643766: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 09:29:58.645972: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 09:29:58.648258: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 09:29:58.650693: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 09:29:58.652943: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:29:58.655189: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 09:29:59.071338: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 09:29:59.074486: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 09:29:59.075895: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 09:29:59.077454: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 09:29:59.083961: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x19cddff0c20 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 09:29:59.086814: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 09:30:01.083508: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 09:30:01.770295: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:30:02.434432: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:30:02.440800: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:30:03.780038: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 09:30:03.828141: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 09:30:04.545055: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 258ms/step
[INFOR]: Index of most vote   :510
[INFOR]: Class of most vote   :container ship, containership, container vessel
[INFOR]: Number of most vote  :14.0


[INFOR]: Index of second most vote     :404
[INFOR]: Class of second most vote     :airliner
[INFOR]: Number of second most vote    :12.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 31ms/step
[INFOR]: Toltal norm before transform: 0.5344
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0747

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 31ms/step
[INFOR]: SEN training of class 61_33 before transform: 14
[INFOR]: SPE training of class 61_33 before transform: 22

[INFOR]: SEN training of class 61_33 after transform: 31
[INFOR]: SPE training of class 61_33 after transform: 22
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
3/3 [==============================] - 0s 31ms/step
[INFOR]: Index of most vote   :510
[INFOR]: Class of most vote   :container ship, containership, container vessel
[INFOR]: Number of most vote  :13.0


[INFOR]: Index of second most vote     :404
[INFOR]: Class of second most vote     :airliner
[INFOR]: Number of second most vote    :12.0
[INFOR]: SEN testing of class 61_33 before transform: 13
[INFOR]: SPE testing of class 61_33 before transform: 22

[INFOR]: SEN testing of class 61_33 after transform: 29
[INFOR]: SPE testing of class 61_33 after transform: 9
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name fgvc_aircraft --class_name_train 62_34 --class_name_test 62_33
2021-09-13 09:30:08.190427: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  fgvc_aircraft
class_name_train =  62_34
class_name_test =  62_33
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (68, 32, 32, 3)
[INFOR]: shape of y: (68, 1)
[INFOR]: get pretrained model
2021-09-13 09:30:10.679686: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 09:30:10.705393: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 09:30:10.710563: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 09:30:10.718511: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:30:10.720673: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:30:10.726024: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 09:30:10.729362: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 09:30:10.735489: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 09:30:10.740516: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 09:30:10.744067: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:30:10.746561: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 09:30:10.748705: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 09:30:10.761066: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x2bc374db1f0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 09:30:10.764569: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 09:30:10.766912: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 09:30:10.771932: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 09:30:10.774199: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:30:10.776450: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:30:10.778726: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 09:30:10.780955: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 09:30:10.783372: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 09:30:10.785725: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 09:30:10.788070: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:30:10.790327: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 09:30:11.207843: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 09:30:11.210856: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 09:30:11.212262: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 09:30:11.213853: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 09:30:11.220684: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x2bc660cebd0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 09:30:11.223519: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 09:30:13.187347: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 09:30:13.869898: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:30:14.529527: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:30:14.535371: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:30:15.860860: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 09:30:15.908814: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 09:30:16.625317: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 267ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :16.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :11.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 31ms/step
[INFOR]: Toltal norm before transform: 0.4245
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0935

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 31ms/step
[INFOR]: SEN training of class 62_34 before transform: 16
[INFOR]: SPE training of class 62_34 before transform: 19

[INFOR]: SEN training of class 62_34 after transform: 27
[INFOR]: SPE training of class 62_34 after transform: 19
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
3/3 [==============================] - 0s 32ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :20.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :8.0
[INFOR]: SEN testing of class 62_33 before transform: 20
[INFOR]: SPE testing of class 62_33 before transform: 11

[INFOR]: SEN testing of class 62_33 after transform: 33
[INFOR]: SPE testing of class 62_33 after transform: 0
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name fgvc_aircraft --class_name_train 63_33 --class_name_test 63_34
2021-09-13 09:30:20.782500: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  fgvc_aircraft
class_name_train =  63_33
class_name_test =  63_34
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
[INFOR]: get pretrained model
2021-09-13 09:30:23.267338: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 09:30:23.291270: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 09:30:23.295936: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 09:30:23.303662: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:30:23.305842: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:30:23.310804: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 09:30:23.314080: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 09:30:23.320263: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 09:30:23.325082: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 09:30:23.327900: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:30:23.330014: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 09:30:23.332019: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 09:30:23.344307: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1d13a7d5530 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 09:30:23.347739: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 09:30:23.349732: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 09:30:23.354216: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 09:30:23.356524: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:30:23.358582: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:30:23.360672: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 09:30:23.362716: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 09:30:23.364775: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 09:30:23.367061: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 09:30:23.369214: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:30:23.371260: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 09:30:23.794047: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 09:30:23.796894: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 09:30:23.798318: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 09:30:23.799889: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 09:30:23.806727: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1d1696eed70 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 09:30:23.809458: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 09:30:25.797438: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 09:30:26.481428: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:30:27.122486: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:30:27.128368: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:30:28.445768: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 09:30:28.494651: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 09:30:29.211226: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 283ms/step
[INFOR]: Index of most vote   :510
[INFOR]: Class of most vote   :container ship, containership, container vessel
[INFOR]: Number of most vote  :12.0


[INFOR]: Index of second most vote     :404
[INFOR]: Class of second most vote     :airliner
[INFOR]: Number of second most vote    :8.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 31ms/step
[INFOR]: Toltal norm before transform: 0.6199
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.2198

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 39ms/step
[INFOR]: SEN training of class 63_33 before transform: 12
[INFOR]: SPE training of class 63_33 before transform: 22

[INFOR]: SEN training of class 63_33 after transform: 32
[INFOR]: SPE training of class 63_33 after transform: 21
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (68, 32, 32, 3)
[INFOR]: shape of y: (68, 1)
3/3 [==============================] - 0s 31ms/step
[INFOR]: Index of most vote   :510
[INFOR]: Class of most vote   :container ship, containership, container vessel
[INFOR]: Number of most vote  :8.0


[INFOR]: Index of second most vote     :404
[INFOR]: Class of second most vote     :airliner
[INFOR]: Number of second most vote    :5.0
[INFOR]: SEN testing of class 63_34 before transform: 8
[INFOR]: SPE testing of class 63_34 before transform: 20

[INFOR]: SEN testing of class 63_34 after transform: 33
[INFOR]: SPE testing of class 63_34 after transform: 2
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name fgvc_aircraft --class_name_train 64_33 --class_name_test 64_33
2021-09-13 09:30:33.386462: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  fgvc_aircraft
class_name_train =  64_33
class_name_test =  64_33
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
[INFOR]: get pretrained model
2021-09-13 09:30:35.850126: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 09:30:35.874103: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 09:30:35.878675: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 09:30:35.886848: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:30:35.889504: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:30:35.894329: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 09:30:35.897664: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 09:30:35.903622: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 09:30:35.908296: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 09:30:35.911134: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:30:35.913330: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 09:30:35.915171: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 09:30:35.926844: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x185376a3570 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 09:30:35.929990: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 09:30:35.931992: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 09:30:35.936072: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 09:30:35.938224: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:30:35.940493: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:30:35.942582: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 09:30:35.944668: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 09:30:35.946733: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 09:30:35.948829: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 09:30:35.950985: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:30:35.953081: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 09:30:36.376443: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 09:30:36.379312: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 09:30:36.380684: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 09:30:36.382164: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 09:30:36.388605: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x18566386570 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 09:30:36.391374: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 09:30:38.347148: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 09:30:39.032853: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:30:39.677565: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:30:39.683436: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:30:41.010000: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 09:30:41.059235: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 09:30:41.778833: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 250ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :21.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :8.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 23ms/step
[INFOR]: Toltal norm before transform: 0.2941
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0997

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 31ms/step
[INFOR]: SEN training of class 64_33 before transform: 21
[INFOR]: SPE training of class 64_33 before transform: 17

[INFOR]: SEN training of class 64_33 after transform: 31
[INFOR]: SPE training of class 64_33 after transform: 17
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
3/3 [==============================] - 0s 33ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :20.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :8.0
[INFOR]: SEN testing of class 64_33 before transform: 20
[INFOR]: SPE testing of class 64_33 before transform: 21

[INFOR]: SEN testing of class 64_33 after transform: 33
[INFOR]: SPE testing of class 64_33 after transform: 0
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name fgvc_aircraft --class_name_train 65_33 --class_name_test 65_34
2021-09-13 09:30:45.439544: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  fgvc_aircraft
class_name_train =  65_33
class_name_test =  65_34
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
[INFOR]: get pretrained model
2021-09-13 09:30:47.954388: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 09:30:47.978807: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 09:30:47.983735: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 09:30:47.991615: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:30:47.993678: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:30:47.998664: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 09:30:48.001923: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 09:30:48.008135: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 09:30:48.012894: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 09:30:48.015692: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:30:48.017788: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 09:30:48.019782: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 09:30:48.032125: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x28eb8405260 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 09:30:48.035464: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 09:30:48.037406: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 09:30:48.041868: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 09:30:48.044132: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:30:48.046173: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:30:48.048274: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 09:30:48.050295: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 09:30:48.052336: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 09:30:48.054523: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 09:30:48.056635: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:30:48.058854: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 09:30:48.480777: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 09:30:48.483999: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 09:30:48.485360: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 09:30:48.486794: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 09:30:48.493655: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x28ed8db5900 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 09:30:48.496512: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 09:30:50.435641: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 09:30:51.128918: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:30:51.800667: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:30:51.807666: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:30:53.145941: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 09:30:53.193504: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 09:30:53.916477: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 260ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :27.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :5.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 23ms/step
[INFOR]: Toltal norm before transform: 0.2487
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0023

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 31ms/step
[INFOR]: SEN training of class 65_33 before transform: 27
[INFOR]: SPE training of class 65_33 before transform: 21

[INFOR]: SEN training of class 65_33 after transform: 28
[INFOR]: SPE training of class 65_33 after transform: 21
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (68, 32, 32, 3)
[INFOR]: shape of y: (68, 1)
3/3 [==============================] - 0s 31ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :24.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :8.0
[INFOR]: SEN testing of class 65_34 before transform: 24
[INFOR]: SPE testing of class 65_34 before transform: 18

[INFOR]: SEN testing of class 65_34 after transform: 34
[INFOR]: SPE testing of class 65_34 after transform: 0
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name fgvc_aircraft --class_name_train 66_34 --class_name_test 66_33
2021-09-13 09:30:58.042232: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  fgvc_aircraft
class_name_train =  66_34
class_name_test =  66_33
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (68, 32, 32, 3)
[INFOR]: shape of y: (68, 1)
[INFOR]: get pretrained model
2021-09-13 09:31:00.555145: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 09:31:00.578089: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 09:31:00.582572: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 09:31:00.590439: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:31:00.592680: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:31:00.597586: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 09:31:00.600968: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 09:31:00.607054: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 09:31:00.611794: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 09:31:00.614671: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:31:00.616930: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 09:31:00.618736: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 09:31:00.630680: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x166b5480610 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 09:31:00.633892: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 09:31:00.635873: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 09:31:00.639936: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 09:31:00.641986: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:31:00.644039: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:31:00.646321: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 09:31:00.648379: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 09:31:00.650419: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 09:31:00.652572: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 09:31:00.654628: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:31:00.656686: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 09:31:01.080970: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 09:31:01.083950: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 09:31:01.085258: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 09:31:01.086684: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 09:31:01.093110: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x166e065fd00 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 09:31:01.095843: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 09:31:03.073391: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 09:31:03.755953: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:31:04.395119: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:31:04.400923: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:31:05.721753: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 09:31:05.774863: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 09:31:06.491641: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 266ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :20.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :13.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 31ms/step
[INFOR]: Toltal norm before transform: 0.3182
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1529

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 31ms/step
[INFOR]: SEN training of class 66_34 before transform: 20
[INFOR]: SPE training of class 66_34 before transform: 16

[INFOR]: SEN training of class 66_34 after transform: 27
[INFOR]: SPE training of class 66_34 after transform: 16
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
3/3 [==============================] - 0s 31ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :16.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :13.0
[INFOR]: SEN testing of class 66_33 before transform: 16
[INFOR]: SPE testing of class 66_33 before transform: 17

[INFOR]: SEN testing of class 66_33 after transform: 28
[INFOR]: SPE testing of class 66_33 after transform: 7
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name fgvc_aircraft --class_name_train 67_33 --class_name_test 67_33
2021-09-13 09:31:10.605722: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  fgvc_aircraft
class_name_train =  67_33
class_name_test =  67_33
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
[INFOR]: get pretrained model
2021-09-13 09:31:13.071247: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 09:31:13.096401: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 09:31:13.100965: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 09:31:13.108670: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:31:13.110763: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:31:13.115840: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 09:31:13.119046: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 09:31:13.125123: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 09:31:13.129896: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 09:31:13.132669: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:31:13.134754: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 09:31:13.136826: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 09:31:13.148778: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x2a8ba7821f0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 09:31:13.152572: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 09:31:13.154619: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 09:31:13.158967: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 09:31:13.161097: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:31:13.163228: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:31:13.165355: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 09:31:13.167437: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 09:31:13.169537: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 09:31:13.171816: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 09:31:13.173939: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:31:13.176023: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 09:31:13.596510: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 09:31:13.599237: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 09:31:13.600548: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 09:31:13.601978: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 09:31:13.608874: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x2a8e3287180 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 09:31:13.612046: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 09:31:15.567998: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 09:31:16.245498: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:31:16.886373: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:31:16.892870: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:31:18.224365: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 09:31:18.274226: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 09:31:19.032680: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 258ms/step
[INFOR]: Index of most vote   :510
[INFOR]: Class of most vote   :container ship, containership, container vessel
[INFOR]: Number of most vote  :14.0


[INFOR]: Index of second most vote     :404
[INFOR]: Class of second most vote     :airliner
[INFOR]: Number of second most vote    :12.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 32ms/step
[INFOR]: Toltal norm before transform: 0.6454
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1647

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 32ms/step
[INFOR]: SEN training of class 67_33 before transform: 14
[INFOR]: SPE training of class 67_33 before transform: 26

[INFOR]: SEN training of class 67_33 after transform: 26
[INFOR]: SPE training of class 67_33 after transform: 24
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
3/3 [==============================] - 0s 23ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :16.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :7.0
[INFOR]: SEN testing of class 67_33 before transform: 16
[INFOR]: SPE testing of class 67_33 before transform: 15

[INFOR]: SEN testing of class 67_33 after transform: 31
[INFOR]: SPE testing of class 67_33 after transform: 1
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name fgvc_aircraft --class_name_train 68_33 --class_name_test 68_33
2021-09-13 09:31:22.663335: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  fgvc_aircraft
class_name_train =  68_33
class_name_test =  68_33
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
[INFOR]: get pretrained model
2021-09-13 09:31:25.170314: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 09:31:25.196678: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 09:31:25.202759: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 09:31:25.210526: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:31:25.212595: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:31:25.217493: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 09:31:25.220706: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 09:31:25.226885: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 09:31:25.231676: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 09:31:25.234464: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:31:25.236513: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 09:31:25.238385: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 09:31:25.251110: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x172b9acba80 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 09:31:25.254658: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 09:31:25.256696: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 09:31:25.261017: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 09:31:25.263333: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:31:25.265374: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:31:25.267429: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 09:31:25.269442: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 09:31:25.271564: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 09:31:25.273678: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 09:31:25.275723: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:31:25.277770: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 09:31:25.713309: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 09:31:25.716188: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 09:31:25.717516: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 09:31:25.718962: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 09:31:25.725593: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x172e45a78a0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 09:31:25.728353: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 09:31:27.729715: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 09:31:28.483525: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:31:29.135301: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:31:29.141647: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:31:30.516781: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 09:31:30.566868: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 09:31:31.286870: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 252ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :18.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :10.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 24ms/step
[INFOR]: Toltal norm before transform: 0.3637
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0467

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 31ms/step
[INFOR]: SEN training of class 68_33 before transform: 18
[INFOR]: SPE training of class 68_33 before transform: 17

[INFOR]: SEN training of class 68_33 after transform: 24
[INFOR]: SPE training of class 68_33 after transform: 17
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
3/3 [==============================] - 0s 31ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :19.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :7.0
[INFOR]: SEN testing of class 68_33 before transform: 19
[INFOR]: SPE testing of class 68_33 before transform: 13

[INFOR]: SEN testing of class 68_33 after transform: 33
[INFOR]: SPE testing of class 68_33 after transform: 0
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name fgvc_aircraft --class_name_train 69_33 --class_name_test 69_34
2021-09-13 09:31:34.900221: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  fgvc_aircraft
class_name_train =  69_33
class_name_test =  69_34
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
[INFOR]: get pretrained model
2021-09-13 09:31:37.342042: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 09:31:37.366493: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 09:31:37.370957: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 09:31:37.378668: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:31:37.380682: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:31:37.385615: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 09:31:37.388763: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 09:31:37.394763: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 09:31:37.399480: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 09:31:37.403352: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:31:37.405420: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 09:31:37.407239: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 09:31:37.419167: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1ed362a52b0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 09:31:37.422722: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 09:31:37.424721: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 09:31:37.428819: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 09:31:37.430871: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:31:37.433017: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:31:37.435072: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 09:31:37.437081: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 09:31:37.439108: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 09:31:37.441277: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 09:31:37.443525: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:31:37.445549: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 09:31:37.864886: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 09:31:37.868141: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 09:31:37.869517: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 09:31:37.870975: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 09:31:37.877327: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1ed64e1bbf0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 09:31:37.880207: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 09:31:39.844596: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 09:31:40.516460: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:31:41.174797: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:31:41.181560: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:31:42.496154: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 09:31:42.553052: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 09:31:43.268852: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 251ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :17.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :12.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 32ms/step
[INFOR]: Toltal norm before transform: 0.3796
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1473

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 32ms/step
[INFOR]: SEN training of class 69_33 before transform: 17
[INFOR]: SPE training of class 69_33 before transform: 18

[INFOR]: SEN training of class 69_33 after transform: 24
[INFOR]: SPE training of class 69_33 after transform: 18
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (68, 32, 32, 3)
[INFOR]: shape of y: (68, 1)
3/3 [==============================] - 0s 31ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :23.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :8.0
[INFOR]: SEN testing of class 69_34 before transform: 23
[INFOR]: SPE testing of class 69_34 before transform: 20

[INFOR]: SEN testing of class 69_34 after transform: 32
[INFOR]: SPE testing of class 69_34 after transform: 1
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name fgvc_aircraft --class_name_train 70_34 --class_name_test 70_33
2021-09-13 09:31:47.346236: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  fgvc_aircraft
class_name_train =  70_34
class_name_test =  70_33
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (68, 32, 32, 3)
[INFOR]: shape of y: (68, 1)
[INFOR]: get pretrained model
2021-09-13 09:31:49.866571: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 09:31:49.891780: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 09:31:49.896724: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 09:31:49.904585: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:31:49.906631: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:31:49.911630: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 09:31:49.914888: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 09:31:49.921092: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 09:31:49.925804: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 09:31:49.928652: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:31:49.930729: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 09:31:49.932708: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 09:31:49.944947: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x20c32ea1070 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 09:31:49.948482: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 09:31:49.950650: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 09:31:49.955369: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 09:31:49.957524: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:31:49.959642: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:31:49.961854: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 09:31:49.963957: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 09:31:49.966115: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 09:31:49.968473: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 09:31:49.970621: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:31:49.972740: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 09:31:50.395310: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 09:31:50.398571: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 09:31:50.400054: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 09:31:50.401498: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 09:31:50.407916: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x20c61760440 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 09:31:50.410708: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 09:31:52.389444: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 09:31:53.070991: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:31:53.725784: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:31:53.732409: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:31:55.053922: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 09:31:55.100982: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 09:31:55.820086: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 266ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :16.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :12.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 31ms/step
[INFOR]: Toltal norm before transform: 0.5279
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1026

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 31ms/step
[INFOR]: SEN training of class 70_34 before transform: 16
[INFOR]: SPE training of class 70_34 before transform: 17

[INFOR]: SEN training of class 70_34 after transform: 26
[INFOR]: SPE training of class 70_34 after transform: 17
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
3/3 [==============================] - 0s 31ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :12.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :11.0
[INFOR]: SEN testing of class 70_33 before transform: 12
[INFOR]: SPE testing of class 70_33 before transform: 17

[INFOR]: SEN testing of class 70_33 after transform: 33
[INFOR]: SPE testing of class 70_33 after transform: 6
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name fgvc_aircraft --class_name_train 71_33 --class_name_test 71_34
2021-09-13 09:31:59.937424: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  fgvc_aircraft
class_name_train =  71_33
class_name_test =  71_34
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
[INFOR]: get pretrained model
2021-09-13 09:32:02.400529: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 09:32:02.425520: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 09:32:02.430158: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 09:32:02.437738: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:32:02.439894: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:32:02.444736: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 09:32:02.447887: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 09:32:02.453842: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 09:32:02.458717: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 09:32:02.461479: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:32:02.463522: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 09:32:02.465307: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 09:32:02.477560: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x24cb40fb4e0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 09:32:02.481110: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 09:32:02.483082: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 09:32:02.487388: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 09:32:02.489598: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:32:02.491592: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:32:02.493651: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 09:32:02.495638: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 09:32:02.497631: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 09:32:02.499721: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 09:32:02.501747: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:32:02.504080: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 09:32:02.935983: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 09:32:02.939309: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 09:32:02.940969: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 09:32:02.942401: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 09:32:02.948836: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x24ce447b470 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 09:32:02.951569: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 09:32:04.894425: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 09:32:05.570443: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:32:06.211928: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:32:06.219086: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:32:07.535449: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 09:32:07.589822: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 09:32:08.305373: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 253ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :15.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :6.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 32ms/step
[INFOR]: Toltal norm before transform: 0.4803
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0171

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 31ms/step
[INFOR]: SEN training of class 71_33 before transform: 15
[INFOR]: SPE training of class 71_33 before transform: 18

[INFOR]: SEN training of class 71_33 after transform: 24
[INFOR]: SPE training of class 71_33 after transform: 18
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (68, 32, 32, 3)
[INFOR]: shape of y: (68, 1)
3/3 [==============================] - 0s 23ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :27.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :3.0
[INFOR]: SEN testing of class 71_34 before transform: 27
[INFOR]: SPE testing of class 71_34 before transform: 11

[INFOR]: SEN testing of class 71_34 after transform: 34
[INFOR]: SPE testing of class 71_34 after transform: 0
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name fgvc_aircraft --class_name_train 72_33 --class_name_test 72_33
2021-09-13 09:32:12.392044: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  fgvc_aircraft
class_name_train =  72_33
class_name_test =  72_33
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
[INFOR]: get pretrained model
2021-09-13 09:32:14.919370: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 09:32:14.944728: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 09:32:14.949400: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 09:32:14.957055: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:32:14.959111: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:32:14.964084: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 09:32:14.967279: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 09:32:14.973224: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 09:32:14.977941: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 09:32:14.980857: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:32:14.982913: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 09:32:14.984877: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 09:32:14.997295: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1d332ed8a20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 09:32:15.000835: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 09:32:15.002746: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 09:32:15.006959: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 09:32:15.009032: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:32:15.011159: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:32:15.013264: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 09:32:15.015320: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 09:32:15.017395: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 09:32:15.019562: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 09:32:15.021709: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:32:15.023973: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 09:32:15.438652: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 09:32:15.441497: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 09:32:15.442817: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 09:32:15.444256: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 09:32:15.451192: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1d35ee01aa0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 09:32:15.453910: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 09:32:17.423898: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 09:32:18.098631: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:32:18.742697: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:32:18.749010: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:32:20.061879: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 09:32:20.108328: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 09:32:20.827497: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 254ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :18.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :7.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 31ms/step
[INFOR]: Toltal norm before transform: 0.4445
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0803

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 31ms/step
[INFOR]: SEN training of class 72_33 before transform: 18
[INFOR]: SPE training of class 72_33 before transform: 15

[INFOR]: SEN training of class 72_33 after transform: 26
[INFOR]: SPE training of class 72_33 after transform: 15
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
3/3 [==============================] - 0s 24ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :19.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :4.0
[INFOR]: SEN testing of class 72_33 before transform: 19
[INFOR]: SPE testing of class 72_33 before transform: 18

[INFOR]: SEN testing of class 72_33 after transform: 31
[INFOR]: SPE testing of class 72_33 after transform: 7
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name fgvc_aircraft --class_name_train 73_34 --class_name_test 73_33
2021-09-13 09:32:24.432882: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  fgvc_aircraft
class_name_train =  73_34
class_name_test =  73_33
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (68, 32, 32, 3)
[INFOR]: shape of y: (68, 1)
[INFOR]: get pretrained model
2021-09-13 09:32:26.953730: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 09:32:26.976680: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 09:32:26.981265: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 09:32:26.988860: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:32:26.990900: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:32:26.995912: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 09:32:26.999089: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 09:32:27.005028: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 09:32:27.010087: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 09:32:27.013017: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:32:27.015082: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 09:32:27.016905: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 09:32:27.028888: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x154ac8bd320 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 09:32:27.032335: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 09:32:27.034296: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 09:32:27.038372: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 09:32:27.040437: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:32:27.042660: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:32:27.044934: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 09:32:27.046973: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 09:32:27.049023: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 09:32:27.051101: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 09:32:27.053238: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:32:27.055319: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 09:32:27.498056: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 09:32:27.501273: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 09:32:27.502773: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 09:32:27.504342: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 09:32:27.510986: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x154de7a0670 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 09:32:27.513704: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 09:32:29.464076: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 09:32:30.149303: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:32:30.790421: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:32:30.797158: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:32:32.144772: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 09:32:32.199100: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 09:32:32.917513: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 270ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :13.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :7.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 31ms/step
[INFOR]: Toltal norm before transform: 0.5840
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0382

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 31ms/step
[INFOR]: SEN training of class 73_34 before transform: 13
[INFOR]: SPE training of class 73_34 before transform: 22

[INFOR]: SEN training of class 73_34 after transform: 33
[INFOR]: SPE training of class 73_34 after transform: 22
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
3/3 [==============================] - 0s 31ms/step
[INFOR]: Index of most vote   :510
[INFOR]: Class of most vote   :container ship, containership, container vessel
[INFOR]: Number of most vote  :12.0


[INFOR]: Index of second most vote     :404
[INFOR]: Class of second most vote     :airliner
[INFOR]: Number of second most vote    :9.0
[INFOR]: SEN testing of class 73_33 before transform: 12
[INFOR]: SPE testing of class 73_33 before transform: 24

[INFOR]: SEN testing of class 73_33 after transform: 32
[INFOR]: SPE testing of class 73_33 after transform: 0
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name fgvc_aircraft --class_name_train 74_33 --class_name_test 74_34
2021-09-13 09:32:36.992200: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  fgvc_aircraft
class_name_train =  74_33
class_name_test =  74_34
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
[INFOR]: get pretrained model
2021-09-13 09:32:39.507087: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 09:32:39.531579: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 09:32:39.536006: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 09:32:39.543669: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:32:39.545690: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:32:39.550684: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 09:32:39.553872: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 09:32:39.559859: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 09:32:39.564717: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 09:32:39.567659: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:32:39.569673: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 09:32:39.571455: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 09:32:39.583826: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1fa339e6c60 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 09:32:39.587289: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 09:32:39.589246: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 09:32:39.593358: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 09:32:39.595434: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:32:39.597481: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:32:39.599534: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 09:32:39.601518: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 09:32:39.603562: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 09:32:39.605852: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 09:32:39.607902: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:32:39.610453: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 09:32:40.030773: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 09:32:40.033924: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 09:32:40.035275: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 09:32:40.036693: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 09:32:40.043145: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1fa54f10df0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 09:32:40.046243: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 09:32:41.983527: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 09:32:42.652910: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:32:43.293155: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:32:43.298946: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:32:44.622710: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 09:32:44.670491: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 09:32:45.385235: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 247ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :20.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :6.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 31ms/step
[INFOR]: Toltal norm before transform: 0.3439
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0625

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 31ms/step
[INFOR]: SEN training of class 74_33 before transform: 20
[INFOR]: SPE training of class 74_33 before transform: 13

[INFOR]: SEN training of class 74_33 after transform: 26
[INFOR]: SPE training of class 74_33 after transform: 13
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (68, 32, 32, 3)
[INFOR]: shape of y: (68, 1)
3/3 [==============================] - 0s 32ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :25.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :7.0
[INFOR]: SEN testing of class 74_34 before transform: 25
[INFOR]: SPE testing of class 74_34 before transform: 17

[INFOR]: SEN testing of class 74_34 after transform: 34
[INFOR]: SPE testing of class 74_34 after transform: 0
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name fgvc_aircraft --class_name_train 75_34 --class_name_test 75_33
2021-09-13 09:32:49.524642: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  fgvc_aircraft
class_name_train =  75_34
class_name_test =  75_33
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (68, 32, 32, 3)
[INFOR]: shape of y: (68, 1)
[INFOR]: get pretrained model
2021-09-13 09:32:52.051261: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 09:32:52.076795: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 09:32:52.081913: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 09:32:52.089509: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:32:52.091549: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:32:52.096576: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 09:32:52.099811: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 09:32:52.105826: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 09:32:52.110874: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 09:32:52.113755: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:32:52.115996: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 09:32:52.117828: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 09:32:52.129866: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x2813a772000 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 09:32:52.133457: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 09:32:52.135456: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 09:32:52.139600: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 09:32:52.141738: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:32:52.143953: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:32:52.146046: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 09:32:52.148087: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 09:32:52.150145: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 09:32:52.152234: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 09:32:52.154427: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:32:52.156670: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 09:32:52.573995: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 09:32:52.576588: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 09:32:52.578064: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 09:32:52.579723: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 09:32:52.586398: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x28169f9fb90 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 09:32:52.589134: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 09:32:54.561159: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 09:32:55.247677: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:32:55.892080: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:32:55.898305: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:32:57.217662: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 09:32:57.273748: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 09:32:57.988326: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 264ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :18.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :12.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 31ms/step
[INFOR]: Toltal norm before transform: 0.4249
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0503

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 24ms/step
[INFOR]: SEN training of class 75_34 before transform: 18
[INFOR]: SPE training of class 75_34 before transform: 16

[INFOR]: SEN training of class 75_34 after transform: 25
[INFOR]: SPE training of class 75_34 after transform: 16
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
3/3 [==============================] - 0s 31ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :22.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :7.0
[INFOR]: SEN testing of class 75_33 before transform: 22
[INFOR]: SPE testing of class 75_33 before transform: 19

[INFOR]: SEN testing of class 75_33 after transform: 33
[INFOR]: SPE testing of class 75_33 after transform: 1
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name fgvc_aircraft --class_name_train 76_33 --class_name_test 76_33
2021-09-13 09:33:02.102534: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  fgvc_aircraft
class_name_train =  76_33
class_name_test =  76_33
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
[INFOR]: get pretrained model
2021-09-13 09:33:04.565353: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 09:33:04.590492: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 09:33:04.596000: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 09:33:04.603785: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:33:04.605889: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:33:04.610897: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 09:33:04.614327: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 09:33:04.620405: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 09:33:04.625279: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 09:33:04.628232: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:33:04.630330: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 09:33:04.632191: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 09:33:04.644122: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1b5344e3eb0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 09:33:04.647296: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 09:33:04.649319: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 09:33:04.653442: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 09:33:04.655547: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:33:04.657632: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:33:04.659961: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 09:33:04.662045: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 09:33:04.664184: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 09:33:04.666306: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 09:33:04.668404: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:33:04.670451: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 09:33:05.096380: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 09:33:05.099664: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 09:33:05.101172: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 09:33:05.102763: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 09:33:05.109206: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1b55fe5df60 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 09:33:05.112070: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 09:33:07.062091: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 09:33:07.735907: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:33:08.375611: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:33:08.381464: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:33:09.705678: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 09:33:09.755180: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 09:33:10.476285: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 258ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :16.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :9.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 31ms/step
[INFOR]: Toltal norm before transform: 0.4465
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0734

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 31ms/step
[INFOR]: SEN training of class 76_33 before transform: 16
[INFOR]: SPE training of class 76_33 before transform: 12

[INFOR]: SEN training of class 76_33 after transform: 28
[INFOR]: SPE training of class 76_33 after transform: 12
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
3/3 [==============================] - 0s 31ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :16.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :7.0
[INFOR]: SEN testing of class 76_33 before transform: 16
[INFOR]: SPE testing of class 76_33 before transform: 13

[INFOR]: SEN testing of class 76_33 after transform: 33
[INFOR]: SPE testing of class 76_33 after transform: 0
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name fgvc_aircraft --class_name_train 77_33 --class_name_test 77_34
2021-09-13 09:33:14.110630: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  fgvc_aircraft
class_name_train =  77_33
class_name_test =  77_34
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
[INFOR]: get pretrained model
2021-09-13 09:33:16.589604: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 09:33:16.613700: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 09:33:16.617828: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 09:33:16.625699: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:33:16.627713: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:33:16.632576: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 09:33:16.635747: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 09:33:16.641888: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 09:33:16.646620: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 09:33:16.649548: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:33:16.651819: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 09:33:16.653654: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 09:33:16.666185: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x268b4e570e0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 09:33:16.669596: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 09:33:16.671762: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 09:33:16.675901: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 09:33:16.677945: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:33:16.679953: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:33:16.681988: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 09:33:16.684409: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 09:33:16.686421: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 09:33:16.688544: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 09:33:16.690788: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:33:16.692820: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 09:33:17.107259: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 09:33:17.109731: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 09:33:17.111050: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 09:33:17.112480: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 09:33:17.118895: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x268e2f1b6f0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 09:33:17.121888: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 09:33:19.106136: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 09:33:19.790472: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:33:20.433103: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:33:20.439282: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:33:21.771839: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 09:33:21.827143: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 09:33:22.549484: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 254ms/step
[INFOR]: Index of most vote   :510
[INFOR]: Class of most vote   :container ship, containership, container vessel
[INFOR]: Number of most vote  :16.0


[INFOR]: Index of second most vote     :404
[INFOR]: Class of second most vote     :airliner
[INFOR]: Number of second most vote    :11.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 31ms/step
[INFOR]: Toltal norm before transform: 0.4125
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0459

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 32ms/step
[INFOR]: SEN training of class 77_33 before transform: 16
[INFOR]: SPE training of class 77_33 before transform: 26

[INFOR]: SEN training of class 77_33 after transform: 29
[INFOR]: SPE training of class 77_33 after transform: 26
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (68, 32, 32, 3)
[INFOR]: shape of y: (68, 1)
3/3 [==============================] - 0s 31ms/step
[INFOR]: Index of most vote   :510
[INFOR]: Class of most vote   :container ship, containership, container vessel
[INFOR]: Number of most vote  :19.0


[INFOR]: Index of second most vote     :404
[INFOR]: Class of second most vote     :airliner
[INFOR]: Number of second most vote    :11.0
[INFOR]: SEN testing of class 77_34 before transform: 19
[INFOR]: SPE testing of class 77_34 before transform: 24

[INFOR]: SEN testing of class 77_34 after transform: 32
[INFOR]: SPE testing of class 77_34 after transform: 7
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name fgvc_aircraft --class_name_train 78_34 --class_name_test 78_33
2021-09-13 09:33:26.655382: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  fgvc_aircraft
class_name_train =  78_34
class_name_test =  78_33
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (68, 32, 32, 3)
[INFOR]: shape of y: (68, 1)
[INFOR]: get pretrained model
2021-09-13 09:33:29.104894: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 09:33:29.130387: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 09:33:29.135320: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 09:33:29.142984: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:33:29.145020: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:33:29.149939: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 09:33:29.153142: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 09:33:29.159168: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 09:33:29.164077: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 09:33:29.166974: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:33:29.169008: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 09:33:29.170834: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 09:33:29.182949: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1ba33443640 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 09:33:29.186130: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 09:33:29.188104: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 09:33:29.192177: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 09:33:29.194251: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:33:29.196517: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:33:29.198553: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 09:33:29.200548: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 09:33:29.202554: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 09:33:29.204623: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 09:33:29.206724: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:33:29.208718: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 09:33:29.635363: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 09:33:29.638181: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 09:33:29.639519: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 09:33:29.640984: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 09:33:29.647477: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1ba627e9a20 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 09:33:29.650431: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 09:33:31.634474: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 09:33:32.318729: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:33:32.976177: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:33:32.982169: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:33:34.314484: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 09:33:34.361926: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 09:33:35.144208: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 266ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :21.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :8.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 31ms/step
[INFOR]: Toltal norm before transform: 0.3538
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0432

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 31ms/step
[INFOR]: SEN training of class 78_34 before transform: 21
[INFOR]: SPE training of class 78_34 before transform: 18

[INFOR]: SEN training of class 78_34 after transform: 29
[INFOR]: SPE training of class 78_34 after transform: 18
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
3/3 [==============================] - 0s 31ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :19.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :13.0
[INFOR]: SEN testing of class 78_33 before transform: 19
[INFOR]: SPE testing of class 78_33 before transform: 12

[INFOR]: SEN testing of class 78_33 after transform: 33
[INFOR]: SPE testing of class 78_33 after transform: 0
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name fgvc_aircraft --class_name_train 79_33 --class_name_test 79_33
2021-09-13 09:33:39.275644: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  fgvc_aircraft
class_name_train =  79_33
class_name_test =  79_33
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
[INFOR]: get pretrained model
2021-09-13 09:33:41.737995: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 09:33:41.765670: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 09:33:41.770774: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 09:33:41.779010: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:33:41.781371: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:33:41.786780: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 09:33:41.790137: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 09:33:41.796401: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 09:33:41.801240: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 09:33:41.804173: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:33:41.806228: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 09:33:41.808036: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 09:33:41.819574: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x25bb4a0d2d0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 09:33:41.822753: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 09:33:41.824764: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 09:33:41.829177: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 09:33:41.831504: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:33:41.833763: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:33:41.835869: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 09:33:41.837970: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 09:33:41.840250: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 09:33:41.842408: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 09:33:41.844503: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:33:41.846561: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 09:33:42.267070: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 09:33:42.270059: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 09:33:42.271532: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 09:33:42.272995: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 09:33:42.279322: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x25bdec0cae0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 09:33:42.282034: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 09:33:44.230967: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 09:33:44.903294: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:33:45.549853: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:33:45.556402: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:33:46.896027: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 09:33:46.946397: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 09:33:47.667770: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 250ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :21.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :7.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 31ms/step
[INFOR]: Toltal norm before transform: 0.2606
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0097

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 31ms/step
[INFOR]: SEN training of class 79_33 before transform: 21
[INFOR]: SPE training of class 79_33 before transform: 14

[INFOR]: SEN training of class 79_33 after transform: 29
[INFOR]: SPE training of class 79_33 after transform: 14
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
3/3 [==============================] - 0s 39ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :19.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :7.0
[INFOR]: SEN testing of class 79_33 before transform: 19
[INFOR]: SPE testing of class 79_33 before transform: 12

[INFOR]: SEN testing of class 79_33 after transform: 31
[INFOR]: SPE testing of class 79_33 after transform: 3
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name fgvc_aircraft --class_name_train 80_33 --class_name_test 80_34
2021-09-13 09:33:51.315657: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  fgvc_aircraft
class_name_train =  80_33
class_name_test =  80_34
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
[INFOR]: get pretrained model
2021-09-13 09:33:53.780033: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 09:33:53.804213: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 09:33:53.808784: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 09:33:53.816294: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:33:53.818305: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:33:53.823237: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 09:33:53.826389: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 09:33:53.832375: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 09:33:53.837315: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 09:33:53.840043: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:33:53.842051: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 09:33:53.843830: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 09:33:53.856185: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x2033a628620 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 09:33:53.859693: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 09:33:53.861597: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 09:33:53.865723: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 09:33:53.867835: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:33:53.869880: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:33:53.871907: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 09:33:53.873890: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 09:33:53.875886: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 09:33:53.877968: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 09:33:53.880042: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:33:53.882343: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 09:33:54.301462: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 09:33:54.304659: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 09:33:54.306043: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 09:33:54.307552: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 09:33:54.313893: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x20368498fd0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 09:33:54.316616: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 09:33:56.281898: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 09:33:56.998094: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:33:57.652059: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:33:57.657821: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:33:59.004326: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 09:33:59.054799: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 09:33:59.776836: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 289ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :19.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :10.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 31ms/step
[INFOR]: Toltal norm before transform: 0.2913
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0008

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 31ms/step
[INFOR]: SEN training of class 80_33 before transform: 19
[INFOR]: SPE training of class 80_33 before transform: 17

[INFOR]: SEN training of class 80_33 after transform: 30
[INFOR]: SPE training of class 80_33 after transform: 17
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (68, 32, 32, 3)
[INFOR]: shape of y: (68, 1)
3/3 [==============================] - 0s 31ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :18.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :12.0
[INFOR]: SEN testing of class 80_34 before transform: 18
[INFOR]: SPE testing of class 80_34 before transform: 16

[INFOR]: SEN testing of class 80_34 after transform: 34
[INFOR]: SPE testing of class 80_34 after transform: 0
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name fgvc_aircraft --class_name_train 81_34 --class_name_test 81_33
2021-09-13 09:34:03.997458: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  fgvc_aircraft
class_name_train =  81_34
class_name_test =  81_33
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (68, 32, 32, 3)
[INFOR]: shape of y: (68, 1)
[INFOR]: get pretrained model
2021-09-13 09:34:06.583839: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 09:34:06.608395: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 09:34:06.613207: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 09:34:06.621229: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:34:06.623305: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:34:06.628369: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 09:34:06.631845: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 09:34:06.638059: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 09:34:06.643112: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 09:34:06.645941: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:34:06.648016: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 09:34:06.649858: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 09:34:06.661991: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x19cba9d6710 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 09:34:06.665279: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 09:34:06.667416: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 09:34:06.671489: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 09:34:06.673568: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:34:06.675693: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:34:06.677778: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 09:34:06.679820: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 09:34:06.682093: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 09:34:06.684288: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 09:34:06.686557: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:34:06.688596: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 09:34:07.110683: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 09:34:07.113241: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 09:34:07.114587: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 09:34:07.116155: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 09:34:07.122817: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x19ce497c970 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 09:34:07.125748: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 09:34:09.105610: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 09:34:09.807156: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:34:10.454104: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:34:10.460709: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:34:11.814696: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 09:34:11.863331: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 09:34:12.579341: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 305ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :17.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :9.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 32ms/step
[INFOR]: Toltal norm before transform: 0.5020
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.2298

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 31ms/step
[INFOR]: SEN training of class 81_34 before transform: 17
[INFOR]: SPE training of class 81_34 before transform: 15

[INFOR]: SEN training of class 81_34 after transform: 26
[INFOR]: SPE training of class 81_34 after transform: 15
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
3/3 [==============================] - 0s 31ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :14.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :14.0
[INFOR]: SEN testing of class 81_33 before transform: 14
[INFOR]: SPE testing of class 81_33 before transform: 13

[INFOR]: SEN testing of class 81_33 after transform: 33
[INFOR]: SPE testing of class 81_33 after transform: 0
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name fgvc_aircraft --class_name_train 82_33 --class_name_test 82_33
2021-09-13 09:34:16.855817: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  fgvc_aircraft
class_name_train =  82_33
class_name_test =  82_33
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
[INFOR]: get pretrained model
2021-09-13 09:34:19.472949: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 09:34:19.496397: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 09:34:19.501149: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 09:34:19.509210: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:34:19.511784: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:34:19.517012: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 09:34:19.520599: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 09:34:19.527014: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 09:34:19.532319: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 09:34:19.535337: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:34:19.537512: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 09:34:19.539422: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 09:34:19.551248: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x17933a073d0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 09:34:19.554449: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 09:34:19.556580: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 09:34:19.561218: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 09:34:19.563438: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:34:19.565722: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:34:19.568008: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 09:34:19.570178: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 09:34:19.572446: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 09:34:19.574785: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 09:34:19.577066: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:34:19.579295: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 09:34:20.008879: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 09:34:20.011495: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 09:34:20.012937: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 09:34:20.014567: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 09:34:20.021222: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1795e3dcfb0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 09:34:20.024155: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 09:34:22.039799: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 09:34:22.713080: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:34:23.364506: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:34:23.371633: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:34:24.707231: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 09:34:24.757011: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 09:34:25.472808: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 251ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :14.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :5.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 31ms/step
[INFOR]: Toltal norm before transform: 0.4485
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1016

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 32ms/step
[INFOR]: SEN training of class 82_33 before transform: 14
[INFOR]: SPE training of class 82_33 before transform: 13

[INFOR]: SEN training of class 82_33 after transform: 32
[INFOR]: SPE training of class 82_33 after transform: 13
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
3/3 [==============================] - 0s 31ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :15.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :8.0
[INFOR]: SEN testing of class 82_33 before transform: 15
[INFOR]: SPE testing of class 82_33 before transform: 17

[INFOR]: SEN testing of class 82_33 after transform: 32
[INFOR]: SPE testing of class 82_33 after transform: 2
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name fgvc_aircraft --class_name_train 83_33 --class_name_test 83_34
2021-09-13 09:34:29.091798: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  fgvc_aircraft
class_name_train =  83_33
class_name_test =  83_34
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
[INFOR]: get pretrained model
2021-09-13 09:34:31.571577: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 09:34:31.597164: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 09:34:31.601516: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 09:34:31.609380: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:34:31.611480: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:34:31.616523: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 09:34:31.619848: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 09:34:31.625993: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 09:34:31.630824: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 09:34:31.633682: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:34:31.635832: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 09:34:31.637904: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 09:34:31.649706: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x26b37a91940 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 09:34:31.652724: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 09:34:31.654701: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 09:34:31.658991: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 09:34:31.661109: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:34:31.663192: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:34:31.665303: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 09:34:31.667375: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 09:34:31.669527: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 09:34:31.671753: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 09:34:31.674067: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:34:31.676140: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 09:34:32.097642: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 09:34:32.100459: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 09:34:32.101917: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 09:34:32.103482: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 09:34:32.110111: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x26b6781ee60 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 09:34:32.112992: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 09:34:34.064673: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 09:34:34.746786: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:34:35.389708: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:34:35.396749: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:34:36.717076: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 09:34:36.771683: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 09:34:37.491757: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 255ms/step
[INFOR]: Index of most vote   :510
[INFOR]: Class of most vote   :container ship, containership, container vessel
[INFOR]: Number of most vote  :20.0


[INFOR]: Index of second most vote     :404
[INFOR]: Class of second most vote     :airliner
[INFOR]: Number of second most vote    :12.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 23ms/step
[INFOR]: Toltal norm before transform: 0.4380
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0278

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 33ms/step
[INFOR]: SEN training of class 83_33 before transform: 20
[INFOR]: SPE training of class 83_33 before transform: 21

[INFOR]: SEN training of class 83_33 after transform: 26
[INFOR]: SPE training of class 83_33 after transform: 21
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (68, 32, 32, 3)
[INFOR]: shape of y: (68, 1)
3/3 [==============================] - 0s 31ms/step
[INFOR]: Index of most vote   :510
[INFOR]: Class of most vote   :container ship, containership, container vessel
[INFOR]: Number of most vote  :18.0


[INFOR]: Index of second most vote     :404
[INFOR]: Class of second most vote     :airliner
[INFOR]: Number of second most vote    :13.0
[INFOR]: SEN testing of class 83_34 before transform: 18
[INFOR]: SPE testing of class 83_34 before transform: 25

[INFOR]: SEN testing of class 83_34 after transform: 34
[INFOR]: SPE testing of class 83_34 after transform: 2
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name fgvc_aircraft --class_name_train 84_34 --class_name_test 84_33
2021-09-13 09:34:41.581247: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  fgvc_aircraft
class_name_train =  84_34
class_name_test =  84_33
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (68, 32, 32, 3)
[INFOR]: shape of y: (68, 1)
[INFOR]: get pretrained model
2021-09-13 09:34:44.045398: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 09:34:44.068511: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 09:34:44.073279: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 09:34:44.081092: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:34:44.083176: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:34:44.088210: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 09:34:44.091516: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 09:34:44.097570: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 09:34:44.102549: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 09:34:44.105397: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:34:44.107713: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 09:34:44.109681: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 09:34:44.121837: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x261b72b74b0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 09:34:44.125573: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 09:34:44.127689: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 09:34:44.131735: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 09:34:44.133801: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:34:44.135881: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:34:44.138250: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 09:34:44.140275: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 09:34:44.142308: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 09:34:44.144428: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 09:34:44.146487: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:34:44.148547: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 09:34:44.566208: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 09:34:44.569411: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 09:34:44.570893: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 09:34:44.572434: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 09:34:44.579096: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x261e2b430d0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 09:34:44.582014: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 09:34:46.551485: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 09:34:47.225046: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:34:47.872073: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:34:47.879341: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:34:49.210061: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 09:34:49.259772: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 09:34:49.978036: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 297ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :14.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :11.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 31ms/step
[INFOR]: Toltal norm before transform: 0.5482
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0668

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 32ms/step
[INFOR]: SEN training of class 84_34 before transform: 14
[INFOR]: SPE training of class 84_34 before transform: 14

[INFOR]: SEN training of class 84_34 after transform: 28
[INFOR]: SPE training of class 84_34 after transform: 14
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
3/3 [==============================] - 0s 39ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :15.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :6.0
[INFOR]: SEN testing of class 84_33 before transform: 15
[INFOR]: SPE testing of class 84_33 before transform: 21

[INFOR]: SEN testing of class 84_33 after transform: 29
[INFOR]: SPE testing of class 84_33 after transform: 8
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name fgvc_aircraft --class_name_train 85_33 --class_name_test 85_33
2021-09-13 09:34:54.213522: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  fgvc_aircraft
class_name_train =  85_33
class_name_test =  85_33
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
[INFOR]: get pretrained model
2021-09-13 09:34:56.748452: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 09:34:56.771684: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 09:34:56.775984: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 09:34:56.784119: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:34:56.786248: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:34:56.791285: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 09:34:56.794608: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 09:34:56.800711: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 09:34:56.805714: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 09:34:56.808575: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:34:56.810794: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 09:34:56.812684: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 09:34:56.824538: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x23136b7f970 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 09:34:56.827800: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 09:34:56.829786: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 09:34:56.833934: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 09:34:56.836083: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:34:56.838372: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:34:56.840481: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 09:34:56.842658: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 09:34:56.844747: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 09:34:56.846860: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 09:34:56.849042: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:34:56.851121: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 09:34:57.268696: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 09:34:57.271317: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 09:34:57.272652: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 09:34:57.274132: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 09:34:57.280867: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x231655a4c60 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 09:34:57.283614: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 09:34:59.250177: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 09:34:59.937046: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:35:00.583000: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:35:00.589634: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:35:01.926647: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 09:35:01.981706: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 09:35:02.700040: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 250ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :21.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :10.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 31ms/step
[INFOR]: Toltal norm before transform: 0.2987
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0247

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 31ms/step
[INFOR]: SEN training of class 85_33 before transform: 21
[INFOR]: SPE training of class 85_33 before transform: 15

[INFOR]: SEN training of class 85_33 after transform: 26
[INFOR]: SPE training of class 85_33 after transform: 15
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
3/3 [==============================] - 0s 31ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :21.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :7.0
[INFOR]: SEN testing of class 85_33 before transform: 21
[INFOR]: SPE testing of class 85_33 before transform: 15

[INFOR]: SEN testing of class 85_33 after transform: 33
[INFOR]: SPE testing of class 85_33 after transform: 0
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name fgvc_aircraft --class_name_train 86_33 --class_name_test 86_34
2021-09-13 09:35:06.304909: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  fgvc_aircraft
class_name_train =  86_33
class_name_test =  86_34
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
[INFOR]: get pretrained model
2021-09-13 09:35:08.766500: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 09:35:08.790565: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 09:35:08.795181: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 09:35:08.802768: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:35:08.804926: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:35:08.809742: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 09:35:08.812926: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 09:35:08.818955: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 09:35:08.823983: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 09:35:08.826753: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:35:08.828797: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 09:35:08.830610: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 09:35:08.843057: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1d7371cd3f0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 09:35:08.846846: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 09:35:08.849020: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 09:35:08.853593: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 09:35:08.855840: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:35:08.857864: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:35:08.859917: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 09:35:08.861930: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 09:35:08.863956: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 09:35:08.866011: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 09:35:08.868256: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:35:08.870283: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 09:35:09.293836: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 09:35:09.296998: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 09:35:09.298307: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 09:35:09.299768: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 09:35:09.306293: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1d75f4ac180 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 09:35:09.309274: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 09:35:11.270315: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 09:35:11.942278: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:35:12.581946: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:35:12.588495: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:35:13.908757: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 09:35:13.956485: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 09:35:14.682696: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 266ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :19.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :8.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 31ms/step
[INFOR]: Toltal norm before transform: 0.3123
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0055

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 31ms/step
[INFOR]: SEN training of class 86_33 before transform: 19
[INFOR]: SPE training of class 86_33 before transform: 17

[INFOR]: SEN training of class 86_33 after transform: 27
[INFOR]: SPE training of class 86_33 after transform: 17
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (68, 32, 32, 3)
[INFOR]: shape of y: (68, 1)
3/3 [==============================] - 0s 31ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :13.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :9.0
[INFOR]: SEN testing of class 86_34 before transform: 13
[INFOR]: SPE testing of class 86_34 before transform: 17

[INFOR]: SEN testing of class 86_34 after transform: 34
[INFOR]: SPE testing of class 86_34 after transform: 0
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name fgvc_aircraft --class_name_train 87_34 --class_name_test 87_33
2021-09-13 09:35:18.848643: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  fgvc_aircraft
class_name_train =  87_34
class_name_test =  87_33
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (68, 32, 32, 3)
[INFOR]: shape of y: (68, 1)
[INFOR]: get pretrained model
2021-09-13 09:35:21.344944: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 09:35:21.371110: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 09:35:21.375517: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 09:35:21.383371: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:35:21.385546: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:35:21.390531: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 09:35:21.393734: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 09:35:21.399912: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 09:35:21.404597: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 09:35:21.407347: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:35:21.409359: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 09:35:21.411143: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 09:35:21.423619: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x2a7b556e250 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 09:35:21.426791: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 09:35:21.428969: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 09:35:21.433270: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 09:35:21.435335: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:35:21.437369: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:35:21.439437: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 09:35:21.441459: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 09:35:21.443666: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 09:35:21.445732: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 09:35:21.447855: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:35:21.449924: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 09:35:21.869231: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 09:35:21.872475: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 09:35:21.873967: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 09:35:21.875525: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 09:35:21.882085: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x2a7e362bb00 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 09:35:21.884817: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 09:35:23.829777: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 09:35:24.504735: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:35:25.145301: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:35:25.151426: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:35:26.474455: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 09:35:26.529148: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 09:35:27.250258: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 267ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :24.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :5.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 31ms/step
[INFOR]: Toltal norm before transform: 0.1738
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0244

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 32ms/step
[INFOR]: SEN training of class 87_34 before transform: 24
[INFOR]: SPE training of class 87_34 before transform: 19

[INFOR]: SEN training of class 87_34 after transform: 33
[INFOR]: SPE training of class 87_34 after transform: 19
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
3/3 [==============================] - 0s 32ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :20.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :8.0
[INFOR]: SEN testing of class 87_33 before transform: 20
[INFOR]: SPE testing of class 87_33 before transform: 16

[INFOR]: SEN testing of class 87_33 after transform: 33
[INFOR]: SPE testing of class 87_33 after transform: 0
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name fgvc_aircraft --class_name_train 88_33 --class_name_test 88_33
2021-09-13 09:35:31.341295: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  fgvc_aircraft
class_name_train =  88_33
class_name_test =  88_33
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
[INFOR]: get pretrained model
2021-09-13 09:35:33.869176: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 09:35:33.892807: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 09:35:33.897226: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 09:35:33.904948: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:35:33.907018: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:35:33.912095: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 09:35:33.915469: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 09:35:33.921468: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 09:35:33.926249: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 09:35:33.929103: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:35:33.931317: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 09:35:33.933139: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 09:35:33.945161: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1ddb9e54f50 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 09:35:33.948657: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 09:35:33.950619: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 09:35:33.954651: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 09:35:33.956720: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:35:33.958790: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:35:33.961115: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 09:35:33.963152: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 09:35:33.965197: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 09:35:33.967319: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 09:35:33.969666: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:35:33.971737: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 09:35:34.389573: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 09:35:34.392803: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 09:35:34.394161: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 09:35:34.395592: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 09:35:34.401971: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1ddda977340 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 09:35:34.404845: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 09:35:36.361649: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 09:35:37.044692: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:35:37.687642: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:35:37.693299: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:35:39.011709: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 09:35:39.059095: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 09:35:39.780438: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 258ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :11.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :10.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 31ms/step
[INFOR]: Toltal norm before transform: 0.6422
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1719

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 31ms/step
[INFOR]: SEN training of class 88_33 before transform: 11
[INFOR]: SPE training of class 88_33 before transform: 20

[INFOR]: SEN training of class 88_33 after transform: 31
[INFOR]: SPE training of class 88_33 after transform: 20
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
3/3 [==============================] - 0s 31ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :17.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :6.0
[INFOR]: SEN testing of class 88_33 before transform: 17
[INFOR]: SPE testing of class 88_33 before transform: 19

[INFOR]: SEN testing of class 88_33 after transform: 32
[INFOR]: SPE testing of class 88_33 after transform: 5
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name fgvc_aircraft --class_name_train 89_33 --class_name_test 89_34
2021-09-13 09:35:43.361646: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  fgvc_aircraft
class_name_train =  89_33
class_name_test =  89_34
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
[INFOR]: get pretrained model
2021-09-13 09:35:45.841342: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 09:35:45.868053: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 09:35:45.872396: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 09:35:45.880267: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:35:45.882527: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:35:45.887407: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 09:35:45.890604: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 09:35:45.896792: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 09:35:45.901728: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 09:35:45.904530: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:35:45.906590: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 09:35:45.908404: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 09:35:45.919984: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x2b2b92e2360 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 09:35:45.923225: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 09:35:45.925266: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 09:35:45.929477: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 09:35:45.931614: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:35:45.933734: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:35:45.935882: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 09:35:45.938014: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 09:35:45.940331: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 09:35:45.942462: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 09:35:45.944714: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:35:45.946810: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 09:35:46.368936: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 09:35:46.372182: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 09:35:46.373535: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 09:35:46.374960: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 09:35:46.381476: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x2b2e4866ac0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 09:35:46.384289: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 09:35:48.332432: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 09:35:49.015838: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:35:49.656225: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:35:49.663161: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:35:50.979707: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 09:35:51.035168: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 09:35:51.757328: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 258ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :13.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :10.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 31ms/step
[INFOR]: Toltal norm before transform: 0.5757
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0067

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 31ms/step
[INFOR]: SEN training of class 89_33 before transform: 13
[INFOR]: SPE training of class 89_33 before transform: 17

[INFOR]: SEN training of class 89_33 after transform: 26
[INFOR]: SPE training of class 89_33 after transform: 17
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (68, 32, 32, 3)
[INFOR]: shape of y: (68, 1)
3/3 [==============================] - 0s 39ms/step
[INFOR]: Index of most vote   :510
[INFOR]: Class of most vote   :container ship, containership, container vessel
[INFOR]: Number of most vote  :16.0


[INFOR]: Index of second most vote     :404
[INFOR]: Class of second most vote     :airliner
[INFOR]: Number of second most vote    :11.0
[INFOR]: SEN testing of class 89_34 before transform: 16
[INFOR]: SPE testing of class 89_34 before transform: 23

[INFOR]: SEN testing of class 89_34 after transform: 32
[INFOR]: SPE testing of class 89_34 after transform: 1
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name fgvc_aircraft --class_name_train 90_34 --class_name_test 90_33
2021-09-13 09:35:55.867829: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  fgvc_aircraft
class_name_train =  90_34
class_name_test =  90_33
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (68, 32, 32, 3)
[INFOR]: shape of y: (68, 1)
[INFOR]: get pretrained model
2021-09-13 09:35:58.391548: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 09:35:58.416663: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 09:35:58.421218: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 09:35:58.429079: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:35:58.431322: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:35:58.436361: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 09:35:58.439646: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 09:35:58.445901: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 09:35:58.450776: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 09:35:58.453619: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:35:58.455724: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 09:35:58.457557: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 09:35:58.469536: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x168b691b900 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 09:35:58.472668: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 09:35:58.474660: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 09:35:58.478781: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 09:35:58.480934: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:35:58.483203: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:35:58.485301: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 09:35:58.487359: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 09:35:58.489429: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 09:35:58.491592: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 09:35:58.493695: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:35:58.495806: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 09:35:58.939244: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 09:35:58.942391: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 09:35:58.943724: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 09:35:58.945176: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 09:35:58.951698: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x168e0f2a520 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 09:35:58.954457: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 09:36:00.944059: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 09:36:01.633501: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:36:02.282568: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:36:02.289421: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:36:03.624920: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 09:36:03.670893: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 09:36:04.386911: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 267ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :14.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :10.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 31ms/step
[INFOR]: Toltal norm before transform: 0.5298
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0905

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 31ms/step
[INFOR]: SEN training of class 90_34 before transform: 14
[INFOR]: SPE training of class 90_34 before transform: 12

[INFOR]: SEN training of class 90_34 after transform: 27
[INFOR]: SPE training of class 90_34 after transform: 12
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
3/3 [==============================] - 0s 31ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :13.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :13.0
[INFOR]: SEN testing of class 90_33 before transform: 13
[INFOR]: SPE testing of class 90_33 before transform: 19

[INFOR]: SEN testing of class 90_33 after transform: 28
[INFOR]: SPE testing of class 90_33 after transform: 1
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name fgvc_aircraft --class_name_train 91_33 --class_name_test 91_33
2021-09-13 09:36:08.515887: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  fgvc_aircraft
class_name_train =  91_33
class_name_test =  91_33
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
[INFOR]: get pretrained model
2021-09-13 09:36:10.967945: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 09:36:10.991726: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 09:36:10.996112: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 09:36:11.003734: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:36:11.005760: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:36:11.010671: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 09:36:11.013836: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 09:36:11.019851: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 09:36:11.024525: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 09:36:11.027301: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:36:11.029360: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 09:36:11.031367: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 09:36:11.043494: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x21ab380bd20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 09:36:11.047221: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 09:36:11.049215: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 09:36:11.053283: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 09:36:11.055340: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:36:11.057391: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:36:11.059636: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 09:36:11.061822: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 09:36:11.063870: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 09:36:11.066143: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 09:36:11.068178: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:36:11.070182: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 09:36:11.489218: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 09:36:11.491998: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 09:36:11.493312: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 09:36:11.494734: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 09:36:11.501334: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x21addfc60f0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 09:36:11.504245: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 09:36:13.448062: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 09:36:14.127332: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:36:14.781189: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:36:14.788259: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:36:16.105493: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 09:36:16.152966: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 09:36:16.868042: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 250ms/step
[INFOR]: Index of most vote   :510
[INFOR]: Class of most vote   :container ship, containership, container vessel
[INFOR]: Number of most vote  :10.0


[INFOR]: Index of second most vote     :404
[INFOR]: Class of second most vote     :airliner
[INFOR]: Number of second most vote    :8.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 31ms/step
[INFOR]: Toltal norm before transform: 0.7081
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.3383

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 31ms/step
[INFOR]: SEN training of class 91_33 before transform: 10
[INFOR]: SPE training of class 91_33 before transform: 17

[INFOR]: SEN training of class 91_33 after transform: 31
[INFOR]: SPE training of class 91_33 after transform: 17
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
3/3 [==============================] - 0s 29ms/step
[INFOR]: Index of most vote   :510
[INFOR]: Class of most vote   :container ship, containership, container vessel
[INFOR]: Number of most vote  :12.0


[INFOR]: Index of second most vote     :404
[INFOR]: Class of second most vote     :airliner
[INFOR]: Number of second most vote    :10.0
[INFOR]: SEN testing of class 91_33 before transform: 12
[INFOR]: SPE testing of class 91_33 before transform: 26

[INFOR]: SEN testing of class 91_33 after transform: 27
[INFOR]: SPE testing of class 91_33 after transform: 10
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name fgvc_aircraft --class_name_train 92_34 --class_name_test 92_33
2021-09-13 09:36:20.468310: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  fgvc_aircraft
class_name_train =  92_34
class_name_test =  92_33
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (68, 32, 32, 3)
[INFOR]: shape of y: (68, 1)
[INFOR]: get pretrained model
2021-09-13 09:36:22.933915: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 09:36:22.957905: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 09:36:22.962535: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 09:36:22.970466: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:36:22.972488: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:36:22.977384: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 09:36:22.980550: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 09:36:22.986568: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 09:36:22.991294: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 09:36:22.994088: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:36:22.996151: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 09:36:22.998118: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 09:36:23.010573: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1f3b4b1f400 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 09:36:23.014028: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 09:36:23.016094: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 09:36:23.020241: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 09:36:23.022340: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:36:23.024445: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:36:23.026555: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 09:36:23.028624: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 09:36:23.030745: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 09:36:23.032890: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 09:36:23.035066: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:36:23.037130: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 09:36:23.455630: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 09:36:23.458404: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 09:36:23.459732: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 09:36:23.461170: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 09:36:23.467539: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1f3df021f30 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 09:36:23.470565: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 09:36:25.427617: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 09:36:26.111307: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:36:26.753434: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:36:26.759417: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:36:28.085115: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 09:36:28.140110: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 09:36:28.860522: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 268ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :17.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :8.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 31ms/step
[INFOR]: Toltal norm before transform: 0.4335
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1465

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 23ms/step
[INFOR]: SEN training of class 92_34 before transform: 17
[INFOR]: SPE training of class 92_34 before transform: 14

[INFOR]: SEN training of class 92_34 after transform: 27
[INFOR]: SPE training of class 92_34 after transform: 14
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
3/3 [==============================] - 0s 31ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :12.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :11.0
[INFOR]: SEN testing of class 92_33 before transform: 12
[INFOR]: SPE testing of class 92_33 before transform: 13

[INFOR]: SEN testing of class 92_33 after transform: 32
[INFOR]: SPE testing of class 92_33 after transform: 0
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name fgvc_aircraft --class_name_train 93_33 --class_name_test 93_33
2021-09-13 09:36:32.953070: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  fgvc_aircraft
class_name_train =  93_33
class_name_test =  93_33
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
[INFOR]: get pretrained model
2021-09-13 09:36:35.425039: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 09:36:35.450456: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 09:36:35.454907: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 09:36:35.462684: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:36:35.465102: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:36:35.470224: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 09:36:35.473441: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 09:36:35.479482: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 09:36:35.484182: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 09:36:35.487106: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:36:35.489127: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 09:36:35.490910: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 09:36:35.503226: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x2043808d710 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 09:36:35.506802: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 09:36:35.508809: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 09:36:35.512987: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 09:36:35.515098: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:36:35.517222: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:36:35.519533: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 09:36:35.521595: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 09:36:35.523677: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 09:36:35.525965: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 09:36:35.528054: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:36:35.530132: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 09:36:35.951414: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 09:36:35.954671: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 09:36:35.956053: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 09:36:35.957509: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 09:36:35.964249: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x20462c9c2f0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 09:36:35.967140: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 09:36:37.946519: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 09:36:38.625233: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:36:39.268813: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:36:39.274632: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:36:40.604078: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 09:36:40.654185: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 09:36:41.374095: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 255ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :20.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :8.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 31ms/step
[INFOR]: Toltal norm before transform: 0.3122
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1478

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 31ms/step
[INFOR]: SEN training of class 93_33 before transform: 20
[INFOR]: SPE training of class 93_33 before transform: 13

[INFOR]: SEN training of class 93_33 after transform: 32
[INFOR]: SPE training of class 93_33 after transform: 13
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
3/3 [==============================] - 0s 27ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :15.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :11.0
[INFOR]: SEN testing of class 93_33 before transform: 15
[INFOR]: SPE testing of class 93_33 before transform: 17

[INFOR]: SEN testing of class 93_33 after transform: 32
[INFOR]: SPE testing of class 93_33 after transform: 0
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name fgvc_aircraft --class_name_train 94_33 --class_name_test 94_34
2021-09-13 09:36:44.981870: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  fgvc_aircraft
class_name_train =  94_33
class_name_test =  94_34
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
[INFOR]: get pretrained model
2021-09-13 09:36:47.414983: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 09:36:47.438805: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 09:36:47.443598: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 09:36:47.451558: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:36:47.453581: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:36:47.458426: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 09:36:47.461598: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 09:36:47.467702: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 09:36:47.472408: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 09:36:47.475378: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:36:47.477402: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 09:36:47.479581: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 09:36:47.492354: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x23db6afc870 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 09:36:47.495858: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 09:36:47.497937: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 09:36:47.501977: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 09:36:47.504022: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:36:47.506080: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:36:47.508344: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 09:36:47.510339: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 09:36:47.512376: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 09:36:47.514533: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 09:36:47.516707: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:36:47.518769: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 09:36:47.935810: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 09:36:47.939414: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 09:36:47.940796: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 09:36:47.942243: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 09:36:47.948603: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x23de6bf0a80 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 09:36:47.951542: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 09:36:49.909027: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 09:36:50.576723: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:36:51.248096: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:36:51.255179: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:36:52.582828: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 09:36:52.630190: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 09:36:53.347762: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 252ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :7.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :7.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 31ms/step
[INFOR]: Toltal norm before transform: 0.7519
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.2579

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 31ms/step
[INFOR]: SEN training of class 94_33 before transform: 7
[INFOR]: SPE training of class 94_33 before transform: 14

[INFOR]: SEN training of class 94_33 after transform: 33
[INFOR]: SPE training of class 94_33 after transform: 14
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (68, 32, 32, 3)
[INFOR]: shape of y: (68, 1)
3/3 [==============================] - 0s 25ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :11.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :11.0
[INFOR]: SEN testing of class 94_34 before transform: 11
[INFOR]: SPE testing of class 94_34 before transform: 16

[INFOR]: SEN testing of class 94_34 after transform: 31
[INFOR]: SPE testing of class 94_34 after transform: 0
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name fgvc_aircraft --class_name_train 95_33 --class_name_test 95_34
2021-09-13 09:36:57.473811: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  fgvc_aircraft
class_name_train =  95_33
class_name_test =  95_34
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
[INFOR]: get pretrained model
2021-09-13 09:37:00.056889: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 09:37:00.080575: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 09:37:00.085141: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 09:37:00.092945: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:37:00.095034: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:37:00.100179: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 09:37:00.103493: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 09:37:00.109569: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 09:37:00.114435: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 09:37:00.117322: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:37:00.119572: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 09:37:00.121410: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 09:37:00.133541: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x28833690520 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 09:37:00.137334: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 09:37:00.139319: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 09:37:00.143396: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 09:37:00.145488: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:37:00.147699: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:37:00.149785: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 09:37:00.151823: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 09:37:00.153873: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 09:37:00.155953: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 09:37:00.158138: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:37:00.160378: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 09:37:00.583990: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 09:37:00.587212: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 09:37:00.588581: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 09:37:00.590020: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 09:37:00.596547: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x2885e957bf0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 09:37:00.599477: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 09:37:02.573209: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 09:37:03.268367: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:37:03.913589: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:37:03.918950: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:37:05.239682: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 09:37:05.288557: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 09:37:06.010176: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 258ms/step
[INFOR]: Index of most vote   :510
[INFOR]: Class of most vote   :container ship, containership, container vessel
[INFOR]: Number of most vote  :11.0


[INFOR]: Index of second most vote     :404
[INFOR]: Class of second most vote     :airliner
[INFOR]: Number of second most vote    :9.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 31ms/step
[INFOR]: Toltal norm before transform: 0.6564
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1490

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 31ms/step
[INFOR]: SEN training of class 95_33 before transform: 11
[INFOR]: SPE training of class 95_33 before transform: 25

[INFOR]: SEN training of class 95_33 after transform: 33
[INFOR]: SPE training of class 95_33 after transform: 25
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (68, 32, 32, 3)
[INFOR]: shape of y: (68, 1)
3/3 [==============================] - 0s 31ms/step
[INFOR]: Index of most vote   :510
[INFOR]: Class of most vote   :container ship, containership, container vessel
[INFOR]: Number of most vote  :11.0


[INFOR]: Index of second most vote     :404
[INFOR]: Class of second most vote     :airliner
[INFOR]: Number of second most vote    :10.0
[INFOR]: SEN testing of class 95_34 before transform: 11
[INFOR]: SPE testing of class 95_34 before transform: 27

[INFOR]: SEN testing of class 95_34 after transform: 32
[INFOR]: SPE testing of class 95_34 after transform: 12
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name fgvc_aircraft --class_name_train 96_34 --class_name_test 96_33
2021-09-13 09:37:10.114099: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  fgvc_aircraft
class_name_train =  96_34
class_name_test =  96_33
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (68, 32, 32, 3)
[INFOR]: shape of y: (68, 1)
[INFOR]: get pretrained model
2021-09-13 09:37:12.569357: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 09:37:12.593759: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 09:37:12.599699: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 09:37:12.607482: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:37:12.609783: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:37:12.614757: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 09:37:12.618176: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 09:37:12.624180: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 09:37:12.629141: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 09:37:12.631930: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:37:12.633982: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 09:37:12.635789: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 09:37:12.647953: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1d7b3c48420 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 09:37:12.651566: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 09:37:12.653540: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 09:37:12.657887: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 09:37:12.659973: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:37:12.662040: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:37:12.664119: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 09:37:12.666152: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 09:37:12.668202: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 09:37:12.670330: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 09:37:12.672768: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:37:12.675035: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 09:37:13.095234: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 09:37:13.098528: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 09:37:13.099886: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 09:37:13.101309: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 09:37:13.107659: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1d7df6548f0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 09:37:13.110635: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 09:37:15.072747: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 09:37:15.743014: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:37:16.388285: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:37:16.394734: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:37:17.720508: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 09:37:17.775921: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 09:37:18.495638: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 281ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :11.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :8.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 31ms/step
[INFOR]: Toltal norm before transform: 0.6711
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.2869

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 31ms/step
[INFOR]: SEN training of class 96_34 before transform: 11
[INFOR]: SPE training of class 96_34 before transform: 14

[INFOR]: SEN training of class 96_34 after transform: 24
[INFOR]: SPE training of class 96_34 after transform: 14
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
3/3 [==============================] - 0s 39ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :17.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :3.0
[INFOR]: SEN testing of class 96_33 before transform: 17
[INFOR]: SPE testing of class 96_33 before transform: 17

[INFOR]: SEN testing of class 96_33 after transform: 32
[INFOR]: SPE testing of class 96_33 after transform: 4
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name fgvc_aircraft --class_name_train 97_33 --class_name_test 97_33
2021-09-13 09:37:22.645239: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  fgvc_aircraft
class_name_train =  97_33
class_name_test =  97_33
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
[INFOR]: get pretrained model
2021-09-13 09:37:25.102562: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 09:37:25.126900: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 09:37:25.131841: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 09:37:25.139569: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:37:25.141615: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:37:25.146589: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 09:37:25.149782: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 09:37:25.155783: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 09:37:25.160667: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 09:37:25.163502: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:37:25.165727: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 09:37:25.167547: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 09:37:25.179721: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1f7b9f57ce0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 09:37:25.183436: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 09:37:25.185408: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 09:37:25.189490: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 09:37:25.191560: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:37:25.193710: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:37:25.195773: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 09:37:25.197792: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 09:37:25.199868: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 09:37:25.202185: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 09:37:25.204239: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:37:25.206265: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 09:37:25.623850: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 09:37:25.627084: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 09:37:25.628443: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 09:37:25.629874: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 09:37:25.636396: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1f7e9b58970 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 09:37:25.639255: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 09:37:27.566931: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 09:37:28.240731: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:37:28.884604: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:37:28.890879: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:37:30.211705: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 09:37:30.260504: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 09:37:30.976615: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 250ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :15.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :8.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 31ms/step
[INFOR]: Toltal norm before transform: 0.4971
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0216

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 32ms/step
[INFOR]: SEN training of class 97_33 before transform: 15
[INFOR]: SPE training of class 97_33 before transform: 15

[INFOR]: SEN training of class 97_33 after transform: 25
[INFOR]: SPE training of class 97_33 after transform: 15
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
3/3 [==============================] - 0s 31ms/step
[INFOR]: Index of most vote   :510
[INFOR]: Class of most vote   :container ship, containership, container vessel
[INFOR]: Number of most vote  :13.0


[INFOR]: Index of second most vote     :404
[INFOR]: Class of second most vote     :airliner
[INFOR]: Number of second most vote    :7.0
[INFOR]: SEN testing of class 97_33 before transform: 13
[INFOR]: SPE testing of class 97_33 before transform: 23

[INFOR]: SEN testing of class 97_33 after transform: 32
[INFOR]: SPE testing of class 97_33 after transform: 3
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name fgvc_aircraft --class_name_train 98_33 --class_name_test 98_34
2021-09-13 09:37:34.633737: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  fgvc_aircraft
class_name_train =  98_33
class_name_test =  98_34
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
[INFOR]: get pretrained model
2021-09-13 09:37:37.210822: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 09:37:37.235185: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 09:37:37.240182: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 09:37:37.248161: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:37:37.250443: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:37:37.255568: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 09:37:37.258848: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 09:37:37.264924: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 09:37:37.269843: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 09:37:37.272710: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:37:37.274810: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 09:37:37.276662: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 09:37:37.289035: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x17b358e1d60 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 09:37:37.292432: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 09:37:37.294417: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 09:37:37.298487: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 09:37:37.300678: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:37:37.302945: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:37:37.305053: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 09:37:37.307088: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 09:37:37.309135: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 09:37:37.311210: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 09:37:37.313391: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:37:37.315563: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 09:37:37.746692: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 09:37:37.749597: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 09:37:37.751102: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 09:37:37.752720: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 09:37:37.759641: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x17b6178acb0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 09:37:37.762624: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 09:37:39.718780: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 09:37:40.403310: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:37:41.065962: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:37:41.073289: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:37:42.463406: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 09:37:42.513170: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 09:37:43.248228: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 272ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :11.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :10.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 32ms/step
[INFOR]: Toltal norm before transform: 0.6525
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1931

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 31ms/step
[INFOR]: SEN training of class 98_33 before transform: 11
[INFOR]: SPE training of class 98_33 before transform: 19

[INFOR]: SEN training of class 98_33 after transform: 29
[INFOR]: SPE training of class 98_33 after transform: 19
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (68, 32, 32, 3)
[INFOR]: shape of y: (68, 1)
3/3 [==============================] - 0s 31ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :16.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :14.0
[INFOR]: SEN testing of class 98_34 before transform: 16
[INFOR]: SPE testing of class 98_34 before transform: 10

[INFOR]: SEN testing of class 98_34 after transform: 31
[INFOR]: SPE testing of class 98_34 after transform: 1
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name fgvc_aircraft --class_name_train 99_34 --class_name_test 99_33
2021-09-13 09:37:47.386744: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  fgvc_aircraft
class_name_train =  99_34
class_name_test =  99_33
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (68, 32, 32, 3)
[INFOR]: shape of y: (68, 1)
[INFOR]: get pretrained model
2021-09-13 09:37:49.910276: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 09:37:49.937254: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 09:37:49.942319: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 09:37:49.950422: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:37:49.952475: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:37:49.957429: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 09:37:49.960673: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 09:37:49.966894: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 09:37:49.971757: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 09:37:49.974751: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:37:49.976809: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 09:37:49.978749: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 09:37:49.990792: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x211ba855d90 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 09:37:49.994412: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 09:37:49.996382: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 09:37:50.000803: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 09:37:50.003072: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:37:50.005131: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:37:50.007206: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 09:37:50.009427: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 09:37:50.011518: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 09:37:50.013825: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 09:37:50.016360: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:37:50.018528: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 09:37:50.446707: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 09:37:50.449527: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 09:37:50.450978: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 09:37:50.452577: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 09:37:50.459049: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x211e5964720 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 09:37:50.461784: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 09:37:52.497708: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 09:37:53.230434: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 09:37:53.880641: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 09:37:53.886845: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 09:37:55.274583: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 09:37:55.323681: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 09:37:56.059390: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 298ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :21.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :5.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 31ms/step
[INFOR]: Toltal norm before transform: 0.3163
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0390

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 31ms/step
[INFOR]: SEN training of class 99_34 before transform: 21
[INFOR]: SPE training of class 99_34 before transform: 18

[INFOR]: SEN training of class 99_34 after transform: 32
[INFOR]: SPE training of class 99_34 after transform: 18
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
3/3 [==============================] - 0s 31ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :21.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :8.0
[INFOR]: SEN testing of class 99_33 before transform: 21
[INFOR]: SPE testing of class 99_33 before transform: 13

[INFOR]: SEN testing of class 99_33 after transform: 32
[INFOR]: SPE testing of class 99_33 after transform: 0
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>