model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (70, 32, 32, 3)
[INFOR]: shape of y: (70, 1)
[INFOR]: get pretrained model
2021-09-13 11:54:04.029954: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 11:54:04.053743: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 11:54:04.058226: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 11:54:04.066086: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 11:54:04.068166: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 11:54:04.073124: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 11:54:04.076385: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 11:54:04.082542: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 11:54:04.087279: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 11:54:04.090075: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 11:54:04.092229: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 11:54:04.094040: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 11:54:04.106532: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x281392ca0e0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 11:54:04.110445: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 11:54:04.112531: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 11:54:04.116973: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 11:54:04.119079: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 11:54:04.121162: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 11:54:04.123267: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 11:54:04.125402: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 11:54:04.127541: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 11:54:04.129639: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 11:54:04.131724: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 11:54:04.133836: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 11:54:04.555646: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 11:54:04.558422: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 11:54:04.559800: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 11:54:04.561346: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 11:54:04.568098: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x28161a6bce0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 11:54:04.570888: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 11:54:06.529618: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 11:54:07.215491: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 11:54:07.867054: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 11:54:07.873710: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 11:54:09.224487: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 11:54:09.275420: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 11:54:09.994871: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 276ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :10.0


[INFOR]: Index of second most vote     :408
[INFOR]: Class of second most vote     :amphibian, amphibious vehicle
[INFOR]: Number of second most vote    :8.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 32ms/step
[INFOR]: Toltal norm before transform: 0.6989
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0819

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 32ms/step
[INFOR]: SEN training of class 133_35 before transform: 10
[INFOR]: SPE training of class 133_35 before transform: 30

[INFOR]: SEN training of class 133_35 after transform: 30
[INFOR]: SPE training of class 133_35 after transform: 28
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (68, 32, 32, 3)
[INFOR]: shape of y: (68, 1)
3/3 [==============================] - 0s 31ms/step
[INFOR]: Index of most vote   :408
[INFOR]: Class of most vote   :amphibian, amphibious vehicle
[INFOR]: Number of most vote  :9.0


[INFOR]: Index of second most vote     :510
[INFOR]: Class of second most vote     :container ship, containership, container vessel
[INFOR]: Number of second most vote    :4.0
[INFOR]: SEN testing of class 133_34 before transform: 9
[INFOR]: SPE testing of class 133_34 before transform: 25

[INFOR]: SEN testing of class 133_34 after transform: 32
[INFOR]: SPE testing of class 133_34 after transform: 4
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name stanford_car --class_name_train 134_46 --class_name_test 134_46
2021-09-13 11:54:14.211898: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  stanford_car
class_name_train =  134_46
class_name_test =  134_46
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (92, 32, 32, 3)
[INFOR]: shape of y: (92, 1)
[INFOR]: get pretrained model
2021-09-13 11:54:16.721277: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 11:54:16.744579: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 11:54:16.748796: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 11:54:16.756675: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 11:54:16.758780: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 11:54:16.763709: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 11:54:16.767030: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 11:54:16.773145: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 11:54:16.778083: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 11:54:16.780944: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 11:54:16.783002: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 11:54:16.784923: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 11:54:16.797384: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x200367bee60 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 11:54:16.800926: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 11:54:16.802899: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 11:54:16.807254: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 11:54:16.809377: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 11:54:16.811422: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 11:54:16.813502: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 11:54:16.815686: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 11:54:16.817809: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 11:54:16.819949: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 11:54:16.822613: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 11:54:16.824737: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 11:54:17.255542: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 11:54:17.258537: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 11:54:17.259925: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 11:54:17.261434: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 11:54:17.267990: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x20061951790 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 11:54:17.270957: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 11:54:19.234952: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 11:54:19.936828: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 11:54:20.591810: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 11:54:20.597520: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 11:54:21.946178: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 11:54:22.001351: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 11:54:22.715433: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 354ms/step
[INFOR]: Index of most vote   :408
[INFOR]: Class of most vote   :amphibian, amphibious vehicle
[INFOR]: Number of most vote  :14.0


[INFOR]: Index of second most vote     :674
[INFOR]: Class of second most vote     :mousetrap
[INFOR]: Number of second most vote    :10.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 37ms/step
[INFOR]: Toltal norm before transform: 0.7177
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.2530

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 38ms/step
[INFOR]: SEN training of class 134_46 before transform: 14
[INFOR]: SPE training of class 134_46 before transform: 42

[INFOR]: SEN training of class 134_46 after transform: 37
[INFOR]: SPE training of class 134_46 after transform: 42
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (92, 32, 32, 3)
[INFOR]: shape of y: (92, 1)
3/3 [==============================] - 0s 38ms/step
[INFOR]: Index of most vote   :408
[INFOR]: Class of most vote   :amphibian, amphibious vehicle
[INFOR]: Number of most vote  :9.0


[INFOR]: Index of second most vote     :674
[INFOR]: Class of second most vote     :mousetrap
[INFOR]: Number of second most vote    :7.0
[INFOR]: SEN testing of class 134_46 before transform: 9
[INFOR]: SPE testing of class 134_46 before transform: 39

[INFOR]: SEN testing of class 134_46 after transform: 45
[INFOR]: SPE testing of class 134_46 after transform: 5
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name stanford_car --class_name_train 135_45 --class_name_test 135_44
2021-09-13 11:54:26.689142: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  stanford_car
class_name_train =  135_45
class_name_test =  135_44
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (90, 32, 32, 3)
[INFOR]: shape of y: (90, 1)
[INFOR]: get pretrained model
2021-09-13 11:54:29.243833: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 11:54:29.270205: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 11:54:29.274440: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 11:54:29.282531: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 11:54:29.284727: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 11:54:29.289942: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 11:54:29.293327: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 11:54:29.299823: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 11:54:29.304704: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 11:54:29.307653: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 11:54:29.309770: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 11:54:29.311611: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 11:54:29.323908: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1d73a003490 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 11:54:29.327291: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 11:54:29.329369: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 11:54:29.333602: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 11:54:29.335691: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 11:54:29.337821: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 11:54:29.340223: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 11:54:29.342391: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 11:54:29.344458: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 11:54:29.346608: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 11:54:29.348761: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 11:54:29.350826: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 11:54:29.778740: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 11:54:29.781786: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 11:54:29.783122: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 11:54:29.784555: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 11:54:29.791294: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1d768ce92f0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 11:54:29.794204: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 11:54:31.798601: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 11:54:32.501303: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 11:54:33.158196: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 11:54:33.165127: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 11:54:34.502564: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 11:54:34.551935: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 11:54:35.277346: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 348ms/step
[INFOR]: Index of most vote   :408
[INFOR]: Class of most vote   :amphibian, amphibious vehicle
[INFOR]: Number of most vote  :15.0


[INFOR]: Index of second most vote     :674
[INFOR]: Class of second most vote     :mousetrap
[INFOR]: Number of second most vote    :11.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 38ms/step
[INFOR]: Toltal norm before transform: 0.6709
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1202

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 39ms/step
[INFOR]: SEN training of class 135_45 before transform: 15
[INFOR]: SPE training of class 135_45 before transform: 38

[INFOR]: SEN training of class 135_45 after transform: 40
[INFOR]: SPE training of class 135_45 after transform: 28
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (88, 32, 32, 3)
[INFOR]: shape of y: (88, 1)
3/3 [==============================] - 0s 38ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :16.0


[INFOR]: Index of second most vote     :408
[INFOR]: Class of second most vote     :amphibian, amphibious vehicle
[INFOR]: Number of second most vote    :14.0
[INFOR]: SEN testing of class 135_44 before transform: 16
[INFOR]: SPE testing of class 135_44 before transform: 27

[INFOR]: SEN testing of class 135_44 after transform: 40
[INFOR]: SPE testing of class 135_44 after transform: 6
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name stanford_car --class_name_train 136_33 --class_name_test 136_32
2021-09-13 11:54:39.772000: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  stanford_car
class_name_train =  136_33
class_name_test =  136_32
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
[INFOR]: get pretrained model
2021-09-13 11:54:42.248551: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 11:54:42.274828: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 11:54:42.279467: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 11:54:42.287257: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 11:54:42.289465: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 11:54:42.294562: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 11:54:42.297853: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 11:54:42.304056: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 11:54:42.309013: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 11:54:42.311990: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 11:54:42.314107: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 11:54:42.315977: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 11:54:42.327989: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x15f36a09d90 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 11:54:42.331483: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 11:54:42.333456: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 11:54:42.337713: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 11:54:42.339805: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 11:54:42.341907: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 11:54:42.344107: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 11:54:42.346403: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 11:54:42.348517: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 11:54:42.350620: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 11:54:42.352823: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 11:54:42.354930: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 11:54:42.779831: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 11:54:42.782447: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 11:54:42.783919: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 11:54:42.785400: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 11:54:42.792072: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x15f5bc6a260 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 11:54:42.794802: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 11:54:44.758714: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 11:54:45.456793: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 11:54:46.107499: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 11:54:46.114672: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 11:54:47.466619: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 11:54:47.515848: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 11:54:48.236422: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 257ms/step
[INFOR]: Index of most vote   :408
[INFOR]: Class of most vote   :amphibian, amphibious vehicle
[INFOR]: Number of most vote  :3.0


[INFOR]: Index of second most vote     :674
[INFOR]: Class of second most vote     :mousetrap
[INFOR]: Number of second most vote    :3.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 31ms/step
[INFOR]: Toltal norm before transform: 0.8673
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.2728

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 31ms/step
[INFOR]: SEN training of class 136_33 before transform: 3
[INFOR]: SPE training of class 136_33 before transform: 22

[INFOR]: SEN training of class 136_33 after transform: 28
[INFOR]: SPE training of class 136_33 after transform: 18
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (64, 32, 32, 3)
[INFOR]: shape of y: (64, 1)
2/2 [==============================] - 1s 51ms/step
[INFOR]: Index of most vote   :408
[INFOR]: Class of most vote   :amphibian, amphibious vehicle
[INFOR]: Number of most vote  :3.0


[INFOR]: Index of second most vote     :481
[INFOR]: Class of second most vote     :cassette
[INFOR]: Number of second most vote    :3.0
[INFOR]: SEN testing of class 136_32 before transform: 3
[INFOR]: SPE testing of class 136_32 before transform: 20

[INFOR]: SEN testing of class 136_32 after transform: 29
[INFOR]: SPE testing of class 136_32 after transform: 7
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name stanford_car --class_name_train 137_44 --class_name_test 137_43
2021-09-13 11:54:53.224828: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  stanford_car
class_name_train =  137_44
class_name_test =  137_43
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (88, 32, 32, 3)
[INFOR]: shape of y: (88, 1)
[INFOR]: get pretrained model
2021-09-13 11:54:55.756747: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 11:54:55.801817: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 11:54:55.806644: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 11:54:55.814797: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 11:54:55.817018: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 11:54:55.822294: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 11:54:55.825627: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 11:54:55.831920: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 11:54:55.836828: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 11:54:55.839829: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 11:54:55.841927: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 11:54:55.843851: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 11:54:55.856468: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x22039047cb0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 11:54:55.860004: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 11:54:55.861984: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 11:54:55.866288: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 11:54:55.868389: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 11:54:55.870475: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 11:54:55.872691: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 11:54:55.875159: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 11:54:55.877239: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 11:54:55.879350: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 11:54:55.881456: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 11:54:55.883597: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 11:54:56.304797: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 11:54:56.307483: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 11:54:56.308803: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 11:54:56.310274: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 11:54:56.316706: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x22063d1bc70 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 11:54:56.319523: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 11:54:58.294411: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 11:54:58.995818: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 11:54:59.648460: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 11:54:59.654692: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 11:55:01.005496: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 11:55:01.054390: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 11:55:01.771063: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 330ms/step
[INFOR]: Index of most vote   :408
[INFOR]: Class of most vote   :amphibian, amphibious vehicle
[INFOR]: Number of most vote  :8.0


[INFOR]: Index of second most vote     :449
[INFOR]: Class of second most vote     :boathouse
[INFOR]: Number of second most vote    :3.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 37ms/step
[INFOR]: Toltal norm before transform: 0.7992
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.2417

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 38ms/step
[INFOR]: SEN training of class 137_44 before transform: 8
[INFOR]: SPE training of class 137_44 before transform: 35

[INFOR]: SEN training of class 137_44 after transform: 40
[INFOR]: SPE training of class 137_44 after transform: 35
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (86, 32, 32, 3)
[INFOR]: shape of y: (86, 1)
3/3 [==============================] - 0s 38ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :9.0


[INFOR]: Index of second most vote     :408
[INFOR]: Class of second most vote     :amphibian, amphibious vehicle
[INFOR]: Number of second most vote    :4.0
[INFOR]: SEN testing of class 137_43 before transform: 9
[INFOR]: SPE testing of class 137_43 before transform: 28

[INFOR]: SEN testing of class 137_43 after transform: 36
[INFOR]: SPE testing of class 137_43 after transform: 8
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name stanford_car --class_name_train 138_35 --class_name_test 138_35
2021-09-13 11:55:06.261107: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  stanford_car
class_name_train =  138_35
class_name_test =  138_35
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (70, 32, 32, 3)
[INFOR]: shape of y: (70, 1)
[INFOR]: get pretrained model
2021-09-13 11:55:08.784152: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 11:55:08.809176: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 11:55:08.813971: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 11:55:08.822061: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 11:55:08.824274: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 11:55:08.829356: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 11:55:08.832748: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 11:55:08.839019: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 11:55:08.844101: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 11:55:08.847158: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 11:55:08.849407: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 11:55:08.851315: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 11:55:08.863276: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x200b5309ed0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 11:55:08.866332: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 11:55:08.868337: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 11:55:08.872492: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 11:55:08.874598: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 11:55:08.876727: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 11:55:08.878828: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 11:55:08.880966: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 11:55:08.883189: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 11:55:08.885345: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 11:55:08.887486: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 11:55:08.889657: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 11:55:09.313487: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 11:55:09.316468: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 11:55:09.317993: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 11:55:09.319688: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 11:55:09.326776: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x200de12e5a0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 11:55:09.329657: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 11:55:11.301296: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 11:55:11.993998: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 11:55:12.645637: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 11:55:12.651317: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 11:55:14.011727: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 11:55:14.069405: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 11:55:14.787843: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 278ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :11.0


[INFOR]: Index of second most vote     :408
[INFOR]: Class of second most vote     :amphibian, amphibious vehicle
[INFOR]: Number of second most vote    :6.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 31ms/step
[INFOR]: Toltal norm before transform: 0.6324
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0103

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 31ms/step
[INFOR]: SEN training of class 138_35 before transform: 11
[INFOR]: SPE training of class 138_35 before transform: 22

[INFOR]: SEN training of class 138_35 after transform: 34
[INFOR]: SPE training of class 138_35 after transform: 22
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (70, 32, 32, 3)
[INFOR]: shape of y: (70, 1)
3/3 [==============================] - 0s 30ms/step
[INFOR]: Index of most vote   :408
[INFOR]: Class of most vote   :amphibian, amphibious vehicle
[INFOR]: Number of most vote  :9.0


[INFOR]: Index of second most vote     :674
[INFOR]: Class of second most vote     :mousetrap
[INFOR]: Number of second most vote    :5.0
[INFOR]: SEN testing of class 138_35 before transform: 9
[INFOR]: SPE testing of class 138_35 before transform: 25

[INFOR]: SEN testing of class 138_35 after transform: 34
[INFOR]: SPE testing of class 138_35 after transform: 3
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name stanford_car --class_name_train 139_43 --class_name_test 139_42
2021-09-13 11:55:18.490629: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  stanford_car
class_name_train =  139_43
class_name_test =  139_42
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (86, 32, 32, 3)
[INFOR]: shape of y: (86, 1)
[INFOR]: get pretrained model
2021-09-13 11:55:21.039925: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 11:55:21.066643: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 11:55:21.071348: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 11:55:21.079294: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 11:55:21.081410: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 11:55:21.086423: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 11:55:21.089750: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 11:55:21.095975: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 11:55:21.100964: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 11:55:21.103853: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 11:55:21.105940: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 11:55:21.107790: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 11:55:21.120032: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1b1b9816ef0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 11:55:21.123433: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 11:55:21.125531: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 11:55:21.129818: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 11:55:21.131950: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 11:55:21.134068: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 11:55:21.136171: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 11:55:21.138327: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 11:55:21.140439: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 11:55:21.142548: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 11:55:21.144652: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 11:55:21.146750: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 11:55:21.577304: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 11:55:21.580019: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 11:55:21.581490: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 11:55:21.582925: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 11:55:21.589664: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1b1d735f690 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 11:55:21.592602: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 11:55:23.574418: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 11:55:24.275337: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 11:55:24.931103: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 11:55:24.937666: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 11:55:26.301397: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 11:55:26.350283: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 11:55:27.136881: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 366ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :24.0


[INFOR]: Index of second most vote     :408
[INFOR]: Class of second most vote     :amphibian, amphibious vehicle
[INFOR]: Number of second most vote    :6.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 37ms/step
[INFOR]: Toltal norm before transform: 0.4039
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1765

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 36ms/step
[INFOR]: SEN training of class 139_43 before transform: 24
[INFOR]: SPE training of class 139_43 before transform: 28

[INFOR]: SEN training of class 139_43 after transform: 35
[INFOR]: SPE training of class 139_43 after transform: 28
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (84, 32, 32, 3)
[INFOR]: shape of y: (84, 1)
3/3 [==============================] - 0s 37ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :22.0


[INFOR]: Index of second most vote     :408
[INFOR]: Class of second most vote     :amphibian, amphibious vehicle
[INFOR]: Number of second most vote    :10.0
[INFOR]: SEN testing of class 139_42 before transform: 22
[INFOR]: SPE testing of class 139_42 before transform: 30

[INFOR]: SEN testing of class 139_42 after transform: 41
[INFOR]: SPE testing of class 139_42 after transform: 1
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name stanford_car --class_name_train 140_38 --class_name_test 140_37
2021-09-13 11:55:31.677314: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  stanford_car
class_name_train =  140_38
class_name_test =  140_37
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (76, 32, 32, 3)
[INFOR]: shape of y: (76, 1)
[INFOR]: get pretrained model
2021-09-13 11:55:34.185219: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 11:55:34.211361: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 11:55:34.216100: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 11:55:34.224137: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 11:55:34.226280: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 11:55:34.231435: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 11:55:34.234815: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 11:55:34.241245: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 11:55:34.246133: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 11:55:34.249090: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 11:55:34.251265: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 11:55:34.253249: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 11:55:34.265101: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x26934023400 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 11:55:34.268133: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 11:55:34.270113: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 11:55:34.274387: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 11:55:34.276541: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 11:55:34.278639: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 11:55:34.280761: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 11:55:34.282990: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 11:55:34.285067: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 11:55:34.287171: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 11:55:34.289280: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 11:55:34.291355: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 11:55:34.706061: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 11:55:34.708925: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 11:55:34.710242: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 11:55:34.711733: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 11:55:34.718510: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x2695f3116e0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 11:55:34.721266: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 11:55:36.676401: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 11:55:37.361095: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 11:55:38.003192: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 11:55:38.008230: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 11:55:39.354078: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 11:55:39.402741: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 11:55:40.122081: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 297ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :10.0


[INFOR]: Index of second most vote     :408
[INFOR]: Class of second most vote     :amphibian, amphibious vehicle
[INFOR]: Number of second most vote    :5.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 34ms/step
[INFOR]: Toltal norm before transform: 0.7018
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0316

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 33ms/step
[INFOR]: SEN training of class 140_38 before transform: 10
[INFOR]: SPE training of class 140_38 before transform: 27

[INFOR]: SEN training of class 140_38 after transform: 30
[INFOR]: SPE training of class 140_38 after transform: 25
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (74, 32, 32, 3)
[INFOR]: shape of y: (74, 1)
3/3 [==============================] - 0s 32ms/step
[INFOR]: Index of most vote   :408
[INFOR]: Class of most vote   :amphibian, amphibious vehicle
[INFOR]: Number of most vote  :7.0


[INFOR]: Index of second most vote     :510
[INFOR]: Class of second most vote     :container ship, containership, container vessel
[INFOR]: Number of second most vote    :6.0
[INFOR]: SEN testing of class 140_37 before transform: 7
[INFOR]: SPE testing of class 140_37 before transform: 22

[INFOR]: SEN testing of class 140_37 after transform: 36
[INFOR]: SPE testing of class 140_37 after transform: 0
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name stanford_car --class_name_train 141_41 --class_name_test 141_40
2021-09-13 11:55:44.399343: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  stanford_car
class_name_train =  141_41
class_name_test =  141_40
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (82, 32, 32, 3)
[INFOR]: shape of y: (82, 1)
[INFOR]: get pretrained model
2021-09-13 11:55:46.910317: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 11:55:46.938591: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 11:55:46.943150: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 11:55:46.951220: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 11:55:46.953340: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 11:55:46.958325: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 11:55:46.961662: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 11:55:46.967775: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 11:55:46.972610: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 11:55:46.975433: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 11:55:46.977492: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 11:55:46.979314: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 11:55:46.991487: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x18b333e8780 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 11:55:46.995186: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 11:55:46.997194: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 11:55:47.001344: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 11:55:47.003475: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 11:55:47.005516: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 11:55:47.007634: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 11:55:47.009792: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 11:55:47.011921: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 11:55:47.013983: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 11:55:47.016161: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 11:55:47.018182: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 11:55:47.445209: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 11:55:47.447919: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 11:55:47.449466: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 11:55:47.451009: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 11:55:47.457469: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x18b619a3750 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 11:55:47.460355: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 11:55:49.434972: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 11:55:50.121364: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 11:55:50.773176: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 11:55:50.780130: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 11:55:52.129467: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 11:55:52.176313: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 11:55:52.893493: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 319ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :18.0


[INFOR]: Index of second most vote     :408
[INFOR]: Class of second most vote     :amphibian, amphibious vehicle
[INFOR]: Number of second most vote    :4.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 34ms/step
[INFOR]: Toltal norm before transform: 0.5333
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1106

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 35ms/step
[INFOR]: SEN training of class 141_41 before transform: 18
[INFOR]: SPE training of class 141_41 before transform: 27

[INFOR]: SEN training of class 141_41 after transform: 32
[INFOR]: SPE training of class 141_41 after transform: 27
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (80, 32, 32, 3)
[INFOR]: shape of y: (80, 1)
3/3 [==============================] - 0s 34ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :19.0


[INFOR]: Index of second most vote     :408
[INFOR]: Class of second most vote     :amphibian, amphibious vehicle
[INFOR]: Number of second most vote    :4.0
[INFOR]: SEN testing of class 141_40 before transform: 19
[INFOR]: SPE testing of class 141_40 before transform: 26

[INFOR]: SEN testing of class 141_40 after transform: 40
[INFOR]: SPE testing of class 141_40 after transform: 0
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name stanford_car --class_name_train 142_42 --class_name_test 142_42
2021-09-13 11:55:57.260315: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  stanford_car
class_name_train =  142_42
class_name_test =  142_42
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (84, 32, 32, 3)
[INFOR]: shape of y: (84, 1)
[INFOR]: get pretrained model
2021-09-13 11:55:59.795635: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 11:55:59.819131: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 11:55:59.823368: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 11:55:59.831301: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 11:55:59.833408: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 11:55:59.838580: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 11:55:59.841978: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 11:55:59.848065: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 11:55:59.853092: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 11:55:59.855965: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 11:55:59.858031: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 11:55:59.859951: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 11:55:59.872027: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x22cb36dfe40 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 11:55:59.875643: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 11:55:59.877661: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 11:55:59.881944: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 11:55:59.884088: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 11:55:59.886210: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 11:55:59.888385: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 11:55:59.890488: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 11:55:59.892579: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 11:55:59.894711: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 11:55:59.896796: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 11:55:59.898881: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 11:56:00.345053: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 11:56:00.348212: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 11:56:00.349652: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 11:56:00.351108: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 11:56:00.357708: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x22ce2f31980 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 11:56:00.360547: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 11:56:02.384408: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 11:56:03.094887: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 11:56:03.764716: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 11:56:03.770854: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 11:56:05.118321: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 11:56:05.167577: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 11:56:05.885743: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 323ms/step
[INFOR]: Index of most vote   :408
[INFOR]: Class of most vote   :amphibian, amphibious vehicle
[INFOR]: Number of most vote  :13.0


[INFOR]: Index of second most vote     :674
[INFOR]: Class of second most vote     :mousetrap
[INFOR]: Number of second most vote    :12.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 36ms/step
[INFOR]: Toltal norm before transform: 0.6439
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0079

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 35ms/step
[INFOR]: SEN training of class 142_42 before transform: 13
[INFOR]: SPE training of class 142_42 before transform: 31

[INFOR]: SEN training of class 142_42 after transform: 38
[INFOR]: SPE training of class 142_42 after transform: 31
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (84, 32, 32, 3)
[INFOR]: shape of y: (84, 1)
3/3 [==============================] - 0s 35ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :22.0


[INFOR]: Index of second most vote     :408
[INFOR]: Class of second most vote     :amphibian, amphibious vehicle
[INFOR]: Number of second most vote    :6.0
[INFOR]: SEN testing of class 142_42 before transform: 22
[INFOR]: SPE testing of class 142_42 before transform: 26

[INFOR]: SEN testing of class 142_42 after transform: 42
[INFOR]: SPE testing of class 142_42 after transform: 0
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name stanford_car --class_name_train 143_43 --class_name_test 143_43
2021-09-13 11:56:09.727286: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  stanford_car
class_name_train =  143_43
class_name_test =  143_43
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (86, 32, 32, 3)
[INFOR]: shape of y: (86, 1)
[INFOR]: get pretrained model
2021-09-13 11:56:12.198691: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 11:56:12.223472: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 11:56:12.228739: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 11:56:12.236640: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 11:56:12.238963: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 11:56:12.244051: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 11:56:12.247330: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 11:56:12.253577: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 11:56:12.258548: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 11:56:12.261536: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 11:56:12.263696: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 11:56:12.265544: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 11:56:12.277991: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1913a18a030 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 11:56:12.281453: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 11:56:12.283481: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 11:56:12.287741: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 11:56:12.289912: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 11:56:12.292010: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 11:56:12.294149: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 11:56:12.296454: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 11:56:12.298602: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 11:56:12.300721: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 11:56:12.302849: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 11:56:12.304940: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 11:56:12.724867: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 11:56:12.727773: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 11:56:12.729174: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 11:56:12.730677: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 11:56:12.737293: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x19168f97810 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 11:56:12.740084: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 11:56:14.711581: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 11:56:15.397164: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 11:56:16.051109: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 11:56:16.056996: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 11:56:17.402303: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 11:56:17.449933: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 11:56:18.170846: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 330ms/step
[INFOR]: Index of most vote   :408
[INFOR]: Class of most vote   :amphibian, amphibious vehicle
[INFOR]: Number of most vote  :8.0


[INFOR]: Index of second most vote     :674
[INFOR]: Class of second most vote     :mousetrap
[INFOR]: Number of second most vote    :6.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 37ms/step
[INFOR]: Toltal norm before transform: 0.7429
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1340

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 36ms/step
[INFOR]: SEN training of class 143_43 before transform: 8
[INFOR]: SPE training of class 143_43 before transform: 32

[INFOR]: SEN training of class 143_43 after transform: 28
[INFOR]: SPE training of class 143_43 after transform: 27
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (86, 32, 32, 3)
[INFOR]: shape of y: (86, 1)
3/3 [==============================] - 0s 36ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :9.0


[INFOR]: Index of second most vote     :408
[INFOR]: Class of second most vote     :amphibian, amphibious vehicle
[INFOR]: Number of second most vote    :8.0
[INFOR]: SEN testing of class 143_43 before transform: 9
[INFOR]: SPE testing of class 143_43 before transform: 29

[INFOR]: SEN testing of class 143_43 after transform: 43
[INFOR]: SPE testing of class 143_43 after transform: 0
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name stanford_car --class_name_train 144_41 --class_name_test 144_41
2021-09-13 11:56:22.057002: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  stanford_car
class_name_train =  144_41
class_name_test =  144_41
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (82, 32, 32, 3)
[INFOR]: shape of y: (82, 1)
[INFOR]: get pretrained model
2021-09-13 11:56:24.580704: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 11:56:24.608258: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 11:56:24.613018: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 11:56:24.620854: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 11:56:24.623080: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 11:56:24.628017: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 11:56:24.631477: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 11:56:24.637774: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 11:56:24.642915: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 11:56:24.645875: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 11:56:24.647991: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 11:56:24.649836: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 11:56:24.662269: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1dbb84e23c0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 11:56:24.665718: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 11:56:24.667894: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 11:56:24.672104: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 11:56:24.674229: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 11:56:24.676294: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 11:56:24.678395: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 11:56:24.680548: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 11:56:24.682622: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 11:56:24.684763: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 11:56:24.686993: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 11:56:24.689056: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 11:56:25.119124: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 11:56:25.121865: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 11:56:25.123218: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 11:56:25.124693: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 11:56:25.131321: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1dbe2a19830 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 11:56:25.134211: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 11:56:27.125854: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 11:56:27.830724: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 11:56:28.488245: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 11:56:28.494336: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 11:56:29.846415: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 11:56:29.895999: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 11:56:30.617043: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 315ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :17.0


[INFOR]: Index of second most vote     :408
[INFOR]: Class of second most vote     :amphibian, amphibious vehicle
[INFOR]: Number of second most vote    :9.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 35ms/step
[INFOR]: Toltal norm before transform: 0.5452
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0535

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 35ms/step
[INFOR]: SEN training of class 144_41 before transform: 17
[INFOR]: SPE training of class 144_41 before transform: 27

[INFOR]: SEN training of class 144_41 after transform: 40
[INFOR]: SPE training of class 144_41 after transform: 27
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (82, 32, 32, 3)
[INFOR]: shape of y: (82, 1)
3/3 [==============================] - 0s 35ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :12.0


[INFOR]: Index of second most vote     :482
[INFOR]: Class of second most vote     :cassette player
[INFOR]: Number of second most vote    :7.0
[INFOR]: SEN testing of class 144_41 before transform: 12
[INFOR]: SPE testing of class 144_41 before transform: 31

[INFOR]: SEN testing of class 144_41 after transform: 41
[INFOR]: SPE testing of class 144_41 after transform: 0
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name stanford_car --class_name_train 145_45 --class_name_test 145_44
2021-09-13 11:56:34.461741: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  stanford_car
class_name_train =  145_45
class_name_test =  145_44
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (90, 32, 32, 3)
[INFOR]: shape of y: (90, 1)
[INFOR]: get pretrained model
2021-09-13 11:56:36.958525: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 11:56:36.982884: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 11:56:36.987470: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 11:56:36.995549: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 11:56:36.997794: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 11:56:37.002939: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 11:56:37.006392: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 11:56:37.012946: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 11:56:37.018659: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 11:56:37.021991: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 11:56:37.024322: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 11:56:37.026419: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 11:56:37.038842: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1e1b438e800 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 11:56:37.042537: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 11:56:37.044790: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 11:56:37.049515: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 11:56:37.051839: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 11:56:37.054174: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 11:56:37.056398: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 11:56:37.058569: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 11:56:37.060647: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 11:56:37.062763: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 11:56:37.065013: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 11:56:37.067087: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 11:56:37.487440: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 11:56:37.490201: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 11:56:37.491581: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 11:56:37.493047: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 11:56:37.499699: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1e1e3cea790 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 11:56:37.502545: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 11:56:39.475292: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 11:56:40.165634: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 11:56:40.820514: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 11:56:40.826073: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 11:56:42.182604: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 11:56:42.232954: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 11:56:42.990648: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 348ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :20.0


[INFOR]: Index of second most vote     :855
[INFOR]: Class of second most vote     :thimble
[INFOR]: Number of second most vote    :9.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 39ms/step
[INFOR]: Toltal norm before transform: 0.5133
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0089

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 38ms/step
[INFOR]: SEN training of class 145_45 before transform: 20
[INFOR]: SPE training of class 145_45 before transform: 28

[INFOR]: SEN training of class 145_45 after transform: 34
[INFOR]: SPE training of class 145_45 after transform: 27
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (88, 32, 32, 3)
[INFOR]: shape of y: (88, 1)
3/3 [==============================] - 0s 38ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :20.0


[INFOR]: Index of second most vote     :408
[INFOR]: Class of second most vote     :amphibian, amphibious vehicle
[INFOR]: Number of second most vote    :10.0
[INFOR]: SEN testing of class 145_44 before transform: 20
[INFOR]: SPE testing of class 145_44 before transform: 30

[INFOR]: SEN testing of class 145_44 after transform: 42
[INFOR]: SPE testing of class 145_44 after transform: 0
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name stanford_car --class_name_train 146_40 --class_name_test 146_40
2021-09-13 11:56:47.568261: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  stanford_car
class_name_train =  146_40
class_name_test =  146_40
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (80, 32, 32, 3)
[INFOR]: shape of y: (80, 1)
[INFOR]: get pretrained model
2021-09-13 11:56:50.092548: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 11:56:50.117411: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 11:56:50.121852: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 11:56:50.129918: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 11:56:50.132015: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 11:56:50.137190: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 11:56:50.140611: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 11:56:50.147003: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 11:56:50.151909: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 11:56:50.155190: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 11:56:50.157388: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 11:56:50.159259: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 11:56:50.171082: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1ff34041860 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 11:56:50.174227: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 11:56:50.176194: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 11:56:50.180347: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 11:56:50.182429: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 11:56:50.184717: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 11:56:50.186847: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 11:56:50.188998: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 11:56:50.191130: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 11:56:50.193220: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 11:56:50.195374: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 11:56:50.197451: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 11:56:50.620241: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 11:56:50.622973: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 11:56:50.624315: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 11:56:50.625740: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 11:56:50.632307: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1ff5eb23600 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 11:56:50.635121: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 11:56:52.613604: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 11:56:53.296851: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 11:56:53.951474: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 11:56:53.957352: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 11:56:55.321451: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 11:56:55.371266: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 11:56:56.092698: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 305ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :18.0


[INFOR]: Index of second most vote     :408
[INFOR]: Class of second most vote     :amphibian, amphibious vehicle
[INFOR]: Number of second most vote    :8.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 35ms/step
[INFOR]: Toltal norm before transform: 0.5321
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0296

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 34ms/step
[INFOR]: SEN training of class 146_40 before transform: 18
[INFOR]: SPE training of class 146_40 before transform: 35

[INFOR]: SEN training of class 146_40 after transform: 36
[INFOR]: SPE training of class 146_40 after transform: 31
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (80, 32, 32, 3)
[INFOR]: shape of y: (80, 1)
3/3 [==============================] - 0s 35ms/step
[INFOR]: Index of most vote   :408
[INFOR]: Class of most vote   :amphibian, amphibious vehicle
[INFOR]: Number of most vote  :15.0


[INFOR]: Index of second most vote     :674
[INFOR]: Class of second most vote     :mousetrap
[INFOR]: Number of second most vote    :12.0
[INFOR]: SEN testing of class 146_40 before transform: 15
[INFOR]: SPE testing of class 146_40 before transform: 31

[INFOR]: SEN testing of class 146_40 after transform: 37
[INFOR]: SPE testing of class 146_40 after transform: 6
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name stanford_car --class_name_train 147_40 --class_name_test 147_39
2021-09-13 11:56:59.886747: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  stanford_car
class_name_train =  147_40
class_name_test =  147_39
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (80, 32, 32, 3)
[INFOR]: shape of y: (80, 1)
[INFOR]: get pretrained model
2021-09-13 11:57:02.443611: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 11:57:02.468981: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 11:57:02.473363: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 11:57:02.481235: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 11:57:02.483392: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 11:57:02.488480: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 11:57:02.491852: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 11:57:02.498030: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 11:57:02.502976: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 11:57:02.505901: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 11:57:02.507973: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 11:57:02.509827: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 11:57:02.521940: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x2a73652e730 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 11:57:02.525717: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 11:57:02.527716: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 11:57:02.531846: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 11:57:02.533997: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 11:57:02.536198: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 11:57:02.538268: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 11:57:02.540386: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 11:57:02.542513: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 11:57:02.544580: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 11:57:02.546785: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 11:57:02.548821: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 11:57:02.978670: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 11:57:02.981675: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 11:57:02.983081: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 11:57:02.984555: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 11:57:02.991227: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x2a765e25070 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 11:57:02.994017: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 11:57:05.003136: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 11:57:05.707396: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 11:57:06.370792: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 11:57:06.376782: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 11:57:07.723335: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 11:57:07.777291: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 11:57:08.493323: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 303ms/step
[INFOR]: Index of most vote   :408
[INFOR]: Class of most vote   :amphibian, amphibious vehicle
[INFOR]: Number of most vote  :12.0


[INFOR]: Index of second most vote     :855
[INFOR]: Class of second most vote     :thimble
[INFOR]: Number of second most vote    :5.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 34ms/step
[INFOR]: Toltal norm before transform: 0.6666
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0754

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 35ms/step
[INFOR]: SEN training of class 147_40 before transform: 12
[INFOR]: SPE training of class 147_40 before transform: 36

[INFOR]: SEN training of class 147_40 after transform: 39
[INFOR]: SPE training of class 147_40 after transform: 36
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (78, 32, 32, 3)
[INFOR]: shape of y: (78, 1)
3/3 [==============================] - 0s 34ms/step
[INFOR]: Index of most vote   :408
[INFOR]: Class of most vote   :amphibian, amphibious vehicle
[INFOR]: Number of most vote  :10.0


[INFOR]: Index of second most vote     :510
[INFOR]: Class of second most vote     :container ship, containership, container vessel
[INFOR]: Number of second most vote    :7.0
[INFOR]: SEN testing of class 147_39 before transform: 10
[INFOR]: SPE testing of class 147_39 before transform: 34

[INFOR]: SEN testing of class 147_39 after transform: 28
[INFOR]: SPE testing of class 147_39 after transform: 3
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name stanford_car --class_name_train 148_47 --class_name_test 148_46
2021-09-13 11:57:12.851367: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  stanford_car
class_name_train =  148_47
class_name_test =  148_46
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (94, 32, 32, 3)
[INFOR]: shape of y: (94, 1)
[INFOR]: get pretrained model
2021-09-13 11:57:15.333144: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 11:57:15.357616: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 11:57:15.361877: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 11:57:15.369878: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 11:57:15.371949: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 11:57:15.376814: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 11:57:15.380131: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 11:57:15.386415: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 11:57:15.391199: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 11:57:15.394056: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 11:57:15.396223: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 11:57:15.398629: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 11:57:15.410898: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1dcb780b1c0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 11:57:15.414045: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 11:57:15.416150: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 11:57:15.420508: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 11:57:15.422758: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 11:57:15.424978: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 11:57:15.427280: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 11:57:15.429486: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 11:57:15.431776: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 11:57:15.433976: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 11:57:15.436166: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 11:57:15.438273: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 11:57:15.864689: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 11:57:15.867478: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 11:57:15.868857: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 11:57:15.870398: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 11:57:15.876974: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1dce7a94100 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 11:57:15.879876: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 11:57:17.857803: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 11:57:18.550213: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 11:57:19.202420: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 11:57:19.208274: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 11:57:20.552524: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 11:57:20.608171: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 11:57:21.327675: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 361ms/step
[INFOR]: Index of most vote   :408
[INFOR]: Class of most vote   :amphibian, amphibious vehicle
[INFOR]: Number of most vote  :9.0


[INFOR]: Index of second most vote     :674
[INFOR]: Class of second most vote     :mousetrap
[INFOR]: Number of second most vote    :9.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 38ms/step
[INFOR]: Toltal norm before transform: 0.8022
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.2176

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 38ms/step
[INFOR]: SEN training of class 148_47 before transform: 9
[INFOR]: SPE training of class 148_47 before transform: 35

[INFOR]: SEN training of class 148_47 after transform: 37
[INFOR]: SPE training of class 148_47 after transform: 32
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (92, 32, 32, 3)
[INFOR]: shape of y: (92, 1)
3/3 [==============================] - 0s 38ms/step
[INFOR]: Index of most vote   :408
[INFOR]: Class of most vote   :amphibian, amphibious vehicle
[INFOR]: Number of most vote  :15.0


[INFOR]: Index of second most vote     :481
[INFOR]: Class of second most vote     :cassette
[INFOR]: Number of second most vote    :4.0
[INFOR]: SEN testing of class 148_46 before transform: 15
[INFOR]: SPE testing of class 148_46 before transform: 33

[INFOR]: SEN testing of class 148_46 after transform: 41
[INFOR]: SPE testing of class 148_46 after transform: 7
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name stanford_car --class_name_train 149_38 --class_name_test 149_37
2021-09-13 11:57:25.955941: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  stanford_car
class_name_train =  149_38
class_name_test =  149_37
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (76, 32, 32, 3)
[INFOR]: shape of y: (76, 1)
[INFOR]: get pretrained model
2021-09-13 11:57:28.510091: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 11:57:28.535032: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 11:57:28.539843: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 11:57:28.547933: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 11:57:28.550054: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 11:57:28.555288: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 11:57:28.558551: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 11:57:28.564886: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 11:57:28.569787: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 11:57:28.572767: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 11:57:28.574841: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 11:57:28.576748: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 11:57:28.588899: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x18f36277310 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 11:57:28.592099: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 11:57:28.594087: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 11:57:28.598365: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 11:57:28.600458: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 11:57:28.602503: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 11:57:28.604661: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 11:57:28.607222: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 11:57:28.609361: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 11:57:28.611430: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 11:57:28.613538: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 11:57:28.615772: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 11:57:29.045636: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 11:57:29.048432: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 11:57:29.049751: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 11:57:29.051200: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 11:57:29.057741: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x18f6160b3f0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 11:57:29.060614: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 11:57:31.040302: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 11:57:31.734914: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 11:57:32.379318: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 11:57:32.385210: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 11:57:33.721418: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 11:57:33.771966: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 11:57:34.492817: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 332ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :8.0


[INFOR]: Index of second most vote     :816
[INFOR]: Class of second most vote     :spindle
[INFOR]: Number of second most vote    :6.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 31ms/step
[INFOR]: Toltal norm before transform: 0.7852
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0392

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 34ms/step
[INFOR]: SEN training of class 149_38 before transform: 8
[INFOR]: SPE training of class 149_38 before transform: 24

[INFOR]: SEN training of class 149_38 after transform: 33
[INFOR]: SPE training of class 149_38 after transform: 24
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (74, 32, 32, 3)
[INFOR]: shape of y: (74, 1)
3/3 [==============================] - 0s 32ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :12.0


[INFOR]: Index of second most vote     :408
[INFOR]: Class of second most vote     :amphibian, amphibious vehicle
[INFOR]: Number of second most vote    :4.0
[INFOR]: SEN testing of class 149_37 before transform: 12
[INFOR]: SPE testing of class 149_37 before transform: 23

[INFOR]: SEN testing of class 149_37 after transform: 37
[INFOR]: SPE testing of class 149_37 after transform: 0
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name stanford_car --class_name_train 150_44 --class_name_test 150_44
2021-09-13 11:57:38.891198: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  stanford_car
class_name_train =  150_44
class_name_test =  150_44
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (88, 32, 32, 3)
[INFOR]: shape of y: (88, 1)
[INFOR]: get pretrained model
2021-09-13 11:57:41.436088: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 11:57:41.460025: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 11:57:41.464344: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 11:57:41.472178: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 11:57:41.474376: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 11:57:41.479409: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 11:57:41.482738: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 11:57:41.488950: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 11:57:41.493929: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 11:57:41.496963: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 11:57:41.499054: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 11:57:41.500896: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 11:57:41.512868: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1cdb3b4fc20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 11:57:41.515944: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 11:57:41.517928: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 11:57:41.522022: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 11:57:41.524279: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 11:57:41.526374: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 11:57:41.528524: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 11:57:41.530680: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 11:57:41.532783: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 11:57:41.535030: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 11:57:41.537229: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 11:57:41.539294: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 11:57:41.962167: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 11:57:41.965014: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 11:57:41.966442: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 11:57:41.967933: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 11:57:41.974275: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1cddee7d8d0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 11:57:41.977075: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 11:57:43.956899: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 11:57:44.657599: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 11:57:45.309551: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 11:57:45.316013: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 11:57:46.675237: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 11:57:46.723440: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 11:57:47.448275: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 331ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :18.0


[INFOR]: Index of second most vote     :408
[INFOR]: Class of second most vote     :amphibian, amphibious vehicle
[INFOR]: Number of second most vote    :13.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 37ms/step
[INFOR]: Toltal norm before transform: 0.5510
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0112

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 38ms/step
[INFOR]: SEN training of class 150_44 before transform: 18
[INFOR]: SPE training of class 150_44 before transform: 27

[INFOR]: SEN training of class 150_44 after transform: 40
[INFOR]: SPE training of class 150_44 after transform: 27
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (88, 32, 32, 3)
[INFOR]: shape of y: (88, 1)
3/3 [==============================] - 0s 37ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :15.0


[INFOR]: Index of second most vote     :408
[INFOR]: Class of second most vote     :amphibian, amphibious vehicle
[INFOR]: Number of second most vote    :12.0
[INFOR]: SEN testing of class 150_44 before transform: 15
[INFOR]: SPE testing of class 150_44 before transform: 33

[INFOR]: SEN testing of class 150_44 after transform: 41
[INFOR]: SPE testing of class 150_44 after transform: 1
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name stanford_car --class_name_train 151_45 --class_name_test 151_44
2021-09-13 11:57:51.377850: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  stanford_car
class_name_train =  151_45
class_name_test =  151_44
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (90, 32, 32, 3)
[INFOR]: shape of y: (90, 1)
[INFOR]: get pretrained model
2021-09-13 11:57:53.916137: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 11:57:53.942863: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 11:57:53.947285: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 11:57:53.955238: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 11:57:53.957355: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 11:57:53.962390: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 11:57:53.965758: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 11:57:53.971918: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 11:57:53.976799: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 11:57:53.979811: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 11:57:53.981903: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 11:57:53.983749: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 11:57:53.996072: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x132b4b959d0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 11:57:53.999453: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 11:57:54.001547: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 11:57:54.005802: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 11:57:54.007970: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 11:57:54.010083: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 11:57:54.012176: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 11:57:54.014284: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 11:57:54.016486: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 11:57:54.018614: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 11:57:54.020700: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 11:57:54.022839: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 11:57:54.444574: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 11:57:54.447485: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 11:57:54.448902: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 11:57:54.450585: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 11:57:54.457175: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x132e3be0f00 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 11:57:54.460041: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 11:57:56.444804: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 11:57:57.139337: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 11:57:57.785589: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 11:57:57.792483: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 11:57:59.138505: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 11:57:59.187373: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 11:57:59.908206: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 363ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :15.0


[INFOR]: Index of second most vote     :408
[INFOR]: Class of second most vote     :amphibian, amphibious vehicle
[INFOR]: Number of second most vote    :11.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 39ms/step
[INFOR]: Toltal norm before transform: 0.5716
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0358

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 38ms/step
[INFOR]: SEN training of class 151_45 before transform: 15
[INFOR]: SPE training of class 151_45 before transform: 30

[INFOR]: SEN training of class 151_45 after transform: 40
[INFOR]: SPE training of class 151_45 after transform: 30
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (88, 32, 32, 3)
[INFOR]: shape of y: (88, 1)
3/3 [==============================] - 0s 38ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :10.0


[INFOR]: Index of second most vote     :408
[INFOR]: Class of second most vote     :amphibian, amphibious vehicle
[INFOR]: Number of second most vote    :5.0
[INFOR]: SEN testing of class 151_44 before transform: 10
[INFOR]: SPE testing of class 151_44 before transform: 27

[INFOR]: SEN testing of class 151_44 after transform: 43
[INFOR]: SPE testing of class 151_44 after transform: 2
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name stanford_car --class_name_train 152_45 --class_name_test 152_44
2021-09-13 11:58:04.463557: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  stanford_car
class_name_train =  152_45
class_name_test =  152_44
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (90, 32, 32, 3)
[INFOR]: shape of y: (90, 1)
[INFOR]: get pretrained model
2021-09-13 11:58:06.970974: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 11:58:06.996875: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 11:58:07.001560: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 11:58:07.009661: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 11:58:07.011852: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 11:58:07.017143: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 11:58:07.020632: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 11:58:07.026991: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 11:58:07.032071: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 11:58:07.034988: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 11:58:07.037181: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 11:58:07.039098: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 11:58:07.050867: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x12db589def0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 11:58:07.053996: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 11:58:07.056008: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 11:58:07.060246: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 11:58:07.062591: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 11:58:07.064724: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 11:58:07.066839: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 11:58:07.068979: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 11:58:07.071109: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 11:58:07.073230: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 11:58:07.075356: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 11:58:07.077516: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 11:58:07.506012: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 11:58:07.508732: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 11:58:07.510114: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 11:58:07.511580: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 11:58:07.518307: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x12de440b680 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 11:58:07.521089: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 11:58:09.499834: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 11:58:10.201637: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 11:58:10.854430: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 11:58:10.860052: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 11:58:12.200933: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 11:58:12.256868: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 11:58:12.976082: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 345ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :9.0


[INFOR]: Index of second most vote     :408
[INFOR]: Class of second most vote     :amphibian, amphibious vehicle
[INFOR]: Number of second most vote    :7.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 38ms/step
[INFOR]: Toltal norm before transform: 0.7473
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0659

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 38ms/step
[INFOR]: SEN training of class 152_45 before transform: 9
[INFOR]: SPE training of class 152_45 before transform: 35

[INFOR]: SEN training of class 152_45 after transform: 39
[INFOR]: SPE training of class 152_45 after transform: 34
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (88, 32, 32, 3)
[INFOR]: shape of y: (88, 1)
3/3 [==============================] - 0s 37ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :17.0


[INFOR]: Index of second most vote     :408
[INFOR]: Class of second most vote     :amphibian, amphibious vehicle
[INFOR]: Number of second most vote    :4.0
[INFOR]: SEN testing of class 152_44 before transform: 17
[INFOR]: SPE testing of class 152_44 before transform: 27

[INFOR]: SEN testing of class 152_44 after transform: 44
[INFOR]: SPE testing of class 152_44 after transform: 0
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name stanford_car --class_name_train 153_37 --class_name_test 153_36
2021-09-13 11:58:17.498313: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  stanford_car
class_name_train =  153_37
class_name_test =  153_36
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (74, 32, 32, 3)
[INFOR]: shape of y: (74, 1)
[INFOR]: get pretrained model
2021-09-13 11:58:20.027582: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 11:58:20.052273: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 11:58:20.057136: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 11:58:20.065029: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 11:58:20.067158: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 11:58:20.072323: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 11:58:20.075768: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 11:58:20.081963: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 11:58:20.086886: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 11:58:20.089970: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 11:58:20.092150: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 11:58:20.094040: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 11:58:20.106020: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x232b3787850 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 11:58:20.109346: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 11:58:20.111459: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 11:58:20.115688: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 11:58:20.117799: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 11:58:20.119975: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 11:58:20.122085: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 11:58:20.124253: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 11:58:20.126344: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 11:58:20.128492: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 11:58:20.130607: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 11:58:20.132732: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 11:58:20.545397: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 11:58:20.548060: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 11:58:20.549464: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 11:58:20.550938: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 11:58:20.557520: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x232dfc19010 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 11:58:20.560366: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 11:58:22.537397: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 11:58:23.222151: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 11:58:23.872780: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 11:58:23.878757: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 11:58:25.224654: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 11:58:25.273461: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 11:58:26.025826: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 294ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :16.0


[INFOR]: Index of second most vote     :408
[INFOR]: Class of second most vote     :amphibian, amphibious vehicle
[INFOR]: Number of second most vote    :7.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 31ms/step
[INFOR]: Toltal norm before transform: 0.5015
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0535

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 33ms/step
[INFOR]: SEN training of class 153_37 before transform: 16
[INFOR]: SPE training of class 153_37 before transform: 29

[INFOR]: SEN training of class 153_37 after transform: 35
[INFOR]: SPE training of class 153_37 after transform: 29
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (72, 32, 32, 3)
[INFOR]: shape of y: (72, 1)
3/3 [==============================] - 0s 32ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :20.0


[INFOR]: Index of second most vote     :408
[INFOR]: Class of second most vote     :amphibian, amphibious vehicle
[INFOR]: Number of second most vote    :5.0
[INFOR]: SEN testing of class 153_36 before transform: 20
[INFOR]: SPE testing of class 153_36 before transform: 20

[INFOR]: SEN testing of class 153_36 after transform: 34
[INFOR]: SPE testing of class 153_36 after transform: 2
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name stanford_car --class_name_train 154_43 --class_name_test 154_43
2021-09-13 11:58:30.280580: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  stanford_car
class_name_train =  154_43
class_name_test =  154_43
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (86, 32, 32, 3)
[INFOR]: shape of y: (86, 1)
[INFOR]: get pretrained model
2021-09-13 11:58:32.826672: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 11:58:32.852944: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 11:58:32.857690: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 11:58:32.865469: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 11:58:32.867546: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 11:58:32.872676: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 11:58:32.876062: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 11:58:32.883015: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 11:58:32.888238: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 11:58:32.891413: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 11:58:32.893720: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 11:58:32.895752: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 11:58:32.908000: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1e0b42bd0a0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 11:58:32.911513: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 11:58:32.913663: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 11:58:32.918217: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 11:58:32.920454: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 11:58:32.922700: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 11:58:32.925064: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 11:58:32.927336: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 11:58:32.929608: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 11:58:32.931738: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 11:58:32.933960: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 11:58:32.936044: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 11:58:33.363184: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 11:58:33.365767: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 11:58:33.367182: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 11:58:33.368665: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 11:58:33.375749: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1e0dd83c090 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 11:58:33.378540: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 11:58:35.405601: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 11:58:36.107479: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 11:58:36.776162: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 11:58:36.782725: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 11:58:38.129650: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 11:58:38.184371: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 11:58:38.905421: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 333ms/step
[INFOR]: Index of most vote   :408
[INFOR]: Class of most vote   :amphibian, amphibious vehicle
[INFOR]: Number of most vote  :15.0


[INFOR]: Index of second most vote     :674
[INFOR]: Class of second most vote     :mousetrap
[INFOR]: Number of second most vote    :12.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 36ms/step
[INFOR]: Toltal norm before transform: 0.6221
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1382

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 36ms/step
[INFOR]: SEN training of class 154_43 before transform: 15
[INFOR]: SPE training of class 154_43 before transform: 35

[INFOR]: SEN training of class 154_43 after transform: 39
[INFOR]: SPE training of class 154_43 after transform: 35
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (86, 32, 32, 3)
[INFOR]: shape of y: (86, 1)
3/3 [==============================] - 0s 37ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :16.0


[INFOR]: Index of second most vote     :408
[INFOR]: Class of second most vote     :amphibian, amphibious vehicle
[INFOR]: Number of second most vote    :14.0
[INFOR]: SEN testing of class 154_43 before transform: 16
[INFOR]: SPE testing of class 154_43 before transform: 29

[INFOR]: SEN testing of class 154_43 after transform: 40
[INFOR]: SPE testing of class 154_43 after transform: 1
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name stanford_car --class_name_train 155_37 --class_name_test 155_37
2021-09-13 11:58:42.796659: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  stanford_car
class_name_train =  155_37
class_name_test =  155_37
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (74, 32, 32, 3)
[INFOR]: shape of y: (74, 1)
[INFOR]: get pretrained model
2021-09-13 11:58:45.264211: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 11:58:45.288850: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 11:58:45.292987: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 11:58:45.300809: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 11:58:45.302939: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 11:58:45.307942: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 11:58:45.311240: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 11:58:45.317461: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 11:58:45.322300: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 11:58:45.325317: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 11:58:45.327395: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 11:58:45.329313: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 11:58:45.341457: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x2e23a47d400 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 11:58:45.344716: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 11:58:45.346810: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 11:58:45.350904: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 11:58:45.353109: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 11:58:45.355211: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 11:58:45.357281: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 11:58:45.359470: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 11:58:45.361668: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 11:58:45.363808: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 11:58:45.365909: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 11:58:45.367989: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 11:58:45.791451: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 11:58:45.794323: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 11:58:45.795648: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 11:58:45.797088: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 11:58:45.803789: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x2e269a3c610 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 11:58:45.806696: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 11:58:47.766010: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 11:58:48.456448: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 11:58:49.113160: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 11:58:49.119605: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 11:58:50.464537: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 11:58:50.518586: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 11:58:51.238106: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 292ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :14.0


[INFOR]: Index of second most vote     :408
[INFOR]: Class of second most vote     :amphibian, amphibious vehicle
[INFOR]: Number of second most vote    :11.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 32ms/step
[INFOR]: Toltal norm before transform: 0.4971
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0219

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 33ms/step
[INFOR]: SEN training of class 155_37 before transform: 14
[INFOR]: SPE training of class 155_37 before transform: 28

[INFOR]: SEN training of class 155_37 after transform: 31
[INFOR]: SPE training of class 155_37 after transform: 28
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (74, 32, 32, 3)
[INFOR]: shape of y: (74, 1)
3/3 [==============================] - 0s 33ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :23.0


[INFOR]: Index of second most vote     :408
[INFOR]: Class of second most vote     :amphibian, amphibious vehicle
[INFOR]: Number of second most vote    :7.0
[INFOR]: SEN testing of class 155_37 before transform: 23
[INFOR]: SPE testing of class 155_37 before transform: 28

[INFOR]: SEN testing of class 155_37 after transform: 35
[INFOR]: SPE testing of class 155_37 after transform: 2
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name stanford_car --class_name_train 156_44 --class_name_test 156_44
2021-09-13 11:58:54.976779: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  stanford_car
class_name_train =  156_44
class_name_test =  156_44
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (88, 32, 32, 3)
[INFOR]: shape of y: (88, 1)
[INFOR]: get pretrained model
2021-09-13 11:58:57.481837: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 11:58:57.506981: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 11:58:57.511335: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 11:58:57.519482: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 11:58:57.521648: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 11:58:57.526824: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 11:58:57.530198: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 11:58:57.536425: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 11:58:57.541359: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 11:58:57.544336: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 11:58:57.546527: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 11:58:57.548407: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 11:58:57.560140: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x21bb93eece0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 11:58:57.563502: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 11:58:57.565487: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 11:58:57.569724: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 11:58:57.571837: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 11:58:57.573982: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 11:58:57.576181: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 11:58:57.578386: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 11:58:57.580497: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 11:58:57.582625: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 11:58:57.584850: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 11:58:57.587019: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 11:58:58.005216: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 11:58:58.008098: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 11:58:58.009426: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 11:58:58.010896: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 11:58:58.017468: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x21be2d985e0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 11:58:58.020236: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 11:58:59.990954: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 11:59:00.690526: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 11:59:01.331778: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 11:59:01.337301: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 11:59:02.691177: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 11:59:02.747291: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 11:59:03.504057: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 330ms/step
[INFOR]: Index of most vote   :408
[INFOR]: Class of most vote   :amphibian, amphibious vehicle
[INFOR]: Number of most vote  :11.0


[INFOR]: Index of second most vote     :674
[INFOR]: Class of second most vote     :mousetrap
[INFOR]: Number of second most vote    :8.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 38ms/step
[INFOR]: Toltal norm before transform: 0.7343
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0779

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 37ms/step
[INFOR]: SEN training of class 156_44 before transform: 11
[INFOR]: SPE training of class 156_44 before transform: 36

[INFOR]: SEN training of class 156_44 after transform: 38
[INFOR]: SPE training of class 156_44 after transform: 36
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (88, 32, 32, 3)
[INFOR]: shape of y: (88, 1)
3/3 [==============================] - 0s 37ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :11.0


[INFOR]: Index of second most vote     :408
[INFOR]: Class of second most vote     :amphibian, amphibious vehicle
[INFOR]: Number of second most vote    :7.0
[INFOR]: SEN testing of class 156_44 before transform: 11
[INFOR]: SPE testing of class 156_44 before transform: 32

[INFOR]: SEN testing of class 156_44 after transform: 41
[INFOR]: SPE testing of class 156_44 after transform: 0
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name stanford_car --class_name_train 157_30 --class_name_test 157_29
2021-09-13 11:59:07.385315: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  stanford_car
class_name_train =  157_30
class_name_test =  157_29
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (60, 32, 32, 3)
[INFOR]: shape of y: (60, 1)
[INFOR]: get pretrained model
2021-09-13 11:59:09.876820: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 11:59:09.901331: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 11:59:09.905798: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 11:59:09.913704: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 11:59:09.915827: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 11:59:09.920876: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 11:59:09.924293: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 11:59:09.930702: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 11:59:09.935876: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 11:59:09.939094: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 11:59:09.941219: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 11:59:09.943134: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 11:59:09.955753: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x216334e8460 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 11:59:09.959187: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 11:59:09.961217: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 11:59:09.965474: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 11:59:09.967582: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 11:59:09.969834: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 11:59:09.971989: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 11:59:09.974146: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 11:59:09.976228: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 11:59:09.978483: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 11:59:09.980595: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 11:59:09.982804: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 11:59:10.405089: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 11:59:10.408415: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 11:59:10.409766: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 11:59:10.411277: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 11:59:10.418101: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x21662a8a6e0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 11:59:10.420937: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 11:59:12.400631: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 11:59:13.093184: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 11:59:13.748427: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 11:59:13.755111: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 11:59:15.102638: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 11:59:15.158938: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 11:59:15.879364: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
2/2 [==============================] - 4s 683ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :22.0


[INFOR]: Index of second most vote     :408
[INFOR]: Class of second most vote     :amphibian, amphibious vehicle
[INFOR]: Number of second most vote    :3.0

[INFOR]: Create PDF for Positive Label

2/2 [==============================] - 1s 46ms/step
[INFOR]: Toltal norm before transform: 0.2083
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0314

[INFOR]: Create PDF for Negative Label

2/2 [==============================] - 0s 47ms/step
[INFOR]: SEN training of class 157_30 before transform: 22
[INFOR]: SPE training of class 157_30 before transform: 16

[INFOR]: SEN training of class 157_30 after transform: 30
[INFOR]: SPE training of class 157_30 after transform: 16
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (58, 32, 32, 3)
[INFOR]: shape of y: (58, 1)
2/2 [==============================] - 0s 44ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :23.0


[INFOR]: Index of second most vote     :408
[INFOR]: Class of second most vote     :amphibian, amphibious vehicle
[INFOR]: Number of second most vote    :2.0
[INFOR]: SEN testing of class 157_29 before transform: 23
[INFOR]: SPE testing of class 157_29 before transform: 17

[INFOR]: SEN testing of class 157_29 after transform: 29
[INFOR]: SPE testing of class 157_29 after transform: 0
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name stanford_car --class_name_train 158_45 --class_name_test 158_45
2021-09-13 11:59:20.241231: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  stanford_car
class_name_train =  158_45
class_name_test =  158_45
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (90, 32, 32, 3)
[INFOR]: shape of y: (90, 1)
[INFOR]: get pretrained model
2021-09-13 11:59:22.747483: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 11:59:22.773037: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 11:59:22.778206: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 11:59:22.786259: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 11:59:22.788531: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 11:59:22.793657: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 11:59:22.796953: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 11:59:22.803241: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 11:59:22.808355: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 11:59:22.811359: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 11:59:22.813473: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 11:59:22.815343: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 11:59:22.827494: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1c9b76e6000 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 11:59:22.830692: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 11:59:22.832760: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 11:59:22.836900: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 11:59:22.838994: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 11:59:22.841076: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 11:59:22.843225: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 11:59:22.845520: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 11:59:22.847623: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 11:59:22.849693: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 11:59:22.851833: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 11:59:22.853977: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 11:59:23.273249: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 11:59:23.275865: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 11:59:23.277215: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 11:59:23.278716: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 11:59:23.285395: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1c9e7233080 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 11:59:23.288174: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 11:59:25.262661: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 11:59:25.952720: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 11:59:26.607569: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 11:59:26.613281: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 11:59:27.977364: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 11:59:28.026705: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 11:59:28.812943: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 349ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :21.0


[INFOR]: Index of second most vote     :408
[INFOR]: Class of second most vote     :amphibian, amphibious vehicle
[INFOR]: Number of second most vote    :11.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 37ms/step
[INFOR]: Toltal norm before transform: 0.4402
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0418

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 37ms/step
[INFOR]: SEN training of class 158_45 before transform: 21
[INFOR]: SPE training of class 158_45 before transform: 28

[INFOR]: SEN training of class 158_45 after transform: 42
[INFOR]: SPE training of class 158_45 after transform: 28
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (90, 32, 32, 3)
[INFOR]: shape of y: (90, 1)
3/3 [==============================] - 0s 35ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :17.0


[INFOR]: Index of second most vote     :408
[INFOR]: Class of second most vote     :amphibian, amphibious vehicle
[INFOR]: Number of second most vote    :13.0
[INFOR]: SEN testing of class 158_45 before transform: 17
[INFOR]: SPE testing of class 158_45 before transform: 30

[INFOR]: SEN testing of class 158_45 after transform: 39
[INFOR]: SPE testing of class 158_45 after transform: 6
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name stanford_car --class_name_train 159_42 --class_name_test 159_41
2021-09-13 11:59:32.752005: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  stanford_car
class_name_train =  159_42
class_name_test =  159_41
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (84, 32, 32, 3)
[INFOR]: shape of y: (84, 1)
[INFOR]: get pretrained model
2021-09-13 11:59:35.320230: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 11:59:35.345126: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 11:59:35.349436: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 11:59:35.357311: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 11:59:35.359413: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 11:59:35.364398: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 11:59:35.367642: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 11:59:35.373784: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 11:59:35.378596: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 11:59:35.381579: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 11:59:35.383707: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 11:59:35.385536: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 11:59:35.397642: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x22bb6273700 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 11:59:35.401184: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 11:59:35.403176: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 11:59:35.407470: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 11:59:35.409637: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 11:59:35.411889: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 11:59:35.413982: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 11:59:35.416110: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 11:59:35.418208: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 11:59:35.420338: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 11:59:35.422429: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 11:59:35.424479: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 11:59:35.853176: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 11:59:35.856521: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 11:59:35.857851: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 11:59:35.859333: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 11:59:35.865870: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x22be61c6d00 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 11:59:35.868750: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 11:59:37.867933: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 11:59:38.569144: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 11:59:39.226507: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 11:59:39.232911: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 11:59:40.582759: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 11:59:40.631409: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 11:59:41.347141: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 321ms/step
[INFOR]: Index of most vote   :408
[INFOR]: Class of most vote   :amphibian, amphibious vehicle
[INFOR]: Number of most vote  :13.0


[INFOR]: Index of second most vote     :674
[INFOR]: Class of second most vote     :mousetrap
[INFOR]: Number of second most vote    :7.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 36ms/step
[INFOR]: Toltal norm before transform: 0.7071
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.2349

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 36ms/step
[INFOR]: SEN training of class 159_42 before transform: 13
[INFOR]: SPE training of class 159_42 before transform: 37

[INFOR]: SEN training of class 159_42 after transform: 40
[INFOR]: SPE training of class 159_42 after transform: 35
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (82, 32, 32, 3)
[INFOR]: shape of y: (82, 1)
3/3 [==============================] - 0s 36ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :11.0


[INFOR]: Index of second most vote     :408
[INFOR]: Class of second most vote     :amphibian, amphibious vehicle
[INFOR]: Number of second most vote    :6.0
[INFOR]: SEN testing of class 159_41 before transform: 11
[INFOR]: SPE testing of class 159_41 before transform: 25

[INFOR]: SEN testing of class 159_41 after transform: 39
[INFOR]: SPE testing of class 159_41 after transform: 0
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name stanford_car --class_name_train 160_39 --class_name_test 160_38
2021-09-13 11:59:45.771327: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  stanford_car
class_name_train =  160_39
class_name_test =  160_38
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (78, 32, 32, 3)
[INFOR]: shape of y: (78, 1)
[INFOR]: get pretrained model
2021-09-13 11:59:48.255261: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 11:59:48.282062: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 11:59:48.287145: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 11:59:48.295286: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 11:59:48.297516: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 11:59:48.302661: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 11:59:48.306093: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 11:59:48.312407: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 11:59:48.317353: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 11:59:48.320422: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 11:59:48.322642: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 11:59:48.324702: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 11:59:48.337550: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x27135899560 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 11:59:48.340868: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 11:59:48.342901: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 11:59:48.347144: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 11:59:48.349255: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 11:59:48.351355: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 11:59:48.353537: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 11:59:48.355616: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 11:59:48.357861: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 11:59:48.360190: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 11:59:48.362278: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 11:59:48.364443: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 11:59:48.780826: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 11:59:48.783671: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 11:59:48.785160: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 11:59:48.786711: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 11:59:48.793259: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x2716189b240 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 11:59:48.796594: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 11:59:50.753424: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 11:59:51.438463: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 11:59:52.088342: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 11:59:52.093979: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 11:59:53.434084: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 11:59:53.482198: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 11:59:54.198564: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 307ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :12.0


[INFOR]: Index of second most vote     :408
[INFOR]: Class of second most vote     :amphibian, amphibious vehicle
[INFOR]: Number of second most vote    :8.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 34ms/step
[INFOR]: Toltal norm before transform: 0.6117
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.2881

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 33ms/step
[INFOR]: SEN training of class 160_39 before transform: 12
[INFOR]: SPE training of class 160_39 before transform: 28

[INFOR]: SEN training of class 160_39 after transform: 28
[INFOR]: SPE training of class 160_39 after transform: 28
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (76, 32, 32, 3)
[INFOR]: shape of y: (76, 1)
3/3 [==============================] - 0s 35ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :8.0


[INFOR]: Index of second most vote     :408
[INFOR]: Class of second most vote     :amphibian, amphibious vehicle
[INFOR]: Number of second most vote    :7.0
[INFOR]: SEN testing of class 160_38 before transform: 8
[INFOR]: SPE testing of class 160_38 before transform: 28

[INFOR]: SEN testing of class 160_38 after transform: 38
[INFOR]: SPE testing of class 160_38 after transform: 0
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name stanford_car --class_name_train 161_40 --class_name_test 161_40
2021-09-13 11:59:58.525408: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  stanford_car
class_name_train =  161_40
class_name_test =  161_40
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (80, 32, 32, 3)
[INFOR]: shape of y: (80, 1)
[INFOR]: get pretrained model
2021-09-13 12:00:00.991699: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 12:00:01.015379: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:00:01.020285: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:00:01.028125: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:00:01.030150: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:00:01.035470: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:00:01.038813: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:00:01.044854: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:00:01.049724: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:00:01.052810: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:00:01.054840: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:00:01.056670: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 12:00:01.069447: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1e9362d30d0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:00:01.072663: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 12:00:01.074651: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:00:01.078978: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:00:01.081138: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:00:01.083381: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:00:01.085487: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:00:01.087683: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:00:01.089851: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:00:01.092006: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:00:01.094179: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:00:01.096331: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:00:01.527228: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 12:00:01.529556: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 12:00:01.530940: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 12:00:01.532440: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 12:00:01.539046: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1e9648ef250 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:00:01.541918: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 12:00:03.494258: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 12:00:04.177123: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:00:04.831065: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:00:04.836542: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:00:06.178584: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:00:06.234227: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:00:06.949131: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 300ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :10.0


[INFOR]: Index of second most vote     :408
[INFOR]: Class of second most vote     :amphibian, amphibious vehicle
[INFOR]: Number of second most vote    :9.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 34ms/step
[INFOR]: Toltal norm before transform: 0.7089
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1938

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 34ms/step
[INFOR]: SEN training of class 161_40 before transform: 10
[INFOR]: SPE training of class 161_40 before transform: 27

[INFOR]: SEN training of class 161_40 after transform: 31
[INFOR]: SPE training of class 161_40 after transform: 23
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (80, 32, 32, 3)
[INFOR]: shape of y: (80, 1)
3/3 [==============================] - 0s 35ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :11.0


[INFOR]: Index of second most vote     :408
[INFOR]: Class of second most vote     :amphibian, amphibious vehicle
[INFOR]: Number of second most vote    :10.0
[INFOR]: SEN testing of class 161_40 before transform: 11
[INFOR]: SPE testing of class 161_40 before transform: 26

[INFOR]: SEN testing of class 161_40 after transform: 33
[INFOR]: SPE testing of class 161_40 after transform: 2
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name stanford_car --class_name_train 162_38 --class_name_test 162_38
2021-09-13 12:00:10.723808: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  stanford_car
class_name_train =  162_38
class_name_test =  162_38
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (76, 32, 32, 3)
[INFOR]: shape of y: (76, 1)
[INFOR]: get pretrained model
2021-09-13 12:00:13.216997: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 12:00:13.240960: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:00:13.245543: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:00:13.253463: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:00:13.255586: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:00:13.260661: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:00:13.263895: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:00:13.270128: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:00:13.275347: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:00:13.278299: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:00:13.280495: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:00:13.282440: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 12:00:13.295070: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1d8335c83c0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:00:13.298376: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 12:00:13.300366: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:00:13.304585: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:00:13.306758: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:00:13.308806: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:00:13.310923: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:00:13.313196: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:00:13.315255: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:00:13.317338: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:00:13.319522: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:00:13.321628: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:00:13.745095: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 12:00:13.747993: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 12:00:13.749380: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 12:00:13.750857: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 12:00:13.758696: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1d85b735810 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:00:13.762132: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 12:00:15.730652: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 12:00:16.426328: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:00:17.073335: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:00:17.079143: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:00:18.426104: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:00:18.474156: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:00:19.192659: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 298ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :17.0


[INFOR]: Index of second most vote     :408
[INFOR]: Class of second most vote     :amphibian, amphibious vehicle
[INFOR]: Number of second most vote    :6.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 33ms/step
[INFOR]: Toltal norm before transform: 0.4247
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0934

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 33ms/step
[INFOR]: SEN training of class 162_38 before transform: 17
[INFOR]: SPE training of class 162_38 before transform: 24

[INFOR]: SEN training of class 162_38 after transform: 32
[INFOR]: SPE training of class 162_38 after transform: 24
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (76, 32, 32, 3)
[INFOR]: shape of y: (76, 1)
3/3 [==============================] - 0s 34ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :14.0


[INFOR]: Index of second most vote     :408
[INFOR]: Class of second most vote     :amphibian, amphibious vehicle
[INFOR]: Number of second most vote    :12.0
[INFOR]: SEN testing of class 162_38 before transform: 14
[INFOR]: SPE testing of class 162_38 before transform: 30

[INFOR]: SEN testing of class 162_38 after transform: 35
[INFOR]: SPE testing of class 162_38 after transform: 9
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name stanford_car --class_name_train 163_39 --class_name_test 163_39
2021-09-13 12:00:22.971076: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  stanford_car
class_name_train =  163_39
class_name_test =  163_39
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (78, 32, 32, 3)
[INFOR]: shape of y: (78, 1)
[INFOR]: get pretrained model
2021-09-13 12:00:25.461216: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 12:00:25.487076: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:00:25.492122: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:00:25.499971: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:00:25.502121: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:00:25.507084: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:00:25.510391: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:00:25.517070: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:00:25.522071: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:00:25.525067: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:00:25.527289: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:00:25.529251: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 12:00:25.541616: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1f5b9498100 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:00:25.545104: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 12:00:25.547237: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:00:25.551622: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:00:25.553786: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:00:25.555934: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:00:25.558217: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:00:25.560478: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:00:25.562621: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:00:25.564828: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:00:25.567020: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:00:25.569266: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:00:25.992485: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 12:00:25.995144: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 12:00:25.996569: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 12:00:25.998038: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 12:00:26.004464: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1f5e287cc60 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:00:26.007294: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 12:00:27.982694: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 12:00:28.677504: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:00:29.334931: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:00:29.341734: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:00:30.698907: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:00:30.749247: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:00:31.534870: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 308ms/step
[INFOR]: Index of most vote   :408
[INFOR]: Class of most vote   :amphibian, amphibious vehicle
[INFOR]: Number of most vote  :9.0


[INFOR]: Index of second most vote     :674
[INFOR]: Class of second most vote     :mousetrap
[INFOR]: Number of second most vote    :7.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 32ms/step
[INFOR]: Toltal norm before transform: 0.7592
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1185

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 34ms/step
[INFOR]: SEN training of class 163_39 before transform: 9
[INFOR]: SPE training of class 163_39 before transform: 26

[INFOR]: SEN training of class 163_39 after transform: 35
[INFOR]: SPE training of class 163_39 after transform: 26
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (78, 32, 32, 3)
[INFOR]: shape of y: (78, 1)
3/3 [==============================] - 0s 33ms/step
[INFOR]: Index of most vote   :408
[INFOR]: Class of most vote   :amphibian, amphibious vehicle
[INFOR]: Number of most vote  :8.0


[INFOR]: Index of second most vote     :674
[INFOR]: Class of second most vote     :mousetrap
[INFOR]: Number of second most vote    :7.0
[INFOR]: SEN testing of class 163_39 before transform: 8
[INFOR]: SPE testing of class 163_39 before transform: 34

[INFOR]: SEN testing of class 163_39 after transform: 39
[INFOR]: SPE testing of class 163_39 after transform: 1
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name stanford_car --class_name_train 164_43 --class_name_test 164_42
2021-09-13 12:00:35.334354: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  stanford_car
class_name_train =  164_43
class_name_test =  164_42
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (86, 32, 32, 3)
[INFOR]: shape of y: (86, 1)
[INFOR]: get pretrained model
2021-09-13 12:00:37.896474: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 12:00:37.921431: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:00:37.926325: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:00:37.934350: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:00:37.936682: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:00:37.941748: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:00:37.945139: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:00:37.951365: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:00:37.956360: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:00:37.959309: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:00:37.961461: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:00:37.963397: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 12:00:37.975273: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x288b3718d40 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:00:37.978698: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 12:00:37.980689: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:00:37.984897: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:00:37.987006: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:00:37.989109: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:00:37.991337: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:00:37.993606: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:00:37.995696: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:00:37.997861: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:00:37.999991: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:00:38.002104: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:00:38.424292: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 12:00:38.427059: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 12:00:38.428446: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 12:00:38.429958: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 12:00:38.436691: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x288d0cff7f0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:00:38.439479: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 12:00:40.428037: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 12:00:41.121415: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:00:41.778600: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:00:41.784543: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:00:43.135413: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:00:43.184714: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:00:43.903311: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 349ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :15.0


[INFOR]: Index of second most vote     :408
[INFOR]: Class of second most vote     :amphibian, amphibious vehicle
[INFOR]: Number of second most vote    :11.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 36ms/step
[INFOR]: Toltal norm before transform: 0.6342
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1639

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 37ms/step
[INFOR]: SEN training of class 164_43 before transform: 15
[INFOR]: SPE training of class 164_43 before transform: 35

[INFOR]: SEN training of class 164_43 after transform: 41
[INFOR]: SPE training of class 164_43 after transform: 33
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (84, 32, 32, 3)
[INFOR]: shape of y: (84, 1)
3/3 [==============================] - 0s 37ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :19.0


[INFOR]: Index of second most vote     :408
[INFOR]: Class of second most vote     :amphibian, amphibious vehicle
[INFOR]: Number of second most vote    :7.0
[INFOR]: SEN testing of class 164_42 before transform: 19
[INFOR]: SPE testing of class 164_42 before transform: 34

[INFOR]: SEN testing of class 164_42 after transform: 38
[INFOR]: SPE testing of class 164_42 after transform: 3
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name stanford_car --class_name_train 165_35 --class_name_test 165_35
2021-09-13 12:00:48.402580: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  stanford_car
class_name_train =  165_35
class_name_test =  165_35
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (70, 32, 32, 3)
[INFOR]: shape of y: (70, 1)
[INFOR]: get pretrained model
2021-09-13 12:00:50.914047: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 12:00:50.938798: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:00:50.943623: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:00:50.951606: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:00:50.953803: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:00:50.958882: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:00:50.962182: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:00:50.968379: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:00:50.973341: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:00:50.976402: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:00:50.978610: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:00:50.980512: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 12:00:50.992447: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x149b5590540 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:00:50.995457: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 12:00:50.997433: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:00:51.001712: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:00:51.003821: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:00:51.005954: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:00:51.008130: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:00:51.010434: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:00:51.012519: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:00:51.014695: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:00:51.016864: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:00:51.019072: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:00:51.443571: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 12:00:51.446343: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 12:00:51.447744: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 12:00:51.449282: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 12:00:51.455996: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x149e1073640 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:00:51.458762: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 12:00:53.427634: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 12:00:54.123502: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:00:54.779152: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:00:54.784310: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:00:56.122713: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:00:56.170155: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:00:56.887704: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 274ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :22.0


[INFOR]: Index of second most vote     :408
[INFOR]: Class of second most vote     :amphibian, amphibious vehicle
[INFOR]: Number of second most vote    :6.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 31ms/step
[INFOR]: Toltal norm before transform: 0.2452
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0841

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 32ms/step
[INFOR]: SEN training of class 165_35 before transform: 22
[INFOR]: SPE training of class 165_35 before transform: 23

[INFOR]: SEN training of class 165_35 after transform: 29
[INFOR]: SPE training of class 165_35 after transform: 23
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (70, 32, 32, 3)
[INFOR]: shape of y: (70, 1)
3/3 [==============================] - 0s 32ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :25.0


[INFOR]: Index of second most vote     :408
[INFOR]: Class of second most vote     :amphibian, amphibious vehicle
[INFOR]: Number of second most vote    :6.0
[INFOR]: SEN testing of class 165_35 before transform: 25
[INFOR]: SPE testing of class 165_35 before transform: 26

[INFOR]: SEN testing of class 165_35 after transform: 32
[INFOR]: SPE testing of class 165_35 after transform: 5
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name stanford_car --class_name_train 166_45 --class_name_test 166_45
2021-09-13 12:01:00.584231: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  stanford_car
class_name_train =  166_45
class_name_test =  166_45
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (90, 32, 32, 3)
[INFOR]: shape of y: (90, 1)
[INFOR]: get pretrained model
2021-09-13 12:01:03.123175: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 12:01:03.147514: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:01:03.151986: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:01:03.160068: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:01:03.162526: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:01:03.167725: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:01:03.171130: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:01:03.177351: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:01:03.182239: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:01:03.185188: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:01:03.187370: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:01:03.189274: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 12:01:03.201661: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x147b34ce9f0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:01:03.204883: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 12:01:03.206887: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:01:03.211295: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:01:03.213461: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:01:03.215586: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:01:03.217702: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:01:03.219900: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:01:03.221999: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:01:03.224217: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:01:03.226333: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:01:03.228510: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:01:03.647280: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 12:01:03.650137: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 12:01:03.651493: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 12:01:03.653007: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 12:01:03.659554: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x147df003870 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:01:03.662371: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 12:01:05.642128: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 12:01:06.341846: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:01:06.997293: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:01:07.002683: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:01:08.353861: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:01:08.401411: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:01:09.117049: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 346ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :12.0


[INFOR]: Index of second most vote     :408
[INFOR]: Class of second most vote     :amphibian, amphibious vehicle
[INFOR]: Number of second most vote    :9.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 38ms/step
[INFOR]: Toltal norm before transform: 0.6959
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1658

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 38ms/step
[INFOR]: SEN training of class 166_45 before transform: 12
[INFOR]: SPE training of class 166_45 before transform: 33

[INFOR]: SEN training of class 166_45 after transform: 36
[INFOR]: SPE training of class 166_45 after transform: 32
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (90, 32, 32, 3)
[INFOR]: shape of y: (90, 1)
3/3 [==============================] - 0s 38ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :13.0


[INFOR]: Index of second most vote     :482
[INFOR]: Class of second most vote     :cassette player
[INFOR]: Number of second most vote    :7.0
[INFOR]: SEN testing of class 166_45 before transform: 13
[INFOR]: SPE testing of class 166_45 before transform: 32

[INFOR]: SEN testing of class 166_45 after transform: 42
[INFOR]: SPE testing of class 166_45 after transform: 1
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name stanford_car --class_name_train 167_45 --class_name_test 167_44
2021-09-13 12:01:13.051692: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  stanford_car
class_name_train =  167_45
class_name_test =  167_44
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (90, 32, 32, 3)
[INFOR]: shape of y: (90, 1)
[INFOR]: get pretrained model
2021-09-13 12:01:15.550839: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 12:01:15.574551: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:01:15.578922: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:01:15.586865: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:01:15.589015: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:01:15.594200: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:01:15.597541: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:01:15.603714: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:01:15.608780: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:01:15.611864: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:01:15.614021: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:01:15.615866: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 12:01:15.627567: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1a1381837d0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:01:15.630531: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 12:01:15.632544: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:01:15.636817: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:01:15.638966: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:01:15.641085: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:01:15.643240: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:01:15.645378: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:01:15.647503: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:01:15.649609: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:01:15.651751: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:01:15.653914: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:01:16.078789: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 12:01:16.081737: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 12:01:16.083092: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 12:01:16.084566: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 12:01:16.091415: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1a1669e0360 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:01:16.094183: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 12:01:18.060159: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 12:01:18.750541: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:01:19.405198: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:01:19.410565: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:01:20.750151: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:01:20.800357: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:01:21.516306: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 348ms/step
[INFOR]: Index of most vote   :408
[INFOR]: Class of most vote   :amphibian, amphibious vehicle
[INFOR]: Number of most vote  :15.0


[INFOR]: Index of second most vote     :510
[INFOR]: Class of second most vote     :container ship, containership, container vessel
[INFOR]: Number of second most vote    :8.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 37ms/step
[INFOR]: Toltal norm before transform: 0.6809
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0315

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 37ms/step
[INFOR]: SEN training of class 167_45 before transform: 15
[INFOR]: SPE training of class 167_45 before transform: 36

[INFOR]: SEN training of class 167_45 after transform: 42
[INFOR]: SPE training of class 167_45 after transform: 36
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (88, 32, 32, 3)
[INFOR]: shape of y: (88, 1)
3/3 [==============================] - 0s 37ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :11.0


[INFOR]: Index of second most vote     :408
[INFOR]: Class of second most vote     :amphibian, amphibious vehicle
[INFOR]: Number of second most vote    :10.0
[INFOR]: SEN testing of class 167_44 before transform: 11
[INFOR]: SPE testing of class 167_44 before transform: 26

[INFOR]: SEN testing of class 167_44 after transform: 44
[INFOR]: SPE testing of class 167_44 after transform: 0
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name stanford_car --class_name_train 168_44 --class_name_test 168_43
2021-09-13 12:01:26.028452: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  stanford_car
class_name_train =  168_44
class_name_test =  168_43
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (88, 32, 32, 3)
[INFOR]: shape of y: (88, 1)
[INFOR]: get pretrained model
2021-09-13 12:01:28.586806: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 12:01:28.610378: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:01:28.615260: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:01:28.623681: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:01:28.626209: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:01:28.631856: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:01:28.635664: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:01:28.642507: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:01:28.648218: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:01:28.651761: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:01:28.654114: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:01:28.656179: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 12:01:28.668701: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x24fb489e170 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:01:28.671782: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 12:01:28.674010: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:01:28.678522: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:01:28.680838: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:01:28.683388: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:01:28.685913: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:01:28.688449: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:01:28.690911: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:01:28.693492: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:01:28.696001: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:01:28.698479: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:01:29.140415: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 12:01:29.143105: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 12:01:29.144712: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 12:01:29.146435: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 12:01:29.153823: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x24fdf9984e0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:01:29.157136: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 12:01:31.143627: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 12:01:31.844781: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:01:32.501502: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:01:32.507040: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:01:33.853500: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:01:33.903020: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:01:34.620183: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 331ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :22.0


[INFOR]: Index of second most vote     :408
[INFOR]: Class of second most vote     :amphibian, amphibious vehicle
[INFOR]: Number of second most vote    :13.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 37ms/step
[INFOR]: Toltal norm before transform: 0.4346
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0512

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 37ms/step
[INFOR]: SEN training of class 168_44 before transform: 22
[INFOR]: SPE training of class 168_44 before transform: 31

[INFOR]: SEN training of class 168_44 after transform: 31
[INFOR]: SPE training of class 168_44 after transform: 26
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (86, 32, 32, 3)
[INFOR]: shape of y: (86, 1)
3/3 [==============================] - 0s 37ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :19.0


[INFOR]: Index of second most vote     :408
[INFOR]: Class of second most vote     :amphibian, amphibious vehicle
[INFOR]: Number of second most vote    :17.0
[INFOR]: SEN testing of class 168_43 before transform: 19
[INFOR]: SPE testing of class 168_43 before transform: 29

[INFOR]: SEN testing of class 168_43 after transform: 38
[INFOR]: SPE testing of class 168_43 after transform: 5
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name stanford_car --class_name_train 169_44 --class_name_test 169_44
2021-09-13 12:01:39.114410: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  stanford_car
class_name_train =  169_44
class_name_test =  169_44
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (88, 32, 32, 3)
[INFOR]: shape of y: (88, 1)
[INFOR]: get pretrained model
2021-09-13 12:01:41.653895: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 12:01:41.678726: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:01:41.683243: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:01:41.691079: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:01:41.693237: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:01:41.698397: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:01:41.701657: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:01:41.707882: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:01:41.712745: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:01:41.715599: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:01:41.717671: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:01:41.719545: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 12:01:41.731982: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1e1383866a0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:01:41.735268: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 12:01:41.737339: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:01:41.741562: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:01:41.743655: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:01:41.745694: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:01:41.747767: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:01:41.749851: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:01:41.751934: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:01:41.754049: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:01:41.756189: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:01:41.758226: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:01:42.184414: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 12:01:42.187315: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 12:01:42.188640: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 12:01:42.190079: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 12:01:42.196762: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1e16347fbb0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:01:42.199579: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 12:01:44.173744: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 12:01:44.861172: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:01:45.518688: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:01:45.525630: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:01:46.872593: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:01:46.921773: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:01:47.676626: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 330ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :17.0


[INFOR]: Index of second most vote     :408
[INFOR]: Class of second most vote     :amphibian, amphibious vehicle
[INFOR]: Number of second most vote    :11.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 37ms/step
[INFOR]: Toltal norm before transform: 0.5280
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0457

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 38ms/step
[INFOR]: SEN training of class 169_44 before transform: 17
[INFOR]: SPE training of class 169_44 before transform: 29

[INFOR]: SEN training of class 169_44 after transform: 41
[INFOR]: SPE training of class 169_44 after transform: 29
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (88, 32, 32, 3)
[INFOR]: shape of y: (88, 1)
3/3 [==============================] - 0s 37ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :15.0


[INFOR]: Index of second most vote     :408
[INFOR]: Class of second most vote     :amphibian, amphibious vehicle
[INFOR]: Number of second most vote    :12.0
[INFOR]: SEN testing of class 169_44 before transform: 15
[INFOR]: SPE testing of class 169_44 before transform: 27

[INFOR]: SEN testing of class 169_44 after transform: 37
[INFOR]: SPE testing of class 169_44 after transform: 1
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name stanford_car --class_name_train 170_44 --class_name_test 170_43
2021-09-13 12:01:51.555664: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  stanford_car
class_name_train =  170_44
class_name_test =  170_43
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (88, 32, 32, 3)
[INFOR]: shape of y: (88, 1)
[INFOR]: get pretrained model
2021-09-13 12:01:54.070176: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 12:01:54.094007: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:01:54.098617: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:01:54.106662: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:01:54.108766: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:01:54.113761: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:01:54.117049: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:01:54.123231: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:01:54.128039: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:01:54.130991: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:01:54.133098: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:01:54.134910: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 12:01:54.147236: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x203376758b0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:01:54.150413: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 12:01:54.152397: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:01:54.156585: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:01:54.158724: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:01:54.160824: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:01:54.163029: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:01:54.165086: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:01:54.167359: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:01:54.169878: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:01:54.172036: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:01:54.174184: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:01:54.587142: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 12:01:54.589835: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 12:01:54.591175: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 12:01:54.592634: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 12:01:54.599142: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x2036254e140 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:01:54.602010: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 12:01:56.564384: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 12:01:57.250461: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:01:57.895191: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:01:57.900754: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:01:59.267221: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:01:59.317133: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:02:00.105380: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 332ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :24.0


[INFOR]: Index of second most vote     :408
[INFOR]: Class of second most vote     :amphibian, amphibious vehicle
[INFOR]: Number of second most vote    :9.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 37ms/step
[INFOR]: Toltal norm before transform: 0.4231
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1341

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 38ms/step
[INFOR]: SEN training of class 170_44 before transform: 24
[INFOR]: SPE training of class 170_44 before transform: 27

[INFOR]: SEN training of class 170_44 after transform: 35
[INFOR]: SPE training of class 170_44 after transform: 27
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (86, 32, 32, 3)
[INFOR]: shape of y: (86, 1)
3/3 [==============================] - 0s 37ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :23.0


[INFOR]: Index of second most vote     :408
[INFOR]: Class of second most vote     :amphibian, amphibious vehicle
[INFOR]: Number of second most vote    :8.0
[INFOR]: SEN testing of class 170_43 before transform: 23
[INFOR]: SPE testing of class 170_43 before transform: 28

[INFOR]: SEN testing of class 170_43 after transform: 42
[INFOR]: SPE testing of class 170_43 after transform: 4
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name stanford_car --class_name_train 171_41 --class_name_test 171_40
2021-09-13 12:02:04.586692: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  stanford_car
class_name_train =  171_41
class_name_test =  171_40
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (82, 32, 32, 3)
[INFOR]: shape of y: (82, 1)
[INFOR]: get pretrained model
2021-09-13 12:02:07.141188: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 12:02:07.165636: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:02:07.170408: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:02:07.178286: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:02:07.180374: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:02:07.185530: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:02:07.188781: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:02:07.195023: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:02:07.199859: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:02:07.202800: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:02:07.204947: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:02:07.206775: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 12:02:07.218682: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x211b34fb110 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:02:07.222271: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 12:02:07.224258: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:02:07.228489: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:02:07.230583: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:02:07.232662: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:02:07.234828: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:02:07.237197: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:02:07.239276: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:02:07.241456: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:02:07.243567: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:02:07.245670: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:02:07.666622: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 12:02:07.669311: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 12:02:07.670660: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 12:02:07.672136: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 12:02:07.678775: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x211dc7f4800 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:02:07.681554: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 12:02:09.700005: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 12:02:10.401000: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:02:11.067276: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:02:11.073844: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:02:12.419648: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:02:12.467694: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:02:13.182104: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 315ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :20.0


[INFOR]: Index of second most vote     :408
[INFOR]: Class of second most vote     :amphibian, amphibious vehicle
[INFOR]: Number of second most vote    :9.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 35ms/step
[INFOR]: Toltal norm before transform: 0.5070
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0229

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 35ms/step
[INFOR]: SEN training of class 171_41 before transform: 20
[INFOR]: SPE training of class 171_41 before transform: 30

[INFOR]: SEN training of class 171_41 after transform: 30
[INFOR]: SPE training of class 171_41 after transform: 27
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (80, 32, 32, 3)
[INFOR]: shape of y: (80, 1)
3/3 [==============================] - 0s 35ms/step
[INFOR]: Index of most vote   :408
[INFOR]: Class of most vote   :amphibian, amphibious vehicle
[INFOR]: Number of most vote  :12.0


[INFOR]: Index of second most vote     :674
[INFOR]: Class of second most vote     :mousetrap
[INFOR]: Number of second most vote    :9.0
[INFOR]: SEN testing of class 171_40 before transform: 12
[INFOR]: SPE testing of class 171_40 before transform: 33

[INFOR]: SEN testing of class 171_40 after transform: 35
[INFOR]: SPE testing of class 171_40 after transform: 0
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name stanford_car --class_name_train 172_38 --class_name_test 172_37
2021-09-13 12:02:17.545202: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  stanford_car
class_name_train =  172_38
class_name_test =  172_37
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (76, 32, 32, 3)
[INFOR]: shape of y: (76, 1)
[INFOR]: get pretrained model
2021-09-13 12:02:20.058057: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 12:02:20.081880: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:02:20.086481: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:02:20.094422: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:02:20.096642: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:02:20.101622: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:02:20.104976: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:02:20.111345: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:02:20.116233: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:02:20.119184: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:02:20.121374: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:02:20.123248: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 12:02:20.135583: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x255394e7410 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:02:20.138841: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 12:02:20.140823: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:02:20.145171: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:02:20.147284: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:02:20.149406: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:02:20.151490: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:02:20.153613: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:02:20.155826: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:02:20.157938: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:02:20.160097: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:02:20.162139: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:02:20.580767: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 12:02:20.583937: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 12:02:20.585294: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 12:02:20.586767: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 12:02:20.593387: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x255647c1dd0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:02:20.596227: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 12:02:22.545595: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 12:02:23.230209: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:02:23.903299: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:02:23.910231: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:02:25.256682: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:02:25.304637: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:02:26.023339: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 298ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :14.0


[INFOR]: Index of second most vote     :511
[INFOR]: Class of second most vote     :convertible
[INFOR]: Number of second most vote    :6.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 34ms/step
[INFOR]: Toltal norm before transform: 0.6147
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1045

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 34ms/step
[INFOR]: SEN training of class 172_38 before transform: 14
[INFOR]: SPE training of class 172_38 before transform: 24

[INFOR]: SEN training of class 172_38 after transform: 28
[INFOR]: SPE training of class 172_38 after transform: 24
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (74, 32, 32, 3)
[INFOR]: shape of y: (74, 1)
3/3 [==============================] - 0s 32ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :21.0


[INFOR]: Index of second most vote     :408
[INFOR]: Class of second most vote     :amphibian, amphibious vehicle
[INFOR]: Number of second most vote    :6.0
[INFOR]: SEN testing of class 172_37 before transform: 21
[INFOR]: SPE testing of class 172_37 before transform: 28

[INFOR]: SEN testing of class 172_37 after transform: 34
[INFOR]: SPE testing of class 172_37 after transform: 3
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name stanford_car --class_name_train 173_49 --class_name_test 173_48
2021-09-13 12:02:30.309472: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  stanford_car
class_name_train =  173_49
class_name_test =  173_48
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (98, 32, 32, 3)
[INFOR]: shape of y: (98, 1)
[INFOR]: get pretrained model
2021-09-13 12:02:32.856747: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 12:02:32.882299: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:02:32.886508: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:02:32.894417: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:02:32.896639: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:02:32.901667: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:02:32.905044: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:02:32.911146: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:02:32.916107: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:02:32.919141: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:02:32.921309: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:02:32.923149: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 12:02:32.935637: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x295b5b32e20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:02:32.939389: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 12:02:32.941469: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:02:32.945633: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:02:32.947791: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:02:32.949865: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:02:32.952010: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:02:32.954254: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:02:32.956456: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:02:32.958552: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:02:32.960648: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:02:32.962752: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:02:33.387163: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 12:02:33.389804: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 12:02:33.391130: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 12:02:33.392616: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 12:02:33.399122: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x295df883e30 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:02:33.401982: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 12:02:35.364420: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 12:02:36.062469: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:02:36.713975: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:02:36.719813: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:02:38.065399: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:02:38.113878: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:02:38.832210: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
4/4 [==============================] - 4s 181ms/step
[INFOR]: Index of most vote   :408
[INFOR]: Class of most vote   :amphibian, amphibious vehicle
[INFOR]: Number of most vote  :11.0


[INFOR]: Index of second most vote     :674
[INFOR]: Class of second most vote     :mousetrap
[INFOR]: Number of second most vote    :9.0

[INFOR]: Create PDF for Positive Label

4/4 [==============================] - 1s 32ms/step
[INFOR]: Toltal norm before transform: 0.7416
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1084

[INFOR]: Create PDF for Negative Label

4/4 [==============================] - 0s 31ms/step
[INFOR]: SEN training of class 173_49 before transform: 11
[INFOR]: SPE training of class 173_49 before transform: 37

[INFOR]: SEN training of class 173_49 after transform: 43
[INFOR]: SPE training of class 173_49 after transform: 35
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (96, 32, 32, 3)
[INFOR]: shape of y: (96, 1)
3/3 [==============================] - 1s 41ms/step
[INFOR]: Index of most vote   :408
[INFOR]: Class of most vote   :amphibian, amphibious vehicle
[INFOR]: Number of most vote  :15.0


[INFOR]: Index of second most vote     :674
[INFOR]: Class of second most vote     :mousetrap
[INFOR]: Number of second most vote    :13.0
[INFOR]: SEN testing of class 173_48 before transform: 15
[INFOR]: SPE testing of class 173_48 before transform: 38

[INFOR]: SEN testing of class 173_48 after transform: 43
[INFOR]: SPE testing of class 173_48 after transform: 4
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name stanford_car --class_name_train 174_45 --class_name_test 174_45
2021-09-13 12:02:44.092776: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  stanford_car
class_name_train =  174_45
class_name_test =  174_45
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (90, 32, 32, 3)
[INFOR]: shape of y: (90, 1)
[INFOR]: get pretrained model
2021-09-13 12:02:46.580932: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 12:02:46.624644: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:02:46.629615: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:02:46.637611: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:02:46.639743: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:02:46.644855: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:02:46.648260: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:02:46.654499: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:02:46.659329: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:02:46.662298: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:02:46.664468: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:02:46.666465: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 12:02:46.679210: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1f936632170 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:02:46.682515: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 12:02:46.684490: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:02:46.688774: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:02:46.690900: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:02:46.692964: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:02:46.695075: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:02:46.697257: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:02:46.699447: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:02:46.701518: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:02:46.703663: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:02:46.705813: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:02:47.151886: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 12:02:47.154670: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 12:02:47.156117: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 12:02:47.157595: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 12:02:47.164142: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1f9651afde0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:02:47.166915: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 12:02:49.141804: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 12:02:49.847838: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:02:50.504334: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:02:50.510058: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:02:51.857297: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:02:51.906878: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:02:52.624112: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 344ms/step
[INFOR]: Index of most vote   :408
[INFOR]: Class of most vote   :amphibian, amphibious vehicle
[INFOR]: Number of most vote  :14.0


[INFOR]: Index of second most vote     :510
[INFOR]: Class of second most vote     :container ship, containership, container vessel
[INFOR]: Number of second most vote    :4.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 38ms/step
[INFOR]: Toltal norm before transform: 0.6314
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1242

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 37ms/step
[INFOR]: SEN training of class 174_45 before transform: 14
[INFOR]: SPE training of class 174_45 before transform: 32

[INFOR]: SEN training of class 174_45 after transform: 34
[INFOR]: SPE training of class 174_45 after transform: 29
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (90, 32, 32, 3)
[INFOR]: shape of y: (90, 1)
3/3 [==============================] - 0s 39ms/step
[INFOR]: Index of most vote   :408
[INFOR]: Class of most vote   :amphibian, amphibious vehicle
[INFOR]: Number of most vote  :9.0


[INFOR]: Index of second most vote     :674
[INFOR]: Class of second most vote     :mousetrap
[INFOR]: Number of second most vote    :7.0
[INFOR]: SEN testing of class 174_45 before transform: 9
[INFOR]: SPE testing of class 174_45 before transform: 36

[INFOR]: SEN testing of class 174_45 after transform: 45
[INFOR]: SPE testing of class 174_45 after transform: 0
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name stanford_car --class_name_train 175_43 --class_name_test 175_43
2021-09-13 12:02:56.519496: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  stanford_car
class_name_train =  175_43
class_name_test =  175_43
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (86, 32, 32, 3)
[INFOR]: shape of y: (86, 1)
[INFOR]: get pretrained model
2021-09-13 12:02:59.017151: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 12:02:59.041838: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:02:59.046607: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:02:59.054464: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:02:59.056606: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:02:59.061781: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:02:59.065113: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:02:59.071224: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:02:59.076068: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:02:59.078978: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:02:59.081068: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:02:59.082911: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 12:02:59.094515: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1b032fbfae0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:02:59.097634: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 12:02:59.099638: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:02:59.103820: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:02:59.106062: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:02:59.108127: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:02:59.110324: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:02:59.112431: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:02:59.114583: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:02:59.116725: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:02:59.118869: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:02:59.121025: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:02:59.546795: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 12:02:59.549539: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 12:02:59.550887: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 12:02:59.552335: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 12:02:59.559632: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1b05d1d1350 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:02:59.562897: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 12:03:01.529570: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 12:03:02.220527: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:03:02.874712: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:03:02.880140: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:03:04.227058: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:03:04.275092: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:03:04.993172: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 330ms/step
[INFOR]: Index of most vote   :408
[INFOR]: Class of most vote   :amphibian, amphibious vehicle
[INFOR]: Number of most vote  :11.0


[INFOR]: Index of second most vote     :674
[INFOR]: Class of second most vote     :mousetrap
[INFOR]: Number of second most vote    :10.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 37ms/step
[INFOR]: Toltal norm before transform: 0.7762
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.3707

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 36ms/step
[INFOR]: SEN training of class 175_43 before transform: 11
[INFOR]: SPE training of class 175_43 before transform: 39

[INFOR]: SEN training of class 175_43 after transform: 29
[INFOR]: SPE training of class 175_43 after transform: 28
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (86, 32, 32, 3)
[INFOR]: shape of y: (86, 1)
3/3 [==============================] - 0s 37ms/step
[INFOR]: Index of most vote   :511
[INFOR]: Class of most vote   :convertible
[INFOR]: Number of most vote  :14.0


[INFOR]: Index of second most vote     :674
[INFOR]: Class of second most vote     :mousetrap
[INFOR]: Number of second most vote    :10.0
[INFOR]: SEN testing of class 175_43 before transform: 14
[INFOR]: SPE testing of class 175_43 before transform: 41

[INFOR]: SEN testing of class 175_43 after transform: 41
[INFOR]: SPE testing of class 175_43 after transform: 2
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name stanford_car --class_name_train 176_45 --class_name_test 176_45
2021-09-13 12:03:08.859199: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  stanford_car
class_name_train =  176_45
class_name_test =  176_45
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (90, 32, 32, 3)
[INFOR]: shape of y: (90, 1)
[INFOR]: get pretrained model
2021-09-13 12:03:11.442316: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 12:03:11.466087: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:03:11.470793: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:03:11.478911: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:03:11.481057: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:03:11.486130: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:03:11.489512: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:03:11.495929: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:03:11.500801: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:03:11.503764: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:03:11.505977: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:03:11.507860: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 12:03:11.520266: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x266bb257d20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:03:11.523861: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 12:03:11.525836: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:03:11.530130: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:03:11.532253: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:03:11.534450: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:03:11.536582: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:03:11.538840: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:03:11.540958: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:03:11.543084: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:03:11.545217: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:03:11.547535: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:03:11.972168: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 12:03:11.975000: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 12:03:11.976378: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 12:03:11.977898: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 12:03:11.984832: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x266e682b6f0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:03:11.987738: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 12:03:14.002732: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 12:03:14.706390: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:03:15.358126: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:03:15.364273: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:03:16.717420: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:03:16.767086: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:03:17.484430: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 349ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :17.0


[INFOR]: Index of second most vote     :408
[INFOR]: Class of second most vote     :amphibian, amphibious vehicle
[INFOR]: Number of second most vote    :12.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 39ms/step
[INFOR]: Toltal norm before transform: 0.5870
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1698

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 39ms/step
[INFOR]: SEN training of class 176_45 before transform: 17
[INFOR]: SPE training of class 176_45 before transform: 31

[INFOR]: SEN training of class 176_45 after transform: 40
[INFOR]: SPE training of class 176_45 after transform: 31
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (90, 32, 32, 3)
[INFOR]: shape of y: (90, 1)
3/3 [==============================] - 0s 38ms/step
[INFOR]: Index of most vote   :408
[INFOR]: Class of most vote   :amphibian, amphibious vehicle
[INFOR]: Number of most vote  :16.0


[INFOR]: Index of second most vote     :674
[INFOR]: Class of second most vote     :mousetrap
[INFOR]: Number of second most vote    :10.0
[INFOR]: SEN testing of class 176_45 before transform: 16
[INFOR]: SPE testing of class 176_45 before transform: 35

[INFOR]: SEN testing of class 176_45 after transform: 45
[INFOR]: SPE testing of class 176_45 after transform: 0
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name stanford_car --class_name_train 177_45 --class_name_test 177_45
2021-09-13 12:03:21.417119: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  stanford_car
class_name_train =  177_45
class_name_test =  177_45
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (90, 32, 32, 3)
[INFOR]: shape of y: (90, 1)
[INFOR]: get pretrained model
2021-09-13 12:03:23.945104: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 12:03:23.971830: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:03:23.976673: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:03:23.984739: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:03:23.987004: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:03:23.992191: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:03:23.995619: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:03:24.001954: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:03:24.006968: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:03:24.009991: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:03:24.012228: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:03:24.014235: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 12:03:24.027281: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x233383de5e0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:03:24.030493: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 12:03:24.032655: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:03:24.037168: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:03:24.039412: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:03:24.042129: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:03:24.044467: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:03:24.046771: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:03:24.049080: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:03:24.051519: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:03:24.053831: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:03:24.055948: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:03:24.479604: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 12:03:24.482379: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 12:03:24.483784: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 12:03:24.485224: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 12:03:24.491980: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x23366511fc0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:03:24.494985: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 12:03:26.466094: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 12:03:27.155865: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:03:27.807938: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:03:27.814457: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:03:29.152013: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:03:29.201292: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:03:29.918899: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 346ms/step
[INFOR]: Index of most vote   :408
[INFOR]: Class of most vote   :amphibian, amphibious vehicle
[INFOR]: Number of most vote  :19.0


[INFOR]: Index of second most vote     :674
[INFOR]: Class of second most vote     :mousetrap
[INFOR]: Number of second most vote    :10.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 37ms/step
[INFOR]: Toltal norm before transform: 0.5513
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0337

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 38ms/step
[INFOR]: SEN training of class 177_45 before transform: 19
[INFOR]: SPE training of class 177_45 before transform: 33

[INFOR]: SEN training of class 177_45 after transform: 42
[INFOR]: SPE training of class 177_45 after transform: 33
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (90, 32, 32, 3)
[INFOR]: shape of y: (90, 1)
3/3 [==============================] - 0s 38ms/step
[INFOR]: Index of most vote   :408
[INFOR]: Class of most vote   :amphibian, amphibious vehicle
[INFOR]: Number of most vote  :24.0


[INFOR]: Index of second most vote     :674
[INFOR]: Class of second most vote     :mousetrap
[INFOR]: Number of second most vote    :8.0
[INFOR]: SEN testing of class 177_45 before transform: 24
[INFOR]: SPE testing of class 177_45 before transform: 36

[INFOR]: SEN testing of class 177_45 after transform: 43
[INFOR]: SPE testing of class 177_45 after transform: 7
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name stanford_car --class_name_train 178_41 --class_name_test 178_40
2021-09-13 12:03:33.861286: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  stanford_car
class_name_train =  178_41
class_name_test =  178_40
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (82, 32, 32, 3)
[INFOR]: shape of y: (82, 1)
[INFOR]: get pretrained model
2021-09-13 12:03:36.406049: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 12:03:36.429345: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:03:36.433484: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:03:36.441638: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:03:36.443722: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:03:36.448732: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:03:36.452023: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:03:36.458073: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:03:36.462890: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:03:36.465864: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:03:36.468033: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:03:36.469881: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 12:03:36.482405: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1efb35958e0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:03:36.486230: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 12:03:36.488352: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:03:36.492632: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:03:36.494848: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:03:36.497012: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:03:36.499197: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:03:36.501320: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:03:36.503466: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:03:36.505598: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:03:36.507689: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:03:36.509795: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:03:36.930511: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 12:03:36.933185: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 12:03:36.934605: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 12:03:36.936146: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 12:03:36.942929: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1efe38083f0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:03:36.945966: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 12:03:38.922982: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 12:03:39.621977: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:03:40.261962: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:03:40.268754: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:03:41.623539: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:03:41.672261: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:03:42.394321: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 314ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :16.0


[INFOR]: Index of second most vote     :408
[INFOR]: Class of second most vote     :amphibian, amphibious vehicle
[INFOR]: Number of second most vote    :9.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 36ms/step
[INFOR]: Toltal norm before transform: 0.5812
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1194

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 35ms/step
[INFOR]: SEN training of class 178_41 before transform: 16
[INFOR]: SPE training of class 178_41 before transform: 28

[INFOR]: SEN training of class 178_41 after transform: 34
[INFOR]: SPE training of class 178_41 after transform: 27
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (80, 32, 32, 3)
[INFOR]: shape of y: (80, 1)
3/3 [==============================] - 0s 34ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :20.0


[INFOR]: Index of second most vote     :408
[INFOR]: Class of second most vote     :amphibian, amphibious vehicle
[INFOR]: Number of second most vote    :9.0
[INFOR]: SEN testing of class 178_40 before transform: 20
[INFOR]: SPE testing of class 178_40 before transform: 29

[INFOR]: SEN testing of class 178_40 after transform: 37
[INFOR]: SPE testing of class 178_40 after transform: 3
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name stanford_car --class_name_train 179_42 --class_name_test 179_42
2021-09-13 12:03:46.758615: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  stanford_car
class_name_train =  179_42
class_name_test =  179_42
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (84, 32, 32, 3)
[INFOR]: shape of y: (84, 1)
[INFOR]: get pretrained model
2021-09-13 12:03:49.255599: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 12:03:49.281138: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:03:49.285269: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:03:49.292936: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:03:49.295188: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:03:49.300380: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:03:49.303683: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:03:49.309686: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:03:49.314589: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:03:49.317453: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:03:49.319622: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:03:49.321444: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 12:03:49.333956: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1f2b58db9a0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:03:49.337473: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 12:03:49.339493: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:03:49.343831: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:03:49.345986: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:03:49.348936: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:03:49.351110: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:03:49.353433: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:03:49.355696: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:03:49.358022: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:03:49.360200: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:03:49.362452: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:03:49.785482: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 12:03:49.788437: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 12:03:49.789758: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 12:03:49.791196: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 12:03:49.797961: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1f2e3cc9e10 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:03:49.800759: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 12:03:51.767140: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 12:03:52.461362: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:03:53.118337: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:03:53.124802: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:03:54.474729: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:03:54.522915: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:03:55.240505: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 322ms/step
[INFOR]: Index of most vote   :408
[INFOR]: Class of most vote   :amphibian, amphibious vehicle
[INFOR]: Number of most vote  :15.0


[INFOR]: Index of second most vote     :674
[INFOR]: Class of second most vote     :mousetrap
[INFOR]: Number of second most vote    :8.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 36ms/step
[INFOR]: Toltal norm before transform: 0.6306
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0490

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 36ms/step
[INFOR]: SEN training of class 179_42 before transform: 15
[INFOR]: SPE training of class 179_42 before transform: 29

[INFOR]: SEN training of class 179_42 after transform: 42
[INFOR]: SPE training of class 179_42 after transform: 29
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (84, 32, 32, 3)
[INFOR]: shape of y: (84, 1)
3/3 [==============================] - 0s 36ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :16.0


[INFOR]: Index of second most vote     :408
[INFOR]: Class of second most vote     :amphibian, amphibious vehicle
[INFOR]: Number of second most vote    :14.0
[INFOR]: SEN testing of class 179_42 before transform: 16
[INFOR]: SPE testing of class 179_42 before transform: 28

[INFOR]: SEN testing of class 179_42 after transform: 41
[INFOR]: SPE testing of class 179_42 after transform: 2
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name stanford_car --class_name_train 180_44 --class_name_test 180_43
2021-09-13 12:03:59.061012: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  stanford_car
class_name_train =  180_44
class_name_test =  180_43
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (88, 32, 32, 3)
[INFOR]: shape of y: (88, 1)
[INFOR]: get pretrained model
2021-09-13 12:04:01.528065: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 12:04:01.551764: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:04:01.556515: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:04:01.564719: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:04:01.567001: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:04:01.572150: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:04:01.575580: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:04:01.582154: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:04:01.587795: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:04:01.590824: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:04:01.593066: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:04:01.594984: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 12:04:01.606819: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x14134029e70 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:04:01.609937: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 12:04:01.612038: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:04:01.616350: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:04:01.618522: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:04:01.620783: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:04:01.622996: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:04:01.625244: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:04:01.627616: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:04:01.629806: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:04:01.632065: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:04:01.634215: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:04:02.053167: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 12:04:02.056151: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 12:04:02.057502: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 12:04:02.058963: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 12:04:02.065561: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x14161e1e170 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:04:02.068368: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 12:04:04.038582: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 12:04:04.723861: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:04:05.374695: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:04:05.380330: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:04:06.725237: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:04:06.781976: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:04:07.498991: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 331ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :19.0


[INFOR]: Index of second most vote     :408
[INFOR]: Class of second most vote     :amphibian, amphibious vehicle
[INFOR]: Number of second most vote    :10.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 37ms/step
[INFOR]: Toltal norm before transform: 0.4586
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0788

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 36ms/step
[INFOR]: SEN training of class 180_44 before transform: 19
[INFOR]: SPE training of class 180_44 before transform: 27

[INFOR]: SEN training of class 180_44 after transform: 30
[INFOR]: SPE training of class 180_44 after transform: 26
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (86, 32, 32, 3)
[INFOR]: shape of y: (86, 1)
3/3 [==============================] - 0s 34ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :22.0


[INFOR]: Index of second most vote     :408
[INFOR]: Class of second most vote     :amphibian, amphibious vehicle
[INFOR]: Number of second most vote    :10.0
[INFOR]: SEN testing of class 180_43 before transform: 22
[INFOR]: SPE testing of class 180_43 before transform: 29

[INFOR]: SEN testing of class 180_43 after transform: 35
[INFOR]: SPE testing of class 180_43 after transform: 1
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name stanford_car --class_name_train 181_43 --class_name_test 181_42
2021-09-13 12:04:11.999312: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  stanford_car
class_name_train =  181_43
class_name_test =  181_42
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (86, 32, 32, 3)
[INFOR]: shape of y: (86, 1)
[INFOR]: get pretrained model
2021-09-13 12:04:14.553442: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 12:04:14.576891: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:04:14.581477: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:04:14.589376: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:04:14.591446: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:04:14.596529: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:04:14.599887: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:04:14.605981: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:04:14.610834: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:04:14.613682: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:04:14.615747: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:04:14.617619: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 12:04:14.629854: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x27733b34b70 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:04:14.633458: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 12:04:14.635459: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:04:14.639721: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:04:14.641896: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:04:14.643960: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:04:14.646122: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:04:14.648254: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:04:14.650394: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:04:14.652548: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:04:14.654636: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:04:14.656682: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:04:15.077934: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 12:04:15.080327: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 12:04:15.081808: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 12:04:15.083387: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 12:04:15.090123: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x27761f5c070 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:04:15.093043: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 12:04:17.082582: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 12:04:17.786467: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:04:18.439306: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:04:18.445276: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:04:19.801236: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:04:19.850259: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:04:20.571023: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 335ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :12.0


[INFOR]: Index of second most vote     :408
[INFOR]: Class of second most vote     :amphibian, amphibious vehicle
[INFOR]: Number of second most vote    :8.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 35ms/step
[INFOR]: Toltal norm before transform: 0.7252
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0605

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 36ms/step
[INFOR]: SEN training of class 181_43 before transform: 12
[INFOR]: SPE training of class 181_43 before transform: 34

[INFOR]: SEN training of class 181_43 after transform: 37
[INFOR]: SPE training of class 181_43 after transform: 34
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (84, 32, 32, 3)
[INFOR]: shape of y: (84, 1)
3/3 [==============================] - 0s 37ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :17.0


[INFOR]: Index of second most vote     :408
[INFOR]: Class of second most vote     :amphibian, amphibious vehicle
[INFOR]: Number of second most vote    :13.0
[INFOR]: SEN testing of class 181_42 before transform: 17
[INFOR]: SPE testing of class 181_42 before transform: 26

[INFOR]: SEN testing of class 181_42 after transform: 41
[INFOR]: SPE testing of class 181_42 after transform: 0
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name stanford_car --class_name_train 182_44 --class_name_test 182_44
2021-09-13 12:04:25.036864: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  stanford_car
class_name_train =  182_44
class_name_test =  182_44
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (88, 32, 32, 3)
[INFOR]: shape of y: (88, 1)
[INFOR]: get pretrained model
2021-09-13 12:04:27.553347: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 12:04:27.577487: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:04:27.582604: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:04:27.590634: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:04:27.592854: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:04:27.598129: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:04:27.601563: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:04:27.607920: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:04:27.614322: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:04:27.617449: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:04:27.619654: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:04:27.621533: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 12:04:27.633727: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1c0b5fad960 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:04:27.636954: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 12:04:27.638975: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:04:27.643353: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:04:27.645496: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:04:27.647585: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:04:27.649783: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:04:27.651946: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:04:27.654036: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:04:27.656509: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:04:27.658762: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:04:27.660847: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:04:28.084295: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 12:04:28.087132: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 12:04:28.088542: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 12:04:28.090041: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 12:04:28.096804: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1c0e104a780 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:04:28.099663: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 12:04:30.060624: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 12:04:30.747070: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:04:31.403687: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:04:31.410464: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:04:32.772207: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:04:32.819841: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:04:33.541704: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 331ms/step
[INFOR]: Index of most vote   :408
[INFOR]: Class of most vote   :amphibian, amphibious vehicle
[INFOR]: Number of most vote  :15.0


[INFOR]: Index of second most vote     :674
[INFOR]: Class of second most vote     :mousetrap
[INFOR]: Number of second most vote    :13.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 38ms/step
[INFOR]: Toltal norm before transform: 0.5504
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0588

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 37ms/step
[INFOR]: SEN training of class 182_44 before transform: 15
[INFOR]: SPE training of class 182_44 before transform: 38

[INFOR]: SEN training of class 182_44 after transform: 41
[INFOR]: SPE training of class 182_44 after transform: 38
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (88, 32, 32, 3)
[INFOR]: shape of y: (88, 1)
3/3 [==============================] - 0s 38ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :19.0


[INFOR]: Index of second most vote     :408
[INFOR]: Class of second most vote     :amphibian, amphibious vehicle
[INFOR]: Number of second most vote    :9.0
[INFOR]: SEN testing of class 182_44 before transform: 19
[INFOR]: SPE testing of class 182_44 before transform: 34

[INFOR]: SEN testing of class 182_44 after transform: 40
[INFOR]: SPE testing of class 182_44 after transform: 0
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name stanford_car --class_name_train 183_40 --class_name_test 183_39
2021-09-13 12:04:37.426781: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  stanford_car
class_name_train =  183_40
class_name_test =  183_39
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (80, 32, 32, 3)
[INFOR]: shape of y: (80, 1)
[INFOR]: get pretrained model
2021-09-13 12:04:39.937944: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 12:04:39.965114: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:04:39.969893: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:04:39.977922: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:04:39.979975: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:04:39.984945: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:04:39.988191: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:04:39.994484: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:04:39.999311: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:04:40.002225: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:04:40.004317: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:04:40.006444: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 12:04:40.018607: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x2b0b44bbd80 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:04:40.022348: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 12:04:40.024347: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:04:40.028726: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:04:40.030806: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:04:40.032868: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:04:40.034970: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:04:40.037151: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:04:40.039272: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:04:40.041336: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:04:40.043432: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:04:40.045616: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:04:40.472104: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 12:04:40.474975: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 12:04:40.476284: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 12:04:40.477745: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 12:04:40.484212: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x2b0e3265fd0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:04:40.487090: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 12:04:42.465185: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 12:04:43.157295: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:04:43.810092: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:04:43.816156: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:04:45.158159: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:04:45.208763: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:04:45.926352: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 300ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :33.0


[INFOR]: Index of second most vote     :408
[INFOR]: Class of second most vote     :amphibian, amphibious vehicle
[INFOR]: Number of second most vote    :3.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 33ms/step
[INFOR]: Toltal norm before transform: 0.1032
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0140

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 35ms/step
[INFOR]: SEN training of class 183_40 before transform: 33
[INFOR]: SPE training of class 183_40 before transform: 28

[INFOR]: SEN training of class 183_40 after transform: 39
[INFOR]: SPE training of class 183_40 after transform: 28
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (78, 32, 32, 3)
[INFOR]: shape of y: (78, 1)
3/3 [==============================] - 0s 34ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :26.0


[INFOR]: Index of second most vote     :408
[INFOR]: Class of second most vote     :amphibian, amphibious vehicle
[INFOR]: Number of second most vote    :3.0
[INFOR]: SEN testing of class 183_39 before transform: 26
[INFOR]: SPE testing of class 183_39 before transform: 25

[INFOR]: SEN testing of class 183_39 after transform: 38
[INFOR]: SPE testing of class 183_39 after transform: 2
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name stanford_car --class_name_train 184_44 --class_name_test 184_44
2021-09-13 12:04:50.274420: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  stanford_car
class_name_train =  184_44
class_name_test =  184_44
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (88, 32, 32, 3)
[INFOR]: shape of y: (88, 1)
[INFOR]: get pretrained model
2021-09-13 12:04:52.854579: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 12:04:52.880235: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:04:52.884454: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:04:52.892309: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:04:52.894403: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:04:52.899534: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:04:52.902790: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:04:52.908893: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:04:52.913867: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:04:52.916750: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:04:52.918858: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:04:52.920698: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 12:04:52.932979: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x26939485760 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:04:52.936412: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 12:04:52.938531: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:04:52.942718: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:04:52.944889: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:04:52.947000: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:04:52.949178: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:04:52.951291: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:04:52.953430: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:04:52.955528: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:04:52.957692: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:04:52.959756: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:04:53.391332: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 12:04:53.394071: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 12:04:53.395475: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 12:04:53.396963: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 12:04:53.403699: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x26962762fd0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:04:53.406493: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 12:04:55.389712: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 12:04:56.094397: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:04:56.757847: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:04:56.763688: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:04:58.108674: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:04:58.157692: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:04:58.880469: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 332ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :18.0


[INFOR]: Index of second most vote     :408
[INFOR]: Class of second most vote     :amphibian, amphibious vehicle
[INFOR]: Number of second most vote    :11.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 37ms/step
[INFOR]: Toltal norm before transform: 0.5135
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0266

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 36ms/step
[INFOR]: SEN training of class 184_44 before transform: 18
[INFOR]: SPE training of class 184_44 before transform: 32

[INFOR]: SEN training of class 184_44 after transform: 40
[INFOR]: SPE training of class 184_44 after transform: 31
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (88, 32, 32, 3)
[INFOR]: shape of y: (88, 1)
3/3 [==============================] - 0s 38ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :20.0


[INFOR]: Index of second most vote     :408
[INFOR]: Class of second most vote     :amphibian, amphibious vehicle
[INFOR]: Number of second most vote    :8.0
[INFOR]: SEN testing of class 184_44 before transform: 20
[INFOR]: SPE testing of class 184_44 before transform: 30

[INFOR]: SEN testing of class 184_44 after transform: 36
[INFOR]: SPE testing of class 184_44 after transform: 4
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name stanford_car --class_name_train 185_41 --class_name_test 185_41
2021-09-13 12:05:02.769486: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  stanford_car
class_name_train =  185_41
class_name_test =  185_41
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (82, 32, 32, 3)
[INFOR]: shape of y: (82, 1)
[INFOR]: get pretrained model
2021-09-13 12:05:05.241000: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 12:05:05.266464: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:05:05.270944: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:05:05.278774: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:05:05.280959: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:05:05.285880: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:05:05.289088: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:05:05.295197: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:05:05.299995: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:05:05.302859: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:05:05.305078: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:05:05.306883: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 12:05:05.318989: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1a6349e6810 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:05:05.322525: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 12:05:05.324537: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:05:05.328645: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:05:05.330835: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:05:05.332912: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:05:05.335050: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:05:05.337161: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:05:05.339213: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:05:05.341269: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:05:05.343324: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:05:05.345408: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:05:05.767650: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 12:05:05.770412: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 12:05:05.771745: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 12:05:05.773207: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 12:05:05.780056: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1a65e8a0960 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:05:05.782797: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 12:05:07.750493: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 12:05:08.443672: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:05:09.094030: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:05:09.099338: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:05:10.437917: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:05:10.489765: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:05:11.207324: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 315ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :7.0


[INFOR]: Index of second most vote     :408
[INFOR]: Class of second most vote     :amphibian, amphibious vehicle
[INFOR]: Number of second most vote    :4.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 37ms/step
[INFOR]: Toltal norm before transform: 0.8277
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.2227

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 36ms/step
[INFOR]: SEN training of class 185_41 before transform: 7
[INFOR]: SPE training of class 185_41 before transform: 27

[INFOR]: SEN training of class 185_41 after transform: 38
[INFOR]: SPE training of class 185_41 after transform: 27
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (82, 32, 32, 3)
[INFOR]: shape of y: (82, 1)
3/3 [==============================] - 0s 35ms/step
[INFOR]: Index of most vote   :408
[INFOR]: Class of most vote   :amphibian, amphibious vehicle
[INFOR]: Number of most vote  :6.0


[INFOR]: Index of second most vote     :674
[INFOR]: Class of second most vote     :mousetrap
[INFOR]: Number of second most vote    :6.0
[INFOR]: SEN testing of class 185_41 before transform: 6
[INFOR]: SPE testing of class 185_41 before transform: 30

[INFOR]: SEN testing of class 185_41 after transform: 41
[INFOR]: SPE testing of class 185_41 after transform: 3
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name stanford_car --class_name_train 186_41 --class_name_test 186_41
2021-09-13 12:05:15.041030: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  stanford_car
class_name_train =  186_41
class_name_test =  186_41
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (82, 32, 32, 3)
[INFOR]: shape of y: (82, 1)
[INFOR]: get pretrained model
2021-09-13 12:05:17.546611: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 12:05:17.573473: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:05:17.578261: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:05:17.586255: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:05:17.588452: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:05:17.593533: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:05:17.596994: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:05:17.603817: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:05:17.608917: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:05:17.612100: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:05:17.614367: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:05:17.617000: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 12:05:17.629287: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1f4b7fdb730 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:05:17.632459: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 12:05:17.634522: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:05:17.638850: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:05:17.641023: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:05:17.643179: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:05:17.645377: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:05:17.647487: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:05:17.649607: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:05:17.651797: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:05:17.654086: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:05:17.656245: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:05:18.081299: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 12:05:18.084329: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 12:05:18.085650: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 12:05:18.087332: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 12:05:18.094333: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1f4dfba6ad0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:05:18.097086: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 12:05:20.075493: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 12:05:20.769649: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:05:21.414604: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:05:21.420673: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:05:22.777917: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:05:22.834740: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:05:23.556826: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 316ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :19.0


[INFOR]: Index of second most vote     :408
[INFOR]: Class of second most vote     :amphibian, amphibious vehicle
[INFOR]: Number of second most vote    :8.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 36ms/step
[INFOR]: Toltal norm before transform: 0.5215
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0550

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 35ms/step
[INFOR]: SEN training of class 186_41 before transform: 19
[INFOR]: SPE training of class 186_41 before transform: 24

[INFOR]: SEN training of class 186_41 after transform: 40
[INFOR]: SPE training of class 186_41 after transform: 24
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (82, 32, 32, 3)
[INFOR]: shape of y: (82, 1)
3/3 [==============================] - 0s 34ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :17.0


[INFOR]: Index of second most vote     :408
[INFOR]: Class of second most vote     :amphibian, amphibious vehicle
[INFOR]: Number of second most vote    :11.0
[INFOR]: SEN testing of class 186_41 before transform: 17
[INFOR]: SPE testing of class 186_41 before transform: 26

[INFOR]: SEN testing of class 186_41 after transform: 38
[INFOR]: SPE testing of class 186_41 after transform: 2
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name stanford_car --class_name_train 187_39 --class_name_test 187_38
2021-09-13 12:05:27.378388: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  stanford_car
class_name_train =  187_39
class_name_test =  187_38
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (78, 32, 32, 3)
[INFOR]: shape of y: (78, 1)
[INFOR]: get pretrained model
2021-09-13 12:05:29.903734: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 12:05:29.928401: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:05:29.932989: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:05:29.940708: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:05:29.942914: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:05:29.947809: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:05:29.951101: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:05:29.957271: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:05:29.962154: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:05:29.965101: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:05:29.967287: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:05:29.969084: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 12:05:29.981277: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1cbb33bdc60 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:05:29.984742: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 12:05:29.986722: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:05:29.991077: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:05:29.993205: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:05:29.995340: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:05:29.997765: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:05:30.000055: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:05:30.002203: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:05:30.004292: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:05:30.006390: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:05:30.008509: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:05:30.436975: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 12:05:30.439805: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 12:05:30.441188: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 12:05:30.442712: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 12:05:30.449314: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1cbde7cd8a0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:05:30.452250: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 12:05:32.430441: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 12:05:33.118489: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:05:33.772954: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:05:33.778933: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:05:35.137615: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:05:35.187167: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:05:35.909310: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 306ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :20.0


[INFOR]: Index of second most vote     :408
[INFOR]: Class of second most vote     :amphibian, amphibious vehicle
[INFOR]: Number of second most vote    :11.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 34ms/step
[INFOR]: Toltal norm before transform: 0.4340
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1418

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 31ms/step
[INFOR]: SEN training of class 187_39 before transform: 20
[INFOR]: SPE training of class 187_39 before transform: 29

[INFOR]: SEN training of class 187_39 after transform: 28
[INFOR]: SPE training of class 187_39 after transform: 26
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (76, 32, 32, 3)
[INFOR]: shape of y: (76, 1)
3/3 [==============================] - 0s 34ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :14.0


[INFOR]: Index of second most vote     :408
[INFOR]: Class of second most vote     :amphibian, amphibious vehicle
[INFOR]: Number of second most vote    :10.0
[INFOR]: SEN testing of class 187_38 before transform: 14
[INFOR]: SPE testing of class 187_38 before transform: 27

[INFOR]: SEN testing of class 187_38 after transform: 35
[INFOR]: SPE testing of class 187_38 after transform: 0
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name stanford_car --class_name_train 188_40 --class_name_test 188_40
2021-09-13 12:05:40.232602: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  stanford_car
class_name_train =  188_40
class_name_test =  188_40
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (80, 32, 32, 3)
[INFOR]: shape of y: (80, 1)
[INFOR]: get pretrained model
2021-09-13 12:05:42.740685: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 12:05:42.765639: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:05:42.770155: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:05:42.778487: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:05:42.780727: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:05:42.786035: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:05:42.789776: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:05:42.796193: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:05:42.801269: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:05:42.804451: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:05:42.806764: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:05:42.808751: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 12:05:42.821344: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x2bdaf32f460 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:05:42.824648: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 12:05:42.826786: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:05:42.831362: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:05:42.833695: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:05:42.836060: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:05:42.838482: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:05:42.840968: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:05:42.843353: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:05:42.845648: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:05:42.848135: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:05:42.850313: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:05:43.284399: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 12:05:43.287261: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 12:05:43.288580: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 12:05:43.290015: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 12:05:43.296501: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x2bde650f6f0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:05:43.299361: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 12:05:45.251784: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 12:05:45.937873: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:05:46.583119: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:05:46.589902: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:05:47.948370: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:05:47.996424: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:05:48.714978: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 299ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :13.0


[INFOR]: Index of second most vote     :511
[INFOR]: Class of second most vote     :convertible
[INFOR]: Number of second most vote    :8.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 34ms/step
[INFOR]: Toltal norm before transform: 0.7188
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0270

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 34ms/step
[INFOR]: SEN training of class 188_40 before transform: 13
[INFOR]: SPE training of class 188_40 before transform: 34

[INFOR]: SEN training of class 188_40 after transform: 27
[INFOR]: SPE training of class 188_40 after transform: 27
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (80, 32, 32, 3)
[INFOR]: shape of y: (80, 1)
3/3 [==============================] - 0s 33ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :12.0


[INFOR]: Index of second most vote     :408
[INFOR]: Class of second most vote     :amphibian, amphibious vehicle
[INFOR]: Number of second most vote    :11.0
[INFOR]: SEN testing of class 188_40 before transform: 12
[INFOR]: SPE testing of class 188_40 before transform: 25

[INFOR]: SEN testing of class 188_40 after transform: 32
[INFOR]: SPE testing of class 188_40 after transform: 6
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name stanford_car --class_name_train 189_39 --class_name_test 189_39
2021-09-13 12:05:52.498809: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  stanford_car
class_name_train =  189_39
class_name_test =  189_39
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (78, 32, 32, 3)
[INFOR]: shape of y: (78, 1)
[INFOR]: get pretrained model
2021-09-13 12:05:55.066969: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 12:05:55.094095: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:05:55.098641: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:05:55.106660: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:05:55.108823: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:05:55.113902: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:05:55.117245: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:05:55.123534: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:05:55.128684: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:05:55.131722: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:05:55.133841: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:05:55.135695: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 12:05:55.148434: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x2cb361e68c0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:05:55.151892: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 12:05:55.154019: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:05:55.158218: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:05:55.160349: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:05:55.162454: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:05:55.164634: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:05:55.166997: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:05:55.169137: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:05:55.171228: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:05:55.173370: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:05:55.175526: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:05:55.602270: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 12:05:55.605078: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 12:05:55.606400: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 12:05:55.607841: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 12:05:55.614538: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x2cb65c20ed0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:05:55.617271: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 12:05:57.613764: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 12:05:58.319929: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:05:58.978487: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:05:58.984854: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:06:00.328073: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:06:00.376904: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:06:01.106346: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 307ms/step
[INFOR]: Index of most vote   :408
[INFOR]: Class of most vote   :amphibian, amphibious vehicle
[INFOR]: Number of most vote  :6.0


[INFOR]: Index of second most vote     :855
[INFOR]: Class of second most vote     :thimble
[INFOR]: Number of second most vote    :6.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 34ms/step
[INFOR]: Toltal norm before transform: 0.8450
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0451

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 34ms/step
[INFOR]: SEN training of class 189_39 before transform: 6
[INFOR]: SPE training of class 189_39 before transform: 33

[INFOR]: SEN training of class 189_39 after transform: 38
[INFOR]: SPE training of class 189_39 after transform: 33
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (78, 32, 32, 3)
[INFOR]: shape of y: (78, 1)
3/3 [==============================] - 0s 33ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :9.0


[INFOR]: Index of second most vote     :408
[INFOR]: Class of second most vote     :amphibian, amphibious vehicle
[INFOR]: Number of second most vote    :8.0
[INFOR]: SEN testing of class 189_39 before transform: 9
[INFOR]: SPE testing of class 189_39 before transform: 27

[INFOR]: SEN testing of class 189_39 after transform: 36
[INFOR]: SPE testing of class 189_39 after transform: 7
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name stanford_car --class_name_train 190_44 --class_name_test 190_43
2021-09-13 12:06:04.883628: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  stanford_car
class_name_train =  190_44
class_name_test =  190_43
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (88, 32, 32, 3)
[INFOR]: shape of y: (88, 1)
[INFOR]: get pretrained model
2021-09-13 12:06:07.357477: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 12:06:07.383340: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:06:07.387939: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:06:07.395742: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:06:07.397793: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:06:07.402779: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:06:07.406161: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:06:07.412411: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:06:07.417458: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:06:07.420564: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:06:07.422824: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:06:07.424783: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 12:06:07.436944: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x18738c3f360 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:06:07.440031: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 12:06:07.442069: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:06:07.446363: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:06:07.448497: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:06:07.450775: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:06:07.452882: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:06:07.455061: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:06:07.457132: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:06:07.459232: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:06:07.461450: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:06:07.463523: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:06:07.890373: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 12:06:07.893209: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 12:06:07.894519: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 12:06:07.896009: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 12:06:07.902533: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x187679ed760 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:06:07.905284: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 12:06:09.860340: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 12:06:10.543100: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:06:11.187599: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:06:11.193667: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:06:12.541042: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:06:12.598090: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:06:13.323875: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 330ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :14.0


[INFOR]: Index of second most vote     :855
[INFOR]: Class of second most vote     :thimble
[INFOR]: Number of second most vote    :5.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 37ms/step
[INFOR]: Toltal norm before transform: 0.6252
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1469

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 38ms/step
[INFOR]: SEN training of class 190_44 before transform: 14
[INFOR]: SPE training of class 190_44 before transform: 32

[INFOR]: SEN training of class 190_44 after transform: 31
[INFOR]: SPE training of class 190_44 after transform: 29
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (86, 32, 32, 3)
[INFOR]: shape of y: (86, 1)
3/3 [==============================] - 0s 37ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :15.0


[INFOR]: Index of second most vote     :408
[INFOR]: Class of second most vote     :amphibian, amphibious vehicle
[INFOR]: Number of second most vote    :11.0
[INFOR]: SEN testing of class 190_43 before transform: 15
[INFOR]: SPE testing of class 190_43 before transform: 30

[INFOR]: SEN testing of class 190_43 after transform: 37
[INFOR]: SPE testing of class 190_43 after transform: 8
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name stanford_car --class_name_train 191_46 --class_name_test 191_45
2021-09-13 12:06:17.822781: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  stanford_car
class_name_train =  191_46
class_name_test =  191_45
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (92, 32, 32, 3)
[INFOR]: shape of y: (92, 1)
[INFOR]: get pretrained model
2021-09-13 12:06:20.342017: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 12:06:20.369037: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:06:20.373904: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:06:20.381891: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:06:20.383957: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:06:20.389079: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:06:20.392334: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:06:20.398583: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:06:20.403585: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:06:20.406545: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:06:20.408687: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:06:20.410520: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 12:06:20.422780: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x285b9667320 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:06:20.426150: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 12:06:20.428191: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:06:20.432651: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:06:20.434893: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:06:20.436947: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:06:20.439072: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:06:20.441229: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:06:20.443287: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:06:20.445374: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:06:20.447457: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:06:20.449696: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:06:20.880836: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 12:06:20.883718: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 12:06:20.885093: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 12:06:20.886535: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 12:06:20.893261: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x285e8c81840 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:06:20.896025: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 12:06:22.886353: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 12:06:23.585503: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:06:24.240765: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:06:24.246720: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:06:25.595866: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:06:25.644878: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:06:26.363463: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 355ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :16.0


[INFOR]: Index of second most vote     :408
[INFOR]: Class of second most vote     :amphibian, amphibious vehicle
[INFOR]: Number of second most vote    :10.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 39ms/step
[INFOR]: Toltal norm before transform: 0.5933
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0228

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 38ms/step
[INFOR]: SEN training of class 191_46 before transform: 16
[INFOR]: SPE training of class 191_46 before transform: 30

[INFOR]: SEN training of class 191_46 after transform: 43
[INFOR]: SPE training of class 191_46 after transform: 30
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (90, 32, 32, 3)
[INFOR]: shape of y: (90, 1)
3/3 [==============================] - 0s 39ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :19.0


[INFOR]: Index of second most vote     :408
[INFOR]: Class of second most vote     :amphibian, amphibious vehicle
[INFOR]: Number of second most vote    :10.0
[INFOR]: SEN testing of class 191_45 before transform: 19
[INFOR]: SPE testing of class 191_45 before transform: 32

[INFOR]: SEN testing of class 191_45 after transform: 44
[INFOR]: SPE testing of class 191_45 after transform: 0
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name stanford_car --class_name_train 192_41 --class_name_test 192_41
2021-09-13 12:06:30.943941: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  stanford_car
class_name_train =  192_41
class_name_test =  192_41
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (82, 32, 32, 3)
[INFOR]: shape of y: (82, 1)
[INFOR]: get pretrained model
2021-09-13 12:06:33.462376: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 12:06:33.487036: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:06:33.491249: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:06:33.498932: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:06:33.501005: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:06:33.506140: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:06:33.509523: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:06:33.515791: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:06:33.520598: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:06:33.523541: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:06:33.525886: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:06:33.527793: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 12:06:33.540239: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1a7b4fe5350 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:06:33.543941: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 12:06:33.545965: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:06:33.550153: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:06:33.552253: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:06:33.554335: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:06:33.556445: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:06:33.558568: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:06:33.560700: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:06:33.562916: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:06:33.564996: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:06:33.567075: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:06:33.991087: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 12:06:33.993738: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 12:06:33.995091: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 12:06:33.996538: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 12:06:34.003451: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1a7e41be060 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:06:34.006354: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 12:06:35.952644: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 12:06:36.642569: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:06:37.291937: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:06:37.298158: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:06:38.653107: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:06:38.703111: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:06:39.423946: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 315ms/step
[INFOR]: Index of most vote   :856
[INFOR]: Class of most vote   :thresher, thrasher, threshing machine
[INFOR]: Number of most vote  :7.0


[INFOR]: Index of second most vote     :675
[INFOR]: Class of second most vote     :moving van
[INFOR]: Number of second most vote    :6.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 34ms/step
[INFOR]: Toltal norm before transform: 0.8189
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0526

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 34ms/step
[INFOR]: SEN training of class 192_41 before transform: 7
[INFOR]: SPE training of class 192_41 before transform: 40

[INFOR]: SEN training of class 192_41 after transform: 34
[INFOR]: SPE training of class 192_41 after transform: 30
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (82, 32, 32, 3)
[INFOR]: shape of y: (82, 1)
3/3 [==============================] - 0s 35ms/step
[INFOR]: Index of most vote   :408
[INFOR]: Class of most vote   :amphibian, amphibious vehicle
[INFOR]: Number of most vote  :7.0


[INFOR]: Index of second most vote     :855
[INFOR]: Class of second most vote     :thimble
[INFOR]: Number of second most vote    :5.0
[INFOR]: SEN testing of class 192_41 before transform: 7
[INFOR]: SPE testing of class 192_41 before transform: 33

[INFOR]: SEN testing of class 192_41 after transform: 35
[INFOR]: SPE testing of class 192_41 after transform: 2
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name stanford_car --class_name_train 193_42 --class_name_test 193_42
2021-09-13 12:06:43.238919: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  stanford_car
class_name_train =  193_42
class_name_test =  193_42
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (84, 32, 32, 3)
[INFOR]: shape of y: (84, 1)
[INFOR]: get pretrained model
2021-09-13 12:06:45.776023: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 12:06:45.801429: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:06:45.805844: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:06:45.813833: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:06:45.815919: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:06:45.821047: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:06:45.824332: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:06:45.830669: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:06:45.835546: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:06:45.838466: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:06:45.840579: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:06:45.842557: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 12:06:45.855113: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x28cb6c1b4f0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:06:45.858848: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 12:06:45.860959: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:06:45.865354: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:06:45.867531: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:06:45.869612: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:06:45.871747: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:06:45.874042: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:06:45.876261: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:06:45.878384: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:06:45.880575: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:06:45.882702: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:06:46.303938: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 12:06:46.306932: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 12:06:46.308364: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 12:06:46.309977: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 12:06:46.316628: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x28ce1c02870 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:06:46.319374: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 12:06:48.273921: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 12:06:48.972340: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:06:49.632077: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:06:49.637916: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:06:50.980423: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:06:51.029785: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:06:51.751540: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 319ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :10.0


[INFOR]: Index of second most vote     :408
[INFOR]: Class of second most vote     :amphibian, amphibious vehicle
[INFOR]: Number of second most vote    :6.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 36ms/step
[INFOR]: Toltal norm before transform: 0.7714
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.3427

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 35ms/step
[INFOR]: SEN training of class 193_42 before transform: 10
[INFOR]: SPE training of class 193_42 before transform: 28

[INFOR]: SEN training of class 193_42 after transform: 39
[INFOR]: SPE training of class 193_42 after transform: 28
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (84, 32, 32, 3)
[INFOR]: shape of y: (84, 1)
3/3 [==============================] - 0s 36ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :9.0


[INFOR]: Index of second most vote     :408
[INFOR]: Class of second most vote     :amphibian, amphibious vehicle
[INFOR]: Number of second most vote    :5.0
[INFOR]: SEN testing of class 193_42 before transform: 9
[INFOR]: SPE testing of class 193_42 before transform: 28

[INFOR]: SEN testing of class 193_42 after transform: 39
[INFOR]: SPE testing of class 193_42 after transform: 0
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name stanford_car --class_name_train 194_46 --class_name_test 194_46
2021-09-13 12:06:55.601183: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  stanford_car
class_name_train =  194_46
class_name_test =  194_46
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (92, 32, 32, 3)
[INFOR]: shape of y: (92, 1)
[INFOR]: get pretrained model
2021-09-13 12:06:58.151762: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 12:06:58.177132: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:06:58.181753: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:06:58.189707: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:06:58.191782: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:06:58.196896: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:06:58.200179: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:06:58.206335: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:06:58.211225: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:06:58.214243: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:06:58.216321: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:06:58.218322: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 12:06:58.230485: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x165b36c3830 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:06:58.234242: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 12:06:58.236578: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:06:58.240839: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:06:58.242919: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:06:58.245023: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:06:58.247192: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:06:58.249434: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:06:58.251580: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:06:58.253677: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:06:58.255766: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:06:58.257890: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:06:58.684283: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 12:06:58.686923: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 12:06:58.688270: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 12:06:58.689793: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 12:06:58.696477: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x165dce0d760 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:06:58.699330: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 12:07:00.687413: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 12:07:01.386227: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:07:02.050157: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:07:02.056094: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:07:03.391748: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:07:03.446246: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:07:04.166112: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 4s 354ms/step
[INFOR]: Index of most vote   :408
[INFOR]: Class of most vote   :amphibian, amphibious vehicle
[INFOR]: Number of most vote  :18.0


[INFOR]: Index of second most vote     :674
[INFOR]: Class of second most vote     :mousetrap
[INFOR]: Number of second most vote    :5.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 38ms/step
[INFOR]: Toltal norm before transform: 0.5937
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1011

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 39ms/step
[INFOR]: SEN training of class 194_46 before transform: 18
[INFOR]: SPE training of class 194_46 before transform: 34

[INFOR]: SEN training of class 194_46 after transform: 41
[INFOR]: SPE training of class 194_46 after transform: 34
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (92, 32, 32, 3)
[INFOR]: shape of y: (92, 1)
3/3 [==============================] - 0s 39ms/step
[INFOR]: Index of most vote   :408
[INFOR]: Class of most vote   :amphibian, amphibious vehicle
[INFOR]: Number of most vote  :13.0


[INFOR]: Index of second most vote     :674
[INFOR]: Class of second most vote     :mousetrap
[INFOR]: Number of second most vote    :9.0
[INFOR]: SEN testing of class 194_46 before transform: 13
[INFOR]: SPE testing of class 194_46 before transform: 34

[INFOR]: SEN testing of class 194_46 after transform: 44
[INFOR]: SPE testing of class 194_46 after transform: 3
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name stanford_car --class_name_train 195_28 --class_name_test 195_27
2021-09-13 12:07:08.098579: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  stanford_car
class_name_train =  195_28
class_name_test =  195_27
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (56, 32, 32, 3)
[INFOR]: shape of y: (56, 1)
[INFOR]: get pretrained model
2021-09-13 12:07:10.578553: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 12:07:10.604801: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:07:10.609303: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:07:10.617252: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:07:10.619307: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:07:10.624342: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:07:10.627566: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:07:10.633782: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:07:10.638752: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:07:10.641637: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:07:10.643754: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:07:10.645568: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 12:07:10.657919: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1bab8b96080 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:07:10.661206: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 12:07:10.663346: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 12:07:10.667539: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 12:07:10.669766: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:07:10.671945: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:07:10.674047: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 12:07:10.676046: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 12:07:10.678234: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 12:07:10.680386: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 12:07:10.682522: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:07:10.684584: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 12:07:11.112884: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 12:07:11.115470: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 12:07:11.116788: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 12:07:11.118260: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 12:07:11.125053: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1bae8c2ca50 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 12:07:11.127794: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 12:07:13.078978: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 12:07:13.779956: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 12:07:14.426692: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 12:07:14.432335: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 12:07:15.770902: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:07:15.819385: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 12:07:16.540226: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
2/2 [==============================] - 4s 668ms/step
[INFOR]: Index of most vote   :408
[INFOR]: Class of most vote   :amphibian, amphibious vehicle
[INFOR]: Number of most vote  :3.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :3.0

[INFOR]: Create PDF for Positive Label

2/2 [==============================] - 1s 43ms/step
[INFOR]: Toltal norm before transform: 0.8944
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0841

[INFOR]: Create PDF for Negative Label

2/2 [==============================] - 0s 42ms/step
[INFOR]: SEN training of class 195_28 before transform: 3
[INFOR]: SPE training of class 195_28 before transform: 19

[INFOR]: SEN training of class 195_28 after transform: 28
[INFOR]: SPE training of class 195_28 after transform: 19
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (54, 32, 32, 3)
[INFOR]: shape of y: (54, 1)
2/2 [==============================] - 0s 41ms/step
[INFOR]: Index of most vote   :450
[INFOR]: Class of most vote   :bobsled, bobsleigh, bob
[INFOR]: Number of most vote  :3.0


[INFOR]: Index of second most vote     :481
[INFOR]: Class of second most vote     :cassette
[INFOR]: Number of second most vote    :3.0
[INFOR]: SEN testing of class 195_27 before transform: 3
[INFOR]: SPE testing of class 195_27 before transform: 26

[INFOR]: SEN testing of class 195_27 after transform: 27
[INFOR]: SPE testing of class 195_27 after transform: 3
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>