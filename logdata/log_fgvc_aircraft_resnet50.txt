
[INFOR]: SEN testing of class 36_34 after transform: 34
[INFOR]: SPE testing of class 36_34 after transform: 0
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name ResNet50  --model_shape 224 224 --dataset_name fgvc_aircraft --class_name_train 37_33 --class_name_test 37_33
2021-09-13 08:46:01.198794: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  ResNet50
dataset_name =  fgvc_aircraft
class_name_train =  37_33
class_name_test =  37_33
data_shape =  (32, 32, 3)
model_shape =  [224, 224]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
[INFOR]: get pretrained model
2021-09-13 08:46:03.690647: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 08:46:03.714682: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 08:46:03.719514: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 08:46:03.727678: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:46:03.729918: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:46:03.735124: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 08:46:03.738809: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 08:46:03.745307: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 08:46:03.750544: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 08:46:03.753749: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:46:03.756314: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 08:46:03.758375: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 08:46:03.771082: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x195348548f0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 08:46:03.775078: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 08:46:03.777340: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 08:46:03.782002: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 08:46:03.784422: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:46:03.786904: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:46:03.789301: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 08:46:03.791650: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 08:46:03.794008: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 08:46:03.796454: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 08:46:03.798835: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:46:03.801220: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 08:46:04.220018: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 08:46:04.223256: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 08:46:04.224657: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 08:46:04.226332: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 08:46:04.233141: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1955f46eab0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 08:46:04.236023: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 08:46:05.850833: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 08:46:06.344676: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:46:06.987792: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:46:06.994075: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:46:08.314655: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 08:46:08.363649: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 08:46:08.675229: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 3s 109ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :15.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :8.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 23ms/step
[INFOR]: Toltal norm before transform: 0.5086
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1883

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 31ms/step
[INFOR]: SEN training of class 37_33 before transform: 15
[INFOR]: SPE training of class 37_33 before transform: 14

[INFOR]: SEN training of class 37_33 after transform: 30
[INFOR]: SPE training of class 37_33 after transform: 14
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
3/3 [==============================] - 0s 23ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :14.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :7.0
[INFOR]: SEN testing of class 37_33 before transform: 14
[INFOR]: SPE testing of class 37_33 before transform: 19

[INFOR]: SEN testing of class 37_33 after transform: 30
[INFOR]: SPE testing of class 37_33 after transform: 1
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name ResNet50  --model_shape 224 224 --dataset_name fgvc_aircraft --class_name_train 38_33 --class_name_test 38_34
2021-09-13 08:46:11.740580: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  ResNet50
dataset_name =  fgvc_aircraft
class_name_train =  38_33
class_name_test =  38_34
data_shape =  (32, 32, 3)
model_shape =  [224, 224]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
[INFOR]: get pretrained model
2021-09-13 08:46:14.207398: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 08:46:14.232074: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 08:46:14.237427: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 08:46:14.245607: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:46:14.247965: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:46:14.253350: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 08:46:14.257050: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 08:46:14.263477: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 08:46:14.268602: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 08:46:14.271827: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:46:14.274221: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 08:46:14.276270: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 08:46:14.288880: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1adb7d16af0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 08:46:14.292239: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 08:46:14.294476: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 08:46:14.299175: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 08:46:14.301560: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:46:14.303984: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:46:14.306383: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 08:46:14.308739: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 08:46:14.311108: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 08:46:14.313505: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 08:46:14.315978: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:46:14.318383: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 08:46:14.765192: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 08:46:14.768311: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 08:46:14.769720: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 08:46:14.771225: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 08:46:14.777964: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1ade6a9bab0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 08:46:14.780813: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 08:46:16.367317: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 08:46:16.856055: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:46:17.499386: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:46:17.504437: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:46:18.827738: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 08:46:18.877635: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 08:46:19.187452: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 3s 102ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :16.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :4.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 24ms/step
[INFOR]: Toltal norm before transform: 0.4180
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0071

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 32ms/step
[INFOR]: SEN training of class 38_33 before transform: 16
[INFOR]: SPE training of class 38_33 before transform: 17

[INFOR]: SEN training of class 38_33 after transform: 26
[INFOR]: SPE training of class 38_33 after transform: 17
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (68, 32, 32, 3)
[INFOR]: shape of y: (68, 1)
3/3 [==============================] - 0s 23ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :13.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :5.0
[INFOR]: SEN testing of class 38_34 before transform: 13
[INFOR]: SPE testing of class 38_34 before transform: 22

[INFOR]: SEN testing of class 38_34 after transform: 34
[INFOR]: SPE testing of class 38_34 after transform: 0
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name ResNet50  --model_shape 224 224 --dataset_name fgvc_aircraft --class_name_train 39_34 --class_name_test 39_33
2021-09-13 08:46:22.417282: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  ResNet50
dataset_name =  fgvc_aircraft
class_name_train =  39_34
class_name_test =  39_33
data_shape =  (32, 32, 3)
model_shape =  [224, 224]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (68, 32, 32, 3)
[INFOR]: shape of y: (68, 1)
[INFOR]: get pretrained model
2021-09-13 08:46:24.968234: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 08:46:25.073507: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 08:46:25.078490: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 08:46:25.086455: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:46:25.088623: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:46:25.094018: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 08:46:25.097696: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 08:46:25.103869: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 08:46:25.108759: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 08:46:25.111914: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:46:25.114137: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 08:46:25.116033: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 08:46:25.128736: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x24db916b4b0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 08:46:25.132004: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 08:46:25.134305: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 08:46:25.138555: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 08:46:25.140749: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:46:25.143145: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:46:25.145467: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 08:46:25.147703: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 08:46:25.149950: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 08:46:25.152283: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 08:46:25.154558: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:46:25.156796: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 08:46:25.600781: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 08:46:25.603989: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 08:46:25.605398: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 08:46:25.606951: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 08:46:25.613735: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x24ddc5026e0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 08:46:25.616564: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 08:46:27.239281: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 08:46:27.730955: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:46:28.396791: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:46:28.403231: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:46:29.729088: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 08:46:29.776002: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 08:46:30.084299: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 3s 102ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :19.0


[INFOR]: Index of second most vote     :811
[INFOR]: Class of second most vote     :space heater
[INFOR]: Number of second most vote    :6.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 23ms/step
[INFOR]: Toltal norm before transform: 0.4275
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1024

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 23ms/step
[INFOR]: SEN training of class 39_34 before transform: 19
[INFOR]: SPE training of class 39_34 before transform: 13

[INFOR]: SEN training of class 39_34 after transform: 33
[INFOR]: SPE training of class 39_34 after transform: 13
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
3/3 [==============================] - 0s 23ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :14.0


[INFOR]: Index of second most vote     :811
[INFOR]: Class of second most vote     :space heater
[INFOR]: Number of second most vote    :9.0
[INFOR]: SEN testing of class 39_33 before transform: 14
[INFOR]: SPE testing of class 39_33 before transform: 18

[INFOR]: SEN testing of class 39_33 after transform: 33
[INFOR]: SPE testing of class 39_33 after transform: 1
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name ResNet50  --model_shape 224 224 --dataset_name fgvc_aircraft --class_name_train 40_33 --class_name_test 40_33
2021-09-13 08:46:33.338205: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  ResNet50
dataset_name =  fgvc_aircraft
class_name_train =  40_33
class_name_test =  40_33
data_shape =  (32, 32, 3)
model_shape =  [224, 224]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
[INFOR]: get pretrained model
2021-09-13 08:46:35.813104: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 08:46:35.839150: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 08:46:35.844262: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 08:46:35.852096: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:46:35.854466: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:46:35.859758: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 08:46:35.863184: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 08:46:35.869473: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 08:46:35.875042: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 08:46:35.878067: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:46:35.880263: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 08:46:35.882130: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 08:46:35.894324: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1ef3ab03400 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 08:46:35.897604: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 08:46:35.899705: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 08:46:35.904122: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 08:46:35.906308: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:46:35.908495: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:46:35.910691: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 08:46:35.912849: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 08:46:35.915225: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 08:46:35.917587: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 08:46:35.919849: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:46:35.922004: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 08:46:36.340346: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 08:46:36.343695: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 08:46:36.345094: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 08:46:36.346615: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 08:46:36.353315: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1ef5bac5090 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 08:46:36.356386: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 08:46:37.966495: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 08:46:38.458795: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:46:39.118476: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:46:39.124301: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:46:40.447751: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 08:46:40.505656: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 08:46:40.818335: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 3s 109ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :12.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :8.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 23ms/step
[INFOR]: Toltal norm before transform: 0.5970
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1341

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 31ms/step
[INFOR]: SEN training of class 40_33 before transform: 12
[INFOR]: SPE training of class 40_33 before transform: 19

[INFOR]: SEN training of class 40_33 after transform: 32
[INFOR]: SPE training of class 40_33 after transform: 19
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
3/3 [==============================] - 0s 23ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :15.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :4.0
[INFOR]: SEN testing of class 40_33 before transform: 15
[INFOR]: SPE testing of class 40_33 before transform: 18

[INFOR]: SEN testing of class 40_33 after transform: 33
[INFOR]: SPE testing of class 40_33 after transform: 0
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name ResNet50  --model_shape 224 224 --dataset_name fgvc_aircraft --class_name_train 41_33 --class_name_test 41_34
2021-09-13 08:46:43.898814: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  ResNet50
dataset_name =  fgvc_aircraft
class_name_train =  41_33
class_name_test =  41_34
data_shape =  (32, 32, 3)
model_shape =  [224, 224]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
[INFOR]: get pretrained model
2021-09-13 08:46:46.423552: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 08:46:46.448991: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 08:46:46.454094: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 08:46:46.462191: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:46:46.464353: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:46:46.469517: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 08:46:46.472877: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 08:46:46.479368: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 08:46:46.484292: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 08:46:46.487204: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:46:46.489474: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 08:46:46.491370: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 08:46:46.503378: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x15c35f4aed0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 08:46:46.506701: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 08:46:46.508768: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 08:46:46.512988: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 08:46:46.515383: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:46:46.517571: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:46:46.519816: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 08:46:46.522056: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 08:46:46.524371: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 08:46:46.526578: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 08:46:46.528863: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:46:46.531039: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 08:46:46.952913: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 08:46:46.955668: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 08:46:46.957062: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 08:46:46.958616: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 08:46:46.965477: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x15c66072370 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 08:46:46.968284: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 08:46:48.585330: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 08:46:49.072323: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:46:49.710086: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:46:49.716238: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:46:51.039079: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 08:46:51.086599: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 08:46:51.400993: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 3s 102ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :19.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :7.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 23ms/step
[INFOR]: Toltal norm before transform: 0.3866
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0417

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 23ms/step
[INFOR]: SEN training of class 41_33 before transform: 19
[INFOR]: SPE training of class 41_33 before transform: 18

[INFOR]: SEN training of class 41_33 after transform: 31
[INFOR]: SPE training of class 41_33 after transform: 18
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (68, 32, 32, 3)
[INFOR]: shape of y: (68, 1)
3/3 [==============================] - 0s 23ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :13.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :11.0
[INFOR]: SEN testing of class 41_34 before transform: 13
[INFOR]: SPE testing of class 41_34 before transform: 18

[INFOR]: SEN testing of class 41_34 after transform: 31
[INFOR]: SPE testing of class 41_34 after transform: 2
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name ResNet50  --model_shape 224 224 --dataset_name fgvc_aircraft --class_name_train 42_34 --class_name_test 42_33
2021-09-13 08:46:54.611930: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  ResNet50
dataset_name =  fgvc_aircraft
class_name_train =  42_34
class_name_test =  42_33
data_shape =  (32, 32, 3)
model_shape =  [224, 224]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (68, 32, 32, 3)
[INFOR]: shape of y: (68, 1)
[INFOR]: get pretrained model
2021-09-13 08:46:57.097149: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 08:46:57.120995: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 08:46:57.125538: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 08:46:57.133653: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:46:57.135800: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:46:57.140958: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 08:46:57.144370: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 08:46:57.150967: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 08:46:57.155941: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 08:46:57.158870: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:46:57.161025: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 08:46:57.163252: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 08:46:57.175729: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1ad3946de50 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 08:46:57.179271: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 08:46:57.181374: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 08:46:57.185610: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 08:46:57.187788: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:46:57.190189: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:46:57.192411: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 08:46:57.194779: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 08:46:57.196968: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 08:46:57.199258: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 08:46:57.201665: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:46:57.203852: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 08:46:57.625350: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 08:46:57.628293: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 08:46:57.629693: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 08:46:57.631248: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 08:46:57.638004: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1ad6795f3a0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 08:46:57.640813: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 08:46:59.262069: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 08:46:59.755408: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:47:00.398821: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:47:00.404962: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:47:01.741231: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 08:47:01.788831: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 08:47:02.100772: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 3s 109ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :10.0


[INFOR]: Index of second most vote     :407
[INFOR]: Class of second most vote     :ambulance
[INFOR]: Number of second most vote    :5.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 31ms/step
[INFOR]: Toltal norm before transform: 0.6688
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1593

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 23ms/step
[INFOR]: SEN training of class 42_34 before transform: 10
[INFOR]: SPE training of class 42_34 before transform: 23

[INFOR]: SEN training of class 42_34 after transform: 32
[INFOR]: SPE training of class 42_34 after transform: 23
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
3/3 [==============================] - 0s 31ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :8.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :6.0
[INFOR]: SEN testing of class 42_33 before transform: 8
[INFOR]: SPE testing of class 42_33 before transform: 22

[INFOR]: SEN testing of class 42_33 after transform: 33
[INFOR]: SPE testing of class 42_33 after transform: 1
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name ResNet50  --model_shape 224 224 --dataset_name fgvc_aircraft --class_name_train 43_33 --class_name_test 43_33
2021-09-13 08:47:05.344399: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  ResNet50
dataset_name =  fgvc_aircraft
class_name_train =  43_33
class_name_test =  43_33
data_shape =  (32, 32, 3)
model_shape =  [224, 224]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
[INFOR]: get pretrained model
2021-09-13 08:47:07.810815: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 08:47:07.836712: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 08:47:07.841840: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 08:47:07.849897: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:47:07.852116: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:47:07.857247: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 08:47:07.860754: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 08:47:07.867110: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 08:47:07.872064: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 08:47:07.875252: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:47:07.877607: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 08:47:07.879488: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 08:47:07.891340: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x23bb43826f0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 08:47:07.894490: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 08:47:07.896579: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 08:47:07.901143: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 08:47:07.903341: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:47:07.905553: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:47:07.907914: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 08:47:07.910299: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 08:47:07.912487: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 08:47:07.914805: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 08:47:07.917014: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:47:07.919194: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 08:47:08.338542: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 08:47:08.341754: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 08:47:08.343277: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 08:47:08.344809: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 08:47:08.351561: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x23bdfe7c160 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 08:47:08.354633: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 08:47:09.959429: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 08:47:10.453089: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:47:11.096503: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:47:11.102654: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:47:12.430745: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 08:47:12.480293: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 08:47:12.790502: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 3s 133ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :10.0


[INFOR]: Index of second most vote     :811
[INFOR]: Class of second most vote     :space heater
[INFOR]: Number of second most vote    :6.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 23ms/step
[INFOR]: Toltal norm before transform: 0.7178
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.2176

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 23ms/step
[INFOR]: SEN training of class 43_33 before transform: 10
[INFOR]: SPE training of class 43_33 before transform: 23

[INFOR]: SEN training of class 43_33 after transform: 32
[INFOR]: SPE training of class 43_33 after transform: 23
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
3/3 [==============================] - 0s 23ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :10.0


[INFOR]: Index of second most vote     :407
[INFOR]: Class of second most vote     :ambulance
[INFOR]: Number of second most vote    :3.0
[INFOR]: SEN testing of class 43_33 before transform: 10
[INFOR]: SPE testing of class 43_33 before transform: 16

[INFOR]: SEN testing of class 43_33 after transform: 33
[INFOR]: SPE testing of class 43_33 after transform: 0
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name ResNet50  --model_shape 224 224 --dataset_name fgvc_aircraft --class_name_train 44_33 --class_name_test 44_34
2021-09-13 08:47:15.956652: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  ResNet50
dataset_name =  fgvc_aircraft
class_name_train =  44_33
class_name_test =  44_34
data_shape =  (32, 32, 3)
model_shape =  [224, 224]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
[INFOR]: get pretrained model
2021-09-13 08:47:18.458888: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 08:47:18.487500: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 08:47:18.493062: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 08:47:18.501670: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:47:18.504048: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:47:18.509730: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 08:47:18.513432: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 08:47:18.521009: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 08:47:18.526777: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 08:47:18.530269: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:47:18.533300: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 08:47:18.535539: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 08:47:18.549004: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1ad363580f0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 08:47:18.552862: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 08:47:18.555600: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 08:47:18.561093: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 08:47:18.564535: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:47:18.567063: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:47:18.569680: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 08:47:18.572275: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 08:47:18.574814: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 08:47:18.577649: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 08:47:18.581251: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:47:18.586870: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 08:47:19.025255: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 08:47:19.028959: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 08:47:19.030524: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 08:47:19.032365: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 08:47:19.040047: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1ad6223f540 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 08:47:19.043262: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 08:47:20.678736: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 08:47:21.178811: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:47:21.831542: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:47:21.837402: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:47:23.177164: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 08:47:23.225716: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 08:47:23.546865: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 3s 110ms/step
[INFOR]: Index of most vote   :510
[INFOR]: Class of most vote   :container ship, containership, container vessel
[INFOR]: Number of most vote  :9.0


[INFOR]: Index of second most vote     :811
[INFOR]: Class of second most vote     :space heater
[INFOR]: Number of second most vote    :6.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 23ms/step
[INFOR]: Toltal norm before transform: 0.6226
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0366

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 32ms/step
[INFOR]: SEN training of class 44_33 before transform: 9
[INFOR]: SPE training of class 44_33 before transform: 26

[INFOR]: SEN training of class 44_33 after transform: 29
[INFOR]: SPE training of class 44_33 after transform: 26
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (68, 32, 32, 3)
[INFOR]: shape of y: (68, 1)
3/3 [==============================] - 0s 23ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :10.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :6.0
[INFOR]: SEN testing of class 44_34 before transform: 10
[INFOR]: SPE testing of class 44_34 before transform: 20

[INFOR]: SEN testing of class 44_34 after transform: 31
[INFOR]: SPE testing of class 44_34 after transform: 0
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name ResNet50  --model_shape 224 224 --dataset_name fgvc_aircraft --class_name_train 45_34 --class_name_test 45_33
2021-09-13 08:47:26.848206: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  ResNet50
dataset_name =  fgvc_aircraft
class_name_train =  45_34
class_name_test =  45_33
data_shape =  (32, 32, 3)
model_shape =  [224, 224]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (68, 32, 32, 3)
[INFOR]: shape of y: (68, 1)
[INFOR]: get pretrained model
2021-09-13 08:47:29.351478: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 08:47:29.378131: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 08:47:29.383239: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 08:47:29.391385: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:47:29.393607: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:47:29.398816: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 08:47:29.402516: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 08:47:29.408776: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 08:47:29.413830: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 08:47:29.416884: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:47:29.419109: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 08:47:29.421214: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 08:47:29.433217: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x294b6708ae0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 08:47:29.436509: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 08:47:29.438856: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 08:47:29.443283: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 08:47:29.445536: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:47:29.447945: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:47:29.450491: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 08:47:29.452758: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 08:47:29.455041: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 08:47:29.457618: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 08:47:29.459925: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:47:29.462688: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 08:47:29.885125: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 08:47:29.889094: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 08:47:29.890571: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 08:47:29.892313: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 08:47:29.899096: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x294e5496af0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 08:47:29.902299: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 08:47:31.538039: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 08:47:32.058305: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:47:32.719904: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:47:32.725715: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:47:34.112438: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 08:47:34.162841: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 08:47:34.482226: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 3s 110ms/step
[INFOR]: Index of most vote   :510
[INFOR]: Class of most vote   :container ship, containership, container vessel
[INFOR]: Number of most vote  :13.0


[INFOR]: Index of second most vote     :794
[INFOR]: Class of second most vote     :shower curtain
[INFOR]: Number of second most vote    :4.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 32ms/step
[INFOR]: Toltal norm before transform: 0.5712
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1192

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 25ms/step
[INFOR]: SEN training of class 45_34 before transform: 13
[INFOR]: SPE training of class 45_34 before transform: 30

[INFOR]: SEN training of class 45_34 after transform: 34
[INFOR]: SPE training of class 45_34 after transform: 30
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
3/3 [==============================] - 0s 23ms/step
[INFOR]: Index of most vote   :510
[INFOR]: Class of most vote   :container ship, containership, container vessel
[INFOR]: Number of most vote  :10.0


[INFOR]: Index of second most vote     :870
[INFOR]: Class of second most vote     :tricycle, trike, velocipede
[INFOR]: Number of second most vote    :6.0
[INFOR]: SEN testing of class 45_33 before transform: 10
[INFOR]: SPE testing of class 45_33 before transform: 27

[INFOR]: SEN testing of class 45_33 after transform: 33
[INFOR]: SPE testing of class 45_33 after transform: 2
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name ResNet50  --model_shape 224 224 --dataset_name fgvc_aircraft --class_name_train 46_33 --class_name_test 46_33
2021-09-13 08:47:37.829059: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  ResNet50
dataset_name =  fgvc_aircraft
class_name_train =  46_33
class_name_test =  46_33
data_shape =  (32, 32, 3)
model_shape =  [224, 224]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
[INFOR]: get pretrained model
2021-09-13 08:47:40.444962: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 08:47:40.468242: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 08:47:40.472807: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 08:47:40.480915: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:47:40.483136: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:47:40.488369: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 08:47:40.491870: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 08:47:40.498126: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 08:47:40.503073: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 08:47:40.506382: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:47:40.508618: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 08:47:40.510543: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 08:47:40.522500: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x28bb2f79f00 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 08:47:40.525825: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 08:47:40.528145: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 08:47:40.532469: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 08:47:40.534874: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:47:40.537381: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:47:40.539602: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 08:47:40.541994: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 08:47:40.544188: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 08:47:40.546562: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 08:47:40.548812: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:47:40.551036: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 08:47:40.974308: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 08:47:40.977017: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 08:47:40.978408: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 08:47:40.979921: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 08:47:40.986940: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x28be11f2fd0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 08:47:40.989887: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 08:47:42.629383: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 08:47:43.138020: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:47:43.782738: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:47:43.788071: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:47:45.153947: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 08:47:45.201296: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 08:47:45.514781: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 3s 102ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :13.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :4.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 31ms/step
[INFOR]: Toltal norm before transform: 0.5692
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0256

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 24ms/step
[INFOR]: SEN training of class 46_33 before transform: 13
[INFOR]: SPE training of class 46_33 before transform: 15

[INFOR]: SEN training of class 46_33 after transform: 29
[INFOR]: SPE training of class 46_33 after transform: 15
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
3/3 [==============================] - 0s 23ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :13.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :6.0
[INFOR]: SEN testing of class 46_33 before transform: 13
[INFOR]: SPE testing of class 46_33 before transform: 20

[INFOR]: SEN testing of class 46_33 after transform: 25
[INFOR]: SPE testing of class 46_33 after transform: 3
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name ResNet50  --model_shape 224 224 --dataset_name fgvc_aircraft --class_name_train 47_33 --class_name_test 47_34
2021-09-13 08:47:48.674884: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  ResNet50
dataset_name =  fgvc_aircraft
class_name_train =  47_33
class_name_test =  47_34
data_shape =  (32, 32, 3)
model_shape =  [224, 224]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
[INFOR]: get pretrained model
2021-09-13 08:47:51.213554: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 08:47:51.237577: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 08:47:51.242077: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 08:47:51.250107: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:47:51.252474: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:47:51.257631: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 08:47:51.261106: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 08:47:51.267315: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 08:47:51.272232: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 08:47:51.275254: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:47:51.277410: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 08:47:51.279327: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 08:47:51.291364: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x17633527b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 08:47:51.294392: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 08:47:51.296533: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 08:47:51.300745: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 08:47:51.303179: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:47:51.305413: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:47:51.307716: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 08:47:51.310084: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 08:47:51.312282: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 08:47:51.314548: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 08:47:51.316824: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:47:51.318999: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 08:47:51.738228: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 08:47:51.741415: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 08:47:51.742820: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 08:47:51.744378: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 08:47:51.751514: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x17661f2b870 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 08:47:51.754370: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 08:47:53.373656: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 08:47:53.866010: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:47:54.509848: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:47:54.516444: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:47:55.847364: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 08:47:55.901385: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 08:47:56.214815: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 3s 102ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :14.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :11.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 23ms/step
[INFOR]: Toltal norm before transform: 0.6120
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0033

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 23ms/step
[INFOR]: SEN training of class 47_33 before transform: 14
[INFOR]: SPE training of class 47_33 before transform: 22

[INFOR]: SEN training of class 47_33 after transform: 29
[INFOR]: SPE training of class 47_33 after transform: 22
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (68, 32, 32, 3)
[INFOR]: shape of y: (68, 1)
3/3 [==============================] - 0s 23ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :14.0


[INFOR]: Index of second most vote     :811
[INFOR]: Class of second most vote     :space heater
[INFOR]: Number of second most vote    :6.0
[INFOR]: SEN testing of class 47_34 before transform: 14
[INFOR]: SPE testing of class 47_34 before transform: 18

[INFOR]: SEN testing of class 47_34 after transform: 31
[INFOR]: SPE testing of class 47_34 after transform: 1
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name ResNet50  --model_shape 224 224 --dataset_name fgvc_aircraft --class_name_train 48_34 --class_name_test 48_33
2021-09-13 08:47:59.489352: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  ResNet50
dataset_name =  fgvc_aircraft
class_name_train =  48_34
class_name_test =  48_33
data_shape =  (32, 32, 3)
model_shape =  [224, 224]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (68, 32, 32, 3)
[INFOR]: shape of y: (68, 1)
[INFOR]: get pretrained model
2021-09-13 08:48:01.990346: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 08:48:02.013502: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 08:48:02.018698: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 08:48:02.026711: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:48:02.028855: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:48:02.034001: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 08:48:02.037518: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 08:48:02.043708: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 08:48:02.048662: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 08:48:02.051613: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:48:02.053805: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 08:48:02.055862: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 08:48:02.067919: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x16f370be6e0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 08:48:02.071349: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 08:48:02.073717: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 08:48:02.078375: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 08:48:02.080596: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:48:02.082992: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:48:02.085223: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 08:48:02.087457: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 08:48:02.089659: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 08:48:02.091947: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 08:48:02.094179: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:48:02.096371: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 08:48:02.516707: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 08:48:02.519763: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 08:48:02.521135: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 08:48:02.522627: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 08:48:02.529291: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x16f62239f70 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 08:48:02.532127: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 08:48:04.153932: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 08:48:04.655014: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:48:05.302132: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:48:05.308175: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:48:06.645734: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 08:48:06.700316: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 08:48:07.037516: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 3s 110ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :13.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :11.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 23ms/step
[INFOR]: Toltal norm before transform: 0.6088
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.2131

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 23ms/step
[INFOR]: SEN training of class 48_34 before transform: 13
[INFOR]: SPE training of class 48_34 before transform: 22

[INFOR]: SEN training of class 48_34 after transform: 30
[INFOR]: SPE training of class 48_34 after transform: 22
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
3/3 [==============================] - 0s 31ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :13.0


[INFOR]: Index of second most vote     :811
[INFOR]: Class of second most vote     :space heater
[INFOR]: Number of second most vote    :8.0
[INFOR]: SEN testing of class 48_33 before transform: 13
[INFOR]: SPE testing of class 48_33 before transform: 21

[INFOR]: SEN testing of class 48_33 after transform: 31
[INFOR]: SPE testing of class 48_33 after transform: 3
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name ResNet50  --model_shape 224 224 --dataset_name fgvc_aircraft --class_name_train 49_33 --class_name_test 49_34
2021-09-13 08:48:10.314979: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  ResNet50
dataset_name =  fgvc_aircraft
class_name_train =  49_33
class_name_test =  49_34
data_shape =  (32, 32, 3)
model_shape =  [224, 224]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
[INFOR]: get pretrained model
2021-09-13 08:48:12.997046: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 08:48:13.023817: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 08:48:13.028860: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 08:48:13.036965: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:48:13.039260: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:48:13.044442: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 08:48:13.048684: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 08:48:13.055149: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 08:48:13.060272: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 08:48:13.063333: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:48:13.065569: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 08:48:13.067455: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 08:48:13.079495: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1f4baa8f8b0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 08:48:13.082552: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 08:48:13.084634: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 08:48:13.089297: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 08:48:13.091477: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:48:13.093841: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:48:13.096083: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 08:48:13.098670: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 08:48:13.101122: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 08:48:13.103427: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 08:48:13.105762: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:48:13.108048: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 08:48:13.599039: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 08:48:13.602141: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 08:48:13.603536: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 08:48:13.605060: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 08:48:13.611845: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1f4e9075db0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 08:48:13.614683: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 08:48:15.249365: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 08:48:15.738951: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:48:16.404923: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:48:16.411008: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:48:17.732272: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 08:48:17.779756: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 08:48:18.092482: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 3s 102ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :13.0


[INFOR]: Index of second most vote     :682
[INFOR]: Class of second most vote     :obelisk
[INFOR]: Number of second most vote    :4.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 23ms/step
[INFOR]: Toltal norm before transform: 0.6033
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.2178

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 23ms/step
[INFOR]: SEN training of class 49_33 before transform: 13
[INFOR]: SPE training of class 49_33 before transform: 22

[INFOR]: SEN training of class 49_33 after transform: 32
[INFOR]: SPE training of class 49_33 after transform: 22
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (68, 32, 32, 3)
[INFOR]: shape of y: (68, 1)
3/3 [==============================] - 0s 23ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :13.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :6.0
[INFOR]: SEN testing of class 49_34 before transform: 13
[INFOR]: SPE testing of class 49_34 before transform: 22

[INFOR]: SEN testing of class 49_34 after transform: 34
[INFOR]: SPE testing of class 49_34 after transform: 1
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name ResNet50  --model_shape 224 224 --dataset_name fgvc_aircraft --class_name_train 50_34 --class_name_test 50_33
2021-09-13 08:48:21.320587: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  ResNet50
dataset_name =  fgvc_aircraft
class_name_train =  50_34
class_name_test =  50_33
data_shape =  (32, 32, 3)
model_shape =  [224, 224]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (68, 32, 32, 3)
[INFOR]: shape of y: (68, 1)
[INFOR]: get pretrained model
2021-09-13 08:48:23.804010: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 08:48:23.829927: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 08:48:23.835037: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 08:48:23.843177: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:48:23.845402: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:48:23.850570: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 08:48:23.854417: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 08:48:23.860750: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 08:48:23.865972: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 08:48:23.869153: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:48:23.871360: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 08:48:23.873267: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 08:48:23.885221: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x260376abfa0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 08:48:23.888528: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 08:48:23.890631: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 08:48:23.895081: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 08:48:23.897320: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:48:23.899786: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:48:23.902013: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 08:48:23.904231: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 08:48:23.906536: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 08:48:23.908831: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 08:48:23.911053: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:48:23.913386: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 08:48:24.345702: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 08:48:24.348987: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 08:48:24.350384: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 08:48:24.351929: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 08:48:24.358563: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x260670b7b90 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 08:48:24.361434: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 08:48:25.986533: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 08:48:26.472140: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:48:27.110954: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:48:27.117693: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:48:28.441652: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 08:48:28.491922: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 08:48:28.801964: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 3s 112ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :15.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :7.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 23ms/step
[INFOR]: Toltal norm before transform: 0.5602
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0977

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 31ms/step
[INFOR]: SEN training of class 50_34 before transform: 15
[INFOR]: SPE training of class 50_34 before transform: 22

[INFOR]: SEN training of class 50_34 after transform: 31
[INFOR]: SPE training of class 50_34 after transform: 22
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
3/3 [==============================] - 0s 32ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :10.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :7.0
[INFOR]: SEN testing of class 50_33 before transform: 10
[INFOR]: SPE testing of class 50_33 before transform: 22

[INFOR]: SEN testing of class 50_33 after transform: 31
[INFOR]: SPE testing of class 50_33 after transform: 2
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name ResNet50  --model_shape 224 224 --dataset_name fgvc_aircraft --class_name_train 51_33 --class_name_test 51_33
2021-09-13 08:48:32.095583: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  ResNet50
dataset_name =  fgvc_aircraft
class_name_train =  51_33
class_name_test =  51_33
data_shape =  (32, 32, 3)
model_shape =  [224, 224]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
[INFOR]: get pretrained model
2021-09-13 08:48:34.668733: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 08:48:34.695310: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 08:48:34.700592: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 08:48:34.709366: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:48:34.711580: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:48:34.716920: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 08:48:34.720384: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 08:48:34.726637: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 08:48:34.731559: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 08:48:34.734779: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:48:34.736965: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 08:48:34.738871: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 08:48:34.751461: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x225b6fb3b60 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 08:48:34.754837: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 08:48:34.757005: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 08:48:34.761289: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 08:48:34.763490: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:48:34.765980: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:48:34.768258: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 08:48:34.770512: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 08:48:34.772734: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 08:48:34.775009: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 08:48:34.777272: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:48:34.779756: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 08:48:35.214318: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 08:48:35.217209: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 08:48:35.218731: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 08:48:35.220290: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 08:48:35.226979: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x225e5e17e20 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 08:48:35.229822: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 08:48:36.853646: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 08:48:37.356422: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:48:38.002914: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:48:38.008972: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:48:39.352750: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 08:48:39.401791: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 08:48:39.713501: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 3s 102ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :10.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :6.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 23ms/step
[INFOR]: Toltal norm before transform: 0.6866
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0381

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 23ms/step
[INFOR]: SEN training of class 51_33 before transform: 10
[INFOR]: SPE training of class 51_33 before transform: 24

[INFOR]: SEN training of class 51_33 after transform: 31
[INFOR]: SPE training of class 51_33 after transform: 24
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
3/3 [==============================] - 0s 23ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :12.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :9.0
[INFOR]: SEN testing of class 51_33 before transform: 12
[INFOR]: SPE testing of class 51_33 before transform: 20

[INFOR]: SEN testing of class 51_33 after transform: 33
[INFOR]: SPE testing of class 51_33 after transform: 0
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name ResNet50  --model_shape 224 224 --dataset_name fgvc_aircraft --class_name_train 52_33 --class_name_test 52_33
2021-09-13 08:48:42.830752: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  ResNet50
dataset_name =  fgvc_aircraft
class_name_train =  52_33
class_name_test =  52_33
data_shape =  (32, 32, 3)
model_shape =  [224, 224]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
[INFOR]: get pretrained model
2021-09-13 08:48:45.331457: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 08:48:45.357322: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 08:48:45.362416: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 08:48:45.370353: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:48:45.372554: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:48:45.377794: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 08:48:45.381334: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 08:48:45.387658: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 08:48:45.392895: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 08:48:45.395866: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:48:45.398404: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 08:48:45.400308: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 08:48:45.412447: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x18ab6f74ae0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 08:48:45.415673: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 08:48:45.417786: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 08:48:45.422196: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 08:48:45.424400: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:48:45.426611: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:48:45.428979: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 08:48:45.431232: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 08:48:45.433457: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 08:48:45.435672: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 08:48:45.437958: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:48:45.440334: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 08:48:45.867322: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 08:48:45.870668: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 08:48:45.872065: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 08:48:45.873618: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 08:48:45.880125: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x18ae24f01b0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 08:48:45.882964: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 08:48:47.500476: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 08:48:47.994044: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:48:48.638444: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:48:48.644644: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:48:49.962871: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 08:48:50.013287: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 08:48:50.324011: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 3s 103ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :11.0


[INFOR]: Index of second most vote     :431
[INFOR]: Class of second most vote     :bassinet
[INFOR]: Number of second most vote    :4.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 23ms/step
[INFOR]: Toltal norm before transform: 0.6447
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.3505

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 31ms/step
[INFOR]: SEN training of class 52_33 before transform: 11
[INFOR]: SPE training of class 52_33 before transform: 24

[INFOR]: SEN training of class 52_33 after transform: 28
[INFOR]: SPE training of class 52_33 after transform: 24
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
3/3 [==============================] - 0s 24ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :13.0


[INFOR]: Index of second most vote     :811
[INFOR]: Class of second most vote     :space heater
[INFOR]: Number of second most vote    :5.0
[INFOR]: SEN testing of class 52_33 before transform: 13
[INFOR]: SPE testing of class 52_33 before transform: 22

[INFOR]: SEN testing of class 52_33 after transform: 32
[INFOR]: SPE testing of class 52_33 after transform: 3
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name ResNet50  --model_shape 224 224 --dataset_name fgvc_aircraft --class_name_train 53_33 --class_name_test 53_34
2021-09-13 08:48:53.405569: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  ResNet50
dataset_name =  fgvc_aircraft
class_name_train =  53_33
class_name_test =  53_34
data_shape =  (32, 32, 3)
model_shape =  [224, 224]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
[INFOR]: get pretrained model
2021-09-13 08:48:55.893339: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 08:48:55.916585: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 08:48:55.921667: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 08:48:55.929710: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:48:55.931920: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:48:55.937188: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 08:48:55.940593: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 08:48:55.947004: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 08:48:55.952223: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 08:48:55.955197: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:48:55.957502: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 08:48:55.959414: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 08:48:55.971438: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1e5b931e600 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 08:48:55.974944: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 08:48:55.977082: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 08:48:55.981389: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 08:48:55.983822: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:48:55.986035: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:48:55.988375: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 08:48:55.990820: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 08:48:55.993026: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 08:48:55.995375: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 08:48:55.997603: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:48:55.999777: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 08:48:56.421705: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 08:48:56.425367: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 08:48:56.426759: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 08:48:56.428287: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 08:48:56.434871: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1e5e45cb960 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 08:48:56.437848: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 08:48:58.044177: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 08:48:58.536869: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:48:59.193145: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:48:59.199526: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:49:00.520289: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 08:49:00.569255: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 08:49:00.888888: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 3s 109ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :10.0


[INFOR]: Index of second most vote     :407
[INFOR]: Class of second most vote     :ambulance
[INFOR]: Number of second most vote    :4.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 23ms/step
[INFOR]: Toltal norm before transform: 0.6741
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0638

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 23ms/step
[INFOR]: SEN training of class 53_33 before transform: 10
[INFOR]: SPE training of class 53_33 before transform: 18

[INFOR]: SEN training of class 53_33 after transform: 31
[INFOR]: SPE training of class 53_33 after transform: 18
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (68, 32, 32, 3)
[INFOR]: shape of y: (68, 1)
3/3 [==============================] - 0s 23ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :6.0


[INFOR]: Index of second most vote     :407
[INFOR]: Class of second most vote     :ambulance
[INFOR]: Number of second most vote    :5.0
[INFOR]: SEN testing of class 53_34 before transform: 6
[INFOR]: SPE testing of class 53_34 before transform: 21

[INFOR]: SEN testing of class 53_34 after transform: 33
[INFOR]: SPE testing of class 53_34 after transform: 5
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name ResNet50  --model_shape 224 224 --dataset_name fgvc_aircraft --class_name_train 54_34 --class_name_test 54_33
2021-09-13 08:49:04.167436: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  ResNet50
dataset_name =  fgvc_aircraft
class_name_train =  54_34
class_name_test =  54_33
data_shape =  (32, 32, 3)
model_shape =  [224, 224]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (68, 32, 32, 3)
[INFOR]: shape of y: (68, 1)
[INFOR]: get pretrained model
2021-09-13 08:49:06.694259: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 08:49:06.717527: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 08:49:06.722155: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 08:49:06.730119: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:49:06.732342: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:49:06.737506: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 08:49:06.740885: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 08:49:06.747135: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 08:49:06.752565: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 08:49:06.755740: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:49:06.757928: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 08:49:06.760117: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 08:49:06.772632: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x21339416860 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 08:49:06.776100: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 08:49:06.778196: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 08:49:06.782540: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 08:49:06.784728: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:49:06.786952: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:49:06.789173: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 08:49:06.791461: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 08:49:06.793654: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 08:49:06.795877: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 08:49:06.798415: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:49:06.800597: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 08:49:07.246083: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 08:49:07.249290: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 08:49:07.250808: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 08:49:07.252348: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 08:49:07.258955: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x21368b46f20 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 08:49:07.261770: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 08:49:08.892311: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 08:49:09.395574: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:49:10.050171: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:49:10.056553: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:49:11.387382: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 08:49:11.437744: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 08:49:11.752699: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 3s 109ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :11.0


[INFOR]: Index of second most vote     :682
[INFOR]: Class of second most vote     :obelisk
[INFOR]: Number of second most vote    :5.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 24ms/step
[INFOR]: Toltal norm before transform: 0.6819
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0865

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 23ms/step
[INFOR]: SEN training of class 54_34 before transform: 11
[INFOR]: SPE training of class 54_34 before transform: 16

[INFOR]: SEN training of class 54_34 after transform: 30
[INFOR]: SPE training of class 54_34 after transform: 16
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
3/3 [==============================] - 0s 23ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :10.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :4.0
[INFOR]: SEN testing of class 54_33 before transform: 10
[INFOR]: SPE testing of class 54_33 before transform: 21

[INFOR]: SEN testing of class 54_33 after transform: 25
[INFOR]: SPE testing of class 54_33 after transform: 6
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name ResNet50  --model_shape 224 224 --dataset_name fgvc_aircraft --class_name_train 55_33 --class_name_test 55_33
2021-09-13 08:49:15.042436: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  ResNet50
dataset_name =  fgvc_aircraft
class_name_train =  55_33
class_name_test =  55_33
data_shape =  (32, 32, 3)
model_shape =  [224, 224]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
[INFOR]: get pretrained model
2021-09-13 08:49:17.490706: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 08:49:17.515068: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 08:49:17.520092: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 08:49:17.528042: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:49:17.530431: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:49:17.535876: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 08:49:17.539469: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 08:49:17.546017: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 08:49:17.551200: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 08:49:17.554380: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:49:17.556777: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 08:49:17.559085: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 08:49:17.571783: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1aa3369e120 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 08:49:17.575479: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 08:49:17.577635: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 08:49:17.582357: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 08:49:17.584771: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:49:17.587157: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:49:17.589685: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 08:49:17.592008: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 08:49:17.594361: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 08:49:17.596731: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 08:49:17.599164: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:49:17.601493: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 08:49:18.025566: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 08:49:18.028670: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 08:49:18.030158: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 08:49:18.031718: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 08:49:18.038276: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1aa62ab39b0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 08:49:18.041120: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 08:49:19.642496: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 08:49:20.136180: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:49:20.778466: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:49:20.784181: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:49:22.105513: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 08:49:22.156185: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 08:49:22.465858: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 3s 110ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :8.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :7.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 31ms/step
[INFOR]: Toltal norm before transform: 0.7371
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1191

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 23ms/step
[INFOR]: SEN training of class 55_33 before transform: 8
[INFOR]: SPE training of class 55_33 before transform: 20

[INFOR]: SEN training of class 55_33 after transform: 28
[INFOR]: SPE training of class 55_33 after transform: 20
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
3/3 [==============================] - 0s 23ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :11.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :4.0
[INFOR]: SEN testing of class 55_33 before transform: 11
[INFOR]: SPE testing of class 55_33 before transform: 19

[INFOR]: SEN testing of class 55_33 after transform: 29
[INFOR]: SPE testing of class 55_33 after transform: 0
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name ResNet50  --model_shape 224 224 --dataset_name fgvc_aircraft --class_name_train 56_33 --class_name_test 56_34
2021-09-13 08:49:25.561605: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  ResNet50
dataset_name =  fgvc_aircraft
class_name_train =  56_33
class_name_test =  56_34
data_shape =  (32, 32, 3)
model_shape =  [224, 224]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
[INFOR]: get pretrained model
2021-09-13 08:49:28.136629: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 08:49:28.160867: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 08:49:28.165564: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 08:49:28.173752: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:49:28.175929: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:49:28.181123: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 08:49:28.184508: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 08:49:28.190842: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 08:49:28.195745: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 08:49:28.198860: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:49:28.201032: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 08:49:28.202925: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 08:49:28.215220: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x2cb34f37e80 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 08:49:28.218533: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 08:49:28.220774: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 08:49:28.225610: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 08:49:28.227814: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:49:28.230198: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:49:28.232446: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 08:49:28.234799: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 08:49:28.237228: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 08:49:28.239540: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 08:49:28.241839: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:49:28.244041: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 08:49:28.665903: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 08:49:28.669003: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 08:49:28.670400: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 08:49:28.671953: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 08:49:28.678924: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x2cb64b5e430 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 08:49:28.681764: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 08:49:30.307196: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 08:49:30.804733: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:49:31.455174: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:49:31.461996: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:49:32.801281: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 08:49:32.850440: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 08:49:33.159305: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 3s 102ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :9.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :7.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 23ms/step
[INFOR]: Toltal norm before transform: 0.7290
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.2715

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 23ms/step
[INFOR]: SEN training of class 56_33 before transform: 9
[INFOR]: SPE training of class 56_33 before transform: 22

[INFOR]: SEN training of class 56_33 after transform: 27
[INFOR]: SPE training of class 56_33 after transform: 22
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (68, 32, 32, 3)
[INFOR]: shape of y: (68, 1)
3/3 [==============================] - 0s 24ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :12.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :11.0
[INFOR]: SEN testing of class 56_34 before transform: 12
[INFOR]: SPE testing of class 56_34 before transform: 15

[INFOR]: SEN testing of class 56_34 after transform: 32
[INFOR]: SPE testing of class 56_34 after transform: 2
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name ResNet50  --model_shape 224 224 --dataset_name fgvc_aircraft --class_name_train 57_34 --class_name_test 57_33
2021-09-13 08:49:36.397515: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  ResNet50
dataset_name =  fgvc_aircraft
class_name_train =  57_34
class_name_test =  57_33
data_shape =  (32, 32, 3)
model_shape =  [224, 224]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (68, 32, 32, 3)
[INFOR]: shape of y: (68, 1)
[INFOR]: get pretrained model
2021-09-13 08:49:38.891242: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 08:49:38.915389: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 08:49:38.920566: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 08:49:38.928745: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:49:38.930966: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:49:38.936263: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 08:49:38.939707: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 08:49:38.946312: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 08:49:38.951376: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 08:49:38.954378: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:49:38.956796: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 08:49:38.958694: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 08:49:38.970851: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x17134099060 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 08:49:38.974180: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 08:49:38.976401: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 08:49:38.980874: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 08:49:38.983112: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:49:38.985366: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:49:38.987855: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 08:49:38.990055: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 08:49:38.992332: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 08:49:38.994578: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 08:49:38.996889: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:49:38.999292: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 08:49:39.421323: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 08:49:39.424654: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 08:49:39.426049: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 08:49:39.427576: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 08:49:39.434619: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x171630ff660 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 08:49:39.437484: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 08:49:41.049202: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 08:49:41.540762: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:49:42.186906: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:49:42.193278: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:49:43.519109: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 08:49:43.569758: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 08:49:43.884065: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 3s 114ms/step
[INFOR]: Index of most vote   :856
[INFOR]: Class of most vote   :thresher, thrasher, threshing machine
[INFOR]: Number of most vote  :6.0


[INFOR]: Index of second most vote     :550
[INFOR]: Class of second most vote     :espresso maker
[INFOR]: Number of second most vote    :5.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 28ms/step
[INFOR]: Toltal norm before transform: 0.7936
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.2489

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 24ms/step
[INFOR]: SEN training of class 57_34 before transform: 6
[INFOR]: SPE training of class 57_34 before transform: 34

[INFOR]: SEN training of class 57_34 after transform: 33
[INFOR]: SPE training of class 57_34 after transform: 31
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
3/3 [==============================] - 0s 23ms/step
[INFOR]: Index of most vote   :550
[INFOR]: Class of most vote   :espresso maker
[INFOR]: Number of most vote  :7.0


[INFOR]: Index of second most vote     :510
[INFOR]: Class of second most vote     :container ship, containership, container vessel
[INFOR]: Number of second most vote    :6.0
[INFOR]: SEN testing of class 57_33 before transform: 7
[INFOR]: SPE testing of class 57_33 before transform: 33

[INFOR]: SEN testing of class 57_33 after transform: 33
[INFOR]: SPE testing of class 57_33 after transform: 4
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name ResNet50  --model_shape 224 224 --dataset_name fgvc_aircraft --class_name_train 58_33 --class_name_test 58_33
2021-09-13 08:49:47.176389: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  ResNet50
dataset_name =  fgvc_aircraft
class_name_train =  58_33
class_name_test =  58_33
data_shape =  (32, 32, 3)
model_shape =  [224, 224]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
[INFOR]: get pretrained model
2021-09-13 08:49:49.673096: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 08:49:49.697080: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 08:49:49.702211: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 08:49:49.710253: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:49:49.712398: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:49:49.717498: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 08:49:49.721002: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 08:49:49.727566: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 08:49:49.732712: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 08:49:49.735630: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:49:49.737912: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 08:49:49.739774: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 08:49:49.751848: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1fcb3a662e0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 08:49:49.755328: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 08:49:49.757464: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 08:49:49.761790: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 08:49:49.764226: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:49:49.766441: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:49:49.768801: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 08:49:49.771218: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 08:49:49.773449: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 08:49:49.775981: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 08:49:49.778250: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:49:49.780512: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 08:49:50.202094: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 08:49:50.205392: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 08:49:50.206786: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 08:49:50.208471: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 08:49:50.215675: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1fce2592010 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 08:49:50.218558: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 08:49:51.816607: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 08:49:52.315170: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:49:52.960263: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:49:52.965935: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:49:54.290410: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 08:49:54.340924: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 08:49:54.648976: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 3s 110ms/step
[INFOR]: Index of most vote   :408
[INFOR]: Class of most vote   :amphibian, amphibious vehicle
[INFOR]: Number of most vote  :8.0


[INFOR]: Index of second most vote     :404
[INFOR]: Class of second most vote     :airliner
[INFOR]: Number of second most vote    :7.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 31ms/step
[INFOR]: Toltal norm before transform: 0.7294
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0476

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 23ms/step
[INFOR]: SEN training of class 58_33 before transform: 8
[INFOR]: SPE training of class 58_33 before transform: 33

[INFOR]: SEN training of class 58_33 after transform: 33
[INFOR]: SPE training of class 58_33 after transform: 33
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
3/3 [==============================] - 0s 23ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :7.0


[INFOR]: Index of second most vote     :407
[INFOR]: Class of second most vote     :ambulance
[INFOR]: Number of second most vote    :4.0
[INFOR]: SEN testing of class 58_33 before transform: 7
[INFOR]: SPE testing of class 58_33 before transform: 21

[INFOR]: SEN testing of class 58_33 after transform: 33
[INFOR]: SPE testing of class 58_33 after transform: 0
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name ResNet50  --model_shape 224 224 --dataset_name fgvc_aircraft --class_name_train 59_33 --class_name_test 59_34
2021-09-13 08:49:57.737088: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  ResNet50
dataset_name =  fgvc_aircraft
class_name_train =  59_33
class_name_test =  59_34
data_shape =  (32, 32, 3)
model_shape =  [224, 224]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
[INFOR]: get pretrained model
2021-09-13 08:50:00.282794: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 08:50:00.307527: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 08:50:00.312662: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 08:50:00.320644: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:50:00.322958: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:50:00.328101: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 08:50:00.331456: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 08:50:00.337879: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 08:50:00.342823: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 08:50:00.345850: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:50:00.348003: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 08:50:00.349892: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 08:50:00.361753: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x26db4c8f5b0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 08:50:00.364909: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 08:50:00.366955: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 08:50:00.371245: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 08:50:00.373634: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:50:00.375796: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:50:00.378105: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 08:50:00.380272: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 08:50:00.382474: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 08:50:00.384881: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 08:50:00.387303: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:50:00.389530: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 08:50:00.814143: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 08:50:00.817247: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 08:50:00.818784: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 08:50:00.820306: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 08:50:00.827071: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x26de5000fb0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 08:50:00.830055: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 08:50:02.472502: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 08:50:02.972409: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:50:03.633357: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:50:03.640308: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:50:04.971848: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 08:50:05.023213: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 08:50:05.332394: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 3s 103ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :4.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :4.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 31ms/step
[INFOR]: Toltal norm before transform: 0.8554
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.2098

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 31ms/step
[INFOR]: SEN training of class 59_33 before transform: 4
[INFOR]: SPE training of class 59_33 before transform: 17

[INFOR]: SEN training of class 59_33 after transform: 30
[INFOR]: SPE training of class 59_33 after transform: 17
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (68, 32, 32, 3)
[INFOR]: shape of y: (68, 1)
3/3 [==============================] - 0s 23ms/step
[INFOR]: Index of most vote   :795
[INFOR]: Class of most vote   :ski
[INFOR]: Number of most vote  :6.0


[INFOR]: Index of second most vote     :683
[INFOR]: Class of second most vote     :oboe, hautboy, hautbois
[INFOR]: Number of second most vote    :5.0
[INFOR]: SEN testing of class 59_34 before transform: 6
[INFOR]: SPE testing of class 59_34 before transform: 34

[INFOR]: SEN testing of class 59_34 after transform: 30
[INFOR]: SPE testing of class 59_34 after transform: 7
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name ResNet50  --model_shape 224 224 --dataset_name fgvc_aircraft --class_name_train 60_34 --class_name_test 60_33
2021-09-13 08:50:08.598140: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  ResNet50
dataset_name =  fgvc_aircraft
class_name_train =  60_34
class_name_test =  60_33
data_shape =  (32, 32, 3)
model_shape =  [224, 224]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (68, 32, 32, 3)
[INFOR]: shape of y: (68, 1)
[INFOR]: get pretrained model
2021-09-13 08:50:11.082010: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 08:50:11.110468: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 08:50:11.114966: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 08:50:11.122933: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:50:11.125108: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:50:11.130316: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 08:50:11.133685: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 08:50:11.139873: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 08:50:11.144947: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 08:50:11.147896: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:50:11.150259: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 08:50:11.152137: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 08:50:11.163963: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x218b3255f60 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 08:50:11.167245: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 08:50:11.169359: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 08:50:11.173662: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 08:50:11.175991: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:50:11.178205: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:50:11.180423: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 08:50:11.182769: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 08:50:11.185024: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 08:50:11.187288: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 08:50:11.189492: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:50:11.191968: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 08:50:11.616993: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 08:50:11.620190: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 08:50:11.621586: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 08:50:11.623118: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 08:50:11.629989: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x218e2034e80 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 08:50:11.633192: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 08:50:13.238146: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 08:50:13.729514: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:50:14.370269: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:50:14.376380: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:50:15.723894: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 08:50:15.771974: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 08:50:16.084095: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 3s 109ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :7.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :5.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 23ms/step
[INFOR]: Toltal norm before transform: 0.7968
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0027

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 23ms/step
[INFOR]: SEN training of class 60_34 before transform: 7
[INFOR]: SPE training of class 60_34 before transform: 18

[INFOR]: SEN training of class 60_34 after transform: 29
[INFOR]: SPE training of class 60_34 after transform: 18
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
3/3 [==============================] - 0s 23ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :7.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :6.0
[INFOR]: SEN testing of class 60_33 before transform: 7
[INFOR]: SPE testing of class 60_33 before transform: 15

[INFOR]: SEN testing of class 60_33 after transform: 31
[INFOR]: SPE testing of class 60_33 after transform: 1
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name ResNet50  --model_shape 224 224 --dataset_name fgvc_aircraft --class_name_train 61_33 --class_name_test 61_33
2021-09-13 08:50:19.355889: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  ResNet50
dataset_name =  fgvc_aircraft
class_name_train =  61_33
class_name_test =  61_33
data_shape =  (32, 32, 3)
model_shape =  [224, 224]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
[INFOR]: get pretrained model
2021-09-13 08:50:21.909580: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 08:50:21.935309: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 08:50:21.939729: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 08:50:21.947686: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:50:21.949934: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:50:21.955125: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 08:50:21.958578: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 08:50:21.964902: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 08:50:21.969762: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 08:50:21.972680: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:50:21.975333: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 08:50:21.977382: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 08:50:21.989752: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x13a350006a0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 08:50:21.992993: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 08:50:21.995241: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 08:50:21.999744: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 08:50:22.002088: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:50:22.004421: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:50:22.006805: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 08:50:22.009083: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 08:50:22.011457: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 08:50:22.013799: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 08:50:22.016194: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:50:22.018433: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 08:50:22.441771: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 08:50:22.444995: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 08:50:22.446428: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 08:50:22.447982: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 08:50:22.454671: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x13a64868c60 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 08:50:22.457485: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 08:50:24.089938: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 08:50:24.584596: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:50:25.227069: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:50:25.233245: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:50:26.555772: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 08:50:26.605409: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 08:50:26.917107: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 3s 102ms/step
[INFOR]: Index of most vote   :510
[INFOR]: Class of most vote   :container ship, containership, container vessel
[INFOR]: Number of most vote  :11.0


[INFOR]: Index of second most vote     :404
[INFOR]: Class of second most vote     :airliner
[INFOR]: Number of second most vote    :9.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 23ms/step
[INFOR]: Toltal norm before transform: 0.6725
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0613

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 23ms/step
[INFOR]: SEN training of class 61_33 before transform: 11
[INFOR]: SPE training of class 61_33 before transform: 25

[INFOR]: SEN training of class 61_33 after transform: 26
[INFOR]: SPE training of class 61_33 after transform: 24
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
3/3 [==============================] - 0s 23ms/step
[INFOR]: Index of most vote   :510
[INFOR]: Class of most vote   :container ship, containership, container vessel
[INFOR]: Number of most vote  :11.0


[INFOR]: Index of second most vote     :404
[INFOR]: Class of second most vote     :airliner
[INFOR]: Number of second most vote    :10.0
[INFOR]: SEN testing of class 61_33 before transform: 11
[INFOR]: SPE testing of class 61_33 before transform: 29

[INFOR]: SEN testing of class 61_33 after transform: 28
[INFOR]: SPE testing of class 61_33 after transform: 9
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name ResNet50  --model_shape 224 224 --dataset_name fgvc_aircraft --class_name_train 62_34 --class_name_test 62_33
2021-09-13 08:50:29.950835: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  ResNet50
dataset_name =  fgvc_aircraft
class_name_train =  62_34
class_name_test =  62_33
data_shape =  (32, 32, 3)
model_shape =  [224, 224]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (68, 32, 32, 3)
[INFOR]: shape of y: (68, 1)
[INFOR]: get pretrained model
2021-09-13 08:50:32.425096: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 08:50:32.448934: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 08:50:32.453703: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 08:50:32.461718: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:50:32.463883: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:50:32.469039: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 08:50:32.472621: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 08:50:32.478981: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 08:50:32.483893: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 08:50:32.486891: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:50:32.489037: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 08:50:32.491053: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 08:50:32.502941: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x2cfb38b5ec0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 08:50:32.506014: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 08:50:32.508119: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 08:50:32.512358: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 08:50:32.514549: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:50:32.516754: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:50:32.518951: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 08:50:32.521122: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 08:50:32.523507: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 08:50:32.525800: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 08:50:32.528129: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:50:32.530390: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 08:50:32.965814: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 08:50:32.968631: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 08:50:32.970030: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 08:50:32.971561: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 08:50:32.978377: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x2cfdee835f0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 08:50:32.981323: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 08:50:34.596059: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 08:50:35.085858: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:50:35.734843: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:50:35.741033: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:50:37.071820: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 08:50:37.122007: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 08:50:37.449876: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 3s 110ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :7.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :7.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 32ms/step
[INFOR]: Toltal norm before transform: 0.7801
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0460

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 23ms/step
[INFOR]: SEN training of class 62_34 before transform: 7
[INFOR]: SPE training of class 62_34 before transform: 24

[INFOR]: SEN training of class 62_34 after transform: 31
[INFOR]: SPE training of class 62_34 after transform: 24
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
3/3 [==============================] - 0s 24ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :10.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :5.0
[INFOR]: SEN testing of class 62_33 before transform: 10
[INFOR]: SPE testing of class 62_33 before transform: 18

[INFOR]: SEN testing of class 62_33 after transform: 31
[INFOR]: SPE testing of class 62_33 after transform: 1
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name ResNet50  --model_shape 224 224 --dataset_name fgvc_aircraft --class_name_train 63_33 --class_name_test 63_34
2021-09-13 08:50:40.699614: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  ResNet50
dataset_name =  fgvc_aircraft
class_name_train =  63_33
class_name_test =  63_34
data_shape =  (32, 32, 3)
model_shape =  [224, 224]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
[INFOR]: get pretrained model
2021-09-13 08:50:43.264933: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 08:50:43.289741: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 08:50:43.294542: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 08:50:43.302675: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:50:43.304971: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:50:43.310181: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 08:50:43.313989: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 08:50:43.320384: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 08:50:43.325371: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 08:50:43.328375: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:50:43.331032: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 08:50:43.332953: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 08:50:43.345392: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x28439ba7e10 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 08:50:43.348816: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 08:50:43.351030: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 08:50:43.355509: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 08:50:43.357990: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:50:43.360391: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:50:43.362857: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 08:50:43.365250: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 08:50:43.367464: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 08:50:43.369761: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 08:50:43.372508: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:50:43.374715: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 08:50:43.806854: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 08:50:43.810182: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 08:50:43.811736: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 08:50:43.813396: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 08:50:43.820430: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x284687d3200 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 08:50:43.823408: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 08:50:45.479892: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 08:50:45.977226: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:50:46.617849: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:50:46.623603: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:50:47.946797: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 08:50:47.996788: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 08:50:48.305198: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 3s 108ms/step
[INFOR]: Index of most vote   :510
[INFOR]: Class of most vote   :container ship, containership, container vessel
[INFOR]: Number of most vote  :10.0


[INFOR]: Index of second most vote     :870
[INFOR]: Class of second most vote     :tricycle, trike, velocipede
[INFOR]: Number of second most vote    :6.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 23ms/step
[INFOR]: Toltal norm before transform: 0.7282
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.2746

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 23ms/step
[INFOR]: SEN training of class 63_33 before transform: 10
[INFOR]: SPE training of class 63_33 before transform: 26

[INFOR]: SEN training of class 63_33 after transform: 30
[INFOR]: SPE training of class 63_33 after transform: 24
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (68, 32, 32, 3)
[INFOR]: shape of y: (68, 1)
3/3 [==============================] - 0s 31ms/step
[INFOR]: Index of most vote   :510
[INFOR]: Class of most vote   :container ship, containership, container vessel
[INFOR]: Number of most vote  :7.0


[INFOR]: Index of second most vote     :870
[INFOR]: Class of second most vote     :tricycle, trike, velocipede
[INFOR]: Number of second most vote    :7.0
[INFOR]: SEN testing of class 63_34 before transform: 7
[INFOR]: SPE testing of class 63_34 before transform: 22

[INFOR]: SEN testing of class 63_34 after transform: 34
[INFOR]: SPE testing of class 63_34 after transform: 1
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name ResNet50  --model_shape 224 224 --dataset_name fgvc_aircraft --class_name_train 64_33 --class_name_test 64_33
2021-09-13 08:50:51.612568: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  ResNet50
dataset_name =  fgvc_aircraft
class_name_train =  64_33
class_name_test =  64_33
data_shape =  (32, 32, 3)
model_shape =  [224, 224]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
[INFOR]: get pretrained model
2021-09-13 08:50:54.167651: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 08:50:54.197311: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 08:50:54.202704: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 08:50:54.210608: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:50:54.212679: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:50:54.217774: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 08:50:54.221084: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 08:50:54.227384: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 08:50:54.232339: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 08:50:54.235220: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:50:54.237505: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 08:50:54.239336: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 08:50:54.251298: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x16fb34104e0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 08:50:54.254899: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 08:50:54.256839: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 08:50:54.261104: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 08:50:54.263348: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:50:54.265417: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:50:54.267541: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 08:50:54.269775: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 08:50:54.271817: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 08:50:54.273894: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 08:50:54.276039: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:50:54.278465: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 08:50:54.729053: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 08:50:54.731703: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 08:50:54.733053: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 08:50:54.734623: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 08:50:54.741323: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x16fd81a93b0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 08:50:54.744103: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 08:50:56.439119: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 08:50:56.956106: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:50:57.603637: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:50:57.609142: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:50:58.997469: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 08:50:59.047442: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 08:50:59.380162: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 3s 110ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :22.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :9.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 23ms/step
[INFOR]: Toltal norm before transform: 0.3392
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0684

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 31ms/step
[INFOR]: SEN training of class 64_33 before transform: 22
[INFOR]: SPE training of class 64_33 before transform: 21

[INFOR]: SEN training of class 64_33 after transform: 26
[INFOR]: SPE training of class 64_33 after transform: 21
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
3/3 [==============================] - 0s 23ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :14.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :3.0
[INFOR]: SEN testing of class 64_33 before transform: 14
[INFOR]: SPE testing of class 64_33 before transform: 19

[INFOR]: SEN testing of class 64_33 after transform: 32
[INFOR]: SPE testing of class 64_33 after transform: 3
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name ResNet50  --model_shape 224 224 --dataset_name fgvc_aircraft --class_name_train 65_33 --class_name_test 65_34
2021-09-13 08:51:02.470008: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  ResNet50
dataset_name =  fgvc_aircraft
class_name_train =  65_33
class_name_test =  65_34
data_shape =  (32, 32, 3)
model_shape =  [224, 224]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
[INFOR]: get pretrained model
2021-09-13 08:51:04.977525: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 08:51:05.001078: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 08:51:05.005467: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 08:51:05.013669: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:51:05.015865: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:51:05.020973: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 08:51:05.024426: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 08:51:05.030714: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 08:51:05.035387: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 08:51:05.038222: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:51:05.040513: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 08:51:05.042570: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 08:51:05.055456: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x2143644fea0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 08:51:05.059042: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 08:51:05.061192: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 08:51:05.065280: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 08:51:05.067332: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:51:05.069386: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:51:05.071445: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 08:51:05.073948: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 08:51:05.076566: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 08:51:05.078812: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 08:51:05.081098: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:51:05.083300: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 08:51:05.510270: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 08:51:05.513495: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 08:51:05.514848: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 08:51:05.516320: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 08:51:05.522847: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x2145fccc700 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 08:51:05.525602: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 08:51:07.130665: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 08:51:07.611083: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:51:08.255987: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:51:08.261598: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:51:09.580294: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 08:51:09.630347: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 08:51:09.941727: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 3s 109ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :15.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :3.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 31ms/step
[INFOR]: Toltal norm before transform: 0.4750
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0769

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 23ms/step
[INFOR]: SEN training of class 65_33 before transform: 15
[INFOR]: SPE training of class 65_33 before transform: 20

[INFOR]: SEN training of class 65_33 after transform: 32
[INFOR]: SPE training of class 65_33 after transform: 20
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (68, 32, 32, 3)
[INFOR]: shape of y: (68, 1)
3/3 [==============================] - 0s 31ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :20.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :6.0
[INFOR]: SEN testing of class 65_34 before transform: 20
[INFOR]: SPE testing of class 65_34 before transform: 17

[INFOR]: SEN testing of class 65_34 after transform: 34
[INFOR]: SPE testing of class 65_34 after transform: 0
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name ResNet50  --model_shape 224 224 --dataset_name fgvc_aircraft --class_name_train 66_34 --class_name_test 66_33
2021-09-13 08:51:13.227138: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  ResNet50
dataset_name =  fgvc_aircraft
class_name_train =  66_34
class_name_test =  66_33
data_shape =  (32, 32, 3)
model_shape =  [224, 224]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (68, 32, 32, 3)
[INFOR]: shape of y: (68, 1)
[INFOR]: get pretrained model
2021-09-13 08:51:15.752999: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 08:51:15.777068: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 08:51:15.781437: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 08:51:15.789216: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:51:15.791272: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:51:15.796177: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 08:51:15.799419: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 08:51:15.805524: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 08:51:15.810247: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 08:51:15.813027: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:51:15.815083: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 08:51:15.816897: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 08:51:15.829137: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1a038135700 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 08:51:15.832746: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 08:51:15.834793: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 08:51:15.838838: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 08:51:15.840937: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:51:15.843050: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:51:15.845317: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 08:51:15.847340: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 08:51:15.849476: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 08:51:15.851541: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 08:51:15.853697: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:51:15.855762: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 08:51:16.283062: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 08:51:16.286304: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 08:51:16.287848: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 08:51:16.289464: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 08:51:16.296037: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1a067014870 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 08:51:16.298791: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 08:51:17.899191: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 08:51:18.386865: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:51:19.031445: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:51:19.038024: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:51:20.357639: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 08:51:20.405963: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 08:51:20.713216: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 3s 110ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :15.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :6.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 23ms/step
[INFOR]: Toltal norm before transform: 0.4784
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0659

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 23ms/step
[INFOR]: SEN training of class 66_34 before transform: 15
[INFOR]: SPE training of class 66_34 before transform: 13

[INFOR]: SEN training of class 66_34 after transform: 32
[INFOR]: SPE training of class 66_34 after transform: 13
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
3/3 [==============================] - 0s 23ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :15.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :10.0
[INFOR]: SEN testing of class 66_33 before transform: 15
[INFOR]: SPE testing of class 66_33 before transform: 23

[INFOR]: SEN testing of class 66_33 after transform: 33
[INFOR]: SPE testing of class 66_33 after transform: 2
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name ResNet50  --model_shape 224 224 --dataset_name fgvc_aircraft --class_name_train 67_33 --class_name_test 67_33
2021-09-13 08:51:23.941717: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  ResNet50
dataset_name =  fgvc_aircraft
class_name_train =  67_33
class_name_test =  67_33
data_shape =  (32, 32, 3)
model_shape =  [224, 224]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
[INFOR]: get pretrained model
2021-09-13 08:51:26.447974: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 08:51:26.473550: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 08:51:26.479620: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 08:51:26.487320: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:51:26.489361: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:51:26.494263: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 08:51:26.497712: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 08:51:26.503619: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 08:51:26.508358: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 08:51:26.511179: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:51:26.513549: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 08:51:26.515380: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 08:51:26.527933: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x215383b48f0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 08:51:26.531265: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 08:51:26.533234: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 08:51:26.537291: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 08:51:26.539351: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:51:26.541403: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:51:26.544250: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 08:51:26.546246: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 08:51:26.548255: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 08:51:26.550292: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 08:51:26.552374: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:51:26.554554: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 08:51:26.997866: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 08:51:27.001005: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 08:51:27.002333: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 08:51:27.003765: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 08:51:27.010414: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x2156704dd20 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 08:51:27.013407: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 08:51:28.687822: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 08:51:29.187001: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:51:29.861310: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:51:29.867125: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:51:31.276431: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 08:51:31.330679: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 08:51:31.648084: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 3s 107ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :10.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :9.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 31ms/step
[INFOR]: Toltal norm before transform: 0.6331
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1126

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 31ms/step
[INFOR]: SEN training of class 67_33 before transform: 10
[INFOR]: SPE training of class 67_33 before transform: 17

[INFOR]: SEN training of class 67_33 after transform: 31
[INFOR]: SPE training of class 67_33 after transform: 17
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
3/3 [==============================] - 0s 23ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :20.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :3.0
[INFOR]: SEN testing of class 67_33 before transform: 20
[INFOR]: SPE testing of class 67_33 before transform: 20

[INFOR]: SEN testing of class 67_33 after transform: 32
[INFOR]: SPE testing of class 67_33 after transform: 2
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name ResNet50  --model_shape 224 224 --dataset_name fgvc_aircraft --class_name_train 68_33 --class_name_test 68_33
2021-09-13 08:51:34.701648: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  ResNet50
dataset_name =  fgvc_aircraft
class_name_train =  68_33
class_name_test =  68_33
data_shape =  (32, 32, 3)
model_shape =  [224, 224]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
[INFOR]: get pretrained model
2021-09-13 08:51:37.183031: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 08:51:37.207760: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 08:51:37.212043: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 08:51:37.219799: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:51:37.221864: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:51:37.226720: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 08:51:37.229922: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 08:51:37.236254: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 08:51:37.241157: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 08:51:37.243928: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:51:37.245967: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 08:51:37.247952: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 08:51:37.260254: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1acb72de3d0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 08:51:37.263901: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 08:51:37.265914: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 08:51:37.270108: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 08:51:37.272251: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:51:37.274287: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:51:37.276502: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 08:51:37.278642: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 08:51:37.280864: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 08:51:37.283183: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 08:51:37.285242: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:51:37.287297: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 08:51:37.707336: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 08:51:37.710189: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 08:51:37.711519: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 08:51:37.712993: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 08:51:37.719288: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1ace0eb1870 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 08:51:37.722212: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 08:51:39.350139: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 08:51:39.852048: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:51:40.494109: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:51:40.499681: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:51:41.820941: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 08:51:41.870036: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 08:51:42.182852: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 3s 110ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :14.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :6.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 23ms/step
[INFOR]: Toltal norm before transform: 0.5571
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1083

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 31ms/step
[INFOR]: SEN training of class 68_33 before transform: 14
[INFOR]: SPE training of class 68_33 before transform: 23

[INFOR]: SEN training of class 68_33 after transform: 30
[INFOR]: SPE training of class 68_33 after transform: 23
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
3/3 [==============================] - 0s 23ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :17.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :5.0
[INFOR]: SEN testing of class 68_33 before transform: 17
[INFOR]: SPE testing of class 68_33 before transform: 16

[INFOR]: SEN testing of class 68_33 after transform: 30
[INFOR]: SPE testing of class 68_33 after transform: 1
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name ResNet50  --model_shape 224 224 --dataset_name fgvc_aircraft --class_name_train 69_33 --class_name_test 69_34
2021-09-13 08:51:45.285301: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  ResNet50
dataset_name =  fgvc_aircraft
class_name_train =  69_33
class_name_test =  69_34
data_shape =  (32, 32, 3)
model_shape =  [224, 224]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
[INFOR]: get pretrained model
2021-09-13 08:51:47.780709: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 08:51:47.805690: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 08:51:47.810059: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 08:51:47.817804: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:51:47.819852: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:51:47.824793: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 08:51:47.827980: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 08:51:47.834071: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 08:51:47.838896: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 08:51:47.841847: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:51:47.843888: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 08:51:47.846679: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 08:51:47.859376: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1213504f000 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 08:51:47.862548: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 08:51:47.864688: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 08:51:47.869250: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 08:51:47.871550: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:51:47.873784: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:51:47.876326: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 08:51:47.878582: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 08:51:47.880849: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 08:51:47.883594: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 08:51:47.885834: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:51:47.888101: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 08:51:48.330810: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 08:51:48.334161: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 08:51:48.335657: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 08:51:48.337218: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 08:51:48.343825: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x12162f92c60 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 08:51:48.347153: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 08:51:49.962515: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 08:51:50.459661: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:51:51.117984: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:51:51.123637: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:51:52.454045: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 08:51:52.509738: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 08:51:52.819664: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 3s 102ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :11.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :8.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 23ms/step
[INFOR]: Toltal norm before transform: 0.6556
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.2309

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 23ms/step
[INFOR]: SEN training of class 69_33 before transform: 11
[INFOR]: SPE training of class 69_33 before transform: 18

[INFOR]: SEN training of class 69_33 after transform: 27
[INFOR]: SPE training of class 69_33 after transform: 18
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (68, 32, 32, 3)
[INFOR]: shape of y: (68, 1)
3/3 [==============================] - 0s 23ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :15.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :5.0
[INFOR]: SEN testing of class 69_34 before transform: 15
[INFOR]: SPE testing of class 69_34 before transform: 20

[INFOR]: SEN testing of class 69_34 after transform: 31
[INFOR]: SPE testing of class 69_34 after transform: 3
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name ResNet50  --model_shape 224 224 --dataset_name fgvc_aircraft --class_name_train 70_34 --class_name_test 70_33
2021-09-13 08:51:56.081473: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  ResNet50
dataset_name =  fgvc_aircraft
class_name_train =  70_34
class_name_test =  70_33
data_shape =  (32, 32, 3)
model_shape =  [224, 224]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (68, 32, 32, 3)
[INFOR]: shape of y: (68, 1)
[INFOR]: get pretrained model
2021-09-13 08:51:58.578824: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 08:51:58.603189: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 08:51:58.607533: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 08:51:58.615419: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:51:58.617484: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:51:58.622385: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 08:51:58.625629: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 08:51:58.631815: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 08:51:58.636578: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 08:51:58.639431: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:51:58.641670: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 08:51:58.643740: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 08:51:58.655748: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x22eb673c5d0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 08:51:58.659502: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 08:51:58.661442: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 08:51:58.665517: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 08:51:58.667596: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:51:58.669636: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:51:58.671708: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 08:51:58.673736: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 08:51:58.675934: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 08:51:58.678112: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 08:51:58.680387: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:51:58.682420: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 08:51:59.108399: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 08:51:59.111730: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 08:51:59.113109: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 08:51:59.114563: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 08:51:59.120981: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x22ee4826060 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 08:51:59.123747: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 08:52:00.752591: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 08:52:01.243667: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:52:01.885526: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:52:01.891453: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:52:03.231070: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 08:52:03.279351: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 08:52:03.590670: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 3s 109ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :11.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :7.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 23ms/step
[INFOR]: Toltal norm before transform: 0.6863
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0226

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 23ms/step
[INFOR]: SEN training of class 70_34 before transform: 11
[INFOR]: SPE training of class 70_34 before transform: 22

[INFOR]: SEN training of class 70_34 after transform: 29
[INFOR]: SPE training of class 70_34 after transform: 22
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
3/3 [==============================] - 0s 23ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :12.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :6.0
[INFOR]: SEN testing of class 70_33 before transform: 12
[INFOR]: SPE testing of class 70_33 before transform: 20

[INFOR]: SEN testing of class 70_33 after transform: 33
[INFOR]: SPE testing of class 70_33 after transform: 1
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name ResNet50  --model_shape 224 224 --dataset_name fgvc_aircraft --class_name_train 71_33 --class_name_test 71_34
2021-09-13 08:52:06.859501: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  ResNet50
dataset_name =  fgvc_aircraft
class_name_train =  71_33
class_name_test =  71_34
data_shape =  (32, 32, 3)
model_shape =  [224, 224]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
[INFOR]: get pretrained model
2021-09-13 08:52:09.384959: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 08:52:09.407760: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 08:52:09.413755: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 08:52:09.421649: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:52:09.423727: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:52:09.428733: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 08:52:09.431947: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 08:52:09.438210: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 08:52:09.443004: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 08:52:09.445949: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:52:09.447980: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 08:52:09.450015: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 08:52:09.462169: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x217b58af060 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 08:52:09.465617: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 08:52:09.467604: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 08:52:09.471723: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 08:52:09.473849: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:52:09.476098: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:52:09.478156: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 08:52:09.480173: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 08:52:09.482328: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 08:52:09.484448: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 08:52:09.486516: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:52:09.488596: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 08:52:09.906613: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 08:52:09.909808: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 08:52:09.911180: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 08:52:09.912626: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 08:52:09.919330: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x217e4335ec0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 08:52:09.922428: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 08:52:11.552409: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 08:52:12.047809: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:52:12.693673: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:52:12.699427: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:52:14.016215: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 08:52:14.065458: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 08:52:14.380105: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 3s 110ms/step
[INFOR]: Index of most vote   :510
[INFOR]: Class of most vote   :container ship, containership, container vessel
[INFOR]: Number of most vote  :9.0


[INFOR]: Index of second most vote     :404
[INFOR]: Class of second most vote     :airliner
[INFOR]: Number of second most vote    :8.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 25ms/step
[INFOR]: Toltal norm before transform: 0.7302
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1338

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 23ms/step
[INFOR]: SEN training of class 71_33 before transform: 9
[INFOR]: SPE training of class 71_33 before transform: 31

[INFOR]: SEN training of class 71_33 after transform: 32
[INFOR]: SPE training of class 71_33 after transform: 29
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (68, 32, 32, 3)
[INFOR]: shape of y: (68, 1)
3/3 [==============================] - 0s 23ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :13.0


[INFOR]: Index of second most vote     :811
[INFOR]: Class of second most vote     :space heater
[INFOR]: Number of second most vote    :8.0
[INFOR]: SEN testing of class 71_34 before transform: 13
[INFOR]: SPE testing of class 71_34 before transform: 22

[INFOR]: SEN testing of class 71_34 after transform: 34
[INFOR]: SPE testing of class 71_34 after transform: 2
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name ResNet50  --model_shape 224 224 --dataset_name fgvc_aircraft --class_name_train 72_33 --class_name_test 72_33
2021-09-13 08:52:17.599974: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  ResNet50
dataset_name =  fgvc_aircraft
class_name_train =  72_33
class_name_test =  72_33
data_shape =  (32, 32, 3)
model_shape =  [224, 224]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
[INFOR]: get pretrained model
2021-09-13 08:52:20.060065: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 08:52:20.084151: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 08:52:20.089119: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 08:52:20.097060: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:52:20.099246: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:52:20.104424: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 08:52:20.107773: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 08:52:20.114590: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 08:52:20.119552: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 08:52:20.122477: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:52:20.124642: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 08:52:20.126784: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 08:52:20.138761: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x25133774af0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 08:52:20.141823: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 08:52:20.143846: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 08:52:20.148170: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 08:52:20.150264: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:52:20.152370: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:52:20.154476: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 08:52:20.156536: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 08:52:20.158704: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 08:52:20.160841: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 08:52:20.163055: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:52:20.165325: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 08:52:20.587616: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 08:52:20.590206: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 08:52:20.591661: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 08:52:20.593257: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 08:52:20.600229: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x2515de04270 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 08:52:20.603006: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 08:52:22.204860: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 08:52:22.688818: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:52:23.329053: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:52:23.334785: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:52:24.655269: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 08:52:24.700810: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 08:52:25.009548: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 3s 111ms/step
[INFOR]: Index of most vote   :510
[INFOR]: Class of most vote   :container ship, containership, container vessel
[INFOR]: Number of most vote  :11.0


[INFOR]: Index of second most vote     :404
[INFOR]: Class of second most vote     :airliner
[INFOR]: Number of second most vote    :9.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 23ms/step
[INFOR]: Toltal norm before transform: 0.6737
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1460

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 23ms/step
[INFOR]: SEN training of class 72_33 before transform: 11
[INFOR]: SPE training of class 72_33 before transform: 28

[INFOR]: SEN training of class 72_33 after transform: 33
[INFOR]: SPE training of class 72_33 after transform: 28
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
3/3 [==============================] - 0s 23ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :7.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :5.0
[INFOR]: SEN testing of class 72_33 before transform: 7
[INFOR]: SPE testing of class 72_33 before transform: 12

[INFOR]: SEN testing of class 72_33 after transform: 33
[INFOR]: SPE testing of class 72_33 after transform: 0
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name ResNet50  --model_shape 224 224 --dataset_name fgvc_aircraft --class_name_train 73_34 --class_name_test 73_33
2021-09-13 08:52:28.048070: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  ResNet50
dataset_name =  fgvc_aircraft
class_name_train =  73_34
class_name_test =  73_33
data_shape =  (32, 32, 3)
model_shape =  [224, 224]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (68, 32, 32, 3)
[INFOR]: shape of y: (68, 1)
[INFOR]: get pretrained model
2021-09-13 08:52:30.586441: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 08:52:30.613258: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 08:52:30.618364: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 08:52:30.626371: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:52:30.628387: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:52:30.633279: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 08:52:30.636626: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 08:52:30.642597: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 08:52:30.647495: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 08:52:30.650246: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:52:30.652440: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 08:52:30.654232: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 08:52:30.666476: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x139b51aa9f0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 08:52:30.669998: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 08:52:30.672124: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 08:52:30.676452: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 08:52:30.678734: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:52:30.680784: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:52:30.683092: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 08:52:30.685127: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 08:52:30.687137: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 08:52:30.689320: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 08:52:30.691423: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:52:30.693526: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 08:52:31.113427: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 08:52:31.116699: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 08:52:31.118024: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 08:52:31.119471: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 08:52:31.126186: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x139e54dec70 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 08:52:31.128918: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 08:52:32.754166: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 08:52:33.242193: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:52:33.882134: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:52:33.887959: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:52:35.206407: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 08:52:35.256115: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 08:52:35.565109: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 3s 110ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :11.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :10.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 23ms/step
[INFOR]: Toltal norm before transform: 0.6762
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0863

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 31ms/step
[INFOR]: SEN training of class 73_34 before transform: 11
[INFOR]: SPE training of class 73_34 before transform: 24

[INFOR]: SEN training of class 73_34 after transform: 33
[INFOR]: SPE training of class 73_34 after transform: 24
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
3/3 [==============================] - 0s 31ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :11.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :10.0
[INFOR]: SEN testing of class 73_33 before transform: 11
[INFOR]: SPE testing of class 73_33 before transform: 16

[INFOR]: SEN testing of class 73_33 after transform: 33
[INFOR]: SPE testing of class 73_33 after transform: 1
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name ResNet50  --model_shape 224 224 --dataset_name fgvc_aircraft --class_name_train 74_33 --class_name_test 74_34
2021-09-13 08:52:38.828484: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  ResNet50
dataset_name =  fgvc_aircraft
class_name_train =  74_33
class_name_test =  74_34
data_shape =  (32, 32, 3)
model_shape =  [224, 224]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
[INFOR]: get pretrained model
2021-09-13 08:52:41.311244: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 08:52:41.335753: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 08:52:41.341632: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 08:52:41.349399: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:52:41.351491: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:52:41.356508: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 08:52:41.359855: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 08:52:41.366196: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 08:52:41.370909: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 08:52:41.373675: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:52:41.375736: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 08:52:41.377790: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 08:52:41.389674: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x24637fa0940 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 08:52:41.393344: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 08:52:41.395268: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 08:52:41.399254: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 08:52:41.401323: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:52:41.403357: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:52:41.405465: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 08:52:41.407677: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 08:52:41.409835: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 08:52:41.412013: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 08:52:41.414261: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:52:41.416284: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 08:52:41.842742: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 08:52:41.846043: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 08:52:41.847398: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 08:52:41.848864: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 08:52:41.855375: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x24666e7bae0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 08:52:41.858092: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 08:52:43.455957: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 08:52:43.942979: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:52:44.587955: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:52:44.593673: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:52:45.959005: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 08:52:46.008476: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 08:52:46.321110: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 3s 103ms/step
[INFOR]: Index of most vote   :812
[INFOR]: Class of most vote   :space shuttle
[INFOR]: Number of most vote  :14.0


[INFOR]: Index of second most vote     :404
[INFOR]: Class of second most vote     :airliner
[INFOR]: Number of second most vote    :10.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 23ms/step
[INFOR]: Toltal norm before transform: 0.5760
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0692

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 23ms/step
[INFOR]: SEN training of class 74_33 before transform: 14
[INFOR]: SPE training of class 74_33 before transform: 30

[INFOR]: SEN training of class 74_33 after transform: 26
[INFOR]: SPE training of class 74_33 after transform: 26
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (68, 32, 32, 3)
[INFOR]: shape of y: (68, 1)
3/3 [==============================] - 0s 31ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :21.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :5.0
[INFOR]: SEN testing of class 74_34 before transform: 21
[INFOR]: SPE testing of class 74_34 before transform: 26

[INFOR]: SEN testing of class 74_34 after transform: 32
[INFOR]: SPE testing of class 74_34 after transform: 0
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name ResNet50  --model_shape 224 224 --dataset_name fgvc_aircraft --class_name_train 75_34 --class_name_test 75_33
2021-09-13 08:52:49.583076: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  ResNet50
dataset_name =  fgvc_aircraft
class_name_train =  75_34
class_name_test =  75_33
data_shape =  (32, 32, 3)
model_shape =  [224, 224]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (68, 32, 32, 3)
[INFOR]: shape of y: (68, 1)
[INFOR]: get pretrained model
2021-09-13 08:52:52.129646: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 08:52:52.155322: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 08:52:52.160358: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 08:52:52.168256: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:52:52.170403: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:52:52.175487: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 08:52:52.178812: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 08:52:52.185019: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 08:52:52.189989: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 08:52:52.193031: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:52:52.195188: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 08:52:52.197067: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 08:52:52.208945: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1e23956ba70 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 08:52:52.211828: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 08:52:52.213827: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 08:52:52.218250: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 08:52:52.220540: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:52:52.222781: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:52:52.224912: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 08:52:52.227137: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 08:52:52.229190: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 08:52:52.231341: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 08:52:52.233437: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:52:52.235488: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 08:52:52.659498: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 08:52:52.662451: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 08:52:52.663749: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 08:52:52.665159: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 08:52:52.671608: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1e263176fa0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 08:52:52.674323: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 08:52:54.281839: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 08:52:54.765145: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:52:55.404467: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:52:55.411330: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:52:56.747591: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 08:52:56.797355: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 08:52:57.106897: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 3s 109ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :18.0


[INFOR]: Index of second most vote     :811
[INFOR]: Class of second most vote     :space heater
[INFOR]: Number of second most vote    :6.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 31ms/step
[INFOR]: Toltal norm before transform: 0.4131
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0299

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 23ms/step
[INFOR]: SEN training of class 75_34 before transform: 18
[INFOR]: SPE training of class 75_34 before transform: 23

[INFOR]: SEN training of class 75_34 after transform: 32
[INFOR]: SPE training of class 75_34 after transform: 23
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
3/3 [==============================] - 0s 28ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :19.0


[INFOR]: Index of second most vote     :811
[INFOR]: Class of second most vote     :space heater
[INFOR]: Number of second most vote    :7.0
[INFOR]: SEN testing of class 75_33 before transform: 19
[INFOR]: SPE testing of class 75_33 before transform: 26

[INFOR]: SEN testing of class 75_33 after transform: 33
[INFOR]: SPE testing of class 75_33 after transform: 0
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name ResNet50  --model_shape 224 224 --dataset_name fgvc_aircraft --class_name_train 76_33 --class_name_test 76_33
2021-09-13 08:53:00.361512: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  ResNet50
dataset_name =  fgvc_aircraft
class_name_train =  76_33
class_name_test =  76_33
data_shape =  (32, 32, 3)
model_shape =  [224, 224]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
[INFOR]: get pretrained model
2021-09-13 08:53:02.889063: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 08:53:02.913144: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 08:53:02.917439: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 08:53:02.925423: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:53:02.927470: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:53:02.932395: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 08:53:02.935654: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 08:53:02.941813: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 08:53:02.946556: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 08:53:02.949454: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:53:02.951699: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 08:53:02.953648: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 08:53:02.965615: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x17933fd4960 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 08:53:02.969215: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 08:53:02.971206: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 08:53:02.975210: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 08:53:02.977334: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:53:02.979569: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:53:02.981625: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 08:53:02.983646: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 08:53:02.985751: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 08:53:02.987992: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 08:53:02.990142: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:53:02.992392: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 08:53:03.413098: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 08:53:03.416238: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 08:53:03.417684: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 08:53:03.419240: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 08:53:03.425958: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1795db3be70 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 08:53:03.428700: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 08:53:05.062755: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 08:53:05.562805: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:53:06.204687: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:53:06.209833: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:53:07.525111: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 08:53:07.576199: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 08:53:07.890505: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 3s 109ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :19.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :6.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 23ms/step
[INFOR]: Toltal norm before transform: 0.3595
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0282

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 23ms/step
[INFOR]: SEN training of class 76_33 before transform: 19
[INFOR]: SPE training of class 76_33 before transform: 20

[INFOR]: SEN training of class 76_33 after transform: 32
[INFOR]: SPE training of class 76_33 after transform: 20
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
3/3 [==============================] - 0s 31ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :12.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :6.0
[INFOR]: SEN testing of class 76_33 before transform: 12
[INFOR]: SPE testing of class 76_33 before transform: 19

[INFOR]: SEN testing of class 76_33 after transform: 30
[INFOR]: SPE testing of class 76_33 after transform: 3
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name ResNet50  --model_shape 224 224 --dataset_name fgvc_aircraft --class_name_train 77_33 --class_name_test 77_34
2021-09-13 08:53:10.966190: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  ResNet50
dataset_name =  fgvc_aircraft
class_name_train =  77_33
class_name_test =  77_34
data_shape =  (32, 32, 3)
model_shape =  [224, 224]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
[INFOR]: get pretrained model
2021-09-13 08:53:13.431746: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 08:53:13.456317: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 08:53:13.461567: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 08:53:13.469515: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:53:13.471697: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:53:13.476769: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 08:53:13.480121: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 08:53:13.486393: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 08:53:13.491354: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 08:53:13.494327: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:53:13.496372: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 08:53:13.498181: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 08:53:13.510301: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1ba3a534090 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 08:53:13.514046: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 08:53:13.516215: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 08:53:13.520310: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 08:53:13.522528: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:53:13.524568: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:53:13.526684: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 08:53:13.528911: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 08:53:13.530947: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 08:53:13.533081: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 08:53:13.535154: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:53:13.537404: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 08:53:13.954116: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 08:53:13.957295: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 08:53:13.958648: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 08:53:13.960077: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 08:53:13.966642: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1ba65d48640 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 08:53:13.969367: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 08:53:15.566098: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 08:53:16.048816: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:53:16.720737: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:53:16.726902: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:53:18.057672: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 08:53:18.107243: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 08:53:18.417631: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 3s 105ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :12.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :10.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 23ms/step
[INFOR]: Toltal norm before transform: 0.6160
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1219

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 24ms/step
[INFOR]: SEN training of class 77_33 before transform: 12
[INFOR]: SPE training of class 77_33 before transform: 18

[INFOR]: SEN training of class 77_33 after transform: 31
[INFOR]: SPE training of class 77_33 after transform: 18
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (68, 32, 32, 3)
[INFOR]: shape of y: (68, 1)
3/3 [==============================] - 0s 23ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :9.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :7.0
[INFOR]: SEN testing of class 77_34 before transform: 9
[INFOR]: SPE testing of class 77_34 before transform: 17

[INFOR]: SEN testing of class 77_34 after transform: 33
[INFOR]: SPE testing of class 77_34 after transform: 0
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name ResNet50  --model_shape 224 224 --dataset_name fgvc_aircraft --class_name_train 78_34 --class_name_test 78_33
2021-09-13 08:53:21.667742: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  ResNet50
dataset_name =  fgvc_aircraft
class_name_train =  78_34
class_name_test =  78_33
data_shape =  (32, 32, 3)
model_shape =  [224, 224]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (68, 32, 32, 3)
[INFOR]: shape of y: (68, 1)
[INFOR]: get pretrained model
2021-09-13 08:53:24.144933: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 08:53:24.168373: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 08:53:24.172504: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 08:53:24.180265: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:53:24.182299: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:53:24.187204: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 08:53:24.190579: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 08:53:24.196717: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 08:53:24.201447: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 08:53:24.204230: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:53:24.206261: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 08:53:24.208057: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 08:53:24.220364: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x18eb464bb20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 08:53:24.223629: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 08:53:24.225974: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 08:53:24.231046: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 08:53:24.233244: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:53:24.235410: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:53:24.237559: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 08:53:24.239664: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 08:53:24.242030: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 08:53:24.244242: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 08:53:24.246439: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:53:24.248743: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 08:53:24.684508: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 08:53:24.686792: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 08:53:24.688330: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 08:53:24.689929: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 08:53:24.696600: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x18ee2c46480 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 08:53:24.699341: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 08:53:26.307585: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 08:53:26.790790: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:53:27.433749: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:53:27.440179: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:53:28.766693: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 08:53:28.815319: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 08:53:29.128890: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 3s 102ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :16.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :10.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 23ms/step
[INFOR]: Toltal norm before transform: 0.4985
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1489

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 32ms/step
[INFOR]: SEN training of class 78_34 before transform: 16
[INFOR]: SPE training of class 78_34 before transform: 20

[INFOR]: SEN training of class 78_34 after transform: 32
[INFOR]: SPE training of class 78_34 after transform: 20
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
3/3 [==============================] - 0s 28ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :15.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :8.0
[INFOR]: SEN testing of class 78_33 before transform: 15
[INFOR]: SPE testing of class 78_33 before transform: 20

[INFOR]: SEN testing of class 78_33 after transform: 32
[INFOR]: SPE testing of class 78_33 after transform: 0
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name ResNet50  --model_shape 224 224 --dataset_name fgvc_aircraft --class_name_train 79_33 --class_name_test 79_33
2021-09-13 08:53:32.387366: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  ResNet50
dataset_name =  fgvc_aircraft
class_name_train =  79_33
class_name_test =  79_33
data_shape =  (32, 32, 3)
model_shape =  [224, 224]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
[INFOR]: get pretrained model
2021-09-13 08:53:34.908751: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 08:53:34.933001: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 08:53:34.938795: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 08:53:34.946759: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:53:34.948841: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:53:34.953747: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 08:53:34.956967: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 08:53:34.962971: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 08:53:34.967762: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 08:53:34.971088: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:53:34.973111: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 08:53:34.975007: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 08:53:34.987165: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x21a351ea7b0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 08:53:34.990385: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 08:53:34.992343: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 08:53:34.996432: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 08:53:34.998571: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:53:35.000705: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:53:35.002992: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 08:53:35.005234: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 08:53:35.007304: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 08:53:35.009399: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 08:53:35.011559: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:53:35.013620: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 08:53:35.444422: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 08:53:35.446760: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 08:53:35.448200: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 08:53:35.449901: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 08:53:35.456535: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x21a6571caa0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 08:53:35.459793: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 08:53:37.146528: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 08:53:37.652813: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:53:38.330893: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:53:38.336854: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:53:39.706798: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 08:53:39.756544: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 08:53:40.093565: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 3s 109ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :17.0


[INFOR]: Index of second most vote     :811
[INFOR]: Class of second most vote     :space heater
[INFOR]: Number of second most vote    :7.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 24ms/step
[INFOR]: Toltal norm before transform: 0.3993
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0054

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 23ms/step
[INFOR]: SEN training of class 79_33 before transform: 17
[INFOR]: SPE training of class 79_33 before transform: 16

[INFOR]: SEN training of class 79_33 after transform: 31
[INFOR]: SPE training of class 79_33 after transform: 16
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
3/3 [==============================] - 0s 23ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :20.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :7.0
[INFOR]: SEN testing of class 79_33 before transform: 20
[INFOR]: SPE testing of class 79_33 before transform: 17

[INFOR]: SEN testing of class 79_33 after transform: 31
[INFOR]: SPE testing of class 79_33 after transform: 3
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name ResNet50  --model_shape 224 224 --dataset_name fgvc_aircraft --class_name_train 80_33 --class_name_test 80_34
2021-09-13 08:53:43.212416: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  ResNet50
dataset_name =  fgvc_aircraft
class_name_train =  80_33
class_name_test =  80_34
data_shape =  (32, 32, 3)
model_shape =  [224, 224]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
[INFOR]: get pretrained model
2021-09-13 08:53:45.757209: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 08:53:45.781409: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 08:53:45.786398: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 08:53:45.794219: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:53:45.796335: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:53:45.801533: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 08:53:45.804799: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 08:53:45.810868: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 08:53:45.815685: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 08:53:45.818494: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:53:45.820572: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 08:53:45.822409: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 08:53:45.834356: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x22f33610640 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 08:53:45.837507: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 08:53:45.839643: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 08:53:45.843699: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 08:53:45.845781: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:53:45.847895: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:53:45.850148: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 08:53:45.852170: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 08:53:45.854386: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 08:53:45.856450: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 08:53:45.858551: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:53:45.860561: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 08:53:46.289356: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 08:53:46.292400: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 08:53:46.294336: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 08:53:46.295844: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 08:53:46.302264: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x22f6319d8c0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 08:53:46.305097: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 08:53:47.911102: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 08:53:48.400178: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:53:49.050734: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:53:49.056721: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:53:50.393754: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 08:53:50.442873: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 08:53:50.789861: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 3s 109ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :17.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :10.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 23ms/step
[INFOR]: Toltal norm before transform: 0.4723
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0773

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 23ms/step
[INFOR]: SEN training of class 80_33 before transform: 17
[INFOR]: SPE training of class 80_33 before transform: 22

[INFOR]: SEN training of class 80_33 after transform: 31
[INFOR]: SPE training of class 80_33 after transform: 22
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (68, 32, 32, 3)
[INFOR]: shape of y: (68, 1)
3/3 [==============================] - 0s 23ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :16.0


[INFOR]: Index of second most vote     :811
[INFOR]: Class of second most vote     :space heater
[INFOR]: Number of second most vote    :6.0
[INFOR]: SEN testing of class 80_34 before transform: 16
[INFOR]: SPE testing of class 80_34 before transform: 16

[INFOR]: SEN testing of class 80_34 after transform: 33
[INFOR]: SPE testing of class 80_34 after transform: 0
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name ResNet50  --model_shape 224 224 --dataset_name fgvc_aircraft --class_name_train 81_34 --class_name_test 81_33
2021-09-13 08:53:54.126036: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  ResNet50
dataset_name =  fgvc_aircraft
class_name_train =  81_34
class_name_test =  81_33
data_shape =  (32, 32, 3)
model_shape =  [224, 224]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (68, 32, 32, 3)
[INFOR]: shape of y: (68, 1)
[INFOR]: get pretrained model
2021-09-13 08:53:56.599629: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 08:53:56.626626: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 08:53:56.631389: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 08:53:56.639255: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:53:56.641446: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:53:56.646357: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 08:53:56.649643: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 08:53:56.655589: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 08:53:56.660258: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 08:53:56.663041: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:53:56.665232: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 08:53:56.667198: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 08:53:56.679580: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x20bb3059860 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 08:53:56.683180: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 08:53:56.685149: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 08:53:56.689300: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 08:53:56.691386: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:53:56.693457: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:53:56.695757: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 08:53:56.697869: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 08:53:56.699936: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 08:53:56.702028: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 08:53:56.704178: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:53:56.706435: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 08:53:57.129328: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 08:53:57.132067: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 08:53:57.133403: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 08:53:57.135046: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 08:53:57.141490: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x20be1a63a70 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 08:53:57.144219: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 08:53:58.768828: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 08:53:59.269151: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:53:59.920227: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:53:59.926011: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:54:01.291156: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 08:54:01.340427: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 08:54:01.659670: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 3s 109ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :17.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :6.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 23ms/step
[INFOR]: Toltal norm before transform: 0.4369
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0648

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 31ms/step
[INFOR]: SEN training of class 81_34 before transform: 17
[INFOR]: SPE training of class 81_34 before transform: 21

[INFOR]: SEN training of class 81_34 after transform: 27
[INFOR]: SPE training of class 81_34 after transform: 21
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
3/3 [==============================] - 0s 23ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :18.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :8.0
[INFOR]: SEN testing of class 81_33 before transform: 18
[INFOR]: SPE testing of class 81_33 before transform: 20

[INFOR]: SEN testing of class 81_33 after transform: 30
[INFOR]: SPE testing of class 81_33 after transform: 2
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name ResNet50  --model_shape 224 224 --dataset_name fgvc_aircraft --class_name_train 82_33 --class_name_test 82_33
2021-09-13 08:54:05.016499: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  ResNet50
dataset_name =  fgvc_aircraft
class_name_train =  82_33
class_name_test =  82_33
data_shape =  (32, 32, 3)
model_shape =  [224, 224]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
[INFOR]: get pretrained model
2021-09-13 08:54:07.552942: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 08:54:07.577854: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 08:54:07.583130: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 08:54:07.591153: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:54:07.593668: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:54:07.598794: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 08:54:07.602355: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 08:54:07.608419: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 08:54:07.613212: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 08:54:07.616018: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:54:07.618202: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 08:54:07.620248: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 08:54:07.632290: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x22c35d22a70 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 08:54:07.635801: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 08:54:07.637799: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 08:54:07.642159: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 08:54:07.644349: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:54:07.646463: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:54:07.648570: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 08:54:07.650745: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 08:54:07.652935: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 08:54:07.655238: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 08:54:07.657341: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:54:07.659413: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 08:54:08.078014: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 08:54:08.081399: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 08:54:08.082745: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 08:54:08.084166: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 08:54:08.090528: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x22c65ad9a70 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 08:54:08.093237: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 08:54:09.686681: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 08:54:10.170455: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:54:10.813735: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:54:10.819447: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:54:12.224518: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 08:54:12.273977: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 08:54:12.601831: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 3s 110ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :6.0


[INFOR]: Index of second most vote     :407
[INFOR]: Class of second most vote     :ambulance
[INFOR]: Number of second most vote    :6.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 24ms/step
[INFOR]: Toltal norm before transform: 0.7370
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1537

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 24ms/step
[INFOR]: SEN training of class 82_33 before transform: 6
[INFOR]: SPE training of class 82_33 before transform: 15

[INFOR]: SEN training of class 82_33 after transform: 33
[INFOR]: SPE training of class 82_33 after transform: 15
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
3/3 [==============================] - 0s 23ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :12.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :5.0
[INFOR]: SEN testing of class 82_33 before transform: 12
[INFOR]: SPE testing of class 82_33 before transform: 17

[INFOR]: SEN testing of class 82_33 after transform: 32
[INFOR]: SPE testing of class 82_33 after transform: 0
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name ResNet50  --model_shape 224 224 --dataset_name fgvc_aircraft --class_name_train 83_33 --class_name_test 83_34
2021-09-13 08:54:15.660438: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  ResNet50
dataset_name =  fgvc_aircraft
class_name_train =  83_33
class_name_test =  83_34
data_shape =  (32, 32, 3)
model_shape =  [224, 224]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
[INFOR]: get pretrained model
2021-09-13 08:54:18.121211: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 08:54:18.148498: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 08:54:18.152731: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 08:54:18.165100: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:54:18.167100: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:54:18.172234: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 08:54:18.175503: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 08:54:18.181563: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 08:54:18.186248: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 08:54:18.189259: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:54:18.191342: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 08:54:18.193183: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 08:54:18.204832: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x2c9b946bcf0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 08:54:18.208228: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 08:54:18.210342: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 08:54:18.215206: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 08:54:18.217343: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:54:18.220020: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:54:18.222164: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 08:54:18.224420: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 08:54:18.226545: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 08:54:18.228638: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 08:54:18.230838: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:54:18.233109: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 08:54:18.663148: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 08:54:18.666472: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 08:54:18.667841: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 08:54:18.669290: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 08:54:18.675719: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x2c9e80b30e0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 08:54:18.678627: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 08:54:20.283836: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 08:54:20.785115: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:54:21.429877: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:54:21.436005: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:54:22.759101: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 08:54:22.813088: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 08:54:23.122211: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 3s 105ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :14.0


[INFOR]: Index of second most vote     :811
[INFOR]: Class of second most vote     :space heater
[INFOR]: Number of second most vote    :8.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 23ms/step
[INFOR]: Toltal norm before transform: 0.6173
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1677

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 31ms/step
[INFOR]: SEN training of class 83_33 before transform: 14
[INFOR]: SPE training of class 83_33 before transform: 19

[INFOR]: SEN training of class 83_33 after transform: 33
[INFOR]: SPE training of class 83_33 after transform: 19
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (68, 32, 32, 3)
[INFOR]: shape of y: (68, 1)
3/3 [==============================] - 0s 31ms/step
[INFOR]: Index of most vote   :510
[INFOR]: Class of most vote   :container ship, containership, container vessel
[INFOR]: Number of most vote  :11.0


[INFOR]: Index of second most vote     :811
[INFOR]: Class of second most vote     :space heater
[INFOR]: Number of second most vote    :7.0
[INFOR]: SEN testing of class 83_34 before transform: 11
[INFOR]: SPE testing of class 83_34 before transform: 29

[INFOR]: SEN testing of class 83_34 after transform: 34
[INFOR]: SPE testing of class 83_34 after transform: 0
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name ResNet50  --model_shape 224 224 --dataset_name fgvc_aircraft --class_name_train 84_34 --class_name_test 84_33
2021-09-13 08:54:26.356120: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  ResNet50
dataset_name =  fgvc_aircraft
class_name_train =  84_34
class_name_test =  84_33
data_shape =  (32, 32, 3)
model_shape =  [224, 224]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (68, 32, 32, 3)
[INFOR]: shape of y: (68, 1)
[INFOR]: get pretrained model
2021-09-13 08:54:28.915893: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 08:54:28.942368: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 08:54:28.947085: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 08:54:28.955573: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:54:28.957727: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:54:28.962802: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 08:54:28.966005: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 08:54:28.972014: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 08:54:28.976777: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 08:54:28.979602: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:54:28.981644: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 08:54:28.983443: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 08:54:28.995668: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x149b3a208b0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 08:54:28.998945: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 08:54:29.000901: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 08:54:29.005135: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 08:54:29.007206: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:54:29.009268: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:54:29.011415: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 08:54:29.013517: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 08:54:29.015572: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 08:54:29.017701: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 08:54:29.020037: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:54:29.022078: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 08:54:29.452110: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 08:54:29.454927: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 08:54:29.456250: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 08:54:29.457866: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 08:54:29.464523: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x149df9ff170 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 08:54:29.467245: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 08:54:31.111076: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 08:54:31.606591: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:54:32.258866: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:54:32.265266: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:54:33.585993: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 08:54:33.641069: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 08:54:33.951629: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 3s 110ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :10.0


[INFOR]: Index of second most vote     :811
[INFOR]: Class of second most vote     :space heater
[INFOR]: Number of second most vote    :8.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 23ms/step
[INFOR]: Toltal norm before transform: 0.6914
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0950

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 31ms/step
[INFOR]: SEN training of class 84_34 before transform: 10
[INFOR]: SPE training of class 84_34 before transform: 23

[INFOR]: SEN training of class 84_34 after transform: 31
[INFOR]: SPE training of class 84_34 after transform: 23
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
3/3 [==============================] - 0s 23ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :16.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :4.0
[INFOR]: SEN testing of class 84_33 before transform: 16
[INFOR]: SPE testing of class 84_33 before transform: 17

[INFOR]: SEN testing of class 84_33 after transform: 33
[INFOR]: SPE testing of class 84_33 after transform: 1
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name ResNet50  --model_shape 224 224 --dataset_name fgvc_aircraft --class_name_train 85_33 --class_name_test 85_33
2021-09-13 08:54:37.223590: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  ResNet50
dataset_name =  fgvc_aircraft
class_name_train =  85_33
class_name_test =  85_33
data_shape =  (32, 32, 3)
model_shape =  [224, 224]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
[INFOR]: get pretrained model
2021-09-13 08:54:39.721293: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 08:54:39.747167: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 08:54:39.752148: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 08:54:39.760012: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:54:39.762267: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:54:39.767173: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 08:54:39.770509: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 08:54:39.776717: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 08:54:39.781387: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 08:54:39.784215: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:54:39.786517: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 08:54:39.788303: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 08:54:39.799853: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x288b3632b30 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 08:54:39.803026: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 08:54:39.805016: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 08:54:39.809121: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 08:54:39.811218: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:54:39.813292: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:54:39.815442: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 08:54:39.817864: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 08:54:39.819938: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 08:54:39.822048: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 08:54:39.824151: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:54:39.826215: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 08:54:40.259561: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 08:54:40.262369: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 08:54:40.263675: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 08:54:40.265103: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 08:54:40.271849: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x288e2b478f0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 08:54:40.274566: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 08:54:41.886742: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 08:54:42.372861: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:54:43.030347: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:54:43.035862: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:54:44.370320: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 08:54:44.418944: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 08:54:44.735120: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 3s 117ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :16.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :7.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 32ms/step
[INFOR]: Toltal norm before transform: 0.4547
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0991

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 23ms/step
[INFOR]: SEN training of class 85_33 before transform: 16
[INFOR]: SPE training of class 85_33 before transform: 14

[INFOR]: SEN training of class 85_33 after transform: 32
[INFOR]: SPE training of class 85_33 after transform: 14
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
3/3 [==============================] - 0s 23ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :17.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :4.0
[INFOR]: SEN testing of class 85_33 before transform: 17
[INFOR]: SPE testing of class 85_33 before transform: 17

[INFOR]: SEN testing of class 85_33 after transform: 33
[INFOR]: SPE testing of class 85_33 after transform: 0
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name ResNet50  --model_shape 224 224 --dataset_name fgvc_aircraft --class_name_train 86_33 --class_name_test 86_34
2021-09-13 08:54:47.854944: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  ResNet50
dataset_name =  fgvc_aircraft
class_name_train =  86_33
class_name_test =  86_34
data_shape =  (32, 32, 3)
model_shape =  [224, 224]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
[INFOR]: get pretrained model
2021-09-13 08:54:50.360203: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 08:54:50.385887: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 08:54:50.390350: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 08:54:50.398401: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:54:50.400631: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:54:50.405515: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 08:54:50.408786: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 08:54:50.414969: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 08:54:50.419893: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 08:54:50.422694: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:54:50.424825: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 08:54:50.426650: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 08:54:50.439061: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1df37979910 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 08:54:50.442529: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 08:54:50.444512: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 08:54:50.448784: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 08:54:50.450843: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:54:50.452890: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:54:50.454977: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 08:54:50.457232: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 08:54:50.459530: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 08:54:50.461593: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 08:54:50.463658: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:54:50.465681: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 08:54:50.898229: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 08:54:50.901436: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 08:54:50.902791: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 08:54:50.904210: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 08:54:50.910561: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1df6378e7b0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 08:54:50.913404: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 08:54:52.530279: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 08:54:53.019076: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:54:53.660627: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:54:53.666347: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:54:54.994663: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 08:54:55.043670: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 08:54:55.372615: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 3s 110ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :19.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :2.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 23ms/step
[INFOR]: Toltal norm before transform: 0.4001
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0953

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 23ms/step
[INFOR]: SEN training of class 86_33 before transform: 19
[INFOR]: SPE training of class 86_33 before transform: 24

[INFOR]: SEN training of class 86_33 after transform: 30
[INFOR]: SPE training of class 86_33 after transform: 24
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (68, 32, 32, 3)
[INFOR]: shape of y: (68, 1)
3/3 [==============================] - 0s 23ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :10.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :7.0
[INFOR]: SEN testing of class 86_34 before transform: 10
[INFOR]: SPE testing of class 86_34 before transform: 15

[INFOR]: SEN testing of class 86_34 after transform: 34
[INFOR]: SPE testing of class 86_34 after transform: 0
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name ResNet50  --model_shape 224 224 --dataset_name fgvc_aircraft --class_name_train 87_34 --class_name_test 87_33
2021-09-13 08:54:58.722463: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  ResNet50
dataset_name =  fgvc_aircraft
class_name_train =  87_34
class_name_test =  87_33
data_shape =  (32, 32, 3)
model_shape =  [224, 224]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (68, 32, 32, 3)
[INFOR]: shape of y: (68, 1)
[INFOR]: get pretrained model
2021-09-13 08:55:01.247435: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 08:55:01.271494: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 08:55:01.275966: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 08:55:01.283663: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:55:01.285817: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:55:01.290728: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 08:55:01.293983: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 08:55:01.300148: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 08:55:01.304936: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 08:55:01.307923: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:55:01.309997: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 08:55:01.311837: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 08:55:01.323998: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x2e032be44e0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 08:55:01.327462: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 08:55:01.329555: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 08:55:01.333802: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 08:55:01.335874: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:55:01.337940: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:55:01.340031: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 08:55:01.342077: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 08:55:01.344305: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 08:55:01.346453: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 08:55:01.348753: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:55:01.350804: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 08:55:01.773463: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 08:55:01.776147: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 08:55:01.777473: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 08:55:01.778928: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 08:55:01.785298: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x2e061243330 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 08:55:01.788268: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 08:55:03.407910: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 08:55:03.898853: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:55:04.544029: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:55:04.550589: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:55:05.866794: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 08:55:05.915391: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 08:55:06.231716: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 3s 109ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :18.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :4.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 23ms/step
[INFOR]: Toltal norm before transform: 0.4085
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1442

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 23ms/step
[INFOR]: SEN training of class 87_34 before transform: 18
[INFOR]: SPE training of class 87_34 before transform: 21

[INFOR]: SEN training of class 87_34 after transform: 33
[INFOR]: SPE training of class 87_34 after transform: 21
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
3/3 [==============================] - 0s 23ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :14.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :8.0
[INFOR]: SEN testing of class 87_33 before transform: 14
[INFOR]: SPE testing of class 87_33 before transform: 19

[INFOR]: SEN testing of class 87_33 after transform: 32
[INFOR]: SPE testing of class 87_33 after transform: 0
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name ResNet50  --model_shape 224 224 --dataset_name fgvc_aircraft --class_name_train 88_33 --class_name_test 88_33
2021-09-13 08:55:09.468777: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  ResNet50
dataset_name =  fgvc_aircraft
class_name_train =  88_33
class_name_test =  88_33
data_shape =  (32, 32, 3)
model_shape =  [224, 224]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
[INFOR]: get pretrained model
2021-09-13 08:55:11.900191: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 08:55:11.927243: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 08:55:11.931971: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 08:55:11.939897: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:55:11.942160: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:55:11.947552: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 08:55:11.951051: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 08:55:11.957219: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 08:55:11.962163: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 08:55:11.965103: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:55:11.967571: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 08:55:11.969350: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 08:55:11.981385: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x23db5217280 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 08:55:11.985196: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 08:55:11.987318: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 08:55:11.991913: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 08:55:11.994232: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:55:11.996493: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:55:11.999105: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 08:55:12.001406: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 08:55:12.003671: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 08:55:12.005963: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 08:55:12.008249: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:55:12.010496: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 08:55:12.436233: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 08:55:12.439259: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 08:55:12.440751: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 08:55:12.442363: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 08:55:12.449074: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x23de3ec0b00 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 08:55:12.451829: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 08:55:14.059953: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 08:55:14.540807: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:55:15.190055: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:55:15.196149: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:55:16.514449: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 08:55:16.562556: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 08:55:16.878020: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 3s 109ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :12.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :5.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 23ms/step
[INFOR]: Toltal norm before transform: 0.6410
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0749

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 23ms/step
[INFOR]: SEN training of class 88_33 before transform: 12
[INFOR]: SPE training of class 88_33 before transform: 21

[INFOR]: SEN training of class 88_33 after transform: 30
[INFOR]: SPE training of class 88_33 after transform: 21
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
3/3 [==============================] - 0s 23ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :15.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :6.0
[INFOR]: SEN testing of class 88_33 before transform: 15
[INFOR]: SPE testing of class 88_33 before transform: 22

[INFOR]: SEN testing of class 88_33 after transform: 33
[INFOR]: SPE testing of class 88_33 after transform: 3
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name ResNet50  --model_shape 224 224 --dataset_name fgvc_aircraft --class_name_train 89_33 --class_name_test 89_34
2021-09-13 08:55:19.935436: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  ResNet50
dataset_name =  fgvc_aircraft
class_name_train =  89_33
class_name_test =  89_34
data_shape =  (32, 32, 3)
model_shape =  [224, 224]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
[INFOR]: get pretrained model
2021-09-13 08:55:22.471473: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 08:55:22.495144: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 08:55:22.499483: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 08:55:22.507330: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:55:22.509363: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:55:22.514225: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 08:55:22.517442: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 08:55:22.523620: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 08:55:22.528416: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 08:55:22.531353: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:55:22.533380: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 08:55:22.535180: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 08:55:22.547865: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1e1355e05c0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 08:55:22.551717: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 08:55:22.553839: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 08:55:22.558088: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 08:55:22.560121: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:55:22.562140: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:55:22.564187: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 08:55:22.566192: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 08:55:22.568410: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 08:55:22.570548: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 08:55:22.572751: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:55:22.574943: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 08:55:23.001541: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 08:55:23.004242: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 08:55:23.005567: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 08:55:23.007175: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 08:55:23.013684: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1e160c38d80 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 08:55:23.016459: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 08:55:24.638520: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 08:55:25.130746: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:55:25.773842: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:55:25.779950: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:55:27.117952: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 08:55:27.167887: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 08:55:27.506531: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 3s 126ms/step
[INFOR]: Index of most vote   :510
[INFOR]: Class of most vote   :container ship, containership, container vessel
[INFOR]: Number of most vote  :10.0


[INFOR]: Index of second most vote     :404
[INFOR]: Class of second most vote     :airliner
[INFOR]: Number of second most vote    :8.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 23ms/step
[INFOR]: Toltal norm before transform: 0.6541
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0468

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 21ms/step
[INFOR]: SEN training of class 89_33 before transform: 10
[INFOR]: SPE training of class 89_33 before transform: 26

[INFOR]: SEN training of class 89_33 after transform: 30
[INFOR]: SPE training of class 89_33 after transform: 26
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (68, 32, 32, 3)
[INFOR]: shape of y: (68, 1)
3/3 [==============================] - 0s 31ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :14.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :6.0
[INFOR]: SEN testing of class 89_34 before transform: 14
[INFOR]: SPE testing of class 89_34 before transform: 17

[INFOR]: SEN testing of class 89_34 after transform: 33
[INFOR]: SPE testing of class 89_34 after transform: 1
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name ResNet50  --model_shape 224 224 --dataset_name fgvc_aircraft --class_name_train 90_34 --class_name_test 90_33
2021-09-13 08:55:30.817251: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  ResNet50
dataset_name =  fgvc_aircraft
class_name_train =  90_34
class_name_test =  90_33
data_shape =  (32, 32, 3)
model_shape =  [224, 224]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (68, 32, 32, 3)
[INFOR]: shape of y: (68, 1)
[INFOR]: get pretrained model
2021-09-13 08:55:33.296663: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 08:55:33.320813: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 08:55:33.326163: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 08:55:33.334428: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:55:33.336443: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:55:33.341406: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 08:55:33.344598: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 08:55:33.350929: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 08:55:33.355808: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 08:55:33.358775: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:55:33.360977: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 08:55:33.363042: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 08:55:33.375545: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1ba39120b60 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 08:55:33.379166: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 08:55:33.381315: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 08:55:33.385833: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 08:55:33.388047: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:55:33.390297: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:55:33.392594: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 08:55:33.394954: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 08:55:33.397234: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 08:55:33.399335: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 08:55:33.401433: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:55:33.403531: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 08:55:33.823495: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 08:55:33.826540: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 08:55:33.827849: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 08:55:33.829272: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 08:55:33.835820: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1ba67c6a060 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 08:55:33.838555: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 08:55:35.432141: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 08:55:35.916818: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:55:36.559034: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:55:36.565017: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:55:37.898740: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 08:55:37.947739: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 08:55:38.282045: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 3s 110ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :16.0


[INFOR]: Index of second most vote     :811
[INFOR]: Class of second most vote     :space heater
[INFOR]: Number of second most vote    :6.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 23ms/step
[INFOR]: Toltal norm before transform: 0.4815
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0280

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 23ms/step
[INFOR]: SEN training of class 90_34 before transform: 16
[INFOR]: SPE training of class 90_34 before transform: 16

[INFOR]: SEN training of class 90_34 after transform: 31
[INFOR]: SPE training of class 90_34 after transform: 16
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
3/3 [==============================] - 0s 23ms/step
[INFOR]: Index of most vote   :510
[INFOR]: Class of most vote   :container ship, containership, container vessel
[INFOR]: Number of most vote  :12.0


[INFOR]: Index of second most vote     :404
[INFOR]: Class of second most vote     :airliner
[INFOR]: Number of second most vote    :11.0
[INFOR]: SEN testing of class 90_33 before transform: 12
[INFOR]: SPE testing of class 90_33 before transform: 26

[INFOR]: SEN testing of class 90_33 after transform: 32
[INFOR]: SPE testing of class 90_33 after transform: 1
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name ResNet50  --model_shape 224 224 --dataset_name fgvc_aircraft --class_name_train 91_33 --class_name_test 91_33
2021-09-13 08:55:41.575697: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  ResNet50
dataset_name =  fgvc_aircraft
class_name_train =  91_33
class_name_test =  91_33
data_shape =  (32, 32, 3)
model_shape =  [224, 224]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
[INFOR]: get pretrained model
2021-09-13 08:55:44.064918: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 08:55:44.110505: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 08:55:44.115782: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 08:55:44.123500: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:55:44.125541: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:55:44.130699: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 08:55:44.134095: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 08:55:44.140054: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 08:55:44.144847: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 08:55:44.147740: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:55:44.149793: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 08:55:44.151609: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 08:55:44.163678: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x2c436fe3780 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 08:55:44.167267: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 08:55:44.169401: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 08:55:44.173747: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 08:55:44.176008: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:55:44.178370: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:55:44.180433: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 08:55:44.182519: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 08:55:44.184555: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 08:55:44.186623: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 08:55:44.188690: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:55:44.190768: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 08:55:44.660228: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 08:55:44.663143: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 08:55:44.664726: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 08:55:44.666514: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 08:55:44.673410: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x2c4661a3c70 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 08:55:44.676275: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 08:55:46.281782: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 08:55:46.771655: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:55:47.413059: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:55:47.418662: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:55:48.747497: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 08:55:48.802192: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 08:55:49.137576: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 3s 110ms/step
[INFOR]: Index of most vote   :871
[INFOR]: Class of most vote   :trimaran
[INFOR]: Number of most vote  :11.0


[INFOR]: Index of second most vote     :404
[INFOR]: Class of second most vote     :airliner
[INFOR]: Number of second most vote    :6.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 23ms/step
[INFOR]: Toltal norm before transform: 0.6179
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0574

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 23ms/step
[INFOR]: SEN training of class 91_33 before transform: 11
[INFOR]: SPE training of class 91_33 before transform: 33

[INFOR]: SEN training of class 91_33 after transform: 33
[INFOR]: SPE training of class 91_33 after transform: 32
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
3/3 [==============================] - 0s 31ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :9.0


[INFOR]: Index of second most vote     :870
[INFOR]: Class of second most vote     :tricycle, trike, velocipede
[INFOR]: Number of second most vote    :9.0
[INFOR]: SEN testing of class 91_33 before transform: 9
[INFOR]: SPE testing of class 91_33 before transform: 24

[INFOR]: SEN testing of class 91_33 after transform: 27
[INFOR]: SPE testing of class 91_33 after transform: 1
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name ResNet50  --model_shape 224 224 --dataset_name fgvc_aircraft --class_name_train 92_34 --class_name_test 92_33
2021-09-13 08:55:52.190115: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  ResNet50
dataset_name =  fgvc_aircraft
class_name_train =  92_34
class_name_test =  92_33
data_shape =  (32, 32, 3)
model_shape =  [224, 224]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (68, 32, 32, 3)
[INFOR]: shape of y: (68, 1)
[INFOR]: get pretrained model
2021-09-13 08:55:54.768123: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 08:55:54.792952: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 08:55:54.798951: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 08:55:54.806812: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:55:54.809030: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:55:54.813919: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 08:55:54.817181: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 08:55:54.823242: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 08:55:54.828096: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 08:55:54.830878: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:55:54.833081: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 08:55:54.835048: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 08:55:54.847192: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x153bb221cc0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 08:55:54.850683: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 08:55:54.852627: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 08:55:54.856629: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 08:55:54.858661: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:55:54.860682: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:55:54.862726: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 08:55:54.864865: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 08:55:54.866985: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 08:55:54.869228: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 08:55:54.871268: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:55:54.873289: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 08:55:55.302109: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 08:55:55.305345: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 08:55:55.306707: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 08:55:55.308169: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 08:55:55.314718: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x153e4aa3520 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 08:55:55.317539: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 08:55:56.952193: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 08:55:57.444133: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:55:58.092662: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:55:58.098875: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:55:59.417322: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 08:55:59.465737: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 08:55:59.775224: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 3s 109ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :13.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :9.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 32ms/step
[INFOR]: Toltal norm before transform: 0.6019
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0731

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 23ms/step
[INFOR]: SEN training of class 92_34 before transform: 13
[INFOR]: SPE training of class 92_34 before transform: 18

[INFOR]: SEN training of class 92_34 after transform: 27
[INFOR]: SPE training of class 92_34 after transform: 18
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
3/3 [==============================] - 0s 31ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :13.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :7.0
[INFOR]: SEN testing of class 92_33 before transform: 13
[INFOR]: SPE testing of class 92_33 before transform: 19

[INFOR]: SEN testing of class 92_33 after transform: 29
[INFOR]: SPE testing of class 92_33 after transform: 2
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name ResNet50  --model_shape 224 224 --dataset_name fgvc_aircraft --class_name_train 93_33 --class_name_test 93_33
2021-09-13 08:56:03.029873: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  ResNet50
dataset_name =  fgvc_aircraft
class_name_train =  93_33
class_name_test =  93_33
data_shape =  (32, 32, 3)
model_shape =  [224, 224]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
[INFOR]: get pretrained model
2021-09-13 08:56:05.479660: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 08:56:05.504192: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 08:56:05.508788: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 08:56:05.516979: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:56:05.519344: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:56:05.524691: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 08:56:05.528319: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 08:56:05.534537: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 08:56:05.539412: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 08:56:05.542466: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:56:05.544569: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 08:56:05.546421: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 08:56:05.558355: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x2d6b357bd60 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 08:56:05.561793: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 08:56:05.564050: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 08:56:05.568341: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 08:56:05.570550: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:56:05.572573: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:56:05.574605: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 08:56:05.576600: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 08:56:05.578695: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 08:56:05.580721: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 08:56:05.582793: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:56:05.584970: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 08:56:06.009922: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 08:56:06.012904: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 08:56:06.014240: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 08:56:06.015685: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 08:56:06.022252: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x2d6dd775be0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 08:56:06.025168: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 08:56:07.619842: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 08:56:08.103758: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:56:08.759774: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:56:08.764998: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:56:10.079189: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 08:56:10.132084: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 08:56:10.439678: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 3s 102ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :15.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :5.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 24ms/step
[INFOR]: Toltal norm before transform: 0.5398
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1119

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 23ms/step
[INFOR]: SEN training of class 93_33 before transform: 15
[INFOR]: SPE training of class 93_33 before transform: 18

[INFOR]: SEN training of class 93_33 after transform: 32
[INFOR]: SPE training of class 93_33 after transform: 18
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
3/3 [==============================] - 0s 23ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :12.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :8.0
[INFOR]: SEN testing of class 93_33 before transform: 12
[INFOR]: SPE testing of class 93_33 before transform: 17

[INFOR]: SEN testing of class 93_33 after transform: 33
[INFOR]: SPE testing of class 93_33 after transform: 0
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name ResNet50  --model_shape 224 224 --dataset_name fgvc_aircraft --class_name_train 94_33 --class_name_test 94_34
2021-09-13 08:56:13.583389: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  ResNet50
dataset_name =  fgvc_aircraft
class_name_train =  94_33
class_name_test =  94_34
data_shape =  (32, 32, 3)
model_shape =  [224, 224]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
[INFOR]: get pretrained model
2021-09-13 08:56:16.107492: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 08:56:16.131254: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 08:56:16.136993: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 08:56:16.144728: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:56:16.146749: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:56:16.151626: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 08:56:16.154860: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 08:56:16.161070: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 08:56:16.165836: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 08:56:16.168589: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:56:16.170640: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 08:56:16.172563: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 08:56:16.184609: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x22135f8cd60 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 08:56:16.188323: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 08:56:16.190293: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 08:56:16.194416: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 08:56:16.196515: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:56:16.198594: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:56:16.200700: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 08:56:16.202824: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 08:56:16.204990: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 08:56:16.207297: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 08:56:16.209404: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:56:16.211476: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 08:56:16.637808: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 08:56:16.641107: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 08:56:16.642433: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 08:56:16.643896: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 08:56:16.650567: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x22160119a90 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 08:56:16.653294: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 08:56:18.253989: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 08:56:18.748106: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:56:19.387703: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:56:19.393858: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:56:20.714268: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 08:56:20.763140: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 08:56:21.071031: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 3s 109ms/step
[INFOR]: Index of most vote   :510
[INFOR]: Class of most vote   :container ship, containership, container vessel
[INFOR]: Number of most vote  :9.0


[INFOR]: Index of second most vote     :404
[INFOR]: Class of second most vote     :airliner
[INFOR]: Number of second most vote    :3.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 23ms/step
[INFOR]: Toltal norm before transform: 0.6842
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0727

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 23ms/step
[INFOR]: SEN training of class 94_33 before transform: 9
[INFOR]: SPE training of class 94_33 before transform: 29

[INFOR]: SEN training of class 94_33 after transform: 33
[INFOR]: SPE training of class 94_33 after transform: 28
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (68, 32, 32, 3)
[INFOR]: shape of y: (68, 1)
3/3 [==============================] - 0s 23ms/step
[INFOR]: Index of most vote   :510
[INFOR]: Class of most vote   :container ship, containership, container vessel
[INFOR]: Number of most vote  :9.0


[INFOR]: Index of second most vote     :404
[INFOR]: Class of second most vote     :airliner
[INFOR]: Number of second most vote    :5.0
[INFOR]: SEN testing of class 94_34 before transform: 9
[INFOR]: SPE testing of class 94_34 before transform: 26

[INFOR]: SEN testing of class 94_34 after transform: 34
[INFOR]: SPE testing of class 94_34 after transform: 11
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name ResNet50  --model_shape 224 224 --dataset_name fgvc_aircraft --class_name_train 95_33 --class_name_test 95_34
2021-09-13 08:56:24.334285: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  ResNet50
dataset_name =  fgvc_aircraft
class_name_train =  95_33
class_name_test =  95_34
data_shape =  (32, 32, 3)
model_shape =  [224, 224]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
[INFOR]: get pretrained model
2021-09-13 08:56:26.823507: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 08:56:26.847528: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 08:56:26.852093: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 08:56:26.859754: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:56:26.861775: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:56:26.866643: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 08:56:26.870047: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 08:56:26.876213: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 08:56:26.880944: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 08:56:26.883884: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:56:26.885917: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 08:56:26.887721: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 08:56:26.900383: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1d1b59b6ce0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 08:56:26.904249: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 08:56:26.906220: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 08:56:26.910325: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 08:56:26.912404: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:56:26.914443: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:56:26.916509: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 08:56:26.918528: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 08:56:26.920723: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 08:56:26.922985: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 08:56:26.925130: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:56:26.927172: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 08:56:27.350130: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 08:56:27.353155: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 08:56:27.354604: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 08:56:27.356488: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 08:56:27.363036: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1d1df791770 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 08:56:27.365988: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 08:56:28.977546: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 08:56:29.469122: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:56:30.115495: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:56:30.122141: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:56:31.468027: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 08:56:31.517265: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 08:56:31.854377: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 3s 102ms/step
[INFOR]: Index of most vote   :510
[INFOR]: Class of most vote   :container ship, containership, container vessel
[INFOR]: Number of most vote  :7.0


[INFOR]: Index of second most vote     :811
[INFOR]: Class of second most vote     :space heater
[INFOR]: Number of second most vote    :5.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 31ms/step
[INFOR]: Toltal norm before transform: 0.7548
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1480

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 23ms/step
[INFOR]: SEN training of class 95_33 before transform: 7
[INFOR]: SPE training of class 95_33 before transform: 28

[INFOR]: SEN training of class 95_33 after transform: 33
[INFOR]: SPE training of class 95_33 after transform: 28
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (68, 32, 32, 3)
[INFOR]: shape of y: (68, 1)
3/3 [==============================] - 0s 23ms/step
[INFOR]: Index of most vote   :812
[INFOR]: Class of most vote   :space shuttle
[INFOR]: Number of most vote  :9.0


[INFOR]: Index of second most vote     :510
[INFOR]: Class of second most vote     :container ship, containership, container vessel
[INFOR]: Number of second most vote    :6.0
[INFOR]: SEN testing of class 95_34 before transform: 9
[INFOR]: SPE testing of class 95_34 before transform: 31

[INFOR]: SEN testing of class 95_34 after transform: 34
[INFOR]: SPE testing of class 95_34 after transform: 2
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name ResNet50  --model_shape 224 224 --dataset_name fgvc_aircraft --class_name_train 96_34 --class_name_test 96_33
2021-09-13 08:56:35.118710: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  ResNet50
dataset_name =  fgvc_aircraft
class_name_train =  96_34
class_name_test =  96_33
data_shape =  (32, 32, 3)
model_shape =  [224, 224]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (68, 32, 32, 3)
[INFOR]: shape of y: (68, 1)
[INFOR]: get pretrained model
2021-09-13 08:56:37.596513: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 08:56:37.620894: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 08:56:37.625081: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 08:56:37.632785: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:56:37.634793: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:56:37.639687: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 08:56:37.642874: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 08:56:37.648962: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 08:56:37.653838: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 08:56:37.656560: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:56:37.658574: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 08:56:37.660542: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 08:56:37.672863: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x2072b02ce30 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 08:56:37.676429: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 08:56:37.678476: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 08:56:37.682501: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 08:56:37.684552: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:56:37.686622: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:56:37.688670: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 08:56:37.690763: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 08:56:37.692871: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 08:56:37.695125: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 08:56:37.697263: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:56:37.699358: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 08:56:38.118541: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 08:56:38.121312: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 08:56:38.122747: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 08:56:38.124330: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 08:56:38.130758: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x2075d548980 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 08:56:38.133478: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 08:56:39.731642: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 08:56:40.214775: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:56:40.854537: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:56:40.860490: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:56:42.195567: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 08:56:42.244433: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 08:56:42.553452: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 3s 110ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :9.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :7.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 23ms/step
[INFOR]: Toltal norm before transform: 0.6792
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.2767

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 25ms/step
[INFOR]: SEN training of class 96_34 before transform: 9
[INFOR]: SPE training of class 96_34 before transform: 21

[INFOR]: SEN training of class 96_34 after transform: 32
[INFOR]: SPE training of class 96_34 after transform: 21
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
3/3 [==============================] - 0s 23ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :8.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :7.0
[INFOR]: SEN testing of class 96_33 before transform: 8
[INFOR]: SPE testing of class 96_33 before transform: 22

[INFOR]: SEN testing of class 96_33 after transform: 30
[INFOR]: SPE testing of class 96_33 after transform: 1
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name ResNet50  --model_shape 224 224 --dataset_name fgvc_aircraft --class_name_train 97_33 --class_name_test 97_33
2021-09-13 08:56:45.836659: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  ResNet50
dataset_name =  fgvc_aircraft
class_name_train =  97_33
class_name_test =  97_33
data_shape =  (32, 32, 3)
model_shape =  [224, 224]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
[INFOR]: get pretrained model
2021-09-13 08:56:48.339339: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 08:56:48.365171: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 08:56:48.370102: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 08:56:48.377756: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:56:48.379805: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:56:48.384728: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 08:56:48.387938: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 08:56:48.394573: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 08:56:48.399356: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 08:56:48.402180: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:56:48.404446: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 08:56:48.406423: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 08:56:48.418726: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x256ba7f8580 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 08:56:48.422367: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 08:56:48.424324: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 08:56:48.428578: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 08:56:48.430683: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:56:48.432716: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:56:48.434794: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 08:56:48.437100: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 08:56:48.439185: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 08:56:48.441241: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 08:56:48.443298: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:56:48.445322: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 08:56:48.876756: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 08:56:48.880038: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 08:56:48.881436: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 08:56:48.882939: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 08:56:48.889437: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x256e8d05310 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 08:56:48.892417: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 08:56:50.519605: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 08:56:51.018019: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:56:51.665349: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:56:51.671058: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:56:52.986090: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 08:56:53.034070: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 08:56:53.343812: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 3s 106ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :15.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :9.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 31ms/step
[INFOR]: Toltal norm before transform: 0.5606
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1129

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 31ms/step
[INFOR]: SEN training of class 97_33 before transform: 15
[INFOR]: SPE training of class 97_33 before transform: 16

[INFOR]: SEN training of class 97_33 after transform: 32
[INFOR]: SPE training of class 97_33 after transform: 16
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
3/3 [==============================] - 0s 24ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :10.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :8.0
[INFOR]: SEN testing of class 97_33 before transform: 10
[INFOR]: SPE testing of class 97_33 before transform: 23

[INFOR]: SEN testing of class 97_33 after transform: 29
[INFOR]: SPE testing of class 97_33 after transform: 3
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name ResNet50  --model_shape 224 224 --dataset_name fgvc_aircraft --class_name_train 98_33 --class_name_test 98_34
2021-09-13 08:56:56.383624: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  ResNet50
dataset_name =  fgvc_aircraft
class_name_train =  98_33
class_name_test =  98_34
data_shape =  (32, 32, 3)
model_shape =  [224, 224]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
[INFOR]: get pretrained model
2021-09-13 08:56:58.855495: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 08:56:58.879983: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 08:56:58.884825: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 08:56:58.892726: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:56:58.894899: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:56:58.900080: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 08:56:58.903404: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 08:56:58.909639: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 08:56:58.914488: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 08:56:58.917342: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:56:58.919597: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 08:56:58.921648: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 08:56:58.933401: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x14c35733f90 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 08:56:58.936587: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 08:56:58.938571: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 08:56:58.942724: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 08:56:58.944814: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:56:58.946881: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:56:58.948978: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 08:56:58.951181: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 08:56:58.953367: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 08:56:58.955653: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 08:56:58.957744: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:56:58.959803: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 08:56:59.383903: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 08:56:59.386773: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 08:56:59.388086: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 08:56:59.389536: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 08:56:59.396161: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x14c612cec90 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 08:56:59.398854: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 08:57:01.010443: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 08:57:01.499930: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:57:02.144346: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:57:02.150144: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:57:03.465924: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 08:57:03.515258: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 08:57:03.823366: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 3s 103ms/step
[INFOR]: Index of most vote   :510
[INFOR]: Class of most vote   :container ship, containership, container vessel
[INFOR]: Number of most vote  :9.0


[INFOR]: Index of second most vote     :404
[INFOR]: Class of second most vote     :airliner
[INFOR]: Number of second most vote    :7.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 23ms/step
[INFOR]: Toltal norm before transform: 0.7512
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0779

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 23ms/step
[INFOR]: SEN training of class 98_33 before transform: 9
[INFOR]: SPE training of class 98_33 before transform: 26

[INFOR]: SEN training of class 98_33 after transform: 30
[INFOR]: SPE training of class 98_33 after transform: 26
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (68, 32, 32, 3)
[INFOR]: shape of y: (68, 1)
3/3 [==============================] - 0s 31ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :17.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :5.0
[INFOR]: SEN testing of class 98_34 before transform: 17
[INFOR]: SPE testing of class 98_34 before transform: 21

[INFOR]: SEN testing of class 98_34 after transform: 33
[INFOR]: SPE testing of class 98_34 after transform: 4
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name ResNet50  --model_shape 224 224 --dataset_name fgvc_aircraft --class_name_train 99_34 --class_name_test 99_33
2021-09-13 08:57:07.102556: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  ResNet50
dataset_name =  fgvc_aircraft
class_name_train =  99_34
class_name_test =  99_33
data_shape =  (32, 32, 3)
model_shape =  [224, 224]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (68, 32, 32, 3)
[INFOR]: shape of y: (68, 1)
[INFOR]: get pretrained model
2021-09-13 08:57:09.612526: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-13 08:57:09.637281: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 08:57:09.641340: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 08:57:09.648989: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:57:09.651064: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:57:09.656069: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 08:57:09.659502: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 08:57:09.665714: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 08:57:09.670675: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 08:57:09.673683: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:57:09.676118: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 08:57:09.678108: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-13 08:57:09.690257: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x222b36c9c10 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-13 08:57:09.693327: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-13 08:57:09.695317: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-13 08:57:09.699479: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-13 08:57:09.701606: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:57:09.703716: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:57:09.705855: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-13 08:57:09.708101: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-13 08:57:09.710466: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-13 08:57:09.712602: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-13 08:57:09.714742: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:57:09.716837: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-13 08:57:10.133477: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-13 08:57:10.136171: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-13 08:57:10.137643: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-13 08:57:10.139264: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-13 08:57:10.146010: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x222e18b3780 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-13 08:57:10.148776: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-13 08:57:11.777214: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-13 08:57:12.269325: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-13 08:57:12.909456: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-13 08:57:12.915202: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-13 08:57:14.240361: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 08:57:14.287804: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-13 08:57:14.599547: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
3/3 [==============================] - 3s 106ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :14.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :8.0

[INFOR]: Create PDF for Positive Label

3/3 [==============================] - 1s 31ms/step
[INFOR]: Toltal norm before transform: 0.5820
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0469

[INFOR]: Create PDF for Negative Label

3/3 [==============================] - 0s 23ms/step
[INFOR]: SEN training of class 99_34 before transform: 14
[INFOR]: SPE training of class 99_34 before transform: 19

[INFOR]: SEN training of class 99_34 after transform: 32
[INFOR]: SPE training of class 99_34 after transform: 19
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (66, 32, 32, 3)
[INFOR]: shape of y: (66, 1)
3/3 [==============================] - 0s 23ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :18.0


[INFOR]: Index of second most vote     :509
[INFOR]: Class of second most vote     :confectionery, confectionary, candy store
[INFOR]: Number of second most vote    :5.0
[INFOR]: SEN testing of class 99_33 before transform: 18
[INFOR]: SPE testing of class 99_33 before transform: 20

[INFOR]: SEN testing of class 99_33 after transform: 31
[INFOR]: SPE testing of class 99_33 after transform: 1
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>