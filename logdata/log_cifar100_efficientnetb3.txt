2021-09-08 15:03:28.711419: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 15:03:28.716563: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 15:03:28.724662: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:03:28.727085: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:03:28.732225: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 15:03:28.735702: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 15:03:28.742095: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 15:03:28.747023: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 15:03:28.750042: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:03:28.752288: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 15:03:28.754238: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 15:03:28.766434: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x199b4f149e0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 15:03:28.769806: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 15:03:28.772044: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 15:03:28.776372: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 15:03:28.778590: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:03:28.780814: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:03:28.783064: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 15:03:28.785307: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 15:03:28.787670: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 15:03:28.790004: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 15:03:28.792272: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:03:28.794539: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 15:03:29.235926: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 15:03:29.239354: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 15:03:29.240842: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 15:03:29.242438: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 15:03:29.249388: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x199e5103570 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 15:03:29.252299: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 15:03:31.488552: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 15:03:32.652397: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:03:33.293650: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:03:33.301182: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:03:34.637549: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 15:03:34.686952: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 15:03:35.248272: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 6s 72ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :51.0


[INFOR]: Index of second most vote     :510
[INFOR]: Class of second most vote     :container ship, containership, container vessel
[INFOR]: Number of second most vote    :41.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 3s 62ms/step
[INFOR]: Toltal norm before transform: 0.8528
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0969

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 2s 62ms/step
[INFOR]: SEN training of class 37_500 before transform: 51
[INFOR]: SPE training of class 37_500 before transform: 487

[INFOR]: SEN training of class 37_500 after transform: 431
[INFOR]: SPE training of class 37_500 after transform: 344
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 65ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :12.0


[INFOR]: Index of second most vote     :510
[INFOR]: Class of second most vote     :container ship, containership, container vessel
[INFOR]: Number of second most vote    :8.0
[INFOR]: SEN testing of class 37_100 before transform: 12
[INFOR]: SPE testing of class 37_100 before transform: 95

[INFOR]: SEN testing of class 37_100 after transform: 96
[INFOR]: SPE testing of class 37_100 after transform: 17
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name cifar_100 --class_name_train 38_500 --class_name_test 38_100
2021-09-08 15:03:46.961344: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  cifar_100
class_name_train =  38_500
class_name_test =  38_100
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 15:03:49.495660: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 15:03:49.541197: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 15:03:49.546354: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 15:03:49.554352: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:03:49.556796: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:03:49.562021: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 15:03:49.565627: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 15:03:49.572283: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 15:03:49.577323: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 15:03:49.580527: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:03:49.582803: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 15:03:49.584739: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 15:03:49.597147: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1febb54a7a0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 15:03:49.600567: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 15:03:49.602846: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 15:03:49.607327: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 15:03:49.609738: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:03:49.612239: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:03:49.614552: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 15:03:49.616861: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 15:03:49.619147: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 15:03:49.621530: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 15:03:49.623882: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:03:49.626250: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 15:03:50.076527: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 15:03:50.079367: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 15:03:50.080829: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 15:03:50.082511: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 15:03:50.089701: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1fee6bd14d0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 15:03:50.093163: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 15:03:52.352254: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 15:03:53.545131: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:03:54.190406: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:03:54.197704: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:03:55.525370: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 15:03:55.581063: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 15:03:56.150117: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 6s 73ms/step
[INFOR]: Index of most vote   :335
[INFOR]: Class of most vote   :fox squirrel, eastern fox squirrel, Sciurus niger
[INFOR]: Number of most vote  :74.0


[INFOR]: Index of second most vote     :104
[INFOR]: Class of second most vote     :wallaby, brush kangaroo
[INFOR]: Number of second most vote    :63.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 3s 62ms/step
[INFOR]: Toltal norm before transform: 0.8431
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.3307

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 2s 62ms/step
[INFOR]: SEN training of class 38_500 before transform: 74
[INFOR]: SPE training of class 38_500 before transform: 460

[INFOR]: SEN training of class 38_500 after transform: 477
[INFOR]: SPE training of class 38_500 after transform: 335
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 65ms/step
[INFOR]: Index of most vote   :335
[INFOR]: Class of most vote   :fox squirrel, eastern fox squirrel, Sciurus niger
[INFOR]: Number of most vote  :14.0


[INFOR]: Index of second most vote     :268
[INFOR]: Class of second most vote     :Mexican hairless
[INFOR]: Number of second most vote    :12.0
[INFOR]: SEN testing of class 38_100 before transform: 14
[INFOR]: SPE testing of class 38_100 before transform: 91

[INFOR]: SEN testing of class 38_100 after transform: 96
[INFOR]: SPE testing of class 38_100 after transform: 18
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name cifar_100 --class_name_train 39_500 --class_name_test 39_100
2021-09-08 15:04:07.943752: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  cifar_100
class_name_train =  39_500
class_name_test =  39_100
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 15:04:10.498478: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 15:04:10.522747: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 15:04:10.527445: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 15:04:10.535505: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:04:10.537728: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:04:10.543060: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 15:04:10.546501: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 15:04:10.553146: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 15:04:10.558081: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 15:04:10.561091: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:04:10.563331: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 15:04:10.565520: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 15:04:10.578018: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x11f3a5b53f0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 15:04:10.581926: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 15:04:10.584299: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 15:04:10.588778: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 15:04:10.591277: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:04:10.593565: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:04:10.595949: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 15:04:10.598285: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 15:04:10.600569: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 15:04:10.602950: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 15:04:10.605471: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:04:10.607762: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 15:04:11.031282: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 15:04:11.034513: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 15:04:11.036033: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 15:04:11.037753: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 15:04:11.044642: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x11f635a0060 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 15:04:11.047770: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 15:04:13.317271: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 15:04:14.494694: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:04:15.142807: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:04:15.150073: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:04:16.492064: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 15:04:16.548541: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 15:04:17.111790: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 6s 74ms/step
[INFOR]: Index of most vote   :810
[INFOR]: Class of most vote   :space bar
[INFOR]: Number of most vote  :145.0


[INFOR]: Index of second most vote     :699
[INFOR]: Class of second most vote     :panpipe, pandean pipe, syrinx
[INFOR]: Number of second most vote    :41.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 3s 62ms/step
[INFOR]: Toltal norm before transform: 0.6344
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0499

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 2s 62ms/step
[INFOR]: SEN training of class 39_500 before transform: 145
[INFOR]: SPE training of class 39_500 before transform: 500

[INFOR]: SEN training of class 39_500 after transform: 487
[INFOR]: SPE training of class 39_500 after transform: 454
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 63ms/step
[INFOR]: Index of most vote   :810
[INFOR]: Class of most vote   :space bar
[INFOR]: Number of most vote  :36.0


[INFOR]: Index of second most vote     :798
[INFOR]: Class of second most vote     :slide rule, slipstick
[INFOR]: Number of second most vote    :10.0
[INFOR]: SEN testing of class 39_100 before transform: 36
[INFOR]: SPE testing of class 39_100 before transform: 100

[INFOR]: SEN testing of class 39_100 after transform: 94
[INFOR]: SPE testing of class 39_100 after transform: 49
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name cifar_100 --class_name_train 40_500 --class_name_test 40_100
2021-09-08 15:04:28.790859: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  cifar_100
class_name_train =  40_500
class_name_test =  40_100
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 15:04:31.341510: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 15:04:31.367335: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 15:04:31.372747: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 15:04:31.380718: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:04:31.382950: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:04:31.388072: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 15:04:31.391471: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 15:04:31.397961: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 15:04:31.402839: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 15:04:31.405891: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:04:31.408442: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 15:04:31.410386: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 15:04:31.423298: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x12a34ea2f00 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 15:04:31.427365: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 15:04:31.429512: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 15:04:31.433829: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 15:04:31.436159: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:04:31.438405: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:04:31.440795: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 15:04:31.443235: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 15:04:31.445497: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 15:04:31.447829: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 15:04:31.450108: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:04:31.452356: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 15:04:31.876767: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 15:04:31.879602: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 15:04:31.881044: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 15:04:31.882626: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 15:04:31.889337: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x12a60aa7840 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 15:04:31.892318: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 15:04:34.148523: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 15:04:35.319207: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:04:35.959708: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:04:35.967782: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:04:37.305602: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 15:04:37.359992: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 15:04:37.923311: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 6s 74ms/step
[INFOR]: Index of most vote   :846
[INFOR]: Class of most vote   :table lamp
[INFOR]: Number of most vote  :205.0


[INFOR]: Index of second most vote     :680
[INFOR]: Class of second most vote     :nipple
[INFOR]: Number of second most vote    :44.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 3s 62ms/step
[INFOR]: Toltal norm before transform: 0.2881
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0823

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 2s 62ms/step
[INFOR]: SEN training of class 40_500 before transform: 205
[INFOR]: SPE training of class 40_500 before transform: 498

[INFOR]: SEN training of class 40_500 after transform: 425
[INFOR]: SPE training of class 40_500 after transform: 371
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 62ms/step
[INFOR]: Index of most vote   :846
[INFOR]: Class of most vote   :table lamp
[INFOR]: Number of most vote  :44.0


[INFOR]: Index of second most vote     :680
[INFOR]: Class of second most vote     :nipple
[INFOR]: Number of second most vote    :9.0
[INFOR]: SEN testing of class 40_100 before transform: 44
[INFOR]: SPE testing of class 40_100 before transform: 98

[INFOR]: SEN testing of class 40_100 after transform: 96
[INFOR]: SPE testing of class 40_100 after transform: 8
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name cifar_100 --class_name_train 41_500 --class_name_test 41_100
2021-09-08 15:04:49.794768: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  cifar_100
class_name_train =  41_500
class_name_test =  41_100
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 15:04:52.383415: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 15:04:52.409105: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 15:04:52.413942: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 15:04:52.422150: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:04:52.424656: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:04:52.429884: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 15:04:52.433400: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 15:04:52.439985: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 15:04:52.444954: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 15:04:52.447985: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:04:52.450234: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 15:04:52.452401: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 15:04:52.465623: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x24baea6c7d0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 15:04:52.468859: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 15:04:52.471208: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 15:04:52.475780: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 15:04:52.478141: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:04:52.480906: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:04:52.483234: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 15:04:52.485661: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 15:04:52.488014: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 15:04:52.490332: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 15:04:52.492702: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:04:52.494990: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 15:04:52.921478: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 15:04:52.924565: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 15:04:52.926031: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 15:04:52.927648: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 15:04:52.934601: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x24be6b9f9c0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 15:04:52.937598: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 15:04:55.226567: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 15:04:56.417291: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:04:57.063092: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:04:57.069837: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:04:58.409695: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 15:04:58.457644: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 15:04:59.019726: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 6s 73ms/step
[INFOR]: Index of most vote   :856
[INFOR]: Class of most vote   :thresher, thrasher, threshing machine
[INFOR]: Number of most vote  :56.0


[INFOR]: Index of second most vote     :473
[INFOR]: Class of second most vote     :can opener, tin opener
[INFOR]: Number of second most vote    :54.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 3s 62ms/step
[INFOR]: Toltal norm before transform: 0.9431
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1784

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 2s 62ms/step
[INFOR]: SEN training of class 41_500 before transform: 56
[INFOR]: SPE training of class 41_500 before transform: 497

[INFOR]: SEN training of class 41_500 after transform: 463
[INFOR]: SPE training of class 41_500 after transform: 384
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 62ms/step
[INFOR]: Index of most vote   :621
[INFOR]: Class of most vote   :lawn mower, mower
[INFOR]: Number of most vote  :14.0


[INFOR]: Index of second most vote     :771
[INFOR]: Class of second most vote     :safe
[INFOR]: Number of second most vote    :9.0
[INFOR]: SEN testing of class 41_100 before transform: 14
[INFOR]: SPE testing of class 41_100 before transform: 100

[INFOR]: SEN testing of class 41_100 after transform: 81
[INFOR]: SPE testing of class 41_100 after transform: 49
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name cifar_100 --class_name_train 42_500 --class_name_test 42_100
2021-09-08 15:05:10.749903: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  cifar_100
class_name_train =  42_500
class_name_test =  42_100
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 15:05:13.276255: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 15:05:13.299646: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 15:05:13.304433: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 15:05:13.312543: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:05:13.314826: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:05:13.320144: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 15:05:13.323760: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 15:05:13.330441: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 15:05:13.335524: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 15:05:13.338689: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:05:13.341171: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 15:05:13.343196: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 15:05:13.355944: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x228b7cb95d0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 15:05:13.359251: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 15:05:13.361415: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 15:05:13.366001: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 15:05:13.368254: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:05:13.370486: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:05:13.373084: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 15:05:13.375309: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 15:05:13.377586: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 15:05:13.379908: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 15:05:13.382164: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:05:13.384375: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 15:05:13.808744: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 15:05:13.812057: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 15:05:13.813496: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 15:05:13.815109: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 15:05:13.822012: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x228e2dd2f30 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 15:05:13.825318: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 15:05:16.072693: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 15:05:17.234658: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:05:17.893025: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:05:17.900570: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:05:19.237041: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 15:05:19.284602: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 15:05:19.847120: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 6s 72ms/step
[INFOR]: Index of most vote   :335
[INFOR]: Class of most vote   :fox squirrel, eastern fox squirrel, Sciurus niger
[INFOR]: Number of most vote  :204.0


[INFOR]: Index of second most vote     :149
[INFOR]: Class of second most vote     :dugong, Dugong dugon
[INFOR]: Number of second most vote    :22.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 3s 62ms/step
[INFOR]: Toltal norm before transform: 0.5127
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0913

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 2s 62ms/step
[INFOR]: SEN training of class 42_500 before transform: 204
[INFOR]: SPE training of class 42_500 before transform: 482

[INFOR]: SEN training of class 42_500 after transform: 468
[INFOR]: SPE training of class 42_500 after transform: 367
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 60ms/step
[INFOR]: Index of most vote   :335
[INFOR]: Class of most vote   :fox squirrel, eastern fox squirrel, Sciurus niger
[INFOR]: Number of most vote  :41.0


[INFOR]: Index of second most vote     :149
[INFOR]: Class of second most vote     :dugong, Dugong dugon
[INFOR]: Number of second most vote    :4.0
[INFOR]: SEN testing of class 42_100 before transform: 41
[INFOR]: SPE testing of class 42_100 before transform: 94

[INFOR]: SEN testing of class 42_100 after transform: 98
[INFOR]: SPE testing of class 42_100 after transform: 14
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name cifar_100 --class_name_train 43_500 --class_name_test 43_100
2021-09-08 15:05:31.596337: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  cifar_100
class_name_train =  43_500
class_name_test =  43_100
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 15:05:34.138075: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 15:05:34.162980: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 15:05:34.168185: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 15:05:34.176327: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:05:34.178588: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:05:34.183997: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 15:05:34.187510: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 15:05:34.194077: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 15:05:34.199262: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 15:05:34.202337: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:05:34.204675: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 15:05:34.206670: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 15:05:34.218884: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1feb3d10720 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 15:05:34.222397: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 15:05:34.224671: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 15:05:34.229258: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 15:05:34.231586: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:05:34.233834: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:05:34.236108: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 15:05:34.238555: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 15:05:34.240802: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 15:05:34.243195: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 15:05:34.245465: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:05:34.247703: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 15:05:34.668145: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 15:05:34.671458: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 15:05:34.672905: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 15:05:34.674477: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 15:05:34.681504: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1fedcde4ce0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 15:05:34.684459: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 15:05:36.951210: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 15:05:38.138936: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:05:38.787907: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:05:38.795124: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:05:40.116122: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 15:05:40.165611: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 15:05:40.772552: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 6s 72ms/step
[INFOR]: Index of most vote   :291
[INFOR]: Class of most vote   :lion, king of beasts, Panthera leo
[INFOR]: Number of most vote  :112.0


[INFOR]: Index of second most vote     :334
[INFOR]: Class of second most vote     :porcupine, hedgehog
[INFOR]: Number of second most vote    :77.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 3s 62ms/step
[INFOR]: Toltal norm before transform: 0.7338
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.2388

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 2s 62ms/step
[INFOR]: SEN training of class 43_500 before transform: 112
[INFOR]: SPE training of class 43_500 before transform: 495

[INFOR]: SEN training of class 43_500 after transform: 465
[INFOR]: SPE training of class 43_500 after transform: 361
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 63ms/step
[INFOR]: Index of most vote   :291
[INFOR]: Class of most vote   :lion, king of beasts, Panthera leo
[INFOR]: Number of most vote  :22.0


[INFOR]: Index of second most vote     :334
[INFOR]: Class of second most vote     :porcupine, hedgehog
[INFOR]: Number of second most vote    :18.0
[INFOR]: SEN testing of class 43_100 before transform: 22
[INFOR]: SPE testing of class 43_100 before transform: 100

[INFOR]: SEN testing of class 43_100 after transform: 96
[INFOR]: SPE testing of class 43_100 after transform: 10
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name cifar_100 --class_name_train 44_500 --class_name_test 44_100
2021-09-08 15:05:52.525423: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  cifar_100
class_name_train =  44_500
class_name_test =  44_100
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 15:05:55.119291: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 15:05:55.144439: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 15:05:55.149737: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 15:05:55.157824: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:05:55.160056: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:05:55.165246: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 15:05:55.168670: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 15:05:55.175083: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 15:05:55.180289: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 15:05:55.183325: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:05:55.185592: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 15:05:55.187533: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 15:05:55.199578: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x15eb390b700 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 15:05:55.202797: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 15:05:55.205229: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 15:05:55.209551: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 15:05:55.212033: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:05:55.214294: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:05:55.216652: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 15:05:55.218897: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 15:05:55.221353: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 15:05:55.223702: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 15:05:55.226038: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:05:55.228281: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 15:05:55.653120: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 15:05:55.656339: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 15:05:55.657785: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 15:05:55.659335: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 15:05:55.666084: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x15edd5ce2e0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 15:05:55.669009: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 15:05:57.947174: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 15:05:59.132725: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:05:59.775342: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:05:59.782766: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:06:01.108197: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 15:06:01.156628: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 15:06:01.721518: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 6s 74ms/step
[INFOR]: Index of most vote   :38
[INFOR]: Class of most vote   :banded gecko
[INFOR]: Number of most vote  :80.0


[INFOR]: Index of second most vote     :110
[INFOR]: Class of second most vote     :flatworm, platyhelminth
[INFOR]: Number of second most vote    :51.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 3s 64ms/step
[INFOR]: Toltal norm before transform: 0.8088
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.2728

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 2s 64ms/step
[INFOR]: SEN training of class 44_500 before transform: 80
[INFOR]: SPE training of class 44_500 before transform: 499

[INFOR]: SEN training of class 44_500 after transform: 411
[INFOR]: SPE training of class 44_500 after transform: 349
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 65ms/step
[INFOR]: Index of most vote   :38
[INFOR]: Class of most vote   :banded gecko
[INFOR]: Number of most vote  :23.0


[INFOR]: Index of second most vote     :110
[INFOR]: Class of second most vote     :flatworm, platyhelminth
[INFOR]: Number of second most vote    :10.0
[INFOR]: SEN testing of class 44_100 before transform: 23
[INFOR]: SPE testing of class 44_100 before transform: 100

[INFOR]: SEN testing of class 44_100 after transform: 96
[INFOR]: SPE testing of class 44_100 after transform: 11
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name cifar_100 --class_name_train 45_500 --class_name_test 45_100
2021-09-08 15:06:13.604806: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  cifar_100
class_name_train =  45_500
class_name_test =  45_100
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 15:06:16.154855: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 15:06:16.208245: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 15:06:16.213544: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 15:06:16.221486: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:06:16.223700: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:06:16.228950: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 15:06:16.232365: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 15:06:16.238913: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 15:06:16.243858: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 15:06:16.246871: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:06:16.249080: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 15:06:16.251008: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 15:06:16.263152: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x20233897db0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 15:06:16.266290: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 15:06:16.268454: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 15:06:16.272800: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 15:06:16.275180: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:06:16.277427: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:06:16.279708: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 15:06:16.282174: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 15:06:16.284421: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 15:06:16.286810: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 15:06:16.289070: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:06:16.291383: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 15:06:16.721574: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 15:06:16.724842: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 15:06:16.726279: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 15:06:16.728372: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 15:06:16.735317: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x20262b7a130 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 15:06:16.738209: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 15:06:18.990695: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 15:06:20.153477: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:06:20.796570: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:06:20.804295: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:06:22.128203: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 15:06:22.177081: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 15:06:22.740847: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 6s 73ms/step
[INFOR]: Index of most vote   :680
[INFOR]: Class of most vote   :nipple
[INFOR]: Number of most vote  :89.0


[INFOR]: Index of second most vote     :126
[INFOR]: Class of second most vote     :isopod
[INFOR]: Number of second most vote    :41.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 3s 62ms/step
[INFOR]: Toltal norm before transform: 0.8177
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0760

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 2s 62ms/step
[INFOR]: SEN training of class 45_500 before transform: 89
[INFOR]: SPE training of class 45_500 before transform: 458

[INFOR]: SEN training of class 45_500 after transform: 368
[INFOR]: SPE training of class 45_500 after transform: 318
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 65ms/step
[INFOR]: Index of most vote   :680
[INFOR]: Class of most vote   :nipple
[INFOR]: Number of most vote  :25.0


[INFOR]: Index of second most vote     :126
[INFOR]: Class of second most vote     :isopod
[INFOR]: Number of second most vote    :9.0
[INFOR]: SEN testing of class 45_100 before transform: 25
[INFOR]: SPE testing of class 45_100 before transform: 94

[INFOR]: SEN testing of class 45_100 after transform: 85
[INFOR]: SPE testing of class 45_100 after transform: 26
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name cifar_100 --class_name_train 46_500 --class_name_test 46_100
2021-09-08 15:06:34.499586: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  cifar_100
class_name_train =  46_500
class_name_test =  46_100
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 15:06:37.113739: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 15:06:37.137610: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 15:06:37.142859: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 15:06:37.151147: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:06:37.153600: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:06:37.159068: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 15:06:37.162747: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 15:06:37.169527: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 15:06:37.174843: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 15:06:37.178069: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:06:37.180602: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 15:06:37.182767: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 15:06:37.196050: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1edb98877b0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 15:06:37.199875: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 15:06:37.202089: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 15:06:37.206486: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 15:06:37.208825: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:06:37.211411: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:06:37.213765: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 15:06:37.216098: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 15:06:37.218397: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 15:06:37.220789: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 15:06:37.223120: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:06:37.225412: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 15:06:37.652248: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 15:06:37.654917: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 15:06:37.656380: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 15:06:37.658006: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 15:06:37.665170: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1ede4f107e0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 15:06:37.668088: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 15:06:39.951172: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 15:06:41.135126: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:06:41.789453: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:06:41.796158: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:06:43.120144: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 15:06:43.175216: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 15:06:43.737625: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 6s 73ms/step
[INFOR]: Index of most vote   :906
[INFOR]: Class of most vote   :Windsor tie
[INFOR]: Number of most vote  :188.0


[INFOR]: Index of second most vote     :680
[INFOR]: Class of second most vote     :nipple
[INFOR]: Number of second most vote    :47.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 3s 62ms/step
[INFOR]: Toltal norm before transform: 0.5083
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.2175

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 2s 62ms/step
[INFOR]: SEN training of class 46_500 before transform: 188
[INFOR]: SPE training of class 46_500 before transform: 484

[INFOR]: SEN training of class 46_500 after transform: 427
[INFOR]: SPE training of class 46_500 after transform: 391
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 63ms/step
[INFOR]: Index of most vote   :906
[INFOR]: Class of most vote   :Windsor tie
[INFOR]: Number of most vote  :25.0


[INFOR]: Index of second most vote     :680
[INFOR]: Class of second most vote     :nipple
[INFOR]: Number of second most vote    :11.0
[INFOR]: SEN testing of class 46_100 before transform: 25
[INFOR]: SPE testing of class 46_100 before transform: 95

[INFOR]: SEN testing of class 46_100 after transform: 80
[INFOR]: SPE testing of class 46_100 after transform: 9
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name cifar_100 --class_name_train 47_500 --class_name_test 47_100
2021-09-08 15:06:55.509594: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  cifar_100
class_name_train =  47_500
class_name_test =  47_100
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 15:06:58.062128: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 15:06:58.086348: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 15:06:58.091668: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 15:06:58.099715: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:06:58.101974: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:06:58.107141: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 15:06:58.110793: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 15:06:58.117215: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 15:06:58.122209: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 15:06:58.125216: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:06:58.127476: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 15:06:58.129408: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 15:06:58.141619: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x19cb7314690 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 15:06:58.144980: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 15:06:58.147366: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 15:06:58.151750: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 15:06:58.154039: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:06:58.156315: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:06:58.158619: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 15:06:58.161096: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 15:06:58.163405: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 15:06:58.165754: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 15:06:58.168036: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:06:58.170290: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 15:06:58.591284: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 15:06:58.594407: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 15:06:58.595829: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 15:06:58.597362: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 15:06:58.604129: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x19ce6a254a0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 15:06:58.607026: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 15:07:00.850680: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 15:07:02.027887: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:07:02.672886: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:07:02.679919: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:07:04.018742: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 15:07:04.069198: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 15:07:04.693092: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 6s 72ms/step
[INFOR]: Index of most vote   :975
[INFOR]: Class of most vote   :lakeside, lakeshore
[INFOR]: Number of most vote  :43.0


[INFOR]: Index of second most vote     :147
[INFOR]: Class of second most vote     :grey whale, gray whale, devilfish, Eschrichtius gibbosus, Eschrichtius robustus
[INFOR]: Number of second most vote    :38.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 3s 62ms/step
[INFOR]: Toltal norm before transform: 0.8584
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1092

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 2s 62ms/step
[INFOR]: SEN training of class 47_500 before transform: 43
[INFOR]: SPE training of class 47_500 before transform: 497

[INFOR]: SEN training of class 47_500 after transform: 468
[INFOR]: SPE training of class 47_500 after transform: 371
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 64ms/step
[INFOR]: Index of most vote   :147
[INFOR]: Class of most vote   :grey whale, gray whale, devilfish, Eschrichtius gibbosus, Eschrichtius robustus
[INFOR]: Number of most vote  :10.0


[INFOR]: Index of second most vote     :781
[INFOR]: Class of second most vote     :scoreboard
[INFOR]: Number of second most vote    :7.0
[INFOR]: SEN testing of class 47_100 before transform: 10
[INFOR]: SPE testing of class 47_100 before transform: 100

[INFOR]: SEN testing of class 47_100 after transform: 98
[INFOR]: SPE testing of class 47_100 after transform: 12
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name cifar_100 --class_name_train 48_500 --class_name_test 48_100
2021-09-08 15:07:16.464251: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  cifar_100
class_name_train =  48_500
class_name_test =  48_100
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 15:07:19.026688: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 15:07:19.050398: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 15:07:19.055519: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 15:07:19.063459: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:07:19.065669: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:07:19.070892: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 15:07:19.074334: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 15:07:19.080807: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 15:07:19.085662: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 15:07:19.088638: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:07:19.090941: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 15:07:19.093079: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 15:07:19.105573: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1c1bb0e0830 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 15:07:19.109259: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 15:07:19.111438: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 15:07:19.115762: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 15:07:19.118065: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:07:19.120535: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:07:19.122904: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 15:07:19.125156: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 15:07:19.127423: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 15:07:19.129802: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 15:07:19.132262: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:07:19.134484: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 15:07:19.554934: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 15:07:19.558002: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 15:07:19.559455: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 15:07:19.561075: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 15:07:19.568181: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1c1e5da6440 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 15:07:19.571186: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 15:07:21.840401: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 15:07:23.020255: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:07:23.658668: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:07:23.665734: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:07:24.987918: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 15:07:25.037612: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 15:07:25.601076: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 6s 73ms/step
[INFOR]: Index of most vote   :856
[INFOR]: Class of most vote   :thresher, thrasher, threshing machine
[INFOR]: Number of most vote  :143.0


[INFOR]: Index of second most vote     :665
[INFOR]: Class of second most vote     :moped
[INFOR]: Number of second most vote    :67.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 3s 62ms/step
[INFOR]: Toltal norm before transform: 0.6628
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.4554

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 2s 62ms/step
[INFOR]: SEN training of class 48_500 before transform: 143
[INFOR]: SPE training of class 48_500 before transform: 493

[INFOR]: SEN training of class 48_500 after transform: 461
[INFOR]: SPE training of class 48_500 after transform: 420
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 63ms/step
[INFOR]: Index of most vote   :856
[INFOR]: Class of most vote   :thresher, thrasher, threshing machine
[INFOR]: Number of most vote  :30.0


[INFOR]: Index of second most vote     :680
[INFOR]: Class of second most vote     :nipple
[INFOR]: Number of second most vote    :14.0
[INFOR]: SEN testing of class 48_100 before transform: 30
[INFOR]: SPE testing of class 48_100 before transform: 99

[INFOR]: SEN testing of class 48_100 after transform: 96
[INFOR]: SPE testing of class 48_100 after transform: 27
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name cifar_100 --class_name_train 49_500 --class_name_test 49_100
2021-09-08 15:07:37.340782: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  cifar_100
class_name_train =  49_500
class_name_test =  49_100
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 15:07:39.899337: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 15:07:39.926543: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 15:07:39.931863: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 15:07:39.939861: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:07:39.942075: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:07:39.947170: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 15:07:39.950589: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 15:07:39.957077: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 15:07:39.961974: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 15:07:39.965125: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:07:39.967344: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 15:07:39.969271: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 15:07:39.981316: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x2acb38a3720 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 15:07:39.984630: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 15:07:39.986919: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 15:07:39.991330: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 15:07:39.993798: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:07:39.996064: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:07:39.998391: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 15:07:40.000642: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 15:07:40.003035: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 15:07:40.005391: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 15:07:40.007680: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:07:40.009928: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 15:07:40.432586: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 15:07:40.435867: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 15:07:40.437306: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 15:07:40.438904: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 15:07:40.445833: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x2acdd503570 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 15:07:40.448884: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 15:07:42.712443: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 15:07:43.885730: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:07:44.541440: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:07:44.548629: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:07:45.879503: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 15:07:45.929540: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 15:07:46.493494: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 6s 73ms/step
[INFOR]: Index of most vote   :149
[INFOR]: Class of most vote   :dugong, Dugong dugon
[INFOR]: Number of most vote  :68.0


[INFOR]: Index of second most vote     :147
[INFOR]: Class of second most vote     :grey whale, gray whale, devilfish, Eschrichtius gibbosus, Eschrichtius robustus
[INFOR]: Number of second most vote    :59.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 3s 62ms/step
[INFOR]: Toltal norm before transform: 0.8388
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1145

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 2s 62ms/step
[INFOR]: SEN training of class 49_500 before transform: 68
[INFOR]: SPE training of class 49_500 before transform: 478

[INFOR]: SEN training of class 49_500 after transform: 476
[INFOR]: SPE training of class 49_500 after transform: 379
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 65ms/step
[INFOR]: Index of most vote   :147
[INFOR]: Class of most vote   :grey whale, gray whale, devilfish, Eschrichtius gibbosus, Eschrichtius robustus
[INFOR]: Number of most vote  :10.0


[INFOR]: Index of second most vote     :148
[INFOR]: Class of second most vote     :killer whale, killer, orca, grampus, sea wolf, Orcinus orca
[INFOR]: Number of second most vote    :10.0
[INFOR]: SEN testing of class 49_100 before transform: 10
[INFOR]: SPE testing of class 49_100 before transform: 98

[INFOR]: SEN testing of class 49_100 after transform: 46
[INFOR]: SPE testing of class 49_100 after transform: 11
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name cifar_100 --class_name_train 50_500 --class_name_test 50_100
2021-09-08 15:07:58.249017: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  cifar_100
class_name_train =  50_500
class_name_test =  50_100
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 15:08:00.783915: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 15:08:00.807362: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 15:08:00.812341: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 15:08:00.820311: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:08:00.822502: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:08:00.827662: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 15:08:00.831105: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 15:08:00.837561: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 15:08:00.842516: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 15:08:00.845467: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:08:00.847665: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 15:08:00.849582: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 15:08:00.861726: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x231b6db0c80 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 15:08:00.865000: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 15:08:00.867240: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 15:08:00.871678: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 15:08:00.873886: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:08:00.876107: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:08:00.878548: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 15:08:00.880750: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 15:08:00.883166: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 15:08:00.885434: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 15:08:00.887813: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:08:00.890029: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 15:08:01.317219: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 15:08:01.320085: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 15:08:01.321669: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 15:08:01.323313: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 15:08:01.330023: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x231e2d659c0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 15:08:01.333111: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 15:08:03.578241: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 15:08:04.755122: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:08:05.400913: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:08:05.407536: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:08:06.759712: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 15:08:06.810902: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 15:08:07.395562: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 6s 75ms/step
[INFOR]: Index of most vote   :335
[INFOR]: Class of most vote   :fox squirrel, eastern fox squirrel, Sciurus niger
[INFOR]: Number of most vote  :139.0


[INFOR]: Index of second most vote     :679
[INFOR]: Class of second most vote     :necklace
[INFOR]: Number of second most vote    :66.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 3s 62ms/step
[INFOR]: Toltal norm before transform: 0.7031
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1329

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 2s 63ms/step
[INFOR]: SEN training of class 50_500 before transform: 139
[INFOR]: SPE training of class 50_500 before transform: 459

[INFOR]: SEN training of class 50_500 after transform: 383
[INFOR]: SPE training of class 50_500 after transform: 332
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 63ms/step
[INFOR]: Index of most vote   :335
[INFOR]: Class of most vote   :fox squirrel, eastern fox squirrel, Sciurus niger
[INFOR]: Number of most vote  :27.0


[INFOR]: Index of second most vote     :679
[INFOR]: Class of second most vote     :necklace
[INFOR]: Number of second most vote    :18.0
[INFOR]: SEN testing of class 50_100 before transform: 27
[INFOR]: SPE testing of class 50_100 before transform: 94

[INFOR]: SEN testing of class 50_100 after transform: 87
[INFOR]: SPE testing of class 50_100 after transform: 46
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name cifar_100 --class_name_train 51_500 --class_name_test 51_100
2021-09-08 15:08:19.322142: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  cifar_100
class_name_train =  51_500
class_name_test =  51_100
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 15:08:21.899191: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 15:08:21.968535: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 15:08:21.973911: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 15:08:21.981930: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:08:21.984158: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:08:21.989509: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 15:08:21.993047: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 15:08:21.999450: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 15:08:22.004345: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 15:08:22.007664: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:08:22.009950: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 15:08:22.012073: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 15:08:22.024859: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x194bb5a57a0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 15:08:22.028937: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 15:08:22.031133: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 15:08:22.035495: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 15:08:22.038011: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:08:22.040276: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:08:22.042657: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 15:08:22.044922: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 15:08:22.047195: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 15:08:22.049756: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 15:08:22.052245: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:08:22.054497: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 15:08:22.487896: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 15:08:22.490784: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 15:08:22.492336: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 15:08:22.494108: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 15:08:22.501056: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x194e625d070 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 15:08:22.503978: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 15:08:24.797605: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 15:08:26.001844: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:08:26.650201: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:08:26.658352: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:08:27.981179: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 15:08:28.036078: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 15:08:28.596902: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 6s 72ms/step
[INFOR]: Index of most vote   :335
[INFOR]: Class of most vote   :fox squirrel, eastern fox squirrel, Sciurus niger
[INFOR]: Number of most vote  :85.0


[INFOR]: Index of second most vote     :679
[INFOR]: Class of second most vote     :necklace
[INFOR]: Number of second most vote    :38.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 3s 62ms/step
[INFOR]: Toltal norm before transform: 0.7794
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0019

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 2s 63ms/step
[INFOR]: SEN training of class 51_500 before transform: 85
[INFOR]: SPE training of class 51_500 before transform: 455

[INFOR]: SEN training of class 51_500 after transform: 462
[INFOR]: SPE training of class 51_500 after transform: 350
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 65ms/step
[INFOR]: Index of most vote   :335
[INFOR]: Class of most vote   :fox squirrel, eastern fox squirrel, Sciurus niger
[INFOR]: Number of most vote  :20.0


[INFOR]: Index of second most vote     :103
[INFOR]: Class of second most vote     :platypus, duckbill, duckbilled platypus, duck-billed platypus, Ornithorhynchus anatinus
[INFOR]: Number of second most vote    :7.0
[INFOR]: SEN testing of class 51_100 before transform: 20
[INFOR]: SPE testing of class 51_100 before transform: 96

[INFOR]: SEN testing of class 51_100 after transform: 96
[INFOR]: SPE testing of class 51_100 after transform: 25
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name cifar_100 --class_name_train 52_500 --class_name_test 52_100
2021-09-08 15:08:40.439712: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  cifar_100
class_name_train =  52_500
class_name_test =  52_100
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 15:08:43.011958: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 15:08:43.035495: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 15:08:43.041171: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 15:08:43.049339: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:08:43.051591: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:08:43.056938: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 15:08:43.060384: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 15:08:43.066539: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 15:08:43.071638: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 15:08:43.074622: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:08:43.077053: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 15:08:43.078976: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 15:08:43.091154: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1f33acbf120 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 15:08:43.094577: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 15:08:43.096698: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 15:08:43.101004: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 15:08:43.103391: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:08:43.105621: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:08:43.107883: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 15:08:43.110104: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 15:08:43.112341: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 15:08:43.114677: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 15:08:43.117141: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:08:43.119451: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 15:08:43.547102: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 15:08:43.550456: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 15:08:43.551893: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 15:08:43.553465: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 15:08:43.560442: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1f3660f0660 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 15:08:43.563574: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 15:08:45.839565: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 15:08:47.001412: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:08:47.642506: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:08:47.650008: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:08:48.975586: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 15:08:49.030042: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 15:08:49.590970: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 6s 72ms/step
[INFOR]: Index of most vote   :975
[INFOR]: Class of most vote   :lakeside, lakeshore
[INFOR]: Number of most vote  :59.0


[INFOR]: Index of second most vote     :856
[INFOR]: Class of second most vote     :thresher, thrasher, threshing machine
[INFOR]: Number of second most vote    :39.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 3s 62ms/step
[INFOR]: Toltal norm before transform: 0.8120
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0258

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 2s 62ms/step
[INFOR]: SEN training of class 52_500 before transform: 59
[INFOR]: SPE training of class 52_500 before transform: 500

[INFOR]: SEN training of class 52_500 after transform: 484
[INFOR]: SPE training of class 52_500 after transform: 399
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 63ms/step
[INFOR]: Index of most vote   :975
[INFOR]: Class of most vote   :lakeside, lakeshore
[INFOR]: Number of most vote  :14.0


[INFOR]: Index of second most vote     :439
[INFOR]: Class of second most vote     :bearskin, busby, shako
[INFOR]: Number of second most vote    :11.0
[INFOR]: SEN testing of class 52_100 before transform: 14
[INFOR]: SPE testing of class 52_100 before transform: 100

[INFOR]: SEN testing of class 52_100 after transform: 85
[INFOR]: SPE testing of class 52_100 after transform: 43
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name cifar_100 --class_name_train 53_500 --class_name_test 53_100
2021-09-08 15:09:01.245178: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  cifar_100
class_name_train =  53_500
class_name_test =  53_100
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 15:09:03.830495: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 15:09:03.856187: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 15:09:03.861951: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 15:09:03.869964: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:09:03.872356: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:09:03.877735: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 15:09:03.881214: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 15:09:03.887617: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 15:09:03.892694: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 15:09:03.895747: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:09:03.897974: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 15:09:03.900108: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 15:09:03.913123: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1deb509b510 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 15:09:03.916734: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 15:09:03.918997: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 15:09:03.923609: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 15:09:03.925954: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:09:03.928233: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:09:03.930558: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 15:09:03.932855: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 15:09:03.935125: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 15:09:03.937596: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 15:09:03.939898: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:09:03.942161: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 15:09:04.366791: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 15:09:04.370123: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 15:09:04.371600: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 15:09:04.373228: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 15:09:04.380146: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1dee468df60 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 15:09:04.383079: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 15:09:06.682266: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 15:09:07.867291: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:09:08.510752: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:09:08.518724: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:09:09.848493: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 15:09:09.897723: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 15:09:10.460039: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 6s 74ms/step
[INFOR]: Index of most vote   :722
[INFOR]: Class of most vote   :ping-pong ball
[INFOR]: Number of most vote  :146.0


[INFOR]: Index of second most vote     :551
[INFOR]: Class of second most vote     :face powder
[INFOR]: Number of second most vote    :72.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 3s 64ms/step
[INFOR]: Toltal norm before transform: 0.6555
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0755

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 2s 64ms/step
[INFOR]: SEN training of class 53_500 before transform: 146
[INFOR]: SPE training of class 53_500 before transform: 497

[INFOR]: SEN training of class 53_500 after transform: 481
[INFOR]: SPE training of class 53_500 after transform: 446
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 66ms/step
[INFOR]: Index of most vote   :722
[INFOR]: Class of most vote   :ping-pong ball
[INFOR]: Number of most vote  :32.0


[INFOR]: Index of second most vote     :837
[INFOR]: Class of second most vote     :sunglasses, dark glasses, shades
[INFOR]: Number of second most vote    :15.0
[INFOR]: SEN testing of class 53_100 before transform: 32
[INFOR]: SPE testing of class 53_100 before transform: 100

[INFOR]: SEN testing of class 53_100 after transform: 96
[INFOR]: SPE testing of class 53_100 after transform: 53
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name cifar_100 --class_name_train 54_500 --class_name_test 54_100
2021-09-08 15:09:22.424926: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  cifar_100
class_name_train =  54_500
class_name_test =  54_100
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 15:09:25.117266: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 15:09:25.178445: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 15:09:25.183563: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 15:09:25.192088: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:09:25.194677: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:09:25.200018: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 15:09:25.203620: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 15:09:25.210239: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 15:09:25.215465: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 15:09:25.218624: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:09:25.220931: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 15:09:25.223089: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 15:09:25.235430: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x27fb38ef690 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 15:09:25.238593: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 15:09:25.240853: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 15:09:25.245386: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 15:09:25.247899: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:09:25.250387: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:09:25.252857: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 15:09:25.255327: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 15:09:25.257702: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 15:09:25.260342: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 15:09:25.262830: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:09:25.265223: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 15:09:25.712946: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 15:09:25.715950: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 15:09:25.717482: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 15:09:25.719101: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 15:09:25.725907: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x27fde9c3020 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 15:09:25.729016: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 15:09:28.034167: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 15:09:29.202883: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:09:29.849418: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:09:29.858310: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:09:31.188508: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 15:09:31.237339: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 15:09:31.846792: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 6s 72ms/step
[INFOR]: Index of most vote   :680
[INFOR]: Class of most vote   :nipple
[INFOR]: Number of most vote  :72.0


[INFOR]: Index of second most vote     :653
[INFOR]: Class of second most vote     :milk can
[INFOR]: Number of second most vote    :30.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 3s 62ms/step
[INFOR]: Toltal norm before transform: 0.8587
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.3121

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 2s 62ms/step
[INFOR]: SEN training of class 54_500 before transform: 72
[INFOR]: SPE training of class 54_500 before transform: 460

[INFOR]: SEN training of class 54_500 after transform: 458
[INFOR]: SPE training of class 54_500 after transform: 369
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 62ms/step
[INFOR]: Index of most vote   :680
[INFOR]: Class of most vote   :nipple
[INFOR]: Number of most vote  :14.0


[INFOR]: Index of second most vote     :713
[INFOR]: Class of second most vote     :photocopier
[INFOR]: Number of second most vote    :8.0
[INFOR]: SEN testing of class 54_100 before transform: 14
[INFOR]: SPE testing of class 54_100 before transform: 96

[INFOR]: SEN testing of class 54_100 after transform: 54
[INFOR]: SPE testing of class 54_100 after transform: 7
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name cifar_100 --class_name_train 55_500 --class_name_test 55_100
2021-09-08 15:09:43.527032: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  cifar_100
class_name_train =  55_500
class_name_test =  55_100
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 15:09:46.100010: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 15:09:46.125991: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 15:09:46.131571: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 15:09:46.139823: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:09:46.142236: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:09:46.147576: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 15:09:46.151266: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 15:09:46.157614: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 15:09:46.162758: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 15:09:46.165734: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:09:46.168024: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 15:09:46.169959: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 15:09:46.182110: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x13b37a677d0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 15:09:46.185523: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 15:09:46.187866: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 15:09:46.192204: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 15:09:46.194485: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:09:46.196965: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:09:46.199331: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 15:09:46.201593: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 15:09:46.203865: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 15:09:46.206240: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 15:09:46.208750: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:09:46.211007: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 15:09:46.637349: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 15:09:46.640757: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 15:09:46.642211: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 15:09:46.643790: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 15:09:46.650713: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x13b65a60c90 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 15:09:46.653834: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 15:09:48.886473: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 15:09:50.052264: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:09:50.695820: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:09:50.703341: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:09:52.043178: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 15:09:52.091112: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 15:09:52.680070: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 6s 72ms/step
[INFOR]: Index of most vote   :335
[INFOR]: Class of most vote   :fox squirrel, eastern fox squirrel, Sciurus niger
[INFOR]: Number of most vote  :83.0


[INFOR]: Index of second most vote     :103
[INFOR]: Class of second most vote     :platypus, duckbill, duckbilled platypus, duck-billed platypus, Ornithorhynchus anatinus
[INFOR]: Number of second most vote    :72.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 3s 62ms/step
[INFOR]: Toltal norm before transform: 0.8142
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0202

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 2s 63ms/step
[INFOR]: SEN training of class 55_500 before transform: 83
[INFOR]: SPE training of class 55_500 before transform: 463

[INFOR]: SEN training of class 55_500 after transform: 419
[INFOR]: SPE training of class 55_500 after transform: 323
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 63ms/step
[INFOR]: Index of most vote   :335
[INFOR]: Class of most vote   :fox squirrel, eastern fox squirrel, Sciurus niger
[INFOR]: Number of most vote  :18.0


[INFOR]: Index of second most vote     :149
[INFOR]: Class of second most vote     :dugong, Dugong dugon
[INFOR]: Number of second most vote    :13.0
[INFOR]: SEN testing of class 55_100 before transform: 18
[INFOR]: SPE testing of class 55_100 before transform: 90

[INFOR]: SEN testing of class 55_100 after transform: 87
[INFOR]: SPE testing of class 55_100 after transform: 35
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name cifar_100 --class_name_train 56_500 --class_name_test 56_100
2021-09-08 15:10:04.411627: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  cifar_100
class_name_train =  56_500
class_name_test =  56_100
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 15:10:06.947589: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 15:10:06.972643: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 15:10:06.978512: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 15:10:06.986551: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:10:06.988890: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:10:06.994273: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 15:10:06.997826: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 15:10:07.004378: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 15:10:07.009741: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 15:10:07.012798: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:10:07.015092: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 15:10:07.017038: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 15:10:07.029437: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x14835bfc440 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 15:10:07.032790: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 15:10:07.034984: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 15:10:07.039772: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 15:10:07.042148: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:10:07.044464: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:10:07.046803: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 15:10:07.049102: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 15:10:07.051418: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 15:10:07.053827: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 15:10:07.056292: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:10:07.058602: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 15:10:07.484953: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 15:10:07.488135: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 15:10:07.489735: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 15:10:07.491298: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 15:10:07.498307: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1486180d8b0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 15:10:07.501380: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 15:10:09.762011: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 15:10:10.936030: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:10:11.579063: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:10:11.586123: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:10:12.906208: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 15:10:12.961091: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 15:10:13.521600: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 6s 72ms/step
[INFOR]: Index of most vote   :335
[INFOR]: Class of most vote   :fox squirrel, eastern fox squirrel, Sciurus niger
[INFOR]: Number of most vote  :44.0


[INFOR]: Index of second most vote     :555
[INFOR]: Class of second most vote     :fire engine, fire truck
[INFOR]: Number of second most vote    :27.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 3s 62ms/step
[INFOR]: Toltal norm before transform: 0.8931
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1244

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 2s 63ms/step
[INFOR]: SEN training of class 56_500 before transform: 44
[INFOR]: SPE training of class 56_500 before transform: 467

[INFOR]: SEN training of class 56_500 after transform: 449
[INFOR]: SPE training of class 56_500 after transform: 375
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 65ms/step
[INFOR]: Index of most vote   :335
[INFOR]: Class of most vote   :fox squirrel, eastern fox squirrel, Sciurus niger
[INFOR]: Number of most vote  :11.0


[INFOR]: Index of second most vote     :555
[INFOR]: Class of second most vote     :fire engine, fire truck
[INFOR]: Number of second most vote    :6.0
[INFOR]: SEN testing of class 56_100 before transform: 11
[INFOR]: SPE testing of class 56_100 before transform: 90

[INFOR]: SEN testing of class 56_100 after transform: 90
[INFOR]: SPE testing of class 56_100 after transform: 1
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name cifar_100 --class_name_train 57_500 --class_name_test 57_100
2021-09-08 15:10:25.305830: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  cifar_100
class_name_train =  57_500
class_name_test =  57_100
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 15:10:27.891377: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 15:10:27.915867: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 15:10:27.920656: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 15:10:27.928753: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:10:27.931005: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:10:27.936163: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 15:10:27.939880: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 15:10:27.946263: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 15:10:27.951270: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 15:10:27.954300: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:10:27.956630: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 15:10:27.958609: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 15:10:27.971382: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x20e3b07d430 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 15:10:27.975008: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 15:10:27.977212: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 15:10:27.981595: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 15:10:27.983935: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:10:27.986419: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:10:27.988914: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 15:10:27.991247: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 15:10:27.993550: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 15:10:27.995949: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 15:10:27.998290: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:10:28.000601: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 15:10:28.427273: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 15:10:28.430606: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 15:10:28.432158: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 15:10:28.433916: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 15:10:28.440741: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x20e668770a0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 15:10:28.443776: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 15:10:30.735062: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 15:10:31.926430: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:10:32.572074: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:10:32.579488: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:10:33.915284: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 15:10:33.965870: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 15:10:34.569764: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 6s 74ms/step
[INFOR]: Index of most vote   :680
[INFOR]: Class of most vote   :nipple
[INFOR]: Number of most vote  :169.0


[INFOR]: Index of second most vote     :746
[INFOR]: Class of second most vote     :puck, hockey puck
[INFOR]: Number of second most vote    :42.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 3s 65ms/step
[INFOR]: Toltal norm before transform: 0.6279
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1048

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 2s 64ms/step
[INFOR]: SEN training of class 57_500 before transform: 169
[INFOR]: SPE training of class 57_500 before transform: 467

[INFOR]: SEN training of class 57_500 after transform: 462
[INFOR]: SPE training of class 57_500 after transform: 408
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 65ms/step
[INFOR]: Index of most vote   :680
[INFOR]: Class of most vote   :nipple
[INFOR]: Number of most vote  :30.0


[INFOR]: Index of second most vote     :641
[INFOR]: Class of second most vote     :maraca
[INFOR]: Number of second most vote    :10.0
[INFOR]: SEN testing of class 57_100 before transform: 30
[INFOR]: SPE testing of class 57_100 before transform: 96

[INFOR]: SEN testing of class 57_100 after transform: 96
[INFOR]: SPE testing of class 57_100 after transform: 36
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name cifar_100 --class_name_train 58_500 --class_name_test 58_100
2021-09-08 15:10:46.489873: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  cifar_100
class_name_train =  58_500
class_name_test =  58_100
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 15:10:49.029711: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 15:10:49.090019: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 15:10:49.095296: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 15:10:49.103572: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:10:49.105901: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:10:49.111100: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 15:10:49.114599: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 15:10:49.121114: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 15:10:49.126291: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 15:10:49.129324: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:10:49.131624: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 15:10:49.133779: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 15:10:49.146359: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x251353e50c0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 15:10:49.150809: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 15:10:49.153313: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 15:10:49.158248: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 15:10:49.160752: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:10:49.163338: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:10:49.166121: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 15:10:49.168593: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 15:10:49.171072: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 15:10:49.173578: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 15:10:49.176170: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:10:49.178578: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 15:10:49.612373: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 15:10:49.615686: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 15:10:49.617245: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 15:10:49.618810: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 15:10:49.625481: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x25160cade10 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 15:10:49.628438: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 15:10:51.879166: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 15:10:53.055596: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:10:53.698330: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:10:53.705140: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:10:55.029254: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 15:10:55.076669: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 15:10:55.639636: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 6s 73ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :227.0


[INFOR]: Index of second most vote     :408
[INFOR]: Class of second most vote     :amphibian, amphibious vehicle
[INFOR]: Number of second most vote    :52.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 3s 62ms/step
[INFOR]: Toltal norm before transform: 0.4008
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0780

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 2s 62ms/step
[INFOR]: SEN training of class 58_500 before transform: 227
[INFOR]: SPE training of class 58_500 before transform: 490

[INFOR]: SEN training of class 58_500 after transform: 476
[INFOR]: SPE training of class 58_500 after transform: 388
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 63ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :40.0


[INFOR]: Index of second most vote     :408
[INFOR]: Class of second most vote     :amphibian, amphibious vehicle
[INFOR]: Number of second most vote    :10.0
[INFOR]: SEN testing of class 58_100 before transform: 40
[INFOR]: SPE testing of class 58_100 before transform: 96

[INFOR]: SEN testing of class 58_100 after transform: 100
[INFOR]: SPE testing of class 58_100 after transform: 12
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name cifar_100 --class_name_train 59_500 --class_name_test 59_1005
2021-09-08 15:11:07.391814: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  cifar_100
class_name_train =  59_500
class_name_test =  59_1005
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 15:11:09.978843: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 15:11:10.068369: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 15:11:10.073557: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 15:11:10.081728: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:11:10.083954: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:11:10.089158: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 15:11:10.092658: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 15:11:10.099407: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 15:11:10.104400: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 15:11:10.107626: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:11:10.110033: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 15:11:10.111971: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 15:11:10.124162: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1a1bb1207a0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 15:11:10.127294: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 15:11:10.129493: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 15:11:10.133905: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 15:11:10.136179: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:11:10.138656: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:11:10.141140: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 15:11:10.143441: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 15:11:10.145710: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 15:11:10.148233: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 15:11:10.150529: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:11:10.152781: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 15:11:10.600833: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 15:11:10.604079: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 15:11:10.605531: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 15:11:10.607107: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 15:11:10.614104: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1a1e9276d10 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 15:11:10.617038: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 15:11:12.909425: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 15:11:14.095111: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:11:14.749096: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:11:14.757035: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:11:16.080178: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 15:11:16.128377: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 15:11:16.689695: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 6s 73ms/step
[INFOR]: Index of most vote   :335
[INFOR]: Class of most vote   :fox squirrel, eastern fox squirrel, Sciurus niger
[INFOR]: Number of most vote  :53.0


[INFOR]: Index of second most vote     :80
[INFOR]: Class of second most vote     :black grouse
[INFOR]: Number of second most vote    :49.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 3s 63ms/step
[INFOR]: Toltal norm before transform: 0.8836
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0981

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 2s 62ms/step
[INFOR]: SEN training of class 59_500 before transform: 53
[INFOR]: SPE training of class 59_500 before transform: 460

[INFOR]: SEN training of class 59_500 after transform: 459
[INFOR]: SPE training of class 59_500 after transform: 341
[INFOR]

==================== TESTING STAGE ====================


Traceback (most recent call last):
  File "main.py", line 252, in <module>
    main(FLAGS)
  File "main.py", line 113, in main
    x_test, y_test = get_data(FLAGS.dataset_name, 'test', FLAGS.class_name_test)
  File "C:\Users\LauNT\Desktop\topology\generate\utils.py", line 59, in get_data
    else: raise ValueError('[ERROR]: path to data not found')
ValueError: [ERROR]: path to data not found

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name cifar_100 --class_name_train 60_500 --class_name_test 60_100
2021-09-08 15:11:27.721392: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  cifar_100
class_name_train =  60_500
class_name_test =  60_100
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 15:11:30.251204: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 15:11:30.277447: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 15:11:30.282034: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 15:11:30.289937: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:11:30.292506: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:11:30.297692: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 15:11:30.301160: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 15:11:30.307529: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 15:11:30.312402: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 15:11:30.315454: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:11:30.317697: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 15:11:30.319814: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 15:11:30.332756: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x2c9b62934b0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 15:11:30.336324: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 15:11:30.338695: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 15:11:30.343169: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 15:11:30.345630: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:11:30.347897: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:11:30.350244: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 15:11:30.352489: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 15:11:30.354764: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 15:11:30.357056: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 15:11:30.359525: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:11:30.361774: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 15:11:30.780870: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 15:11:30.783622: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 15:11:30.785196: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 15:11:30.786765: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 15:11:30.793525: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x2c9e4cab580 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 15:11:30.796605: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 15:11:33.060429: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 15:11:34.238227: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:11:34.873121: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:11:34.880477: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:11:36.202113: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 15:11:36.251446: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 15:11:36.811208: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 6s 75ms/step
[INFOR]: Index of most vote   :147
[INFOR]: Class of most vote   :grey whale, gray whale, devilfish, Eschrichtius gibbosus, Eschrichtius robustus
[INFOR]: Number of most vote  :186.0


[INFOR]: Index of second most vote     :498
[INFOR]: Class of second most vote     :cinema, movie theater, movie theatre, movie house, picture palace
[INFOR]: Number of second most vote    :65.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 3s 62ms/step
[INFOR]: Toltal norm before transform: 0.5096
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.3025

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 2s 62ms/step
[INFOR]: SEN training of class 60_500 before transform: 186
[INFOR]: SPE training of class 60_500 before transform: 495

[INFOR]: SEN training of class 60_500 after transform: 477
[INFOR]: SPE training of class 60_500 after transform: 417
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 65ms/step
[INFOR]: Index of most vote   :147
[INFOR]: Class of most vote   :grey whale, gray whale, devilfish, Eschrichtius gibbosus, Eschrichtius robustus
[INFOR]: Number of most vote  :40.0


[INFOR]: Index of second most vote     :498
[INFOR]: Class of second most vote     :cinema, movie theater, movie theatre, movie house, picture palace
[INFOR]: Number of second most vote    :14.0
[INFOR]: SEN testing of class 60_100 before transform: 40
[INFOR]: SPE testing of class 60_100 before transform: 100

[INFOR]: SEN testing of class 60_100 after transform: 94
[INFOR]: SPE testing of class 60_100 after transform: 32
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name cifar_100 --class_name_train 61_500 --class_name_test 61_100
2021-09-08 15:11:48.629262: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  cifar_100
class_name_train =  61_500
class_name_test =  61_100
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 15:11:51.117942: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 15:11:51.144927: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 15:11:51.150117: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 15:11:51.158177: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:11:51.160566: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:11:51.165721: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 15:11:51.169203: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 15:11:51.175641: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 15:11:51.180571: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 15:11:51.183642: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:11:51.186117: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 15:11:51.188097: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 15:11:51.200683: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1dfb68c5ae0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 15:11:51.204420: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 15:11:51.206774: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 15:11:51.211454: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 15:11:51.213806: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:11:51.216142: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:11:51.218489: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 15:11:51.220868: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 15:11:51.223380: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 15:11:51.225768: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 15:11:51.228091: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:11:51.230372: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 15:11:51.650012: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 15:11:51.653305: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 15:11:51.654750: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 15:11:51.656340: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 15:11:51.663246: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1dfe6315890 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 15:11:51.666162: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 15:11:53.902018: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 15:11:55.064933: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:11:55.707710: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:11:55.716121: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:11:57.047936: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 15:11:57.095584: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 15:11:57.659989: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 6s 74ms/step
[INFOR]: Index of most vote   :551
[INFOR]: Class of most vote   :face powder
[INFOR]: Number of most vote  :126.0


[INFOR]: Index of second most vote     :679
[INFOR]: Class of second most vote     :necklace
[INFOR]: Number of second most vote    :65.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 3s 63ms/step
[INFOR]: Toltal norm before transform: 0.6977
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1270

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 2s 62ms/step
[INFOR]: SEN training of class 61_500 before transform: 126
[INFOR]: SPE training of class 61_500 before transform: 494

[INFOR]: SEN training of class 61_500 after transform: 494
[INFOR]: SPE training of class 61_500 after transform: 440
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 65ms/step
[INFOR]: Index of most vote   :551
[INFOR]: Class of most vote   :face powder
[INFOR]: Number of most vote  :24.0


[INFOR]: Index of second most vote     :679
[INFOR]: Class of second most vote     :necklace
[INFOR]: Number of second most vote    :13.0
[INFOR]: SEN testing of class 61_100 before transform: 24
[INFOR]: SPE testing of class 61_100 before transform: 98

[INFOR]: SEN testing of class 61_100 after transform: 77
[INFOR]: SPE testing of class 61_100 after transform: 2
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name cifar_100 --class_name_train 62_500 --class_name_test 62_100
2021-09-08 15:12:09.470948: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  cifar_100
class_name_train =  62_500
class_name_test =  62_100
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 15:12:11.972808: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 15:12:11.998209: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 15:12:12.003500: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 15:12:12.011531: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:12:12.013907: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:12:12.019125: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 15:12:12.022846: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 15:12:12.029369: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 15:12:12.034558: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 15:12:12.037614: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:12:12.039910: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 15:12:12.041858: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 15:12:12.054108: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x17237aec6c0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 15:12:12.057226: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 15:12:12.059441: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 15:12:12.063951: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 15:12:12.066211: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:12:12.068464: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:12:12.070937: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 15:12:12.073174: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 15:12:12.075529: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 15:12:12.077876: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 15:12:12.080150: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:12:12.082379: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 15:12:12.502885: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 15:12:12.506184: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 15:12:12.507755: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 15:12:12.509324: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 15:12:12.516421: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1726266f330 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 15:12:12.519374: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 15:12:14.760603: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 15:12:15.942274: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:12:16.582190: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:12:16.589723: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:12:17.929632: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 15:12:17.979804: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 15:12:18.540535: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 6s 72ms/step
[INFOR]: Index of most vote   :680
[INFOR]: Class of most vote   :nipple
[INFOR]: Number of most vote  :75.0


[INFOR]: Index of second most vote     :392
[INFOR]: Class of second most vote     :rock beauty, Holocanthus tricolor
[INFOR]: Number of second most vote    :67.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 3s 62ms/step
[INFOR]: Toltal norm before transform: 0.8568
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.3691

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 2s 63ms/step
[INFOR]: SEN training of class 62_500 before transform: 75
[INFOR]: SPE training of class 62_500 before transform: 460

[INFOR]: SEN training of class 62_500 after transform: 481
[INFOR]: SPE training of class 62_500 after transform: 370
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 64ms/step
[INFOR]: Index of most vote   :714
[INFOR]: Class of most vote   :pick, plectrum, plectron
[INFOR]: Number of most vote  :13.0


[INFOR]: Index of second most vote     :392
[INFOR]: Class of second most vote     :rock beauty, Holocanthus tricolor
[INFOR]: Number of second most vote    :11.0
[INFOR]: SEN testing of class 62_100 before transform: 13
[INFOR]: SPE testing of class 62_100 before transform: 99

[INFOR]: SEN testing of class 62_100 after transform: 95
[INFOR]: SPE testing of class 62_100 after transform: 22
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name cifar_100 --class_name_train 63_500 --class_name_test 63_100
2021-09-08 15:12:30.257576: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  cifar_100
class_name_train =  63_500
class_name_test =  63_100
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 15:12:32.876716: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 15:12:32.902931: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 15:12:32.909024: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 15:12:32.916794: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:12:32.918998: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:12:32.924192: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 15:12:32.927428: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 15:12:32.933278: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 15:12:32.938371: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 15:12:32.941233: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:12:32.943354: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 15:12:32.945219: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 15:12:32.957686: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x16637c7eb40 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 15:12:32.961494: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 15:12:32.963693: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 15:12:32.967951: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 15:12:32.970056: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:12:32.972148: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:12:32.974272: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 15:12:32.976364: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 15:12:32.978463: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 15:12:32.980588: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 15:12:32.982974: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:12:32.985102: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 15:12:33.410218: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 15:12:33.413697: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 15:12:33.415087: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 15:12:33.416560: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 15:12:33.423396: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x166627cfaa0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 15:12:33.426212: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 15:12:35.664263: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 15:12:36.841263: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:12:37.486179: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:12:37.493204: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:12:38.839402: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 15:12:38.890470: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 15:12:39.481583: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 6s 75ms/step
[INFOR]: Index of most vote   :335
[INFOR]: Class of most vote   :fox squirrel, eastern fox squirrel, Sciurus niger
[INFOR]: Number of most vote  :147.0


[INFOR]: Index of second most vote     :103
[INFOR]: Class of second most vote     :platypus, duckbill, duckbilled platypus, duck-billed platypus, Ornithorhynchus anatinus
[INFOR]: Number of second most vote    :90.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 3s 63ms/step
[INFOR]: Toltal norm before transform: 0.6750
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.2918

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 2s 62ms/step
[INFOR]: SEN training of class 63_500 before transform: 147
[INFOR]: SPE training of class 63_500 before transform: 456

[INFOR]: SEN training of class 63_500 after transform: 471
[INFOR]: SPE training of class 63_500 after transform: 344
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 63ms/step
[INFOR]: Index of most vote   :335
[INFOR]: Class of most vote   :fox squirrel, eastern fox squirrel, Sciurus niger
[INFOR]: Number of most vote  :30.0


[INFOR]: Index of second most vote     :103
[INFOR]: Class of second most vote     :platypus, duckbill, duckbilled platypus, duck-billed platypus, Ornithorhynchus anatinus
[INFOR]: Number of second most vote    :12.0
[INFOR]: SEN testing of class 63_100 before transform: 30
[INFOR]: SPE testing of class 63_100 before transform: 91

[INFOR]: SEN testing of class 63_100 after transform: 78
[INFOR]: SPE testing of class 63_100 after transform: 6
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name cifar_100 --class_name_train 64_500 --class_name_test 64_100
2021-09-08 15:12:51.278107: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  cifar_100
class_name_train =  64_500
class_name_test =  64_100
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 15:12:53.805881: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 15:12:53.829784: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 15:12:53.834228: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 15:12:53.842621: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:12:53.844766: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:12:53.849972: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 15:12:53.853230: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 15:12:53.859349: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 15:12:53.864162: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 15:12:53.867009: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:12:53.869148: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 15:12:53.871184: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 15:12:53.883599: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x259354be8d0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 15:12:53.886996: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 15:12:53.888959: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 15:12:53.893336: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 15:12:53.895595: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:12:53.897673: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:12:53.899774: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 15:12:53.901891: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 15:12:53.904178: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 15:12:53.906354: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 15:12:53.908462: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:12:53.910633: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 15:12:54.334540: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 15:12:54.337920: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 15:12:54.339442: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 15:12:54.341032: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 15:12:54.348121: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x259602b7a30 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 15:12:54.350909: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 15:12:56.604676: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 15:12:57.770040: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:12:58.412200: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:12:58.420201: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:12:59.741436: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 15:12:59.795787: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 15:13:00.360557: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 6s 73ms/step
[INFOR]: Index of most vote   :335
[INFOR]: Class of most vote   :fox squirrel, eastern fox squirrel, Sciurus niger
[INFOR]: Number of most vote  :114.0


[INFOR]: Index of second most vote     :357
[INFOR]: Class of second most vote     :mink
[INFOR]: Number of second most vote    :43.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 3s 62ms/step
[INFOR]: Toltal norm before transform: 0.7352
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.2239

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 2s 62ms/step
[INFOR]: SEN training of class 64_500 before transform: 114
[INFOR]: SPE training of class 64_500 before transform: 462

[INFOR]: SEN training of class 64_500 after transform: 411
[INFOR]: SPE training of class 64_500 after transform: 347
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 64ms/step
[INFOR]: Index of most vote   :335
[INFOR]: Class of most vote   :fox squirrel, eastern fox squirrel, Sciurus niger
[INFOR]: Number of most vote  :21.0


[INFOR]: Index of second most vote     :357
[INFOR]: Class of second most vote     :mink
[INFOR]: Number of second most vote    :8.0
[INFOR]: SEN testing of class 64_100 before transform: 21
[INFOR]: SPE testing of class 64_100 before transform: 95

[INFOR]: SEN testing of class 64_100 after transform: 96
[INFOR]: SPE testing of class 64_100 after transform: 3
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name cifar_100 --class_name_train 65_500 --class_name_test 65_100
2021-09-08 15:13:12.067495: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  cifar_100
class_name_train =  65_500
class_name_test =  65_100
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 15:13:14.636605: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 15:13:14.664244: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 15:13:14.670234: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 15:13:14.678157: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:13:14.680287: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:13:14.685375: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 15:13:14.688749: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 15:13:14.694867: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 15:13:14.699585: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 15:13:14.702516: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:13:14.704651: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 15:13:14.706695: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 15:13:14.719294: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x19d36abb630 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 15:13:14.722858: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 15:13:14.724883: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 15:13:14.729066: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 15:13:14.731184: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:13:14.733387: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:13:14.735497: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 15:13:14.737684: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 15:13:14.740041: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 15:13:14.742272: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 15:13:14.744454: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:13:14.746587: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 15:13:15.169917: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 15:13:15.173196: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 15:13:15.174602: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 15:13:15.176068: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 15:13:15.182603: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x19d60ac3ac0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 15:13:15.185591: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 15:13:17.505371: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 15:13:18.761163: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:13:19.425337: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:13:19.432202: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:13:20.790566: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 15:13:20.840341: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 15:13:21.405236: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 6s 75ms/step
[INFOR]: Index of most vote   :335
[INFOR]: Class of most vote   :fox squirrel, eastern fox squirrel, Sciurus niger
[INFOR]: Number of most vote  :68.0


[INFOR]: Index of second most vote     :679
[INFOR]: Class of second most vote     :necklace
[INFOR]: Number of second most vote    :59.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 3s 64ms/step
[INFOR]: Toltal norm before transform: 0.8655
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0021

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 2s 64ms/step
[INFOR]: SEN training of class 65_500 before transform: 68
[INFOR]: SPE training of class 65_500 before transform: 467

[INFOR]: SEN training of class 65_500 after transform: 392
[INFOR]: SPE training of class 65_500 after transform: 331
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 65ms/step
[INFOR]: Index of most vote   :331
[INFOR]: Class of most vote   :hare
[INFOR]: Number of most vote  :14.0


[INFOR]: Index of second most vote     :330
[INFOR]: Class of second most vote     :wood rabbit, cottontail, cottontail rabbit
[INFOR]: Number of second most vote    :11.0
[INFOR]: SEN testing of class 65_100 before transform: 14
[INFOR]: SPE testing of class 65_100 before transform: 100

[INFOR]: SEN testing of class 65_100 after transform: 95
[INFOR]: SPE testing of class 65_100 after transform: 9
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name cifar_100 --class_name_train 66_500 --class_name_test 66_100
2021-09-08 15:13:33.367825: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  cifar_100
class_name_train =  66_500
class_name_test =  66_100
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 15:13:35.868538: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 15:13:35.895318: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 15:13:35.901581: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 15:13:35.909525: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:13:35.911659: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:13:35.916732: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 15:13:35.920098: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 15:13:35.926212: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 15:13:35.930912: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 15:13:35.933733: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:13:35.935937: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 15:13:35.937804: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 15:13:35.950186: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x22033880ab0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 15:13:35.953997: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 15:13:35.956015: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 15:13:35.960192: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 15:13:35.962303: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:13:35.964450: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:13:35.966882: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 15:13:35.968963: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 15:13:35.971063: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 15:13:35.973191: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 15:13:35.975386: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:13:35.977467: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 15:13:36.402229: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 15:13:36.405091: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 15:13:36.406533: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 15:13:36.408086: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 15:13:36.414969: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x2205f02f980 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 15:13:36.418009: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 15:13:38.652804: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 15:13:39.824089: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:13:40.466420: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:13:40.473573: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:13:41.801363: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 15:13:41.852254: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 15:13:42.423967: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 6s 75ms/step
[INFOR]: Index of most vote   :335
[INFOR]: Class of most vote   :fox squirrel, eastern fox squirrel, Sciurus niger
[INFOR]: Number of most vote  :96.0


[INFOR]: Index of second most vote     :370
[INFOR]: Class of second most vote     :guenon, guenon monkey
[INFOR]: Number of second most vote    :51.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 3s 63ms/step
[INFOR]: Toltal norm before transform: 0.7707
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0469

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 2s 62ms/step
[INFOR]: SEN training of class 66_500 before transform: 96
[INFOR]: SPE training of class 66_500 before transform: 466

[INFOR]: SEN training of class 66_500 after transform: 412
[INFOR]: SPE training of class 66_500 after transform: 337
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 63ms/step
[INFOR]: Index of most vote   :335
[INFOR]: Class of most vote   :fox squirrel, eastern fox squirrel, Sciurus niger
[INFOR]: Number of most vote  :18.0


[INFOR]: Index of second most vote     :370
[INFOR]: Class of second most vote     :guenon, guenon monkey
[INFOR]: Number of second most vote    :11.0
[INFOR]: SEN testing of class 66_100 before transform: 18
[INFOR]: SPE testing of class 66_100 before transform: 93

[INFOR]: SEN testing of class 66_100 after transform: 86
[INFOR]: SPE testing of class 66_100 after transform: 35
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name cifar_100 --class_name_train 67_500 --class_name_test 67_100
2021-09-08 15:13:54.367048: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  cifar_100
class_name_train =  67_500
class_name_test =  67_100
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 15:13:56.904927: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 15:13:56.928944: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 15:13:56.933276: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 15:13:56.941157: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:13:56.943319: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:13:56.948322: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 15:13:56.951680: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 15:13:56.958001: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 15:13:56.962840: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 15:13:56.965802: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:13:56.968220: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 15:13:56.970108: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 15:13:56.981795: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x18239578f70 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 15:13:56.984965: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 15:13:56.986974: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 15:13:56.991356: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 15:13:56.993506: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:13:56.995640: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:13:56.998014: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 15:13:57.000139: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 15:13:57.002273: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 15:13:57.004441: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 15:13:57.006673: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:13:57.008800: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 15:13:57.425368: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 15:13:57.428630: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 15:13:57.430022: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 15:13:57.431473: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 15:13:57.438280: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1826297c380 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 15:13:57.441062: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 15:13:59.706140: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 15:14:00.896719: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:14:01.533647: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:14:01.540597: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:14:02.858975: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 15:14:02.908931: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 15:14:03.470796: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 6s 73ms/step
[INFOR]: Index of most vote   :149
[INFOR]: Class of most vote   :dugong, Dugong dugon
[INFOR]: Number of most vote  :81.0


[INFOR]: Index of second most vote     :5
[INFOR]: Class of second most vote     :electric ray, crampfish, numbfish, torpedo
[INFOR]: Number of second most vote    :53.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 3s 62ms/step
[INFOR]: Toltal norm before transform: 0.8006
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1913

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 2s 62ms/step
[INFOR]: SEN training of class 67_500 before transform: 81
[INFOR]: SPE training of class 67_500 before transform: 478

[INFOR]: SEN training of class 67_500 after transform: 454
[INFOR]: SPE training of class 67_500 after transform: 347
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 65ms/step
[INFOR]: Index of most vote   :149
[INFOR]: Class of most vote   :dugong, Dugong dugon
[INFOR]: Number of most vote  :15.0


[INFOR]: Index of second most vote     :103
[INFOR]: Class of second most vote     :platypus, duckbill, duckbilled platypus, duck-billed platypus, Ornithorhynchus anatinus
[INFOR]: Number of second most vote    :9.0
[INFOR]: SEN testing of class 67_100 before transform: 15
[INFOR]: SPE testing of class 67_100 before transform: 99

[INFOR]: SEN testing of class 67_100 after transform: 77
[INFOR]: SPE testing of class 67_100 after transform: 3
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name cifar_100 --class_name_train 68_500 --class_name_test 68_100
2021-09-08 15:14:15.247800: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  cifar_100
class_name_train =  68_500
class_name_test =  68_100
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 15:14:17.768537: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 15:14:17.793480: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 15:14:17.799491: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 15:14:17.807266: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:14:17.809557: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:14:17.814478: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 15:14:17.817771: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 15:14:17.824093: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 15:14:17.828851: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 15:14:17.831740: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:14:17.833899: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 15:14:17.836151: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 15:14:17.848722: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x256bab59c70 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 15:14:17.852589: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 15:14:17.854613: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 15:14:17.858766: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 15:14:17.860874: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:14:17.863011: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:14:17.865507: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 15:14:17.867585: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 15:14:17.869681: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 15:14:17.871801: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 15:14:17.873924: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:14:17.876065: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 15:14:18.295513: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 15:14:18.298848: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 15:14:18.300215: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 15:14:18.301721: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 15:14:18.308807: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x256e8c4b670 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 15:14:18.311814: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 15:14:20.551795: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 15:14:21.722668: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:14:22.358137: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:14:22.365772: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:14:23.692515: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 15:14:23.750331: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 15:14:24.315158: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 6s 72ms/step
[INFOR]: Index of most vote   :149
[INFOR]: Class of most vote   :dugong, Dugong dugon
[INFOR]: Number of most vote  :44.0


[INFOR]: Index of second most vote     :905
[INFOR]: Class of second most vote     :window shade
[INFOR]: Number of second most vote    :32.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 3s 62ms/step
[INFOR]: Toltal norm before transform: 0.9223
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1049

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 2s 63ms/step
[INFOR]: SEN training of class 68_500 before transform: 44
[INFOR]: SPE training of class 68_500 before transform: 478

[INFOR]: SEN training of class 68_500 after transform: 449
[INFOR]: SPE training of class 68_500 after transform: 392
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 65ms/step
[INFOR]: Index of most vote   :149
[INFOR]: Class of most vote   :dugong, Dugong dugon
[INFOR]: Number of most vote  :9.0


[INFOR]: Index of second most vote     :905
[INFOR]: Class of second most vote     :window shade
[INFOR]: Number of second most vote    :6.0
[INFOR]: SEN testing of class 68_100 before transform: 9
[INFOR]: SPE testing of class 68_100 before transform: 98

[INFOR]: SEN testing of class 68_100 after transform: 84
[INFOR]: SPE testing of class 68_100 after transform: 21
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name cifar_100 --class_name_train 69_500 --class_name_test 69_100
2021-09-08 15:14:36.068317: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  cifar_100
class_name_train =  69_500
class_name_test =  69_100
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 15:14:38.602297: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 15:14:38.627247: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 15:14:38.633370: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 15:14:38.641310: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:14:38.643404: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:14:38.648270: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 15:14:38.651539: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 15:14:38.657884: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 15:14:38.662818: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 15:14:38.665657: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:14:38.667749: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 15:14:38.669778: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 15:14:38.682192: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x29bb6100960 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 15:14:38.685918: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 15:14:38.688101: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 15:14:38.692229: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 15:14:38.694325: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:14:38.696404: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:14:38.698510: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 15:14:38.700737: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 15:14:38.703042: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 15:14:38.705202: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 15:14:38.707307: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:14:38.709372: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 15:14:39.135581: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 15:14:39.138956: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 15:14:39.140752: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 15:14:39.142221: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 15:14:39.148834: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x29be4b1f2e0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 15:14:39.151660: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 15:14:41.409754: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 15:14:42.599095: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:14:43.238363: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:14:43.245525: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:14:44.564398: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 15:14:44.611867: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 15:14:45.172784: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 6s 72ms/step
[INFOR]: Index of most vote   :744
[INFOR]: Class of most vote   :projectile, missile
[INFOR]: Number of most vote  :102.0


[INFOR]: Index of second most vote     :811
[INFOR]: Class of second most vote     :space heater
[INFOR]: Number of second most vote    :47.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 3s 62ms/step
[INFOR]: Toltal norm before transform: 0.7622
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1595

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 2s 62ms/step
[INFOR]: SEN training of class 69_500 before transform: 102
[INFOR]: SPE training of class 69_500 before transform: 499

[INFOR]: SEN training of class 69_500 after transform: 446
[INFOR]: SPE training of class 69_500 after transform: 373
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 62ms/step
[INFOR]: Index of most vote   :744
[INFOR]: Class of most vote   :projectile, missile
[INFOR]: Number of most vote  :13.0


[INFOR]: Index of second most vote     :811
[INFOR]: Class of second most vote     :space heater
[INFOR]: Number of second most vote    :12.0
[INFOR]: SEN testing of class 69_100 before transform: 13
[INFOR]: SPE testing of class 69_100 before transform: 100

[INFOR]: SEN testing of class 69_100 after transform: 89
[INFOR]: SPE testing of class 69_100 after transform: 1
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name cifar_100 --class_name_train 70_500 --class_name_test 70_100
2021-09-08 15:14:56.931080: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  cifar_100
class_name_train =  70_500
class_name_test =  70_100
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 15:14:59.463011: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 15:14:59.486434: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 15:14:59.492939: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 15:14:59.501217: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:14:59.503319: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:14:59.508227: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 15:14:59.511765: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 15:14:59.517961: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 15:14:59.522699: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 15:14:59.526093: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:14:59.528201: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 15:14:59.530060: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 15:14:59.542278: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x24937f81a40 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 15:14:59.545522: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 15:14:59.547764: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 15:14:59.552056: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 15:14:59.554203: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:14:59.556379: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:14:59.558541: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 15:14:59.560674: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 15:14:59.562810: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 15:14:59.565044: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 15:14:59.567216: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:14:59.569342: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 15:14:59.989852: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 15:14:59.993123: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 15:14:59.994549: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 15:14:59.996042: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 15:15:00.002709: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x2495916e700 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 15:15:00.005687: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 15:15:02.263441: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 15:15:03.430494: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:15:04.073932: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:15:04.081409: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:15:05.405470: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 15:15:05.460005: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 15:15:06.021553: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 6s 73ms/step
[INFOR]: Index of most vote   :680
[INFOR]: Class of most vote   :nipple
[INFOR]: Number of most vote  :58.0


[INFOR]: Index of second most vote     :884
[INFOR]: Class of second most vote     :vault
[INFOR]: Number of second most vote    :44.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 3s 63ms/step
[INFOR]: Toltal norm before transform: 0.9032
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0323

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 2s 62ms/step
[INFOR]: SEN training of class 70_500 before transform: 58
[INFOR]: SPE training of class 70_500 before transform: 467

[INFOR]: SEN training of class 70_500 after transform: 445
[INFOR]: SPE training of class 70_500 after transform: 372
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 63ms/step
[INFOR]: Index of most vote   :680
[INFOR]: Class of most vote   :nipple
[INFOR]: Number of most vote  :13.0


[INFOR]: Index of second most vote     :653
[INFOR]: Class of second most vote     :milk can
[INFOR]: Number of second most vote    :10.0
[INFOR]: SEN testing of class 70_100 before transform: 13
[INFOR]: SPE testing of class 70_100 before transform: 95

[INFOR]: SEN testing of class 70_100 after transform: 88
[INFOR]: SPE testing of class 70_100 after transform: 42
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name cifar_100 --class_name_train 71_500 --class_name_test 71_100
2021-09-08 15:15:17.728508: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  cifar_100
class_name_train =  71_500
class_name_test =  71_100
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 15:15:20.298263: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 15:15:20.323466: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 15:15:20.328300: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 15:15:20.335902: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:15:20.337971: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:15:20.343034: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 15:15:20.346842: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 15:15:20.353268: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 15:15:20.358254: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 15:15:20.361449: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:15:20.363814: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 15:15:20.365850: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 15:15:20.378382: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x23fb3956de0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 15:15:20.381979: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 15:15:20.384052: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 15:15:20.388453: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 15:15:20.390666: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:15:20.392898: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:15:20.395128: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 15:15:20.397413: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 15:15:20.399617: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 15:15:20.401866: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 15:15:20.404044: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:15:20.406256: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 15:15:20.825423: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 15:15:20.828803: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 15:15:20.830184: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 15:15:20.831630: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 15:15:20.838227: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x23fe1b88d40 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 15:15:20.841165: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 15:15:23.096670: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 15:15:24.276608: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:15:24.948244: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:15:24.955031: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:15:26.283029: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 15:15:26.332111: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 15:15:26.894084: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 6s 72ms/step
[INFOR]: Index of most vote   :499
[INFOR]: Class of most vote   :cleaver, meat cleaver, chopper
[INFOR]: Number of most vote  :65.0


[INFOR]: Index of second most vote     :149
[INFOR]: Class of second most vote     :dugong, Dugong dugon
[INFOR]: Number of second most vote    :35.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 3s 62ms/step
[INFOR]: Toltal norm before transform: 0.8116
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1517

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 2s 62ms/step
[INFOR]: SEN training of class 71_500 before transform: 65
[INFOR]: SPE training of class 71_500 before transform: 499

[INFOR]: SEN training of class 71_500 after transform: 447
[INFOR]: SPE training of class 71_500 after transform: 366
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 63ms/step
[INFOR]: Index of most vote   :149
[INFOR]: Class of most vote   :dugong, Dugong dugon
[INFOR]: Number of most vote  :11.0


[INFOR]: Index of second most vote     :498
[INFOR]: Class of second most vote     :cinema, movie theater, movie theatre, movie house, picture palace
[INFOR]: Number of second most vote    :11.0
[INFOR]: SEN testing of class 71_100 before transform: 11
[INFOR]: SPE testing of class 71_100 before transform: 94

[INFOR]: SEN testing of class 71_100 after transform: 94
[INFOR]: SPE testing of class 71_100 after transform: 10
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name cifar_100 --class_name_train 72_500 --class_name_test 72_100
2021-09-08 15:15:38.661775: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  cifar_100
class_name_train =  72_500
class_name_test =  72_100
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 15:15:41.238488: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 15:15:41.262015: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 15:15:41.267161: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 15:15:41.274916: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:15:41.277179: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:15:41.282182: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 15:15:41.285713: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 15:15:41.292023: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 15:15:41.296876: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 15:15:41.299848: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:15:41.302000: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 15:15:41.303887: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 15:15:41.316104: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x23bb83a4920 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 15:15:41.319347: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 15:15:41.321361: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 15:15:41.325702: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 15:15:41.327849: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:15:41.329970: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:15:41.332152: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 15:15:41.334221: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 15:15:41.336301: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 15:15:41.338494: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 15:15:41.340793: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:15:41.342926: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 15:15:41.769065: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 15:15:41.771536: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 15:15:41.772943: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 15:15:41.774480: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 15:15:41.781106: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x23bdef56250 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 15:15:41.784091: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 15:15:44.067076: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 15:15:45.235243: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:15:45.879815: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:15:45.887027: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:15:47.203202: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 15:15:47.252478: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 15:15:47.815891: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 6s 72ms/step
[INFOR]: Index of most vote   :149
[INFOR]: Class of most vote   :dugong, Dugong dugon
[INFOR]: Number of most vote  :81.0


[INFOR]: Index of second most vote     :334
[INFOR]: Class of second most vote     :porcupine, hedgehog
[INFOR]: Number of second most vote    :62.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 3s 62ms/step
[INFOR]: Toltal norm before transform: 0.8128
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0633

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 2s 62ms/step
[INFOR]: SEN training of class 72_500 before transform: 81
[INFOR]: SPE training of class 72_500 before transform: 478

[INFOR]: SEN training of class 72_500 after transform: 438
[INFOR]: SPE training of class 72_500 after transform: 299
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 63ms/step
[INFOR]: Index of most vote   :335
[INFOR]: Class of most vote   :fox squirrel, eastern fox squirrel, Sciurus niger
[INFOR]: Number of most vote  :19.0


[INFOR]: Index of second most vote     :150
[INFOR]: Class of second most vote     :sea lion
[INFOR]: Number of second most vote    :7.0
[INFOR]: SEN testing of class 72_100 before transform: 19
[INFOR]: SPE testing of class 72_100 before transform: 93

[INFOR]: SEN testing of class 72_100 after transform: 94
[INFOR]: SPE testing of class 72_100 after transform: 27
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name cifar_100 --class_name_train 73_500 --class_name_test 73_100
2021-09-08 15:15:59.529382: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  cifar_100
class_name_train =  73_500
class_name_test =  73_100
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 15:16:02.061675: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 15:16:02.084605: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 15:16:02.089007: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 15:16:02.096999: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:16:02.099105: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:16:02.104064: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 15:16:02.107342: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 15:16:02.113619: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 15:16:02.118499: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 15:16:02.121554: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:16:02.123662: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 15:16:02.125518: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 15:16:02.137843: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x26d3589a7c0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 15:16:02.141324: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 15:16:02.143466: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 15:16:02.147658: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 15:16:02.149796: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:16:02.151925: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:16:02.154082: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 15:16:02.156202: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 15:16:02.158489: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 15:16:02.160706: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 15:16:02.162861: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:16:02.164979: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 15:16:02.582633: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 15:16:02.585533: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 15:16:02.586880: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 15:16:02.588349: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 15:16:02.594877: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x26d64a0d760 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 15:16:02.597877: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 15:16:04.836667: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 15:16:05.993080: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:16:06.647190: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:16:06.655060: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:16:07.989421: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 15:16:08.037549: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 15:16:08.605769: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 6s 72ms/step
[INFOR]: Index of most vote   :149
[INFOR]: Class of most vote   :dugong, Dugong dugon
[INFOR]: Number of most vote  :185.0


[INFOR]: Index of second most vote     :103
[INFOR]: Class of second most vote     :platypus, duckbill, duckbilled platypus, duck-billed platypus, Ornithorhynchus anatinus
[INFOR]: Number of second most vote    :56.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 3s 63ms/step
[INFOR]: Toltal norm before transform: 0.5212
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0290

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 2s 62ms/step
[INFOR]: SEN training of class 73_500 before transform: 185
[INFOR]: SPE training of class 73_500 before transform: 471

[INFOR]: SEN training of class 73_500 after transform: 464
[INFOR]: SPE training of class 73_500 after transform: 366
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 63ms/step
[INFOR]: Index of most vote   :149
[INFOR]: Class of most vote   :dugong, Dugong dugon
[INFOR]: Number of most vote  :36.0


[INFOR]: Index of second most vote     :103
[INFOR]: Class of second most vote     :platypus, duckbill, duckbilled platypus, duck-billed platypus, Ornithorhynchus anatinus
[INFOR]: Number of second most vote    :9.0
[INFOR]: SEN testing of class 73_100 before transform: 36
[INFOR]: SPE testing of class 73_100 before transform: 95

[INFOR]: SEN testing of class 73_100 after transform: 83
[INFOR]: SPE testing of class 73_100 after transform: 6
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name cifar_100 --class_name_train 74_500 --class_name_test 74_100
2021-09-08 15:16:20.349619: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  cifar_100
class_name_train =  74_500
class_name_test =  74_100
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 15:16:22.916890: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 15:16:22.943061: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 15:16:22.947665: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 15:16:22.955513: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:16:22.957622: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:16:22.962498: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 15:16:22.965786: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 15:16:22.972027: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 15:16:22.976800: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 15:16:22.979934: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:16:22.982043: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 15:16:22.983898: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 15:16:22.996588: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1cfb3a14ce0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 15:16:23.000251: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 15:16:23.002299: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 15:16:23.006528: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 15:16:23.008637: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:16:23.010777: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:16:23.013171: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 15:16:23.015257: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 15:16:23.018005: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 15:16:23.020393: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 15:16:23.022511: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:16:23.024595: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 15:16:23.448260: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 15:16:23.451700: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 15:16:23.453102: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 15:16:23.454779: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 15:16:23.461625: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1cfe3047e40 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 15:16:23.464508: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 15:16:25.754455: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 15:16:26.937825: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:16:27.581947: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:16:27.589421: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:16:28.909585: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 15:16:28.958953: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 15:16:29.520878: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 6s 73ms/step
[INFOR]: Index of most vote   :335
[INFOR]: Class of most vote   :fox squirrel, eastern fox squirrel, Sciurus niger
[INFOR]: Number of most vote  :136.0


[INFOR]: Index of second most vote     :103
[INFOR]: Class of second most vote     :platypus, duckbill, duckbilled platypus, duck-billed platypus, Ornithorhynchus anatinus
[INFOR]: Number of second most vote    :56.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 3s 63ms/step
[INFOR]: Toltal norm before transform: 0.6761
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1133

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 2s 62ms/step
[INFOR]: SEN training of class 74_500 before transform: 136
[INFOR]: SPE training of class 74_500 before transform: 457

[INFOR]: SEN training of class 74_500 after transform: 430
[INFOR]: SPE training of class 74_500 after transform: 338
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 63ms/step
[INFOR]: Index of most vote   :335
[INFOR]: Class of most vote   :fox squirrel, eastern fox squirrel, Sciurus niger
[INFOR]: Number of most vote  :26.0


[INFOR]: Index of second most vote     :103
[INFOR]: Class of second most vote     :platypus, duckbill, duckbilled platypus, duck-billed platypus, Ornithorhynchus anatinus
[INFOR]: Number of second most vote    :12.0
[INFOR]: SEN testing of class 74_100 before transform: 26
[INFOR]: SPE testing of class 74_100 before transform: 96

[INFOR]: SEN testing of class 74_100 after transform: 96
[INFOR]: SPE testing of class 74_100 after transform: 14
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name cifar_100 --class_name_train 75_500 --class_name_test 75_100
2021-09-08 15:16:41.310618: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  cifar_100
class_name_train =  75_500
class_name_test =  75_100
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 15:16:43.861793: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 15:16:43.885111: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 15:16:43.890183: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 15:16:43.897787: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:16:43.899841: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:16:43.904806: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 15:16:43.908078: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 15:16:43.914353: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 15:16:43.918991: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 15:16:43.921923: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:16:43.924022: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 15:16:43.925844: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 15:16:43.938045: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x2b635ac9870 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 15:16:43.941636: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 15:16:43.943632: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 15:16:43.947781: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 15:16:43.949916: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:16:43.952121: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:16:43.954267: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 15:16:43.956429: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 15:16:43.958755: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 15:16:43.960963: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 15:16:43.963106: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:16:43.965215: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 15:16:44.382840: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 15:16:44.386162: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 15:16:44.387550: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 15:16:44.389088: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 15:16:44.395662: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x2b6652fcd20 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 15:16:44.398433: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 15:16:46.639848: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 15:16:47.800578: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:16:48.444084: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:16:48.451705: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:16:49.771169: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 15:16:49.825168: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 15:16:50.385452: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 6s 73ms/step
[INFOR]: Index of most vote   :361
[INFOR]: Class of most vote   :skunk, polecat, wood pussy
[INFOR]: Number of most vote  :88.0


[INFOR]: Index of second most vote     :335
[INFOR]: Class of second most vote     :fox squirrel, eastern fox squirrel, Sciurus niger
[INFOR]: Number of second most vote    :64.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 3s 62ms/step
[INFOR]: Toltal norm before transform: 0.7866
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0020

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 2s 62ms/step
[INFOR]: SEN training of class 75_500 before transform: 88
[INFOR]: SPE training of class 75_500 before transform: 500

[INFOR]: SEN training of class 75_500 after transform: 432
[INFOR]: SPE training of class 75_500 after transform: 372
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 64ms/step
[INFOR]: Index of most vote   :361
[INFOR]: Class of most vote   :skunk, polecat, wood pussy
[INFOR]: Number of most vote  :17.0


[INFOR]: Index of second most vote     :335
[INFOR]: Class of second most vote     :fox squirrel, eastern fox squirrel, Sciurus niger
[INFOR]: Number of second most vote    :16.0
[INFOR]: SEN testing of class 75_100 before transform: 17
[INFOR]: SPE testing of class 75_100 before transform: 100

[INFOR]: SEN testing of class 75_100 after transform: 97
[INFOR]: SPE testing of class 75_100 after transform: 17
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name cifar_100 --class_name_train 76_500 --class_name_test 76_100
2021-09-08 15:17:02.115155: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  cifar_100
class_name_train =  76_500
class_name_test =  76_100
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 15:17:04.675338: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 15:17:04.699424: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 15:17:04.704123: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 15:17:04.712018: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:17:04.714164: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:17:04.719231: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 15:17:04.722513: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 15:17:04.728868: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 15:17:04.733761: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 15:17:04.736587: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:17:04.738691: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 15:17:04.740650: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 15:17:04.752838: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x2373ad48650 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 15:17:04.756634: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 15:17:04.758638: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 15:17:04.762802: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 15:17:04.764986: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:17:04.767324: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:17:04.769462: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 15:17:04.771759: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 15:17:04.773878: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 15:17:04.776087: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 15:17:04.778230: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:17:04.780339: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 15:17:05.217904: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 15:17:05.220451: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 15:17:05.221825: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 15:17:05.223311: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 15:17:05.229785: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x2376a669950 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 15:17:05.232608: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 15:17:07.500338: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 15:17:08.682135: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:17:09.324451: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:17:09.331659: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:17:10.655918: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 15:17:10.710002: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 15:17:11.272212: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 6s 73ms/step
[INFOR]: Index of most vote   :708
[INFOR]: Class of most vote   :pedestal, plinth, footstall
[INFOR]: Number of most vote  :50.0


[INFOR]: Index of second most vote     :905
[INFOR]: Class of second most vote     :window shade
[INFOR]: Number of second most vote    :36.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 3s 62ms/step
[INFOR]: Toltal norm before transform: 0.8807
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.2923

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 2s 62ms/step
[INFOR]: SEN training of class 76_500 before transform: 50
[INFOR]: SPE training of class 76_500 before transform: 492

[INFOR]: SEN training of class 76_500 after transform: 470
[INFOR]: SPE training of class 76_500 after transform: 413
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 64ms/step
[INFOR]: Index of most vote   :708
[INFOR]: Class of most vote   :pedestal, plinth, footstall
[INFOR]: Number of most vote  :8.0


[INFOR]: Index of second most vote     :728
[INFOR]: Class of second most vote     :plastic bag
[INFOR]: Number of second most vote    :8.0
[INFOR]: SEN testing of class 76_100 before transform: 8
[INFOR]: SPE testing of class 76_100 before transform: 99

[INFOR]: SEN testing of class 76_100 after transform: 98
[INFOR]: SPE testing of class 76_100 after transform: 18
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name cifar_100 --class_name_train 77_500 --class_name_test 77_100
2021-09-08 15:17:22.971816: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  cifar_100
class_name_train =  77_500
class_name_test =  77_100
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 15:17:25.536946: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 15:17:25.563500: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 15:17:25.569840: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 15:17:25.577973: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:17:25.580063: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:17:25.584915: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 15:17:25.588261: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 15:17:25.594384: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 15:17:25.599106: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 15:17:25.601938: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:17:25.604315: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 15:17:25.606163: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 15:17:25.618367: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1e8bb452060 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 15:17:25.622031: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 15:17:25.623996: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 15:17:25.628201: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 15:17:25.630308: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:17:25.632391: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:17:25.634656: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 15:17:25.636946: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 15:17:25.639020: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 15:17:25.641246: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 15:17:25.643431: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:17:25.645575: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 15:17:26.069979: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 15:17:26.073272: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 15:17:26.074685: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 15:17:26.076163: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 15:17:26.082792: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1e8e4b10be0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 15:17:26.085638: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 15:17:28.343823: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 15:17:29.516135: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:17:30.156996: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:17:30.163753: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:17:31.497693: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 15:17:31.546148: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 15:17:32.112877: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 6s 73ms/step
[INFOR]: Index of most vote   :680
[INFOR]: Class of most vote   :nipple
[INFOR]: Number of most vote  :74.0


[INFOR]: Index of second most vote     :113
[INFOR]: Class of second most vote     :snail
[INFOR]: Number of second most vote    :67.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 3s 62ms/step
[INFOR]: Toltal norm before transform: 0.8148
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1777

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 2s 63ms/step
[INFOR]: SEN training of class 77_500 before transform: 74
[INFOR]: SPE training of class 77_500 before transform: 461

[INFOR]: SEN training of class 77_500 after transform: 430
[INFOR]: SPE training of class 77_500 after transform: 398
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 65ms/step
[INFOR]: Index of most vote   :335
[INFOR]: Class of most vote   :fox squirrel, eastern fox squirrel, Sciurus niger
[INFOR]: Number of most vote  :16.0


[INFOR]: Index of second most vote     :679
[INFOR]: Class of second most vote     :necklace
[INFOR]: Number of second most vote    :13.0
[INFOR]: SEN testing of class 77_100 before transform: 16
[INFOR]: SPE testing of class 77_100 before transform: 94

[INFOR]: SEN testing of class 77_100 after transform: 93
[INFOR]: SPE testing of class 77_100 after transform: 40
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name cifar_100 --class_name_train 78_500 --class_name_test 78_100
2021-09-08 15:17:43.764560: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  cifar_100
class_name_train =  78_500
class_name_test =  78_100
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 15:17:46.326622: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 15:17:46.350681: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 15:17:46.355071: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 15:17:46.362748: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:17:46.364827: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:17:46.370193: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 15:17:46.373755: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 15:17:46.379729: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 15:17:46.384638: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 15:17:46.387437: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:17:46.389511: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 15:17:46.391374: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 15:17:46.403656: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x20ab7952360 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 15:17:46.407237: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 15:17:46.409188: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 15:17:46.413385: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 15:17:46.415476: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:17:46.417532: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:17:46.419614: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 15:17:46.421650: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 15:17:46.423714: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 15:17:46.425917: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 15:17:46.428302: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:17:46.430348: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 15:17:46.848632: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 15:17:46.852074: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 15:17:46.853471: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 15:17:46.854928: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 15:17:46.861354: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x20ae2aa84e0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 15:17:46.864167: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 15:17:49.129304: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 15:17:50.291205: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:17:50.935113: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:17:50.941696: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:17:52.263316: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 15:17:52.313489: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 15:17:52.878741: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 6s 73ms/step
[INFOR]: Index of most vote   :111
[INFOR]: Class of most vote   :nematode, nematode worm, roundworm
[INFOR]: Number of most vote  :172.0


[INFOR]: Index of second most vote     :68
[INFOR]: Class of second most vote     :sidewinder, horned rattlesnake, Crotalus cerastes
[INFOR]: Number of second most vote    :125.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 3s 62ms/step
[INFOR]: Toltal norm before transform: 0.5489
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1194

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 2s 62ms/step
[INFOR]: SEN training of class 78_500 before transform: 172
[INFOR]: SPE training of class 78_500 before transform: 490

[INFOR]: SEN training of class 78_500 after transform: 469
[INFOR]: SPE training of class 78_500 after transform: 412
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 63ms/step
[INFOR]: Index of most vote   :111
[INFOR]: Class of most vote   :nematode, nematode worm, roundworm
[INFOR]: Number of most vote  :42.0


[INFOR]: Index of second most vote     :68
[INFOR]: Class of second most vote     :sidewinder, horned rattlesnake, Crotalus cerastes
[INFOR]: Number of second most vote    :21.0
[INFOR]: SEN testing of class 78_100 before transform: 42
[INFOR]: SPE testing of class 78_100 before transform: 100

[INFOR]: SEN testing of class 78_100 after transform: 97
[INFOR]: SPE testing of class 78_100 after transform: 21
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name cifar_100 --class_name_train 79_500 --class_name_test 79_100
2021-09-08 15:18:04.690702: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  cifar_100
class_name_train =  79_500
class_name_test =  79_100
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 15:18:07.296710: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 15:18:07.320503: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 15:18:07.325427: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 15:18:07.333115: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:18:07.335312: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:18:07.340330: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 15:18:07.343623: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 15:18:07.349796: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 15:18:07.354829: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 15:18:07.357730: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:18:07.359866: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 15:18:07.361714: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 15:18:07.374108: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x16ab4cb51e0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 15:18:07.377704: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 15:18:07.379796: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 15:18:07.384415: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 15:18:07.386779: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:18:07.388917: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:18:07.391146: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 15:18:07.393283: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 15:18:07.395429: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 15:18:07.397731: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 15:18:07.399953: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:18:07.402267: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 15:18:07.825110: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 15:18:07.828428: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 15:18:07.829843: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 15:18:07.831343: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 15:18:07.838228: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x16ae3b556f0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 15:18:07.841120: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 15:18:10.138663: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 15:18:11.337498: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:18:11.979489: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:18:11.986747: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:18:13.320573: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 15:18:13.374986: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 15:18:13.937117: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 6s 72ms/step
[INFOR]: Index of most vote   :73
[INFOR]: Class of most vote   :barn spider, Araneus cavaticus
[INFOR]: Number of most vote  :226.0


[INFOR]: Index of second most vote     :334
[INFOR]: Class of second most vote     :porcupine, hedgehog
[INFOR]: Number of second most vote    :26.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 3s 62ms/step
[INFOR]: Toltal norm before transform: 0.3535
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0464

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 2s 62ms/step
[INFOR]: SEN training of class 79_500 before transform: 226
[INFOR]: SPE training of class 79_500 before transform: 497

[INFOR]: SEN training of class 79_500 after transform: 420
[INFOR]: SPE training of class 79_500 after transform: 399
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 62ms/step
[INFOR]: Index of most vote   :73
[INFOR]: Class of most vote   :barn spider, Araneus cavaticus
[INFOR]: Number of most vote  :45.0


[INFOR]: Index of second most vote     :334
[INFOR]: Class of second most vote     :porcupine, hedgehog
[INFOR]: Number of second most vote    :7.0
[INFOR]: SEN testing of class 79_100 before transform: 45
[INFOR]: SPE testing of class 79_100 before transform: 99

[INFOR]: SEN testing of class 79_100 after transform: 86
[INFOR]: SPE testing of class 79_100 after transform: 22
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name cifar_100 --class_name_train 80_500 --class_name_test 80_100
2021-09-08 15:18:25.685598: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  cifar_100
class_name_train =  80_500
class_name_test =  80_100
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 15:18:28.252742: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 15:18:28.304566: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 15:18:28.309479: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 15:18:28.317555: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:18:28.319933: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:18:28.325131: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 15:18:28.328493: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 15:18:28.334770: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 15:18:28.339733: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 15:18:28.342633: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:18:28.344797: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 15:18:28.346702: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 15:18:28.358701: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1e0b3793a30 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 15:18:28.362014: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 15:18:28.364052: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 15:18:28.368245: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 15:18:28.370533: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:18:28.372664: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:18:28.374824: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 15:18:28.376952: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 15:18:28.379083: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 15:18:28.381302: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 15:18:28.383510: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:18:28.385838: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 15:18:28.821835: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 15:18:28.825037: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 15:18:28.826386: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 15:18:28.827840: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 15:18:28.834600: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1e0dee62710 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 15:18:28.837416: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 15:18:31.078679: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 15:18:32.261955: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:18:32.904043: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:18:32.911151: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:18:34.246632: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 15:18:34.301940: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 15:18:34.918431: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 6s 72ms/step
[INFOR]: Index of most vote   :335
[INFOR]: Class of most vote   :fox squirrel, eastern fox squirrel, Sciurus niger
[INFOR]: Number of most vote  :285.0


[INFOR]: Index of second most vote     :149
[INFOR]: Class of second most vote     :dugong, Dugong dugon
[INFOR]: Number of second most vote    :24.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 3s 62ms/step
[INFOR]: Toltal norm before transform: 0.3981
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.2357

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 2s 62ms/step
[INFOR]: SEN training of class 80_500 before transform: 285
[INFOR]: SPE training of class 80_500 before transform: 463

[INFOR]: SEN training of class 80_500 after transform: 419
[INFOR]: SPE training of class 80_500 after transform: 327
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 63ms/step
[INFOR]: Index of most vote   :335
[INFOR]: Class of most vote   :fox squirrel, eastern fox squirrel, Sciurus niger
[INFOR]: Number of most vote  :63.0


[INFOR]: Index of second most vote     :149
[INFOR]: Class of second most vote     :dugong, Dugong dugon
[INFOR]: Number of second most vote    :10.0
[INFOR]: SEN testing of class 80_100 before transform: 63
[INFOR]: SPE testing of class 80_100 before transform: 88

[INFOR]: SEN testing of class 80_100 after transform: 96
[INFOR]: SPE testing of class 80_100 after transform: 12
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name cifar_100 --class_name_train 81_500 --class_name_test 81_100
2021-09-08 15:18:46.738014: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  cifar_100
class_name_train =  81_500
class_name_test =  81_100
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 15:18:49.319399: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 15:18:49.344633: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 15:18:49.349588: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 15:18:49.357454: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:18:49.359611: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:18:49.364581: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 15:18:49.368183: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 15:18:49.374484: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 15:18:49.379268: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 15:18:49.382556: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:18:49.384899: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 15:18:49.386843: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 15:18:49.399277: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x24d35a0f3c0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 15:18:49.402562: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 15:18:49.404629: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 15:18:49.408956: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 15:18:49.411074: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:18:49.413278: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:18:49.415415: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 15:18:49.417515: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 15:18:49.419619: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 15:18:49.421808: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 15:18:49.424053: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:18:49.426347: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 15:18:49.843072: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 15:18:49.846417: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 15:18:49.847767: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 15:18:49.849330: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 15:18:49.856060: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x24d64a4c360 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 15:18:49.859025: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 15:18:52.145864: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 15:18:53.332839: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:18:53.971294: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:18:53.979706: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:18:55.295611: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 15:18:55.344697: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 15:18:55.908651: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 6s 73ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :140.0


[INFOR]: Index of second most vote     :704
[INFOR]: Class of second most vote     :parking meter
[INFOR]: Number of second most vote    :37.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 3s 62ms/step
[INFOR]: Toltal norm before transform: 0.6177
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1250

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 2s 62ms/step
[INFOR]: SEN training of class 81_500 before transform: 140
[INFOR]: SPE training of class 81_500 before transform: 484

[INFOR]: SEN training of class 81_500 after transform: 448
[INFOR]: SPE training of class 81_500 after transform: 368
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 66ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :36.0


[INFOR]: Index of second most vote     :556
[INFOR]: Class of second most vote     :fire screen, fireguard
[INFOR]: Number of second most vote    :6.0
[INFOR]: SEN testing of class 81_100 before transform: 36
[INFOR]: SPE testing of class 81_100 before transform: 99

[INFOR]: SEN testing of class 81_100 after transform: 79
[INFOR]: SPE testing of class 81_100 after transform: 3
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name cifar_100 --class_name_train 82_500 --class_name_test 82_100
2021-09-08 15:19:07.636940: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  cifar_100
class_name_train =  82_500
class_name_test =  82_100
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 15:19:10.196091: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 15:19:10.221061: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 15:19:10.225596: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 15:19:10.233240: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:19:10.235548: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:19:10.240400: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 15:19:10.243713: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 15:19:10.249952: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 15:19:10.255251: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 15:19:10.258167: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:19:10.260308: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 15:19:10.262193: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 15:19:10.274233: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x213ba7a4d50 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 15:19:10.277424: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 15:19:10.279436: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 15:19:10.283684: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 15:19:10.285832: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:19:10.287966: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:19:10.290219: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 15:19:10.292550: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 15:19:10.294686: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 15:19:10.296858: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 15:19:10.299178: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:19:10.301509: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 15:19:10.729580: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 15:19:10.733221: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 15:19:10.734598: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 15:19:10.736088: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 15:19:10.742673: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x213e83e2360 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 15:19:10.745471: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 15:19:13.019726: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 15:19:14.181407: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:19:14.823660: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:19:14.830800: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:19:16.159594: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 15:19:16.207672: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 15:19:16.776722: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 6s 73ms/step
[INFOR]: Index of most vote   :451
[INFOR]: Class of most vote   :bolo tie, bolo, bola tie, bola
[INFOR]: Number of most vote  :52.0


[INFOR]: Index of second most vote     :984
[INFOR]: Class of second most vote     :rapeseed
[INFOR]: Number of second most vote    :47.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 3s 62ms/step
[INFOR]: Toltal norm before transform: 0.8721
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0190

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 2s 62ms/step
[INFOR]: SEN training of class 82_500 before transform: 52
[INFOR]: SPE training of class 82_500 before transform: 499

[INFOR]: SEN training of class 82_500 after transform: 418
[INFOR]: SPE training of class 82_500 after transform: 410
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 63ms/step
[INFOR]: Index of most vote   :451
[INFOR]: Class of most vote   :bolo tie, bolo, bola tie, bola
[INFOR]: Number of most vote  :15.0


[INFOR]: Index of second most vote     :117
[INFOR]: Class of second most vote     :chambered nautilus, pearly nautilus, nautilus
[INFOR]: Number of second most vote    :14.0
[INFOR]: SEN testing of class 82_100 before transform: 15
[INFOR]: SPE testing of class 82_100 before transform: 98

[INFOR]: SEN testing of class 82_100 after transform: 85
[INFOR]: SPE testing of class 82_100 after transform: 24
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name cifar_100 --class_name_train 83_500 --class_name_test 83_100
2021-09-08 15:19:28.493565: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  cifar_100
class_name_train =  83_500
class_name_test =  83_100
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 15:19:31.054155: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 15:19:31.079746: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 15:19:31.084707: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 15:19:31.092364: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:19:31.094470: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:19:31.100210: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 15:19:31.104019: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 15:19:31.110172: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 15:19:31.114874: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 15:19:31.117897: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:19:31.120206: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 15:19:31.122038: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 15:19:31.134437: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1e5381ef7e0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 15:19:31.138026: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 15:19:31.140013: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 15:19:31.144202: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 15:19:31.146365: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:19:31.148514: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:19:31.150897: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 15:19:31.153028: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 15:19:31.155184: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 15:19:31.157359: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 15:19:31.159600: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:19:31.161731: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 15:19:31.577229: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 15:19:31.580623: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 15:19:31.582161: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 15:19:31.583790: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 15:19:31.590678: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1e55bdbc280 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 15:19:31.593502: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 15:19:33.845247: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 15:19:35.020819: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:19:35.657017: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:19:35.664308: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:19:36.989421: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 15:19:37.038636: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 15:19:37.597902: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 6s 73ms/step
[INFOR]: Index of most vote   :680
[INFOR]: Class of most vote   :nipple
[INFOR]: Number of most vote  :110.0


[INFOR]: Index of second most vote     :713
[INFOR]: Class of second most vote     :photocopier
[INFOR]: Number of second most vote    :47.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 3s 63ms/step
[INFOR]: Toltal norm before transform: 0.7469
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1427

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 2s 63ms/step
[INFOR]: SEN training of class 83_500 before transform: 110
[INFOR]: SPE training of class 83_500 before transform: 470

[INFOR]: SEN training of class 83_500 after transform: 470
[INFOR]: SPE training of class 83_500 after transform: 388
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 65ms/step
[INFOR]: Index of most vote   :680
[INFOR]: Class of most vote   :nipple
[INFOR]: Number of most vote  :17.0


[INFOR]: Index of second most vote     :944
[INFOR]: Class of second most vote     :artichoke, globe artichoke
[INFOR]: Number of second most vote    :10.0
[INFOR]: SEN testing of class 83_100 before transform: 17
[INFOR]: SPE testing of class 83_100 before transform: 96

[INFOR]: SEN testing of class 83_100 after transform: 97
[INFOR]: SPE testing of class 83_100 after transform: 39
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name cifar_100 --class_name_train 84_500 --class_name_test 84_100
2021-09-08 15:19:49.408599: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  cifar_100
class_name_train =  84_500
class_name_test =  84_100
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 15:19:51.934567: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 15:19:51.959440: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 15:19:51.964824: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 15:19:51.972574: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:19:51.974632: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:19:51.979592: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 15:19:51.982814: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 15:19:51.988902: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 15:19:51.993699: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 15:19:51.996486: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:19:51.998556: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 15:19:52.000416: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 15:19:52.012930: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1f4b765ffe0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 15:19:52.016566: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 15:19:52.018568: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 15:19:52.022730: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 15:19:52.024959: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:19:52.027115: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:19:52.029524: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 15:19:52.031568: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 15:19:52.033668: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 15:19:52.035757: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 15:19:52.038205: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:19:52.040534: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 15:19:52.465487: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 15:19:52.468785: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 15:19:52.470172: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 15:19:52.471634: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 15:19:52.478411: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1f4e5abe950 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 15:19:52.482357: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 15:19:54.726723: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 15:19:55.883986: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:19:56.544649: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:19:56.550857: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:19:57.875376: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 15:19:57.925109: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 15:19:58.487817: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 6s 73ms/step
[INFOR]: Index of most vote   :708
[INFOR]: Class of most vote   :pedestal, plinth, footstall
[INFOR]: Number of most vote  :105.0


[INFOR]: Index of second most vote     :653
[INFOR]: Class of second most vote     :milk can
[INFOR]: Number of second most vote    :44.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 3s 62ms/step
[INFOR]: Toltal norm before transform: 0.7896
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1041

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 2s 62ms/step
[INFOR]: SEN training of class 84_500 before transform: 105
[INFOR]: SPE training of class 84_500 before transform: 490

[INFOR]: SEN training of class 84_500 after transform: 413
[INFOR]: SPE training of class 84_500 after transform: 364
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 65ms/step
[INFOR]: Index of most vote   :708
[INFOR]: Class of most vote   :pedestal, plinth, footstall
[INFOR]: Number of most vote  :23.0


[INFOR]: Index of second most vote     :653
[INFOR]: Class of second most vote     :milk can
[INFOR]: Number of second most vote    :15.0
[INFOR]: SEN testing of class 84_100 before transform: 23
[INFOR]: SPE testing of class 84_100 before transform: 99

[INFOR]: SEN testing of class 84_100 after transform: 80
[INFOR]: SPE testing of class 84_100 after transform: 5
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name cifar_100 --class_name_train 85_500 --class_name_test 85_100
2021-09-08 15:20:10.208848: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  cifar_100
class_name_train =  85_500
class_name_test =  85_100
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 15:20:12.765253: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 15:20:12.790928: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 15:20:12.796360: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 15:20:12.804228: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:20:12.806487: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:20:12.811325: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 15:20:12.814590: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 15:20:12.820898: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 15:20:12.826064: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 15:20:12.829074: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:20:12.831170: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 15:20:12.833046: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 15:20:12.845531: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x23233e77810 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 15:20:12.849458: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 15:20:12.851662: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 15:20:12.856071: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 15:20:12.858397: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:20:12.860501: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:20:12.862635: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 15:20:12.864790: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 15:20:12.866892: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 15:20:12.869088: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 15:20:12.871265: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:20:12.873559: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 15:20:13.293009: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 15:20:13.295558: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 15:20:13.296920: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 15:20:13.298393: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 15:20:13.305244: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x23262831270 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 15:20:13.308059: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 15:20:15.573347: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 15:20:16.777405: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:20:17.433255: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:20:17.440028: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:20:18.774237: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 15:20:18.824336: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 15:20:19.391335: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 6s 72ms/step
[INFOR]: Index of most vote   :856
[INFOR]: Class of most vote   :thresher, thrasher, threshing machine
[INFOR]: Number of most vote  :64.0


[INFOR]: Index of second most vote     :653
[INFOR]: Class of second most vote     :milk can
[INFOR]: Number of second most vote    :38.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 3s 63ms/step
[INFOR]: Toltal norm before transform: 0.8686
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.2054

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 2s 62ms/step
[INFOR]: SEN training of class 85_500 before transform: 64
[INFOR]: SPE training of class 85_500 before transform: 489

[INFOR]: SEN training of class 85_500 after transform: 410
[INFOR]: SPE training of class 85_500 after transform: 380
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 63ms/step
[INFOR]: Index of most vote   :856
[INFOR]: Class of most vote   :thresher, thrasher, threshing machine
[INFOR]: Number of most vote  :14.0


[INFOR]: Index of second most vote     :708
[INFOR]: Class of second most vote     :pedestal, plinth, footstall
[INFOR]: Number of second most vote    :12.0
[INFOR]: SEN testing of class 85_100 before transform: 14
[INFOR]: SPE testing of class 85_100 before transform: 98

[INFOR]: SEN testing of class 85_100 after transform: 97
[INFOR]: SPE testing of class 85_100 after transform: 26
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name cifar_100 --class_name_train 86_500 --class_name_test 86_100
2021-09-08 15:20:31.096181: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  cifar_100
class_name_train =  86_500
class_name_test =  86_100
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 15:20:33.692010: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 15:20:33.718267: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 15:20:33.723244: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 15:20:33.731534: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:20:33.733856: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:20:33.739053: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 15:20:33.742635: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 15:20:33.748934: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 15:20:33.753837: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 15:20:33.756988: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:20:33.759141: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 15:20:33.761041: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 15:20:33.772756: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x29439868910 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 15:20:33.775973: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 15:20:33.777985: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 15:20:33.782170: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 15:20:33.784365: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:20:33.786695: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:20:33.789051: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 15:20:33.791163: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 15:20:33.793300: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 15:20:33.795463: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 15:20:33.797687: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:20:33.799802: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 15:20:34.222564: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 15:20:34.226507: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 15:20:34.227907: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 15:20:34.229379: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 15:20:34.235958: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x2946544edf0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 15:20:34.239359: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 15:20:36.539922: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 15:20:37.735027: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:20:38.391815: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:20:38.399393: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:20:39.724439: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 15:20:39.774096: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 15:20:40.335915: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 6s 72ms/step
[INFOR]: Index of most vote   :590
[INFOR]: Class of most vote   :hand-held computer, hand-held microcomputer
[INFOR]: Number of most vote  :100.0


[INFOR]: Index of second most vote     :679
[INFOR]: Class of second most vote     :necklace
[INFOR]: Number of second most vote    :43.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 3s 62ms/step
[INFOR]: Toltal norm before transform: 0.7426
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1811

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 2s 62ms/step
[INFOR]: SEN training of class 86_500 before transform: 100
[INFOR]: SPE training of class 86_500 before transform: 499

[INFOR]: SEN training of class 86_500 after transform: 476
[INFOR]: SPE training of class 86_500 after transform: 424
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 63ms/step
[INFOR]: Index of most vote   :590
[INFOR]: Class of most vote   :hand-held computer, hand-held microcomputer
[INFOR]: Number of most vote  :17.0


[INFOR]: Index of second most vote     :679
[INFOR]: Class of second most vote     :necklace
[INFOR]: Number of second most vote    :6.0
[INFOR]: SEN testing of class 86_100 before transform: 17
[INFOR]: SPE testing of class 86_100 before transform: 100

[INFOR]: SEN testing of class 86_100 after transform: 100
[INFOR]: SPE testing of class 86_100 after transform: 18
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name cifar_100 --class_name_train 87_500 --class_name_test 87_100
2021-09-08 15:20:52.024631: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  cifar_100
class_name_train =  87_500
class_name_test =  87_100
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 15:20:54.584901: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 15:20:54.609869: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 15:20:54.614229: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 15:20:54.622072: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:20:54.624252: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:20:54.629368: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 15:20:54.632835: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 15:20:54.639371: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 15:20:54.644185: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 15:20:54.647193: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:20:54.649381: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 15:20:54.651296: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 15:20:54.663149: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1db35dedf60 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 15:20:54.666273: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 15:20:54.668319: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 15:20:54.672638: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 15:20:54.674811: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:20:54.676984: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:20:54.679277: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 15:20:54.681642: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 15:20:54.683800: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 15:20:54.686164: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 15:20:54.688417: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:20:54.690615: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 15:20:55.123751: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 15:20:55.127041: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 15:20:55.128528: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 15:20:55.130061: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 15:20:55.136851: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1db5f76bab0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 15:20:55.139686: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 15:20:57.444580: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 15:20:58.636028: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:20:59.289423: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:20:59.297428: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:21:00.621142: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 15:21:00.675684: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 15:21:01.239728: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 6s 72ms/step
[INFOR]: Index of most vote   :782
[INFOR]: Class of most vote   :screen, CRT screen
[INFOR]: Number of most vote  :178.0


[INFOR]: Index of second most vote     :631
[INFOR]: Class of second most vote     :lotion
[INFOR]: Number of second most vote    :42.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 3s 62ms/step
[INFOR]: Toltal norm before transform: 0.5434
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0219

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 2s 63ms/step
[INFOR]: SEN training of class 87_500 before transform: 178
[INFOR]: SPE training of class 87_500 before transform: 495

[INFOR]: SEN training of class 87_500 after transform: 471
[INFOR]: SPE training of class 87_500 after transform: 374
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 63ms/step
[INFOR]: Index of most vote   :782
[INFOR]: Class of most vote   :screen, CRT screen
[INFOR]: Number of most vote  :35.0


[INFOR]: Index of second most vote     :548
[INFOR]: Class of second most vote     :entertainment center
[INFOR]: Number of second most vote    :9.0
[INFOR]: SEN testing of class 87_100 before transform: 35
[INFOR]: SPE testing of class 87_100 before transform: 99

[INFOR]: SEN testing of class 87_100 after transform: 98
[INFOR]: SPE testing of class 87_100 after transform: 30
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name cifar_100 --class_name_train 88_500 --class_name_test 88_100
2021-09-08 15:21:13.056457: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  cifar_100
class_name_train =  88_500
class_name_test =  88_100
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 15:21:15.589516: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 15:21:15.660584: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 15:21:15.665940: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 15:21:15.673985: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:21:15.676323: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:21:15.681546: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 15:21:15.684919: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 15:21:15.691076: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 15:21:15.696160: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 15:21:15.699005: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:21:15.701115: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 15:21:15.702974: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 15:21:15.714953: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x2d436515e30 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 15:21:15.718712: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 15:21:15.720692: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 15:21:15.724803: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 15:21:15.727088: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:21:15.729171: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:21:15.731277: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 15:21:15.733352: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 15:21:15.735434: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 15:21:15.737660: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 15:21:15.739965: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:21:15.742186: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 15:21:16.218417: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 15:21:16.221699: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 15:21:16.223079: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 15:21:16.224777: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 15:21:16.231612: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x2d461905660 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 15:21:16.234389: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 15:21:18.518346: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 15:21:19.780118: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:21:20.467197: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:21:20.474283: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:21:21.849498: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 15:21:21.901428: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 15:21:22.473905: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 6s 75ms/step
[INFOR]: Index of most vote   :335
[INFOR]: Class of most vote   :fox squirrel, eastern fox squirrel, Sciurus niger
[INFOR]: Number of most vote  :164.0


[INFOR]: Index of second most vote     :291
[INFOR]: Class of second most vote     :lion, king of beasts, Panthera leo
[INFOR]: Number of second most vote    :22.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 3s 63ms/step
[INFOR]: Toltal norm before transform: 0.6176
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1731

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 2s 63ms/step
[INFOR]: SEN training of class 88_500 before transform: 164
[INFOR]: SPE training of class 88_500 before transform: 474

[INFOR]: SEN training of class 88_500 after transform: 450
[INFOR]: SPE training of class 88_500 after transform: 371
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 62ms/step
[INFOR]: Index of most vote   :335
[INFOR]: Class of most vote   :fox squirrel, eastern fox squirrel, Sciurus niger
[INFOR]: Number of most vote  :30.0


[INFOR]: Index of second most vote     :272
[INFOR]: Class of second most vote     :coyote, prairie wolf, brush wolf, Canis latrans
[INFOR]: Number of second most vote    :4.0
[INFOR]: SEN testing of class 88_100 before transform: 30
[INFOR]: SPE testing of class 88_100 before transform: 95

[INFOR]: SEN testing of class 88_100 after transform: 92
[INFOR]: SPE testing of class 88_100 after transform: 28
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name cifar_100 --class_name_train 89_500 --class_name_test 89_100
2021-09-08 15:21:34.510548: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  cifar_100
class_name_train =  89_500
class_name_test =  89_100
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 15:21:37.057664: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 15:21:37.082915: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 15:21:37.089124: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 15:21:37.096784: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:21:37.098843: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:21:37.103695: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 15:21:37.107090: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 15:21:37.113214: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 15:21:37.117883: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 15:21:37.120839: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:21:37.123166: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 15:21:37.125104: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 15:21:37.138109: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x173b5682940 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 15:21:37.141724: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 15:21:37.143913: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 15:21:37.148138: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 15:21:37.150308: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:21:37.152488: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:21:37.154854: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 15:21:37.156986: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 15:21:37.159247: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 15:21:37.161408: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 15:21:37.163628: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:21:37.165795: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 15:21:37.603499: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 15:21:37.607038: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 15:21:37.608440: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 15:21:37.609909: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 15:21:37.616670: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x173e065b7f0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 15:21:37.619490: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 15:21:39.875787: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 15:21:41.061114: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:21:41.751597: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:21:41.759127: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:21:43.090944: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 15:21:43.138395: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 15:21:43.702455: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 6s 74ms/step
[INFOR]: Index of most vote   :856
[INFOR]: Class of most vote   :thresher, thrasher, threshing machine
[INFOR]: Number of most vote  :138.0


[INFOR]: Index of second most vote     :675
[INFOR]: Class of second most vote     :moving van
[INFOR]: Number of second most vote    :61.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 3s 64ms/step
[INFOR]: Toltal norm before transform: 0.7064
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.3583

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 2s 64ms/step
[INFOR]: SEN training of class 89_500 before transform: 138
[INFOR]: SPE training of class 89_500 before transform: 493

[INFOR]: SEN training of class 89_500 after transform: 436
[INFOR]: SPE training of class 89_500 after transform: 358
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 65ms/step
[INFOR]: Index of most vote   :856
[INFOR]: Class of most vote   :thresher, thrasher, threshing machine
[INFOR]: Number of most vote  :27.0


[INFOR]: Index of second most vote     :510
[INFOR]: Class of second most vote     :container ship, containership, container vessel
[INFOR]: Number of second most vote    :11.0
[INFOR]: SEN testing of class 89_100 before transform: 27
[INFOR]: SPE testing of class 89_100 before transform: 97

[INFOR]: SEN testing of class 89_100 after transform: 94
[INFOR]: SPE testing of class 89_100 after transform: 24
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name cifar_100 --class_name_train 90_500 --class_name_test 90_100
2021-09-08 15:21:55.609780: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  cifar_100
class_name_train =  90_500
class_name_test =  90_100
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 15:21:58.181788: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 15:21:58.231921: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 15:21:58.236856: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 15:21:58.244844: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:21:58.246956: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:21:58.251973: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 15:21:58.255246: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 15:21:58.261448: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 15:21:58.266539: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 15:21:58.269390: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:21:58.271933: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 15:21:58.273969: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 15:21:58.286332: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x21634d1a070 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 15:21:58.289611: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 15:21:58.291827: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 15:21:58.296013: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 15:21:58.298226: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:21:58.300350: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:21:58.302501: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 15:21:58.304609: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 15:21:58.306790: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 15:21:58.309130: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 15:21:58.311328: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:21:58.313531: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 15:21:58.762299: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 15:21:58.765050: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 15:21:58.766566: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 15:21:58.768167: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 15:21:58.775194: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x21663cc0370 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 15:21:58.778079: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 15:22:01.072333: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 15:22:02.269081: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:22:02.919032: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:22:02.926147: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:22:04.270637: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 15:22:04.327091: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 15:22:04.909123: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 6s 73ms/step
[INFOR]: Index of most vote   :510
[INFOR]: Class of most vote   :container ship, containership, container vessel
[INFOR]: Number of most vote  :78.0


[INFOR]: Index of second most vote     :674
[INFOR]: Class of second most vote     :mousetrap
[INFOR]: Number of second most vote    :51.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 3s 63ms/step
[INFOR]: Toltal norm before transform: 0.8144
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1086

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 2s 63ms/step
[INFOR]: SEN training of class 90_500 before transform: 78
[INFOR]: SPE training of class 90_500 before transform: 498

[INFOR]: SEN training of class 90_500 after transform: 400
[INFOR]: SPE training of class 90_500 after transform: 370
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 61ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :17.0


[INFOR]: Index of second most vote     :510
[INFOR]: Class of second most vote     :container ship, containership, container vessel
[INFOR]: Number of second most vote    :11.0
[INFOR]: SEN testing of class 90_100 before transform: 17
[INFOR]: SPE testing of class 90_100 before transform: 100

[INFOR]: SEN testing of class 90_100 after transform: 88
[INFOR]: SPE testing of class 90_100 after transform: 19
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name cifar_100 --class_name_train 91_500 --class_name_test 91_100
2021-09-08 15:22:16.678315: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  cifar_100
class_name_train =  91_500
class_name_test =  91_100
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 15:22:19.281084: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 15:22:19.308810: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 15:22:19.314052: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 15:22:19.321695: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:22:19.323792: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:22:19.328809: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 15:22:19.332070: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 15:22:19.338183: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 15:22:19.342960: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 15:22:19.346870: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:22:19.349003: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 15:22:19.350888: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 15:22:19.363167: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x18234ad5b70 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 15:22:19.366771: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 15:22:19.369053: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 15:22:19.373188: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 15:22:19.375580: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:22:19.377914: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:22:19.380052: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 15:22:19.382151: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 15:22:19.384267: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 15:22:19.386413: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 15:22:19.388618: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:22:19.390895: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 15:22:19.823707: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 15:22:19.827094: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 15:22:19.828510: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 15:22:19.830101: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 15:22:19.836777: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1825f943840 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 15:22:19.839626: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 15:22:22.156440: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 15:22:23.341551: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:22:23.992077: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:22:23.999756: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:22:25.320851: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 15:22:25.368801: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 15:22:25.929133: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 6s 72ms/step
[INFOR]: Index of most vote   :149
[INFOR]: Class of most vote   :dugong, Dugong dugon
[INFOR]: Number of most vote  :79.0


[INFOR]: Index of second most vote     :103
[INFOR]: Class of second most vote     :platypus, duckbill, duckbilled platypus, duck-billed platypus, Ornithorhynchus anatinus
[INFOR]: Number of second most vote    :56.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 3s 62ms/step
[INFOR]: Toltal norm before transform: 0.8182
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1427

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 2s 62ms/step
[INFOR]: SEN training of class 91_500 before transform: 79
[INFOR]: SPE training of class 91_500 before transform: 478

[INFOR]: SEN training of class 91_500 after transform: 397
[INFOR]: SPE training of class 91_500 after transform: 383
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 63ms/step
[INFOR]: Index of most vote   :684
[INFOR]: Class of most vote   :ocarina, sweet potato
[INFOR]: Number of most vote  :15.0


[INFOR]: Index of second most vote     :103
[INFOR]: Class of second most vote     :platypus, duckbill, duckbilled platypus, duck-billed platypus, Ornithorhynchus anatinus
[INFOR]: Number of second most vote    :14.0
[INFOR]: SEN testing of class 91_100 before transform: 15
[INFOR]: SPE testing of class 91_100 before transform: 99

[INFOR]: SEN testing of class 91_100 after transform: 82
[INFOR]: SPE testing of class 91_100 after transform: 30
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name cifar_100 --class_name_train 92_500 --class_name_test 92_100
2021-09-08 15:22:37.656145: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  cifar_100
class_name_train =  92_500
class_name_test =  92_100
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 15:22:40.208797: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 15:22:40.233142: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 15:22:40.237813: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 15:22:40.246106: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:22:40.248510: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:22:40.253572: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 15:22:40.257302: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 15:22:40.263627: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 15:22:40.268480: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 15:22:40.271543: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:22:40.273886: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 15:22:40.275863: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 15:22:40.288021: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x2c2ba947da0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 15:22:40.291274: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 15:22:40.293429: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 15:22:40.297959: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 15:22:40.300295: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:22:40.302683: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:22:40.304998: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 15:22:40.307299: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 15:22:40.309609: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 15:22:40.311977: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 15:22:40.314264: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:22:40.316458: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 15:22:40.741679: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 15:22:40.744532: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 15:22:40.745876: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 15:22:40.747333: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 15:22:40.753932: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x2c2e9401960 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 15:22:40.756731: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 15:22:42.995421: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 15:22:44.178321: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:22:44.822346: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:22:44.830158: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:22:46.169147: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 15:22:46.224953: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 15:22:46.788316: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 6s 73ms/step
[INFOR]: Index of most vote   :680
[INFOR]: Class of most vote   :nipple
[INFOR]: Number of most vote  :49.0


[INFOR]: Index of second most vote     :392
[INFOR]: Class of second most vote     :rock beauty, Holocanthus tricolor
[INFOR]: Number of second most vote    :36.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 3s 62ms/step
[INFOR]: Toltal norm before transform: 0.9075
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.2143

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 2s 62ms/step
[INFOR]: SEN training of class 92_500 before transform: 49
[INFOR]: SPE training of class 92_500 before transform: 462

[INFOR]: SEN training of class 92_500 after transform: 460
[INFOR]: SPE training of class 92_500 after transform: 371
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 63ms/step
[INFOR]: Index of most vote   :714
[INFOR]: Class of most vote   :pick, plectrum, plectron
[INFOR]: Number of most vote  :11.0


[INFOR]: Index of second most vote     :680
[INFOR]: Class of second most vote     :nipple
[INFOR]: Number of second most vote    :8.0
[INFOR]: SEN testing of class 92_100 before transform: 11
[INFOR]: SPE testing of class 92_100 before transform: 100

[INFOR]: SEN testing of class 92_100 after transform: 69
[INFOR]: SPE testing of class 92_100 after transform: 3
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name cifar_100 --class_name_train 93_500 --class_name_test 93_100
2021-09-08 15:22:58.521632: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  cifar_100
class_name_train =  93_500
class_name_test =  93_100
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 15:23:01.097492: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 15:23:01.120938: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 15:23:01.125489: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 15:23:01.133674: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:23:01.135845: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:23:01.140895: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 15:23:01.144355: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 15:23:01.151166: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 15:23:01.156050: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 15:23:01.158986: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:23:01.161282: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 15:23:01.163198: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 15:23:01.175470: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x19eb4336270 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 15:23:01.179131: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 15:23:01.181205: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 15:23:01.185459: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 15:23:01.187687: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:23:01.190065: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:23:01.192623: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 15:23:01.194762: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 15:23:01.196912: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 15:23:01.199142: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 15:23:01.201583: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:23:01.203718: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 15:23:01.642437: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 15:23:01.645044: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 15:23:01.646434: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 15:23:01.647940: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 15:23:01.655096: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x19edd6b8ae0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 15:23:01.658093: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 15:23:03.976263: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 15:23:05.159522: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:23:05.800302: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:23:05.807757: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:23:07.131146: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 15:23:07.181763: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 15:23:07.742062: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 6s 73ms/step
[INFOR]: Index of most vote   :149
[INFOR]: Class of most vote   :dugong, Dugong dugon
[INFOR]: Number of most vote  :113.0


[INFOR]: Index of second most vote     :103
[INFOR]: Class of second most vote     :platypus, duckbill, duckbilled platypus, duck-billed platypus, Ornithorhynchus anatinus
[INFOR]: Number of second most vote    :96.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 3s 64ms/step
[INFOR]: Toltal norm before transform: 0.7401
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0553

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 2s 64ms/step
[INFOR]: SEN training of class 93_500 before transform: 113
[INFOR]: SPE training of class 93_500 before transform: 476

[INFOR]: SEN training of class 93_500 after transform: 466
[INFOR]: SPE training of class 93_500 after transform: 359
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 63ms/step
[INFOR]: Index of most vote   :103
[INFOR]: Class of most vote   :platypus, duckbill, duckbilled platypus, duck-billed platypus, Ornithorhynchus anatinus
[INFOR]: Number of most vote  :20.0


[INFOR]: Index of second most vote     :148
[INFOR]: Class of second most vote     :killer whale, killer, orca, grampus, sea wolf, Orcinus orca
[INFOR]: Number of second most vote    :16.0
[INFOR]: SEN testing of class 93_100 before transform: 20
[INFOR]: SPE testing of class 93_100 before transform: 97

[INFOR]: SEN testing of class 93_100 after transform: 95
[INFOR]: SPE testing of class 93_100 after transform: 43
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name cifar_100 --class_name_train 94_500 --class_name_test 94_100
2021-09-08 15:23:19.651880: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  cifar_100
class_name_train =  94_500
class_name_test =  94_100
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 15:23:22.269589: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 15:23:22.306485: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 15:23:22.311794: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 15:23:22.320760: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:23:22.323159: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:23:22.328274: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 15:23:22.331614: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 15:23:22.337812: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 15:23:22.343047: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 15:23:22.346105: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:23:22.349033: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 15:23:22.351248: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 15:23:22.363211: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1d6b54b24a0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 15:23:22.366321: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 15:23:22.368387: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 15:23:22.373000: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 15:23:22.375318: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:23:22.377688: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:23:22.379956: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 15:23:22.382157: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 15:23:22.384349: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 15:23:22.386978: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 15:23:22.389410: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:23:22.391533: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 15:23:22.836455: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 15:23:22.839948: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 15:23:22.841357: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 15:23:22.842834: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 15:23:22.849931: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1d6e4f6d7d0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 15:23:22.852723: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 15:23:25.115243: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 15:23:26.284095: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:23:26.927433: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:23:26.934722: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:23:28.274499: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 15:23:28.322454: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 15:23:28.904228: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 6s 73ms/step
[INFOR]: Index of most vote   :789
[INFOR]: Class of most vote   :shoji
[INFOR]: Number of most vote  :79.0


[INFOR]: Index of second most vote     :631
[INFOR]: Class of second most vote     :lotion
[INFOR]: Number of second most vote    :60.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 3s 62ms/step
[INFOR]: Toltal norm before transform: 0.8429
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1099

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 2s 62ms/step
[INFOR]: SEN training of class 94_500 before transform: 79
[INFOR]: SPE training of class 94_500 before transform: 493

[INFOR]: SEN training of class 94_500 after transform: 490
[INFOR]: SPE training of class 94_500 after transform: 415
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 65ms/step
[INFOR]: Index of most vote   :631
[INFOR]: Class of most vote   :lotion
[INFOR]: Number of most vote  :14.0


[INFOR]: Index of second most vote     :788
[INFOR]: Class of second most vote     :shoe shop, shoe-shop, shoe store
[INFOR]: Number of second most vote    :13.0
[INFOR]: SEN testing of class 94_100 before transform: 14
[INFOR]: SPE testing of class 94_100 before transform: 98

[INFOR]: SEN testing of class 94_100 after transform: 99
[INFOR]: SPE testing of class 94_100 after transform: 37
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name cifar_100 --class_name_train 95_500 --class_name_test 95_100
2021-09-08 15:23:40.623321: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  cifar_100
class_name_train =  95_500
class_name_test =  95_100
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 15:23:43.172657: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 15:23:43.198861: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 15:23:43.204126: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 15:23:43.212104: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:23:43.214175: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:23:43.219066: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 15:23:43.222443: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 15:23:43.228505: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 15:23:43.233180: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 15:23:43.236188: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:23:43.238279: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 15:23:43.240104: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 15:23:43.252235: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x165b6e0db90 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 15:23:43.256070: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 15:23:43.258045: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 15:23:43.262439: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 15:23:43.264755: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:23:43.266845: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:23:43.269255: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 15:23:43.271545: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 15:23:43.273645: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 15:23:43.275772: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 15:23:43.277970: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:23:43.280057: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 15:23:43.704378: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 15:23:43.708104: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 15:23:43.709640: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 15:23:43.711239: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 15:23:43.717969: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x165e4d56760 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 15:23:43.720782: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 15:23:45.960628: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 15:23:47.136063: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:23:47.778890: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:23:47.786597: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:23:49.113563: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 15:23:49.162790: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 15:23:49.722520: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 6s 72ms/step
[INFOR]: Index of most vote   :149
[INFOR]: Class of most vote   :dugong, Dugong dugon
[INFOR]: Number of most vote  :98.0


[INFOR]: Index of second most vote     :147
[INFOR]: Class of second most vote     :grey whale, gray whale, devilfish, Eschrichtius gibbosus, Eschrichtius robustus
[INFOR]: Number of second most vote    :75.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 3s 62ms/step
[INFOR]: Toltal norm before transform: 0.7878
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0322

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 2s 62ms/step
[INFOR]: SEN training of class 95_500 before transform: 98
[INFOR]: SPE training of class 95_500 before transform: 472

[INFOR]: SEN training of class 95_500 after transform: 479
[INFOR]: SPE training of class 95_500 after transform: 372
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 65ms/step
[INFOR]: Index of most vote   :149
[INFOR]: Class of most vote   :dugong, Dugong dugon
[INFOR]: Number of most vote  :15.0


[INFOR]: Index of second most vote     :103
[INFOR]: Class of second most vote     :platypus, duckbill, duckbilled platypus, duck-billed platypus, Ornithorhynchus anatinus
[INFOR]: Number of second most vote    :12.0
[INFOR]: SEN testing of class 95_100 before transform: 15
[INFOR]: SPE testing of class 95_100 before transform: 97

[INFOR]: SEN testing of class 95_100 after transform: 94
[INFOR]: SPE testing of class 95_100 after transform: 29
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name cifar_100 --class_name_train 96_500 --class_name_test 96_100
2021-09-08 15:24:01.463860: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  cifar_100
class_name_train =  96_500
class_name_test =  96_100
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 15:24:04.009288: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 15:24:04.033694: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 15:24:04.038348: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 15:24:04.046012: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:24:04.048136: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:24:04.068676: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 15:24:04.072004: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 15:24:04.078230: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 15:24:04.083254: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 15:24:04.086106: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:24:04.088223: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 15:24:04.090087: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 15:24:04.102361: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x275354d7870 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 15:24:04.106070: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 15:24:04.108061: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 15:24:04.112258: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 15:24:04.114575: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:24:04.116677: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:24:04.118861: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 15:24:04.121161: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 15:24:04.123266: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 15:24:04.125396: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 15:24:04.127598: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:24:04.129824: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 15:24:04.555263: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 15:24:04.558671: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 15:24:04.560306: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 15:24:04.561796: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 15:24:04.568423: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x275573b7590 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 15:24:04.571254: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 15:24:06.844588: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 15:24:08.100179: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:24:08.753927: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:24:08.761507: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:24:10.095562: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 15:24:10.151153: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 15:24:10.719316: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 6s 74ms/step
[INFOR]: Index of most vote   :149
[INFOR]: Class of most vote   :dugong, Dugong dugon
[INFOR]: Number of most vote  :63.0


[INFOR]: Index of second most vote     :334
[INFOR]: Class of second most vote     :porcupine, hedgehog
[INFOR]: Number of second most vote    :54.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 3s 63ms/step
[INFOR]: Toltal norm before transform: 0.8657
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.4273

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 2s 62ms/step
[INFOR]: SEN training of class 96_500 before transform: 63
[INFOR]: SPE training of class 96_500 before transform: 471

[INFOR]: SEN training of class 96_500 after transform: 461
[INFOR]: SPE training of class 96_500 after transform: 344
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 63ms/step
[INFOR]: Index of most vote   :149
[INFOR]: Class of most vote   :dugong, Dugong dugon
[INFOR]: Number of most vote  :14.0


[INFOR]: Index of second most vote     :334
[INFOR]: Class of second most vote     :porcupine, hedgehog
[INFOR]: Number of second most vote    :13.0
[INFOR]: SEN testing of class 96_100 before transform: 14
[INFOR]: SPE testing of class 96_100 before transform: 96

[INFOR]: SEN testing of class 96_100 after transform: 99
[INFOR]: SPE testing of class 96_100 after transform: 20
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name cifar_100 --class_name_train 97_500 --class_name_test 97_100
2021-09-08 15:24:22.560358: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  cifar_100
class_name_train =  97_500
class_name_test =  97_100
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 15:24:25.156188: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 15:24:25.180201: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 15:24:25.185328: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 15:24:25.193514: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:24:25.196451: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:24:25.201896: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 15:24:25.205564: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 15:24:25.211890: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 15:24:25.216711: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 15:24:25.219612: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:24:25.221778: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 15:24:25.223668: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 15:24:25.238579: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x13eb6326430 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 15:24:25.242028: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 15:24:25.244068: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 15:24:25.248302: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 15:24:25.250499: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:24:25.252678: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:24:25.254886: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 15:24:25.257069: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 15:24:25.259515: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 15:24:25.261858: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 15:24:25.264526: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:24:25.267231: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 15:24:25.698523: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 15:24:25.701893: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 15:24:25.703285: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 15:24:25.704746: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 15:24:25.711416: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x13ee1080860 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 15:24:25.714217: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 15:24:28.008882: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 15:24:29.227228: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:24:29.883824: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:24:29.891648: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:24:31.243950: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 15:24:31.299617: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 15:24:31.893425: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 6s 80ms/step
[INFOR]: Index of most vote   :335
[INFOR]: Class of most vote   :fox squirrel, eastern fox squirrel, Sciurus niger
[INFOR]: Number of most vote  :87.0


[INFOR]: Index of second most vote     :272
[INFOR]: Class of second most vote     :coyote, prairie wolf, brush wolf, Canis latrans
[INFOR]: Number of second most vote    :67.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 3s 64ms/step
[INFOR]: Toltal norm before transform: 0.8397
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.2348

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 2s 64ms/step
[INFOR]: SEN training of class 97_500 before transform: 87
[INFOR]: SPE training of class 97_500 before transform: 470

[INFOR]: SEN training of class 97_500 after transform: 470
[INFOR]: SPE training of class 97_500 after transform: 373
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 61ms/step
[INFOR]: Index of most vote   :335
[INFOR]: Class of most vote   :fox squirrel, eastern fox squirrel, Sciurus niger
[INFOR]: Number of most vote  :20.0


[INFOR]: Index of second most vote     :269
[INFOR]: Class of second most vote     :timber wolf, grey wolf, gray wolf, Canis lupus
[INFOR]: Number of second most vote    :8.0
[INFOR]: SEN testing of class 97_100 before transform: 20
[INFOR]: SPE testing of class 97_100 before transform: 88

[INFOR]: SEN testing of class 97_100 after transform: 98
[INFOR]: SPE testing of class 97_100 after transform: 32
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name cifar_100 --class_name_train 98_500 --class_name_test 98_100
2021-09-08 15:24:44.060404: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  cifar_100
class_name_train =  98_500
class_name_test =  98_100
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 15:24:46.666044: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 15:24:46.689718: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 15:24:46.694662: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 15:24:46.702297: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:24:46.704558: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:24:46.712089: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 15:24:46.715772: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 15:24:46.722207: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 15:24:46.727228: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 15:24:46.731089: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:24:46.733737: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 15:24:46.735909: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 15:24:46.747961: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1c5b815e600 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 15:24:46.751179: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 15:24:46.753303: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 15:24:46.757656: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 15:24:46.759874: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:24:46.762071: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:24:46.764302: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 15:24:46.766574: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 15:24:46.768766: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 15:24:46.771072: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 15:24:46.773278: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:24:46.775445: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 15:24:47.203325: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 15:24:47.205996: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 15:24:47.207435: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 15:24:47.208980: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 15:24:47.215838: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1c5d8709df0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 15:24:47.219000: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 15:24:49.490744: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 15:24:50.724562: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:24:51.374102: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:24:51.381334: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:24:52.719388: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 15:24:52.765672: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 15:24:53.332554: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 6s 73ms/step
[INFOR]: Index of most vote   :680
[INFOR]: Class of most vote   :nipple
[INFOR]: Number of most vote  :102.0


[INFOR]: Index of second most vote     :905
[INFOR]: Class of second most vote     :window shade
[INFOR]: Number of second most vote    :93.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 3s 62ms/step
[INFOR]: Toltal norm before transform: 0.7907
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1470

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 2s 63ms/step
[INFOR]: SEN training of class 98_500 before transform: 102
[INFOR]: SPE training of class 98_500 before transform: 475

[INFOR]: SEN training of class 98_500 after transform: 452
[INFOR]: SPE training of class 98_500 after transform: 374
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 65ms/step
[INFOR]: Index of most vote   :680
[INFOR]: Class of most vote   :nipple
[INFOR]: Number of most vote  :20.0


[INFOR]: Index of second most vote     :905
[INFOR]: Class of second most vote     :window shade
[INFOR]: Number of second most vote    :13.0
[INFOR]: SEN testing of class 98_100 before transform: 20
[INFOR]: SPE testing of class 98_100 before transform: 96

[INFOR]: SEN testing of class 98_100 after transform: 93
[INFOR]: SPE testing of class 98_100 after transform: 25
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3  --model_shape 300 300 --dataset_name cifar_100 --class_name_train 99_500 --class_name_test 99_100
2021-09-08 15:25:05.285671: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
dataset_name =  cifar_100
class_name_train =  99_500
class_name_test =  99_100
data_shape =  (32, 32, 3)
model_shape =  [300, 300]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 15:25:07.928143: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 15:25:07.954387: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 15:25:07.959571: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 15:25:07.967815: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:25:07.970059: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:25:07.975364: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 15:25:07.978902: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 15:25:07.985442: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 15:25:07.990598: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 15:25:07.993683: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:25:07.996184: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 15:25:07.998165: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 15:25:08.010425: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1f1b7622ba0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 15:25:08.013482: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 15:25:08.015634: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 15:25:08.019919: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 15:25:08.022171: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:25:08.024558: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:25:08.027096: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 15:25:08.029276: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 15:25:08.031517: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 15:25:08.033794: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 15:25:08.036007: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:25:08.038222: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 15:25:08.467810: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 15:25:08.470656: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 15:25:08.472027: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 15:25:08.473516: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 15:25:08.480307: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1f1e6fbb180 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 15:25:08.483427: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 15:25:10.764192: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 15:25:11.979101: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 15:25:12.625193: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 15:25:12.632568: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 15:25:13.985199: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 15:25:14.057303: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 15:25:14.631910: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 6s 73ms/step
[INFOR]: Index of most vote   :111
[INFOR]: Class of most vote   :nematode, nematode worm, roundworm
[INFOR]: Number of most vote  :401.0


[INFOR]: Index of second most vote     :679
[INFOR]: Class of second most vote     :necklace
[INFOR]: Number of second most vote    :12.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 3s 63ms/step
[INFOR]: Toltal norm before transform: 0.0908
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0154

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 2s 65ms/step
[INFOR]: SEN training of class 99_500 before transform: 401
[INFOR]: SPE training of class 99_500 before transform: 492

[INFOR]: SEN training of class 99_500 after transform: 471
[INFOR]: SPE training of class 99_500 after transform: 459
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 63ms/step
[INFOR]: Index of most vote   :111
[INFOR]: Class of most vote   :nematode, nematode worm, roundworm
[INFOR]: Number of most vote  :79.0


[INFOR]: Index of second most vote     :771
[INFOR]: Class of second most vote     :safe
[INFOR]: Number of second most vote    :3.0
[INFOR]: SEN testing of class 99_100 before transform: 79
[INFOR]: SPE testing of class 99_100 before transform: 98

[INFOR]: SEN testing of class 99_100 after transform: 94
[INFOR]: SPE testing of class 99_100 after transform: 1
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>