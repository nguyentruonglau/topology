ic library curand64_10.dll
2021-09-08 14:29:08.326833: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 14:29:08.331902: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 14:29:08.334945: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:29:08.337100: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 14:29:08.339115: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 14:29:08.351995: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x24cb5a1ca30 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 14:29:08.355757: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 14:29:08.357904: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 14:29:08.362373: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 14:29:08.364581: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:29:08.366851: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:29:08.369252: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 14:29:08.371434: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 14:29:08.373732: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 14:29:08.376224: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 14:29:08.378552: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:29:08.380794: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 14:29:08.807157: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 14:29:08.809991: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 14:29:08.811506: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 14:29:08.813058: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 14:29:08.819750: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x24cddef19c0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 14:29:08.822625: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 14:29:10.825273: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 14:29:11.514782: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:29:12.165083: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:29:12.172269: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:29:13.522004: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 14:29:13.571656: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 14:29:14.294116: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 5s 48ms/step
[INFOR]: Index of most vote   :335
[INFOR]: Class of most vote   :fox squirrel, eastern fox squirrel, Sciurus niger
[INFOR]: Number of most vote  :48.0


[INFOR]: Index of second most vote     :679
[INFOR]: Class of second most vote     :necklace
[INFOR]: Number of second most vote    :44.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 2s 31ms/step
[INFOR]: Toltal norm before transform: 0.8842
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.2211

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 1s 32ms/step
[INFOR]: SEN training of class 36_500 before transform: 48
[INFOR]: SPE training of class 36_500 before transform: 489

[INFOR]: SEN training of class 36_500 after transform: 422
[INFOR]: SPE training of class 36_500 after transform: 342
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 31ms/step
[INFOR]: Index of most vote   :335
[INFOR]: Class of most vote   :fox squirrel, eastern fox squirrel, Sciurus niger
[INFOR]: Number of most vote  :8.0


[INFOR]: Index of second most vote     :679
[INFOR]: Class of second most vote     :necklace
[INFOR]: Number of second most vote    :7.0
[INFOR]: SEN testing of class 36_100 before transform: 8
[INFOR]: SPE testing of class 36_100 before transform: 99

[INFOR]: SEN testing of class 36_100 after transform: 87
[INFOR]: SPE testing of class 36_100 after transform: 37
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name cifar_100 --class_name_train 37_500 --class_name_test 37_100
2021-09-08 14:29:22.581826: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  cifar_100
class_name_train =  37_500
class_name_test =  37_100
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 14:29:25.169955: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 14:29:25.200067: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 14:29:25.204981: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 14:29:25.212886: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:29:25.215080: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:29:25.220200: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 14:29:25.223556: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 14:29:25.230069: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 14:29:25.234954: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 14:29:25.238094: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:29:25.240245: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 14:29:25.242175: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 14:29:25.254439: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1d7afdee7e0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 14:29:25.257736: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 14:29:25.259817: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 14:29:25.264176: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 14:29:25.266412: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:29:25.268602: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:29:25.270869: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 14:29:25.273083: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 14:29:25.275579: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 14:29:25.277982: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 14:29:25.280255: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:29:25.282521: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 14:29:25.703824: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 14:29:25.706760: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 14:29:25.708229: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 14:29:25.709987: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 14:29:25.716817: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1d7d998a910 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 14:29:25.719677: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 14:29:27.673825: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 14:29:28.359428: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:29:29.016158: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:29:29.022465: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:29:30.368832: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 14:29:30.415888: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 14:29:31.135355: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 5s 47ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :90.0


[INFOR]: Index of second most vote     :510
[INFOR]: Class of second most vote     :container ship, containership, container vessel
[INFOR]: Number of second most vote    :81.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 2s 32ms/step
[INFOR]: Toltal norm before transform: 0.7888
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0206

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 1s 32ms/step
[INFOR]: SEN training of class 37_500 before transform: 90
[INFOR]: SPE training of class 37_500 before transform: 483

[INFOR]: SEN training of class 37_500 after transform: 421
[INFOR]: SPE training of class 37_500 after transform: 358
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 32ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :23.0


[INFOR]: Index of second most vote     :510
[INFOR]: Class of second most vote     :container ship, containership, container vessel
[INFOR]: Number of second most vote    :16.0
[INFOR]: SEN testing of class 37_100 before transform: 23
[INFOR]: SPE testing of class 37_100 before transform: 97

[INFOR]: SEN testing of class 37_100 after transform: 91
[INFOR]: SPE testing of class 37_100 after transform: 21
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name cifar_100 --class_name_train 38_500 --class_name_test 38_100
2021-09-08 14:29:39.399817: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  cifar_100
class_name_train =  38_500
class_name_test =  38_100
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 14:29:41.973186: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 14:29:41.997813: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 14:29:42.002908: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 14:29:42.010782: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:29:42.013020: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:29:42.018298: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 14:29:42.022031: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 14:29:42.028454: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 14:29:42.033462: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 14:29:42.036524: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:29:42.038754: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 14:29:42.040732: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 14:29:42.053092: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x13634f0b280 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 14:29:42.056343: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 14:29:42.058594: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 14:29:42.063074: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 14:29:42.065307: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:29:42.067569: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:29:42.069852: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 14:29:42.072064: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 14:29:42.074466: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 14:29:42.076790: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 14:29:42.079068: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:29:42.081289: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 14:29:42.503616: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 14:29:42.506636: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 14:29:42.508151: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 14:29:42.509782: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 14:29:42.516670: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1366002dca0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 14:29:42.519548: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 14:29:44.485011: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 14:29:45.180325: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:29:45.836965: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:29:45.843509: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:29:47.206007: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 14:29:47.254763: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 14:29:48.036952: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 5s 47ms/step
[INFOR]: Index of most vote   :104
[INFOR]: Class of most vote   :wallaby, brush kangaroo
[INFOR]: Number of most vote  :42.0


[INFOR]: Index of second most vote     :382
[INFOR]: Class of second most vote     :squirrel monkey, Saimiri sciureus
[INFOR]: Number of second most vote    :35.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 2s 32ms/step
[INFOR]: Toltal norm before transform: 0.9093
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.5868

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 1s 32ms/step
[INFOR]: SEN training of class 38_500 before transform: 42
[INFOR]: SPE training of class 38_500 before transform: 500

[INFOR]: SEN training of class 38_500 after transform: 444
[INFOR]: SPE training of class 38_500 after transform: 352
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 32ms/step
[INFOR]: Index of most vote   :335
[INFOR]: Class of most vote   :fox squirrel, eastern fox squirrel, Sciurus niger
[INFOR]: Number of most vote  :13.0


[INFOR]: Index of second most vote     :104
[INFOR]: Class of second most vote     :wallaby, brush kangaroo
[INFOR]: Number of second most vote    :12.0
[INFOR]: SEN testing of class 38_100 before transform: 13
[INFOR]: SPE testing of class 38_100 before transform: 96

[INFOR]: SEN testing of class 38_100 after transform: 88
[INFOR]: SPE testing of class 38_100 after transform: 0
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name cifar_100 --class_name_train 39_500 --class_name_test 39_100
2021-09-08 14:29:56.306442: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  cifar_100
class_name_train =  39_500
class_name_test =  39_100
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 14:29:58.923198: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 14:29:58.948410: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 14:29:58.953936: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 14:29:58.962393: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:29:58.964777: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:29:58.970240: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 14:29:58.973952: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 14:29:58.980583: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 14:29:58.985944: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 14:29:58.989071: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:29:58.991315: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 14:29:58.993326: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 14:29:59.006061: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x204381784e0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 14:29:59.009380: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 14:29:59.011536: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 14:29:59.016061: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 14:29:59.018296: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:29:59.020578: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:29:59.023155: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 14:29:59.025453: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 14:29:59.027757: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 14:29:59.030037: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 14:29:59.032317: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:29:59.034522: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 14:29:59.463765: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 14:29:59.466573: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 14:29:59.468123: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 14:29:59.469723: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 14:29:59.476647: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x20460bc5780 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 14:29:59.479478: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 14:30:01.499931: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 14:30:02.201127: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:30:02.868671: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:30:02.875301: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:30:04.227294: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 14:30:04.276240: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 14:30:04.996093: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 5s 47ms/step
[INFOR]: Index of most vote   :810
[INFOR]: Class of most vote   :space bar
[INFOR]: Number of most vote  :173.0


[INFOR]: Index of second most vote     :590
[INFOR]: Class of second most vote     :hand-held computer, hand-held microcomputer
[INFOR]: Number of second most vote    :47.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 2s 31ms/step
[INFOR]: Toltal norm before transform: 0.5910
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0384

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 1s 31ms/step
[INFOR]: SEN training of class 39_500 before transform: 173
[INFOR]: SPE training of class 39_500 before transform: 498

[INFOR]: SEN training of class 39_500 after transform: 473
[INFOR]: SPE training of class 39_500 after transform: 448
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 31ms/step
[INFOR]: Index of most vote   :810
[INFOR]: Class of most vote   :space bar
[INFOR]: Number of most vote  :43.0


[INFOR]: Index of second most vote     :590
[INFOR]: Class of second most vote     :hand-held computer, hand-held microcomputer
[INFOR]: Number of second most vote    :13.0
[INFOR]: SEN testing of class 39_100 before transform: 43
[INFOR]: SPE testing of class 39_100 before transform: 100

[INFOR]: SEN testing of class 39_100 after transform: 95
[INFOR]: SPE testing of class 39_100 after transform: 21
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name cifar_100 --class_name_train 40_500 --class_name_test 40_100
2021-09-08 14:30:13.237750: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  cifar_100
class_name_train =  40_500
class_name_test =  40_100
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 14:30:15.762355: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 14:30:15.789110: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 14:30:15.794221: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 14:30:15.802451: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:30:15.804562: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:30:15.809734: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 14:30:15.813100: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 14:30:15.819423: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 14:30:15.824265: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 14:30:15.827278: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:30:15.829556: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 14:30:15.831590: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 14:30:15.844249: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x16cb4439400 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 14:30:15.847656: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 14:30:15.850016: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 14:30:15.855521: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 14:30:15.857993: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:30:15.860445: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:30:15.862988: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 14:30:15.865395: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 14:30:15.867921: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 14:30:15.870548: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 14:30:15.873012: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:30:15.875540: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 14:30:16.301399: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 14:30:16.304239: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 14:30:16.305757: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 14:30:16.307343: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 14:30:16.314029: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x16cdee65900 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 14:30:16.316898: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 14:30:18.289169: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 14:30:18.970160: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:30:19.626823: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:30:19.633484: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:30:20.994757: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 14:30:21.041983: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 14:30:21.761265: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 5s 49ms/step
[INFOR]: Index of most vote   :846
[INFOR]: Class of most vote   :table lamp
[INFOR]: Number of most vote  :163.0


[INFOR]: Index of second most vote     :680
[INFOR]: Class of second most vote     :nipple
[INFOR]: Number of second most vote    :27.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 2s 31ms/step
[INFOR]: Toltal norm before transform: 0.6195
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0826

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 1s 32ms/step
[INFOR]: SEN training of class 40_500 before transform: 163
[INFOR]: SPE training of class 40_500 before transform: 498

[INFOR]: SEN training of class 40_500 after transform: 381
[INFOR]: SPE training of class 40_500 after transform: 407
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 32ms/step
[INFOR]: Index of most vote   :846
[INFOR]: Class of most vote   :table lamp
[INFOR]: Number of most vote  :32.0


[INFOR]: Index of second most vote     :604
[INFOR]: Class of second most vote     :hourglass
[INFOR]: Number of second most vote    :6.0
[INFOR]: SEN testing of class 40_100 before transform: 32
[INFOR]: SPE testing of class 40_100 before transform: 100

[INFOR]: SEN testing of class 40_100 after transform: 93
[INFOR]: SPE testing of class 40_100 after transform: 22
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name cifar_100 --class_name_train 41_500 --class_name_test 41_100
2021-09-08 14:30:30.128295: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  cifar_100
class_name_train =  41_500
class_name_test =  41_100
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 14:30:32.703273: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 14:30:32.727341: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 14:30:32.732119: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 14:30:32.740141: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:30:32.742348: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:30:32.747505: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 14:30:32.750895: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 14:30:32.757209: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 14:30:32.762136: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 14:30:32.765114: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:30:32.767329: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 14:30:32.769297: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 14:30:32.782025: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1b1b3d06fe0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 14:30:32.785380: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 14:30:32.787494: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 14:30:32.791967: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 14:30:32.794189: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:30:32.796393: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:30:32.798681: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 14:30:32.801039: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 14:30:32.803311: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 14:30:32.805620: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 14:30:32.807841: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:30:32.810068: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 14:30:33.234492: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 14:30:33.237292: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 14:30:33.238803: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 14:30:33.240596: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 14:30:33.247500: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1b1df0d2250 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 14:30:33.250423: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 14:30:35.268431: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 14:30:35.961851: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:30:36.608697: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:30:36.614749: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:30:37.968988: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 14:30:38.018131: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 14:30:38.737762: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 5s 47ms/step
[INFOR]: Index of most vote   :473
[INFOR]: Class of most vote   :can opener, tin opener
[INFOR]: Number of most vote  :103.0


[INFOR]: Index of second most vote     :620
[INFOR]: Class of second most vote     :laptop, laptop computer
[INFOR]: Number of second most vote    :96.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 2s 32ms/step
[INFOR]: Toltal norm before transform: 0.7082
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1722

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 1s 32ms/step
[INFOR]: SEN training of class 41_500 before transform: 103
[INFOR]: SPE training of class 41_500 before transform: 495

[INFOR]: SEN training of class 41_500 after transform: 431
[INFOR]: SPE training of class 41_500 after transform: 362
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 31ms/step
[INFOR]: Index of most vote   :473
[INFOR]: Class of most vote   :can opener, tin opener
[INFOR]: Number of most vote  :23.0


[INFOR]: Index of second most vote     :620
[INFOR]: Class of second most vote     :laptop, laptop computer
[INFOR]: Number of second most vote    :17.0
[INFOR]: SEN testing of class 41_100 before transform: 23
[INFOR]: SPE testing of class 41_100 before transform: 99

[INFOR]: SEN testing of class 41_100 after transform: 89
[INFOR]: SPE testing of class 41_100 after transform: 27
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name cifar_100 --class_name_train 42_500 --class_name_test 42_100
2021-09-08 14:30:46.987335: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  cifar_100
class_name_train =  42_500
class_name_test =  42_100
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 14:30:49.586122: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 14:30:49.609742: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 14:30:49.614654: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 14:30:49.622778: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:30:49.624956: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:30:49.630215: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 14:30:49.633668: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 14:30:49.640019: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 14:30:49.645009: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 14:30:49.648074: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:30:49.650281: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 14:30:49.652295: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 14:30:49.664955: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1aa3a28b7f0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 14:30:49.668579: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 14:30:49.670731: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 14:30:49.675261: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 14:30:49.677546: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:30:49.679801: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:30:49.682143: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 14:30:49.684407: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 14:30:49.686688: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 14:30:49.688962: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 14:30:49.691226: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:30:49.693608: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 14:30:50.115445: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 14:30:50.118329: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 14:30:50.120420: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 14:30:50.122160: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 14:30:50.129041: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1aa65e4bf70 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 14:30:50.132105: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 14:30:52.105915: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 14:30:52.833310: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:30:53.507719: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:30:53.513554: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:30:54.990211: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 14:30:55.039684: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 14:30:55.839793: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 5s 51ms/step
[INFOR]: Index of most vote   :335
[INFOR]: Class of most vote   :fox squirrel, eastern fox squirrel, Sciurus niger
[INFOR]: Number of most vote  :78.0


[INFOR]: Index of second most vote     :289
[INFOR]: Class of second most vote     :snow leopard, ounce, Panthera uncia
[INFOR]: Number of second most vote    :42.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 2s 34ms/step
[INFOR]: Toltal norm before transform: 0.7900
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0012

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 1s 34ms/step
[INFOR]: SEN training of class 42_500 before transform: 78
[INFOR]: SPE training of class 42_500 before transform: 491

[INFOR]: SEN training of class 42_500 after transform: 413
[INFOR]: SPE training of class 42_500 after transform: 341
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 34ms/step
[INFOR]: Index of most vote   :335
[INFOR]: Class of most vote   :fox squirrel, eastern fox squirrel, Sciurus niger
[INFOR]: Number of most vote  :20.0


[INFOR]: Index of second most vote     :289
[INFOR]: Class of second most vote     :snow leopard, ounce, Panthera uncia
[INFOR]: Number of second most vote    :8.0
[INFOR]: SEN testing of class 42_100 before transform: 20
[INFOR]: SPE testing of class 42_100 before transform: 97

[INFOR]: SEN testing of class 42_100 after transform: 87
[INFOR]: SPE testing of class 42_100 after transform: 56
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name cifar_100 --class_name_train 43_500 --class_name_test 43_100
2021-09-08 14:31:04.521386: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  cifar_100
class_name_train =  43_500
class_name_test =  43_100
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 14:31:07.212961: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 14:31:07.235626: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 14:31:07.240386: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 14:31:07.248330: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:31:07.250473: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:31:07.255688: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 14:31:07.259073: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 14:31:07.265256: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 14:31:07.270355: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 14:31:07.273290: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:31:07.275450: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 14:31:07.277431: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 14:31:07.289562: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1f237338280 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 14:31:07.292673: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 14:31:07.294808: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 14:31:07.299580: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 14:31:07.301827: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:31:07.304119: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:31:07.306406: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 14:31:07.308895: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 14:31:07.311365: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 14:31:07.313719: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 14:31:07.316005: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:31:07.318242: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 14:31:07.737311: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 14:31:07.740375: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 14:31:07.741835: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 14:31:07.743386: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 14:31:07.750170: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1f26601d390 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 14:31:07.753027: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 14:31:09.755057: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 14:31:10.445438: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:31:11.119136: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:31:11.126197: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:31:12.488249: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 14:31:12.536196: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 14:31:13.265813: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 5s 47ms/step
[INFOR]: Index of most vote   :291
[INFOR]: Class of most vote   :lion, king of beasts, Panthera leo
[INFOR]: Number of most vote  :50.0


[INFOR]: Index of second most vote     :334
[INFOR]: Class of second most vote     :porcupine, hedgehog
[INFOR]: Number of second most vote    :24.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 2s 32ms/step
[INFOR]: Toltal norm before transform: 0.8717
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0515

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 1s 33ms/step
[INFOR]: SEN training of class 43_500 before transform: 50
[INFOR]: SPE training of class 43_500 before transform: 500

[INFOR]: SEN training of class 43_500 after transform: 435
[INFOR]: SPE training of class 43_500 after transform: 363
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 34ms/step
[INFOR]: Index of most vote   :291
[INFOR]: Class of most vote   :lion, king of beasts, Panthera leo
[INFOR]: Number of most vote  :14.0


[INFOR]: Index of second most vote     :334
[INFOR]: Class of second most vote     :porcupine, hedgehog
[INFOR]: Number of second most vote    :8.0
[INFOR]: SEN testing of class 43_100 before transform: 14
[INFOR]: SPE testing of class 43_100 before transform: 100

[INFOR]: SEN testing of class 43_100 after transform: 97
[INFOR]: SPE testing of class 43_100 after transform: 9
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name cifar_100 --class_name_train 44_500 --class_name_test 44_100
2021-09-08 14:31:21.693417: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  cifar_100
class_name_train =  44_500
class_name_test =  44_100
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 14:31:24.364805: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 14:31:24.390293: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 14:31:24.395104: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 14:31:24.403202: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:31:24.405407: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:31:24.410622: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 14:31:24.414247: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 14:31:24.420881: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 14:31:24.425683: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 14:31:24.428617: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:31:24.431001: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 14:31:24.432948: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 14:31:24.445501: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1dcb7b3fea0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 14:31:24.449178: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 14:31:24.451572: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 14:31:24.456182: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 14:31:24.458379: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:31:24.460617: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:31:24.462894: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 14:31:24.465085: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 14:31:24.467414: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 14:31:24.469682: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 14:31:24.472034: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:31:24.474233: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 14:31:24.913033: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 14:31:24.915872: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 14:31:24.917463: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 14:31:24.919037: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 14:31:24.925579: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1dce6005660 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 14:31:24.928532: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 14:31:26.951624: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 14:31:27.650457: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:31:28.316644: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:31:28.322972: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:31:29.678633: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 14:31:29.727508: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 14:31:30.448359: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 5s 50ms/step
[INFOR]: Index of most vote   :38
[INFOR]: Class of most vote   :banded gecko
[INFOR]: Number of most vote  :37.0


[INFOR]: Index of second most vote     :110
[INFOR]: Class of second most vote     :flatworm, platyhelminth
[INFOR]: Number of second most vote    :35.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 2s 32ms/step
[INFOR]: Toltal norm before transform: 0.9244
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.4161

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 1s 32ms/step
[INFOR]: SEN training of class 44_500 before transform: 37
[INFOR]: SPE training of class 44_500 before transform: 500

[INFOR]: SEN training of class 44_500 after transform: 370
[INFOR]: SPE training of class 44_500 after transform: 332
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 32ms/step
[INFOR]: Index of most vote   :38
[INFOR]: Class of most vote   :banded gecko
[INFOR]: Number of most vote  :10.0


[INFOR]: Index of second most vote     :110
[INFOR]: Class of second most vote     :flatworm, platyhelminth
[INFOR]: Number of second most vote    :7.0
[INFOR]: SEN testing of class 44_100 before transform: 10
[INFOR]: SPE testing of class 44_100 before transform: 100

[INFOR]: SEN testing of class 44_100 after transform: 94
[INFOR]: SPE testing of class 44_100 after transform: 19
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name cifar_100 --class_name_train 45_500 --class_name_test 45_100
2021-09-08 14:31:38.869537: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  cifar_100
class_name_train =  45_500
class_name_test =  45_100
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 14:31:41.455122: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 14:31:41.479053: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 14:31:41.483838: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 14:31:41.492055: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:31:41.494202: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:31:41.499418: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 14:31:41.502778: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 14:31:41.509022: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 14:31:41.514013: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 14:31:41.516947: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:31:41.519088: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 14:31:41.521011: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 14:31:41.533095: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x16534f97b60 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 14:31:41.536306: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 14:31:41.538451: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 14:31:41.542881: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 14:31:41.545067: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:31:41.547227: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:31:41.549601: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 14:31:41.551799: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 14:31:41.554095: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 14:31:41.557054: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 14:31:41.559438: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:31:41.561760: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 14:31:41.990462: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 14:31:41.993165: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 14:31:41.995158: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 14:31:41.996815: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 14:31:42.003596: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x16564590c70 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 14:31:42.006512: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 14:31:43.971361: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 14:31:44.653875: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:31:45.316089: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:31:45.322417: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:31:46.687910: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 14:31:46.735377: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 14:31:47.490849: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 5s 49ms/step
[INFOR]: Index of most vote   :392
[INFOR]: Class of most vote   :rock beauty, Holocanthus tricolor
[INFOR]: Number of most vote  :39.0


[INFOR]: Index of second most vote     :713
[INFOR]: Class of second most vote     :photocopier
[INFOR]: Number of second most vote    :35.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 2s 32ms/step
[INFOR]: Toltal norm before transform: 0.9158
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0246

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 1s 32ms/step
[INFOR]: SEN training of class 45_500 before transform: 39
[INFOR]: SPE training of class 45_500 before transform: 475

[INFOR]: SEN training of class 45_500 after transform: 362
[INFOR]: SPE training of class 45_500 after transform: 306
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 32ms/step
[INFOR]: Index of most vote   :680
[INFOR]: Class of most vote   :nipple
[INFOR]: Number of most vote  :8.0


[INFOR]: Index of second most vote     :392
[INFOR]: Class of second most vote     :rock beauty, Holocanthus tricolor
[INFOR]: Number of second most vote    :6.0
[INFOR]: SEN testing of class 45_100 before transform: 8
[INFOR]: SPE testing of class 45_100 before transform: 97

[INFOR]: SEN testing of class 45_100 after transform: 98
[INFOR]: SPE testing of class 45_100 after transform: 7
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name cifar_100 --class_name_train 46_500 --class_name_test 46_100
2021-09-08 14:31:55.817347: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  cifar_100
class_name_train =  46_500
class_name_test =  46_100
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 14:31:58.433618: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 14:31:58.457341: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 14:31:58.462193: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 14:31:58.470269: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:31:58.472435: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:31:58.477655: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 14:31:58.481040: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 14:31:58.487481: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 14:31:58.492372: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 14:31:58.495453: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:31:58.497632: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 14:31:58.499588: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 14:31:58.511708: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x2aeb8433980 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 14:31:58.514958: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 14:31:58.517081: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 14:31:58.521557: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 14:31:58.523803: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:31:58.526242: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:31:58.528497: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 14:31:58.530727: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 14:31:58.533022: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 14:31:58.535546: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 14:31:58.537796: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:31:58.540026: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 14:31:58.973055: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 14:31:58.975822: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 14:31:58.977370: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 14:31:58.979069: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 14:31:58.986078: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x2aee6a4dfa0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 14:31:58.988961: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 14:32:01.003425: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 14:32:01.704520: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:32:02.365475: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:32:02.372554: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:32:03.719696: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 14:32:03.768384: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 14:32:04.489042: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 5s 48ms/step
[INFOR]: Index of most vote   :906
[INFOR]: Class of most vote   :Windsor tie
[INFOR]: Number of most vote  :97.0


[INFOR]: Index of second most vote     :610
[INFOR]: Class of second most vote     :jersey, T-shirt, tee shirt
[INFOR]: Number of second most vote    :29.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 2s 32ms/step
[INFOR]: Toltal norm before transform: 0.7533
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1059

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 1s 32ms/step
[INFOR]: SEN training of class 46_500 before transform: 97
[INFOR]: SPE training of class 46_500 before transform: 495

[INFOR]: SEN training of class 46_500 after transform: 372
[INFOR]: SPE training of class 46_500 after transform: 330
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 33ms/step
[INFOR]: Index of most vote   :906
[INFOR]: Class of most vote   :Windsor tie
[INFOR]: Number of most vote  :14.0


[INFOR]: Index of second most vote     :465
[INFOR]: Class of second most vote     :bulletproof vest
[INFOR]: Number of second most vote    :5.0
[INFOR]: SEN testing of class 46_100 before transform: 14
[INFOR]: SPE testing of class 46_100 before transform: 97

[INFOR]: SEN testing of class 46_100 after transform: 91
[INFOR]: SPE testing of class 46_100 after transform: 12
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name cifar_100 --class_name_train 47_500 --class_name_test 47_100
2021-09-08 14:32:12.815088: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  cifar_100
class_name_train =  47_500
class_name_test =  47_100
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 14:32:15.354862: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 14:32:15.383541: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 14:32:15.388295: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 14:32:15.396269: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:32:15.398457: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:32:15.403596: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 14:32:15.406931: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 14:32:15.413181: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 14:32:15.418080: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 14:32:15.421272: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:32:15.423436: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 14:32:15.425398: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 14:32:15.437341: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1cc33c90ae0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 14:32:15.440684: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 14:32:15.442820: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 14:32:15.447428: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 14:32:15.449626: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:32:15.452020: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:32:15.454273: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 14:32:15.456487: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 14:32:15.458947: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 14:32:15.461169: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 14:32:15.463506: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:32:15.465872: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 14:32:15.889065: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 14:32:15.891847: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 14:32:15.893599: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 14:32:15.895442: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 14:32:15.902833: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1cc5c52a080 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 14:32:15.905980: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 14:32:17.863739: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 14:32:18.553804: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:32:19.205077: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:32:19.211754: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:32:20.557161: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 14:32:20.606632: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 14:32:21.325840: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 5s 47ms/step
[INFOR]: Index of most vote   :975
[INFOR]: Class of most vote   :lakeside, lakeshore
[INFOR]: Number of most vote  :65.0


[INFOR]: Index of second most vote     :782
[INFOR]: Class of second most vote     :screen, CRT screen
[INFOR]: Number of second most vote    :40.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 2s 32ms/step
[INFOR]: Toltal norm before transform: 0.8160
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0553

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 1s 32ms/step
[INFOR]: SEN training of class 47_500 before transform: 65
[INFOR]: SPE training of class 47_500 before transform: 497

[INFOR]: SEN training of class 47_500 after transform: 450
[INFOR]: SPE training of class 47_500 after transform: 402
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 32ms/step
[INFOR]: Index of most vote   :782
[INFOR]: Class of most vote   :screen, CRT screen
[INFOR]: Number of most vote  :13.0


[INFOR]: Index of second most vote     :974
[INFOR]: Class of second most vote     :geyser
[INFOR]: Number of second most vote    :12.0
[INFOR]: SEN testing of class 47_100 before transform: 13
[INFOR]: SPE testing of class 47_100 before transform: 98

[INFOR]: SEN testing of class 47_100 after transform: 100
[INFOR]: SPE testing of class 47_100 after transform: 4
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name cifar_100 --class_name_train 48_500 --class_name_test 48_100
2021-09-08 14:32:29.653516: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  cifar_100
class_name_train =  48_500
class_name_test =  48_100
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 14:32:32.230875: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 14:32:32.257116: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 14:32:32.262539: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 14:32:32.270615: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:32:32.273095: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:32:32.278512: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 14:32:32.282075: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 14:32:32.288404: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 14:32:32.293430: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 14:32:32.296367: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:32:32.298567: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 14:32:32.300517: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 14:32:32.312930: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x21ab7945de0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 14:32:32.316225: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 14:32:32.318413: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 14:32:32.322972: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 14:32:32.325295: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:32:32.327740: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:32:32.330173: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 14:32:32.332398: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 14:32:32.334731: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 14:32:32.337152: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 14:32:32.339699: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:32:32.341901: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 14:32:32.760522: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 14:32:32.763293: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 14:32:32.764802: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 14:32:32.766419: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 14:32:32.773211: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x21ae7bd1c10 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 14:32:32.776161: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 14:32:34.747182: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 14:32:35.427662: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:32:36.084022: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:32:36.090198: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:32:37.458395: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 14:32:37.508595: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 14:32:38.232498: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 5s 47ms/step
[INFOR]: Index of most vote   :856
[INFOR]: Class of most vote   :thresher, thrasher, threshing machine
[INFOR]: Number of most vote  :110.0


[INFOR]: Index of second most vote     :670
[INFOR]: Class of second most vote     :motor scooter, scooter
[INFOR]: Number of second most vote    :98.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 2s 32ms/step
[INFOR]: Toltal norm before transform: 0.7244
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1552

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 1s 32ms/step
[INFOR]: SEN training of class 48_500 before transform: 110
[INFOR]: SPE training of class 48_500 before transform: 489

[INFOR]: SEN training of class 48_500 after transform: 424
[INFOR]: SPE training of class 48_500 after transform: 329
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 32ms/step
[INFOR]: Index of most vote   :856
[INFOR]: Class of most vote   :thresher, thrasher, threshing machine
[INFOR]: Number of most vote  :25.0


[INFOR]: Index of second most vote     :670
[INFOR]: Class of second most vote     :motor scooter, scooter
[INFOR]: Number of second most vote    :20.0
[INFOR]: SEN testing of class 48_100 before transform: 25
[INFOR]: SPE testing of class 48_100 before transform: 99

[INFOR]: SEN testing of class 48_100 after transform: 78
[INFOR]: SPE testing of class 48_100 after transform: 13
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name cifar_100 --class_name_train 49_500 --class_name_test 49_100
2021-09-08 14:32:46.503395: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  cifar_100
class_name_train =  49_500
class_name_test =  49_100
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 14:32:49.093449: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 14:32:49.120114: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 14:32:49.125175: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 14:32:49.133428: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:32:49.135674: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:32:49.140928: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 14:32:49.144447: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 14:32:49.150854: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 14:32:49.155813: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 14:32:49.158818: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:32:49.160991: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 14:32:49.163134: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 14:32:49.175964: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1cb3470d300 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 14:32:49.180005: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 14:32:49.182276: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 14:32:49.186915: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 14:32:49.189251: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:32:49.191621: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:32:49.193939: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 14:32:49.196213: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 14:32:49.198429: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 14:32:49.200766: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 14:32:49.203007: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:32:49.205295: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 14:32:49.630185: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 14:32:49.632680: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 14:32:49.634210: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 14:32:49.635919: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 14:32:49.642951: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1cb5e794340 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 14:32:49.645992: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 14:32:51.637916: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 14:32:52.351702: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:32:53.011950: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:32:53.018475: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:32:54.369840: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 14:32:54.418950: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 14:32:55.136079: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 5s 47ms/step
[INFOR]: Index of most vote   :970
[INFOR]: Class of most vote   :alp
[INFOR]: Number of most vote  :65.0


[INFOR]: Index of second most vote     :252
[INFOR]: Class of second most vote     :affenpinscher, monkey pinscher, monkey dog
[INFOR]: Number of second most vote    :26.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 2s 32ms/step
[INFOR]: Toltal norm before transform: 0.8336
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.3718

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 1s 32ms/step
[INFOR]: SEN training of class 49_500 before transform: 65
[INFOR]: SPE training of class 49_500 before transform: 500

[INFOR]: SEN training of class 49_500 after transform: 458
[INFOR]: SPE training of class 49_500 after transform: 390
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 32ms/step
[INFOR]: Index of most vote   :147
[INFOR]: Class of most vote   :grey whale, gray whale, devilfish, Eschrichtius gibbosus, Eschrichtius robustus
[INFOR]: Number of most vote  :8.0


[INFOR]: Index of second most vote     :969
[INFOR]: Class of second most vote     :eggnog
[INFOR]: Number of second most vote    :5.0
[INFOR]: SEN testing of class 49_100 before transform: 8
[INFOR]: SPE testing of class 49_100 before transform: 98

[INFOR]: SEN testing of class 49_100 after transform: 100
[INFOR]: SPE testing of class 49_100 after transform: 4
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name cifar_100 --class_name_train 50_500 --class_name_test 50_100
2021-09-08 14:33:03.395189: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  cifar_100
class_name_train =  50_500
class_name_test =  50_100
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 14:33:05.967192: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 14:33:05.991757: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 14:33:05.996344: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 14:33:06.004233: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:33:06.006392: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:33:06.011548: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 14:33:06.015010: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 14:33:06.021369: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 14:33:06.026250: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 14:33:06.029314: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:33:06.031479: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 14:33:06.033402: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 14:33:06.045272: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x20133b2cd00 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 14:33:06.048525: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 14:33:06.050607: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 14:33:06.055069: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 14:33:06.057393: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:33:06.059622: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:33:06.061843: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 14:33:06.064196: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 14:33:06.066457: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 14:33:06.068721: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 14:33:06.070974: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:33:06.073250: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 14:33:06.498351: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 14:33:06.501534: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 14:33:06.503003: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 14:33:06.504758: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 14:33:06.511591: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x20162a914e0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 14:33:06.514418: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 14:33:08.513339: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 14:33:09.210006: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:33:09.869477: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:33:09.875948: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:33:11.223063: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 14:33:11.269761: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 14:33:11.994274: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 5s 47ms/step
[INFOR]: Index of most vote   :335
[INFOR]: Class of most vote   :fox squirrel, eastern fox squirrel, Sciurus niger
[INFOR]: Number of most vote  :62.0


[INFOR]: Index of second most vote     :149
[INFOR]: Class of second most vote     :dugong, Dugong dugon
[INFOR]: Number of second most vote    :25.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 2s 31ms/step
[INFOR]: Toltal norm before transform: 0.8631
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.2917

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 1s 31ms/step
[INFOR]: SEN training of class 50_500 before transform: 62
[INFOR]: SPE training of class 50_500 before transform: 487

[INFOR]: SEN training of class 50_500 after transform: 359
[INFOR]: SPE training of class 50_500 after transform: 329
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 31ms/step
[INFOR]: Index of most vote   :335
[INFOR]: Class of most vote   :fox squirrel, eastern fox squirrel, Sciurus niger
[INFOR]: Number of most vote  :12.0


[INFOR]: Index of second most vote     :713
[INFOR]: Class of second most vote     :photocopier
[INFOR]: Number of second most vote    :7.0
[INFOR]: SEN testing of class 50_100 before transform: 12
[INFOR]: SPE testing of class 50_100 before transform: 98

[INFOR]: SEN testing of class 50_100 after transform: 90
[INFOR]: SPE testing of class 50_100 after transform: 7
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name cifar_100 --class_name_train 51_500 --class_name_test 51_100
2021-09-08 14:33:20.237783: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  cifar_100
class_name_train =  51_500
class_name_test =  51_100
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 14:33:22.844929: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 14:33:22.873083: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 14:33:22.878645: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 14:33:22.886909: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:33:22.889202: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:33:22.894592: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 14:33:22.898056: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 14:33:22.904542: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 14:33:22.909506: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 14:33:22.912510: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:33:22.914847: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 14:33:22.916836: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 14:33:22.929177: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x2a837b7a110 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 14:33:22.932571: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 14:33:22.934734: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 14:33:22.939673: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 14:33:22.942103: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:33:22.944622: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:33:22.947207: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 14:33:22.949760: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 14:33:22.952235: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 14:33:22.954748: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 14:33:22.957201: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:33:22.959584: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 14:33:23.380307: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 14:33:23.383143: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 14:33:23.384614: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 14:33:23.386311: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 14:33:23.393098: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x2a867729500 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 14:33:23.396053: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 14:33:25.390631: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 14:33:26.100090: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:33:26.755103: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:33:26.762078: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:33:28.150176: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 14:33:28.199269: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 14:33:28.988817: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 5s 47ms/step
[INFOR]: Index of most vote   :995
[INFOR]: Class of most vote   :earthstar
[INFOR]: Number of most vote  :36.0


[INFOR]: Index of second most vote     :995
[INFOR]: Class of second most vote     :earthstar
[INFOR]: Number of second most vote    :36.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 2s 32ms/step
[INFOR]: Toltal norm before transform: 0.9105
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.3679

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 1s 31ms/step
[INFOR]: SEN training of class 51_500 before transform: 36
[INFOR]: SPE training of class 51_500 before transform: 500

[INFOR]: SEN training of class 51_500 after transform: 399
[INFOR]: SPE training of class 51_500 after transform: 352
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 32ms/step
[INFOR]: Index of most vote   :946
[INFOR]: Class of most vote   :cardoon
[INFOR]: Number of most vote  :7.0


[INFOR]: Index of second most vote     :995
[INFOR]: Class of second most vote     :earthstar
[INFOR]: Number of second most vote    :7.0
[INFOR]: SEN testing of class 51_100 before transform: 7
[INFOR]: SPE testing of class 51_100 before transform: 100

[INFOR]: SEN testing of class 51_100 after transform: 92
[INFOR]: SPE testing of class 51_100 after transform: 12
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name cifar_100 --class_name_train 52_500 --class_name_test 52_100
2021-09-08 14:33:37.275135: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  cifar_100
class_name_train =  52_500
class_name_test =  52_100
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 14:33:39.877177: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 14:33:39.902686: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 14:33:39.907534: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 14:33:39.915679: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:33:39.917931: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:33:39.923260: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 14:33:39.927415: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 14:33:39.934622: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 14:33:39.940114: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 14:33:39.943307: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:33:39.945830: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 14:33:39.948106: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 14:33:39.961123: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x154b37dbff0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 14:33:39.964259: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 14:33:39.966516: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 14:33:39.971151: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 14:33:39.973437: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:33:39.975802: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:33:39.978139: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 14:33:39.980420: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 14:33:39.982727: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 14:33:39.985178: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 14:33:39.987465: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:33:39.989706: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 14:33:40.424846: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 14:33:40.428565: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 14:33:40.430140: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 14:33:40.431796: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 14:33:40.439151: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x154e2fdc9e0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 14:33:40.442122: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 14:33:42.457182: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 14:33:43.163948: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:33:43.820008: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:33:43.827134: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:33:45.192001: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 14:33:45.239822: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 14:33:45.964004: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 5s 48ms/step
[INFOR]: Index of most vote   :252
[INFOR]: Class of most vote   :affenpinscher, monkey pinscher, monkey dog
[INFOR]: Number of most vote  :113.0


[INFOR]: Index of second most vote     :974
[INFOR]: Class of second most vote     :geyser
[INFOR]: Number of second most vote    :104.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 2s 32ms/step
[INFOR]: Toltal norm before transform: 0.7688
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0157

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 1s 33ms/step
[INFOR]: SEN training of class 52_500 before transform: 113
[INFOR]: SPE training of class 52_500 before transform: 491

[INFOR]: SEN training of class 52_500 after transform: 497
[INFOR]: SPE training of class 52_500 after transform: 399
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 32ms/step
[INFOR]: Index of most vote   :975
[INFOR]: Class of most vote   :lakeside, lakeshore
[INFOR]: Number of most vote  :19.0


[INFOR]: Index of second most vote     :252
[INFOR]: Class of second most vote     :affenpinscher, monkey pinscher, monkey dog
[INFOR]: Number of second most vote    :17.0
[INFOR]: SEN testing of class 52_100 before transform: 19
[INFOR]: SPE testing of class 52_100 before transform: 100

[INFOR]: SEN testing of class 52_100 after transform: 97
[INFOR]: SPE testing of class 52_100 after transform: 50
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name cifar_100 --class_name_train 53_500 --class_name_test 53_100
2021-09-08 14:33:54.330228: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  cifar_100
class_name_train =  53_500
class_name_test =  53_100
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 14:33:57.043109: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 14:33:57.070396: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 14:33:57.074995: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 14:33:57.083279: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:33:57.085619: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:33:57.091036: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 14:33:57.095153: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 14:33:57.102259: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 14:33:57.107440: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 14:33:57.110523: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:33:57.112814: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 14:33:57.114807: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 14:33:57.127266: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x225339d1a10 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 14:33:57.130735: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 14:33:57.132941: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 14:33:57.137555: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 14:33:57.139802: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:33:57.142138: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:33:57.144458: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 14:33:57.146687: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 14:33:57.149164: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 14:33:57.151505: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 14:33:57.153844: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:33:57.156329: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 14:33:57.609806: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 14:33:57.612289: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 14:33:57.614134: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 14:33:57.616094: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 14:33:57.623282: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x2255c9088d0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 14:33:57.626235: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 14:33:59.731172: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 14:34:00.471917: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:34:01.179109: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:34:01.187044: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:34:02.571527: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 14:34:02.621360: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 14:34:03.365502: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 5s 48ms/step
[INFOR]: Index of most vote   :722
[INFOR]: Class of most vote   :ping-pong ball
[INFOR]: Number of most vote  :114.0


[INFOR]: Index of second most vote     :522
[INFOR]: Class of second most vote     :croquet ball
[INFOR]: Number of second most vote    :78.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 2s 32ms/step
[INFOR]: Toltal norm before transform: 0.7594
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.2418

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 1s 32ms/step
[INFOR]: SEN training of class 53_500 before transform: 114
[INFOR]: SPE training of class 53_500 before transform: 500

[INFOR]: SEN training of class 53_500 after transform: 480
[INFOR]: SPE training of class 53_500 after transform: 377
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 32ms/step
[INFOR]: Index of most vote   :722
[INFOR]: Class of most vote   :ping-pong ball
[INFOR]: Number of most vote  :22.0


[INFOR]: Index of second most vote     :522
[INFOR]: Class of second most vote     :croquet ball
[INFOR]: Number of second most vote    :15.0
[INFOR]: SEN testing of class 53_100 before transform: 22
[INFOR]: SPE testing of class 53_100 before transform: 100

[INFOR]: SEN testing of class 53_100 after transform: 98
[INFOR]: SPE testing of class 53_100 after transform: 27
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name cifar_100 --class_name_train 54_500 --class_name_test 54_100
2021-09-08 14:34:11.820027: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  cifar_100
class_name_train =  54_500
class_name_test =  54_100
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 14:34:14.547498: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 14:34:14.571703: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 14:34:14.576444: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 14:34:14.584456: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:34:14.586652: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:34:14.591984: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 14:34:14.595391: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 14:34:14.601727: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 14:34:14.606702: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 14:34:14.609888: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:34:14.612179: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 14:34:14.615023: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 14:34:14.627913: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1fb3994eaf0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 14:34:14.631034: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 14:34:14.633375: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 14:34:14.638026: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 14:34:14.640379: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:34:14.642661: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:34:14.645272: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 14:34:14.647505: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 14:34:14.650086: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 14:34:14.652565: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 14:34:14.654899: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:34:14.657114: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 14:34:15.084124: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 14:34:15.086524: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 14:34:15.088221: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 14:34:15.089874: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 14:34:15.096940: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1fb65f932f0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 14:34:15.099878: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 14:34:17.124137: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 14:34:17.831481: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:34:18.493087: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:34:18.499074: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:34:19.857912: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 14:34:19.909743: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 14:34:20.661419: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 5s 49ms/step
[INFOR]: Index of most vote   :723
[INFOR]: Class of most vote   :pinwheel
[INFOR]: Number of most vote  :67.0


[INFOR]: Index of second most vote     :584
[INFOR]: Class of second most vote     :hair slide
[INFOR]: Number of second most vote    :35.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 2s 32ms/step
[INFOR]: Toltal norm before transform: 0.8547
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1082

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 1s 32ms/step
[INFOR]: SEN training of class 54_500 before transform: 67
[INFOR]: SPE training of class 54_500 before transform: 495

[INFOR]: SEN training of class 54_500 after transform: 429
[INFOR]: SPE training of class 54_500 after transform: 374
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 32ms/step
[INFOR]: Index of most vote   :723
[INFOR]: Class of most vote   :pinwheel
[INFOR]: Number of most vote  :13.0


[INFOR]: Index of second most vote     :584
[INFOR]: Class of second most vote     :hair slide
[INFOR]: Number of second most vote    :9.0
[INFOR]: SEN testing of class 54_100 before transform: 13
[INFOR]: SPE testing of class 54_100 before transform: 99

[INFOR]: SEN testing of class 54_100 after transform: 93
[INFOR]: SPE testing of class 54_100 after transform: 12
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name cifar_100 --class_name_train 55_500 --class_name_test 55_100
2021-09-08 14:34:29.033610: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  cifar_100
class_name_train =  55_500
class_name_test =  55_100
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 14:34:31.628505: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 14:34:31.652139: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 14:34:31.657308: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 14:34:31.665421: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:34:31.667767: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:34:31.673098: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 14:34:31.676643: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 14:34:31.683152: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 14:34:31.688153: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 14:34:31.691128: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:34:31.693498: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 14:34:31.695401: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 14:34:31.707289: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x2be3b4574d0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 14:34:31.710529: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 14:34:31.712626: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 14:34:31.717078: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 14:34:31.719461: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:34:31.721639: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:34:31.723876: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 14:34:31.726150: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 14:34:31.728440: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 14:34:31.730636: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 14:34:31.732938: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:34:31.735096: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 14:34:32.154573: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 14:34:32.157471: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 14:34:32.158930: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 14:34:32.160488: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 14:34:32.167270: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x2be65fad0f0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 14:34:32.170172: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 14:34:34.152099: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 14:34:34.854860: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:34:35.519633: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:34:35.526475: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:34:36.872223: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 14:34:36.921091: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 14:34:37.638246: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 5s 47ms/step
[INFOR]: Index of most vote   :103
[INFOR]: Class of most vote   :platypus, duckbill, duckbilled platypus, duck-billed platypus, Ornithorhynchus anatinus
[INFOR]: Number of most vote  :57.0


[INFOR]: Index of second most vote     :334
[INFOR]: Class of second most vote     :porcupine, hedgehog
[INFOR]: Number of second most vote    :34.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 2s 31ms/step
[INFOR]: Toltal norm before transform: 0.8833
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0064

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 1s 31ms/step
[INFOR]: SEN training of class 55_500 before transform: 57
[INFOR]: SPE training of class 55_500 before transform: 494

[INFOR]: SEN training of class 55_500 after transform: 361
[INFOR]: SPE training of class 55_500 after transform: 307
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 32ms/step
[INFOR]: Index of most vote   :103
[INFOR]: Class of most vote   :platypus, duckbill, duckbilled platypus, duck-billed platypus, Ornithorhynchus anatinus
[INFOR]: Number of most vote  :8.0


[INFOR]: Index of second most vote     :359
[INFOR]: Class of second most vote     :black-footed ferret, ferret, Mustela nigripes
[INFOR]: Number of second most vote    :7.0
[INFOR]: SEN testing of class 55_100 before transform: 8
[INFOR]: SPE testing of class 55_100 before transform: 99

[INFOR]: SEN testing of class 55_100 after transform: 77
[INFOR]: SPE testing of class 55_100 after transform: 19
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name cifar_100 --class_name_train 56_500 --class_name_test 56_100
2021-09-08 14:34:45.894965: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  cifar_100
class_name_train =  56_500
class_name_test =  56_100
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 14:34:48.531089: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 14:34:48.555134: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 14:34:48.559822: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 14:34:48.567958: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:34:48.570394: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:34:48.575925: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 14:34:48.579489: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 14:34:48.585926: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 14:34:48.590861: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 14:34:48.593957: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:34:48.596166: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 14:34:48.598200: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 14:34:48.610169: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x29cb410e610 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 14:34:48.613335: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 14:34:48.615510: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 14:34:48.620094: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 14:34:48.622391: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:34:48.624598: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:34:48.626975: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 14:34:48.629218: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 14:34:48.631482: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 14:34:48.633729: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 14:34:48.635992: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:34:48.638300: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 14:34:49.062883: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 14:34:49.065770: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 14:34:49.067256: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 14:34:49.068906: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 14:34:49.075820: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x29ce3730f70 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 14:34:49.078772: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 14:34:51.088470: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 14:34:51.801147: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:34:52.467642: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:34:52.473861: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:34:53.825735: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 14:34:53.875602: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 14:34:54.605957: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 5s 48ms/step
[INFOR]: Index of most vote   :946
[INFOR]: Class of most vote   :cardoon
[INFOR]: Number of most vote  :75.0


[INFOR]: Index of second most vote     :73
[INFOR]: Class of second most vote     :barn spider, Araneus cavaticus
[INFOR]: Number of second most vote    :28.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 2s 32ms/step
[INFOR]: Toltal norm before transform: 0.8179
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.2017

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 1s 32ms/step
[INFOR]: SEN training of class 56_500 before transform: 75
[INFOR]: SPE training of class 56_500 before transform: 494

[INFOR]: SEN training of class 56_500 after transform: 433
[INFOR]: SPE training of class 56_500 after transform: 368
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 32ms/step
[INFOR]: Index of most vote   :946
[INFOR]: Class of most vote   :cardoon
[INFOR]: Number of most vote  :14.0


[INFOR]: Index of second most vote     :252
[INFOR]: Class of second most vote     :affenpinscher, monkey pinscher, monkey dog
[INFOR]: Number of second most vote    :7.0
[INFOR]: SEN testing of class 56_100 before transform: 14
[INFOR]: SPE testing of class 56_100 before transform: 98

[INFOR]: SEN testing of class 56_100 after transform: 100
[INFOR]: SPE testing of class 56_100 after transform: 6
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name cifar_100 --class_name_train 57_500 --class_name_test 57_100
2021-09-08 14:35:02.976930: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  cifar_100
class_name_train =  57_500
class_name_test =  57_100
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 14:35:05.586749: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 14:35:05.613159: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 14:35:05.618385: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 14:35:05.626537: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:35:05.628736: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:35:05.639865: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 14:35:05.643647: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 14:35:05.650126: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 14:35:05.655414: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 14:35:05.658687: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:35:05.660904: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 14:35:05.662959: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 14:35:05.675446: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x15bbafb54a0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 14:35:05.678831: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 14:35:05.680999: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 14:35:05.685747: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 14:35:05.688006: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:35:05.690375: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:35:05.692648: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 14:35:05.694960: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 14:35:05.697262: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 14:35:05.699575: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 14:35:05.701929: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:35:05.704244: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 14:35:06.135932: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 14:35:06.138789: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 14:35:06.140250: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 14:35:06.141807: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 14:35:06.148710: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x15be5d1e2c0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 14:35:06.151669: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 14:35:08.146978: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 14:35:08.858330: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:35:09.515020: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:35:09.521493: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:35:10.878130: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 14:35:10.926822: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 14:35:11.734964: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 5s 48ms/step
[INFOR]: Index of most vote   :680
[INFOR]: Class of most vote   :nipple
[INFOR]: Number of most vote  :81.0


[INFOR]: Index of second most vote     :641
[INFOR]: Class of second most vote     :maraca
[INFOR]: Number of second most vote    :51.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 2s 32ms/step
[INFOR]: Toltal norm before transform: 0.7918
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0525

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 1s 31ms/step
[INFOR]: SEN training of class 57_500 before transform: 81
[INFOR]: SPE training of class 57_500 before transform: 493

[INFOR]: SEN training of class 57_500 after transform: 387
[INFOR]: SPE training of class 57_500 after transform: 317
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 32ms/step
[INFOR]: Index of most vote   :680
[INFOR]: Class of most vote   :nipple
[INFOR]: Number of most vote  :15.0


[INFOR]: Index of second most vote     :641
[INFOR]: Class of second most vote     :maraca
[INFOR]: Number of second most vote    :12.0
[INFOR]: SEN testing of class 57_100 before transform: 15
[INFOR]: SPE testing of class 57_100 before transform: 98

[INFOR]: SEN testing of class 57_100 after transform: 71
[INFOR]: SPE testing of class 57_100 after transform: 33
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name cifar_100 --class_name_train 58_500 --class_name_test 58_100
2021-09-08 14:35:20.033474: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  cifar_100
class_name_train =  58_500
class_name_test =  58_100
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 14:35:22.566504: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 14:35:22.591164: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 14:35:22.596361: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 14:35:22.604471: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:35:22.606675: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:35:22.612012: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 14:35:22.615961: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 14:35:22.622605: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 14:35:22.627742: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 14:35:22.630863: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:35:22.633208: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 14:35:22.635299: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 14:35:22.648310: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1a833879950 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 14:35:22.652036: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 14:35:22.654234: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 14:35:22.658845: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 14:35:22.661252: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:35:22.663798: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:35:22.666035: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 14:35:22.668299: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 14:35:22.670564: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 14:35:22.672919: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 14:35:22.675271: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:35:22.677472: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 14:35:23.109057: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 14:35:23.111918: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 14:35:23.113434: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 14:35:23.115064: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 14:35:23.122021: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1a85e94d080 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 14:35:23.124887: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 14:35:25.117334: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 14:35:25.825557: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:35:26.490001: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:35:26.496761: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:35:27.873229: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 14:35:27.920674: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 14:35:28.644900: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 5s 47ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :228.0


[INFOR]: Index of second most vote     :408
[INFOR]: Class of second most vote     :amphibian, amphibious vehicle
[INFOR]: Number of second most vote    :112.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 2s 33ms/step
[INFOR]: Toltal norm before transform: 0.4833
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0739

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 1s 33ms/step
[INFOR]: SEN training of class 58_500 before transform: 228
[INFOR]: SPE training of class 58_500 before transform: 480

[INFOR]: SEN training of class 58_500 after transform: 462
[INFOR]: SPE training of class 58_500 after transform: 381
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 32ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :51.0


[INFOR]: Index of second most vote     :408
[INFOR]: Class of second most vote     :amphibian, amphibious vehicle
[INFOR]: Number of second most vote    :18.0
[INFOR]: SEN testing of class 58_100 before transform: 51
[INFOR]: SPE testing of class 58_100 before transform: 94

[INFOR]: SEN testing of class 58_100 after transform: 86
[INFOR]: SPE testing of class 58_100 after transform: 5
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name cifar_100 --class_name_train 59_500 --class_name_test 59_1005
2021-09-08 14:35:37.095561: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  cifar_100
class_name_train =  59_500
class_name_test =  59_1005
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 14:35:39.711822: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 14:35:39.740176: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 14:35:39.744928: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 14:35:39.752952: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:35:39.755057: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:35:39.760434: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 14:35:39.763828: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 14:35:39.770319: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 14:35:39.775495: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 14:35:39.778586: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:35:39.780807: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 14:35:39.782824: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 14:35:39.796228: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x234b42865b0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 14:35:39.799548: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 14:35:39.801731: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 14:35:39.806477: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 14:35:39.808807: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:35:39.811170: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:35:39.813454: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 14:35:39.815722: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 14:35:39.818016: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 14:35:39.820314: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 14:35:39.822666: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:35:39.824891: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 14:35:40.248390: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 14:35:40.251463: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 14:35:40.253003: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 14:35:40.255214: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 14:35:40.262199: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x234dfe84590 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 14:35:40.265077: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 14:35:42.250684: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 14:35:42.957796: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:35:43.609964: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:35:43.616609: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:35:45.017512: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 14:35:45.072570: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 14:35:45.794873: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 5s 48ms/step
[INFOR]: Index of most vote   :252
[INFOR]: Class of most vote   :affenpinscher, monkey pinscher, monkey dog
[INFOR]: Number of most vote  :75.0


[INFOR]: Index of second most vote     :974
[INFOR]: Class of second most vote     :geyser
[INFOR]: Number of second most vote    :35.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 2s 32ms/step
[INFOR]: Toltal norm before transform: 0.8378
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0086

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 1s 33ms/step
[INFOR]: SEN training of class 59_500 before transform: 75
[INFOR]: SPE training of class 59_500 before transform: 495

[INFOR]: SEN training of class 59_500 after transform: 437
[INFOR]: SPE training of class 59_500 after transform: 377
[INFOR]

==================== TESTING STAGE ====================


Traceback (most recent call last):
  File "main.py", line 252, in <module>
    main(FLAGS)
  File "main.py", line 113, in main
    x_test, y_test = get_data(FLAGS.dataset_name, 'test', FLAGS.class_name_test)
  File "C:\Users\LauNT\Desktop\topology\generate\utils.py", line 59, in get_data
    else: raise ValueError('[ERROR]: path to data not found')
ValueError: [ERROR]: path to data not found

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name cifar_100 --class_name_train 60_500 --class_name_test 60_100
2021-09-08 14:35:53.684183: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  cifar_100
class_name_train =  60_500
class_name_test =  60_100
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 14:35:56.355956: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 14:35:56.380141: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 14:35:56.385405: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 14:35:56.393571: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:35:56.395844: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:35:56.401219: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 14:35:56.404837: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 14:35:56.411363: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 14:35:56.416470: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 14:35:56.419492: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:35:56.421683: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 14:35:56.423621: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 14:35:56.436292: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x18bb528f210 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 14:35:56.439289: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 14:35:56.441639: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 14:35:56.446398: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 14:35:56.448881: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:35:56.451134: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:35:56.453410: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 14:35:56.455609: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 14:35:56.457881: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 14:35:56.460241: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 14:35:56.462515: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:35:56.464861: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 14:35:56.895439: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 14:35:56.898233: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 14:35:56.899752: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 14:35:56.901338: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 14:35:56.908543: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x18bdd937880 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 14:35:56.912168: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 14:35:58.918493: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 14:35:59.623357: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:36:00.278162: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:36:00.284450: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:36:01.632265: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 14:36:01.679853: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 14:36:02.403434: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 5s 49ms/step
[INFOR]: Index of most vote   :147
[INFOR]: Class of most vote   :grey whale, gray whale, devilfish, Eschrichtius gibbosus, Eschrichtius robustus
[INFOR]: Number of most vote  :95.0


[INFOR]: Index of second most vote     :781
[INFOR]: Class of second most vote     :scoreboard
[INFOR]: Number of second most vote    :36.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 2s 32ms/step
[INFOR]: Toltal norm before transform: 0.7862
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.2472

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 1s 32ms/step
[INFOR]: SEN training of class 60_500 before transform: 95
[INFOR]: SPE training of class 60_500 before transform: 490

[INFOR]: SEN training of class 60_500 after transform: 466
[INFOR]: SPE training of class 60_500 after transform: 397
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 32ms/step
[INFOR]: Index of most vote   :147
[INFOR]: Class of most vote   :grey whale, gray whale, devilfish, Eschrichtius gibbosus, Eschrichtius robustus
[INFOR]: Number of most vote  :14.0


[INFOR]: Index of second most vote     :781
[INFOR]: Class of second most vote     :scoreboard
[INFOR]: Number of second most vote    :9.0
[INFOR]: SEN testing of class 60_100 before transform: 14
[INFOR]: SPE testing of class 60_100 before transform: 100

[INFOR]: SEN testing of class 60_100 after transform: 95
[INFOR]: SPE testing of class 60_100 after transform: 43
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name cifar_100 --class_name_train 61_500 --class_name_test 61_100
2021-09-08 14:36:10.823338: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  cifar_100
class_name_train =  61_500
class_name_test =  61_100
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 14:36:13.410252: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 14:36:13.436656: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 14:36:13.441701: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 14:36:13.450424: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:36:13.452584: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:36:13.457744: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 14:36:13.461230: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 14:36:13.467879: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 14:36:13.472861: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 14:36:13.476124: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:36:13.478265: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 14:36:13.480439: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 14:36:13.493102: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x22f371af920 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 14:36:13.496516: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 14:36:13.498619: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 14:36:13.503221: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 14:36:13.505457: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:36:13.507740: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:36:13.510011: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 14:36:13.512198: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 14:36:13.514510: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 14:36:13.516798: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 14:36:13.519051: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:36:13.521352: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 14:36:13.952579: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 14:36:13.955437: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 14:36:13.957091: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 14:36:13.958826: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 14:36:13.966264: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x22f600e1790 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 14:36:13.969824: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 14:36:15.967657: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 14:36:16.664860: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:36:17.316655: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:36:17.322830: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:36:18.706907: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 14:36:18.757576: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 14:36:19.533172: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 5s 48ms/step
[INFOR]: Index of most vote   :680
[INFOR]: Class of most vote   :nipple
[INFOR]: Number of most vote  :68.0


[INFOR]: Index of second most vote     :551
[INFOR]: Class of second most vote     :face powder
[INFOR]: Number of second most vote    :42.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 2s 32ms/step
[INFOR]: Toltal norm before transform: 0.8697
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1521

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 1s 33ms/step
[INFOR]: SEN training of class 61_500 before transform: 68
[INFOR]: SPE training of class 61_500 before transform: 487

[INFOR]: SEN training of class 61_500 after transform: 451
[INFOR]: SPE training of class 61_500 after transform: 347
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 32ms/step
[INFOR]: Index of most vote   :729
[INFOR]: Class of most vote   :plate rack
[INFOR]: Number of most vote  :12.0


[INFOR]: Index of second most vote     :635
[INFOR]: Class of second most vote     :magnetic compass
[INFOR]: Number of second most vote    :11.0
[INFOR]: SEN testing of class 61_100 before transform: 12
[INFOR]: SPE testing of class 61_100 before transform: 100

[INFOR]: SEN testing of class 61_100 after transform: 100
[INFOR]: SPE testing of class 61_100 after transform: 1
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name cifar_100 --class_name_train 62_500 --class_name_test 62_100
2021-09-08 14:36:27.951460: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  cifar_100
class_name_train =  62_500
class_name_test =  62_100
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 14:36:30.540785: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 14:36:30.567080: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 14:36:30.571818: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 14:36:30.579763: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:36:30.581966: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:36:30.587239: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 14:36:30.590667: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 14:36:30.596849: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 14:36:30.601837: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 14:36:30.604825: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:36:30.607023: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 14:36:30.608992: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 14:36:30.621625: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1b23aa34a30 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 14:36:30.624967: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 14:36:30.627140: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 14:36:30.631800: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 14:36:30.634077: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:36:30.636314: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:36:30.638624: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 14:36:30.640819: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 14:36:30.643100: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 14:36:30.645648: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 14:36:30.647905: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:36:30.650121: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 14:36:31.072407: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 14:36:31.075193: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 14:36:31.076724: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 14:36:31.078270: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 14:36:31.084865: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1b2646dc860 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 14:36:31.087727: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 14:36:33.056678: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 14:36:33.746610: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:36:34.405911: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:36:34.412214: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:36:35.762544: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 14:36:35.811932: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 14:36:36.533689: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 5s 47ms/step
[INFOR]: Index of most vote   :392
[INFOR]: Class of most vote   :rock beauty, Holocanthus tricolor
[INFOR]: Number of most vote  :120.0


[INFOR]: Index of second most vote     :722
[INFOR]: Class of second most vote     :ping-pong ball
[INFOR]: Number of second most vote    :54.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 2s 31ms/step
[INFOR]: Toltal norm before transform: 0.7244
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0471

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 1s 32ms/step
[INFOR]: SEN training of class 62_500 before transform: 120
[INFOR]: SPE training of class 62_500 before transform: 484

[INFOR]: SEN training of class 62_500 after transform: 428
[INFOR]: SPE training of class 62_500 after transform: 346
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 31ms/step
[INFOR]: Index of most vote   :392
[INFOR]: Class of most vote   :rock beauty, Holocanthus tricolor
[INFOR]: Number of most vote  :24.0


[INFOR]: Index of second most vote     :713
[INFOR]: Class of second most vote     :photocopier
[INFOR]: Number of second most vote    :9.0
[INFOR]: SEN testing of class 62_100 before transform: 24
[INFOR]: SPE testing of class 62_100 before transform: 98

[INFOR]: SEN testing of class 62_100 after transform: 93
[INFOR]: SPE testing of class 62_100 after transform: 28
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name cifar_100 --class_name_train 63_500 --class_name_test 63_100
2021-09-08 14:36:44.836179: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  cifar_100
class_name_train =  63_500
class_name_test =  63_100
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 14:36:47.492101: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 14:36:47.520369: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 14:36:47.524944: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 14:36:47.533102: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:36:47.535302: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:36:47.540608: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 14:36:47.544108: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 14:36:47.550411: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 14:36:47.555491: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 14:36:47.558503: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:36:47.560704: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 14:36:47.562676: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 14:36:47.575038: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x28d39f974a0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 14:36:47.578104: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 14:36:47.580293: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 14:36:47.584769: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 14:36:47.587010: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:36:47.589241: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:36:47.591507: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 14:36:47.593851: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 14:36:47.596079: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 14:36:47.598362: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 14:36:47.600819: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:36:47.603138: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 14:36:48.029091: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 14:36:48.031458: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 14:36:48.033102: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 14:36:48.034691: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 14:36:48.041583: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x28d6531f660 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 14:36:48.044533: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 14:36:50.027813: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 14:36:50.726800: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:36:51.379902: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:36:51.386359: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:36:52.736742: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 14:36:52.786390: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 14:36:53.507164: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 5s 48ms/step
[INFOR]: Index of most vote   :335
[INFOR]: Class of most vote   :fox squirrel, eastern fox squirrel, Sciurus niger
[INFOR]: Number of most vote  :95.0


[INFOR]: Index of second most vote     :357
[INFOR]: Class of second most vote     :mink
[INFOR]: Number of second most vote    :29.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 2s 32ms/step
[INFOR]: Toltal norm before transform: 0.7671
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1230

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 1s 32ms/step
[INFOR]: SEN training of class 63_500 before transform: 95
[INFOR]: SPE training of class 63_500 before transform: 481

[INFOR]: SEN training of class 63_500 after transform: 428
[INFOR]: SPE training of class 63_500 after transform: 324
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 32ms/step
[INFOR]: Index of most vote   :335
[INFOR]: Class of most vote   :fox squirrel, eastern fox squirrel, Sciurus niger
[INFOR]: Number of most vote  :18.0


[INFOR]: Index of second most vote     :103
[INFOR]: Class of second most vote     :platypus, duckbill, duckbilled platypus, duck-billed platypus, Ornithorhynchus anatinus
[INFOR]: Number of second most vote    :7.0
[INFOR]: SEN testing of class 63_100 before transform: 18
[INFOR]: SPE testing of class 63_100 before transform: 96

[INFOR]: SEN testing of class 63_100 after transform: 97
[INFOR]: SPE testing of class 63_100 after transform: 1
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name cifar_100 --class_name_train 64_500 --class_name_test 64_100
2021-09-08 14:37:01.791687: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  cifar_100
class_name_train =  64_500
class_name_test =  64_100
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 14:37:04.346307: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 14:37:04.370639: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 14:37:04.375526: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 14:37:04.383752: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:37:04.386107: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:37:04.391423: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 14:37:04.394910: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 14:37:04.401589: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 14:37:04.406461: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 14:37:04.409446: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:37:04.411634: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 14:37:04.413596: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 14:37:04.425725: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x201b513cc40 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 14:37:04.428825: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 14:37:04.430904: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 14:37:04.435298: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 14:37:04.437614: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:37:04.439813: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:37:04.442079: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 14:37:04.444394: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 14:37:04.446690: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 14:37:04.448981: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 14:37:04.451447: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:37:04.453629: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 14:37:04.879467: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 14:37:04.882093: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 14:37:04.883659: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 14:37:04.885207: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 14:37:04.892023: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x201e3c172f0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 14:37:04.894912: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 14:37:06.884007: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 14:37:07.565352: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:37:08.230378: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:37:08.237105: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:37:09.589840: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 14:37:09.640122: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 14:37:10.359004: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 5s 47ms/step
[INFOR]: Index of most vote   :358
[INFOR]: Class of most vote   :polecat, fitch, foulmart, foumart, Mustela putorius
[INFOR]: Number of most vote  :45.0


[INFOR]: Index of second most vote     :335
[INFOR]: Class of second most vote     :fox squirrel, eastern fox squirrel, Sciurus niger
[INFOR]: Number of second most vote    :31.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 2s 31ms/step
[INFOR]: Toltal norm before transform: 0.8860
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0738

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 1s 33ms/step
[INFOR]: SEN training of class 64_500 before transform: 45
[INFOR]: SPE training of class 64_500 before transform: 497

[INFOR]: SEN training of class 64_500 after transform: 380
[INFOR]: SPE training of class 64_500 after transform: 324
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 32ms/step
[INFOR]: Index of most vote   :335
[INFOR]: Class of most vote   :fox squirrel, eastern fox squirrel, Sciurus niger
[INFOR]: Number of most vote  :9.0


[INFOR]: Index of second most vote     :357
[INFOR]: Class of second most vote     :mink
[INFOR]: Number of second most vote    :8.0
[INFOR]: SEN testing of class 64_100 before transform: 9
[INFOR]: SPE testing of class 64_100 before transform: 99

[INFOR]: SEN testing of class 64_100 after transform: 84
[INFOR]: SPE testing of class 64_100 after transform: 7
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name cifar_100 --class_name_train 65_500 --class_name_test 65_100
2021-09-08 14:37:18.680630: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  cifar_100
class_name_train =  65_500
class_name_test =  65_100
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 14:37:21.319333: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 14:37:21.342812: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 14:37:21.347752: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 14:37:21.355843: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:37:21.358140: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:37:21.363372: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 14:37:21.366857: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 14:37:21.373290: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 14:37:21.378341: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 14:37:21.381333: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:37:21.383501: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 14:37:21.385504: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 14:37:21.398157: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x259395a6330 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 14:37:21.401269: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 14:37:21.403399: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 14:37:21.407814: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 14:37:21.410052: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:37:21.412249: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:37:21.414520: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 14:37:21.416711: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 14:37:21.419001: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 14:37:21.421232: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 14:37:21.423494: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:37:21.425890: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 14:37:21.852417: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 14:37:21.855151: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 14:37:21.856625: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 14:37:21.858428: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 14:37:21.865026: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x25968c8a5f0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 14:37:21.868037: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 14:37:23.841202: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 14:37:24.568737: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:37:25.224969: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:37:25.230970: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:37:26.616411: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 14:37:26.665277: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 14:37:27.381484: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 5s 47ms/step
[INFOR]: Index of most vote   :335
[INFOR]: Class of most vote   :fox squirrel, eastern fox squirrel, Sciurus niger
[INFOR]: Number of most vote  :52.0


[INFOR]: Index of second most vote     :330
[INFOR]: Class of second most vote     :wood rabbit, cottontail, cottontail rabbit
[INFOR]: Number of second most vote    :35.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 2s 31ms/step
[INFOR]: Toltal norm before transform: 0.9035
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0122

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 1s 31ms/step
[INFOR]: SEN training of class 65_500 before transform: 52
[INFOR]: SPE training of class 65_500 before transform: 493

[INFOR]: SEN training of class 65_500 after transform: 323
[INFOR]: SPE training of class 65_500 after transform: 319
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 32ms/step
[INFOR]: Index of most vote   :331
[INFOR]: Class of most vote   :hare
[INFOR]: Number of most vote  :10.0


[INFOR]: Index of second most vote     :149
[INFOR]: Class of second most vote     :dugong, Dugong dugon
[INFOR]: Number of second most vote    :8.0
[INFOR]: SEN testing of class 65_100 before transform: 10
[INFOR]: SPE testing of class 65_100 before transform: 100

[INFOR]: SEN testing of class 65_100 after transform: 91
[INFOR]: SPE testing of class 65_100 after transform: 36
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name cifar_100 --class_name_train 66_500 --class_name_test 66_100
2021-09-08 14:37:35.609753: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  cifar_100
class_name_train =  66_500
class_name_test =  66_100
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 14:37:38.201854: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 14:37:38.225929: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 14:37:38.230767: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 14:37:38.238903: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:37:38.241076: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:37:38.246332: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 14:37:38.249720: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 14:37:38.256048: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 14:37:38.261005: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 14:37:38.263960: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:37:38.266129: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 14:37:38.268063: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 14:37:38.280169: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1ee39f98480 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 14:37:38.283327: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 14:37:38.285561: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 14:37:38.289993: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 14:37:38.292325: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:37:38.294528: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:37:38.296792: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 14:37:38.299048: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 14:37:38.301367: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 14:37:38.303629: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 14:37:38.305903: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:37:38.308188: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 14:37:38.734914: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 14:37:38.737662: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 14:37:38.739137: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 14:37:38.740733: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 14:37:38.747769: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1ee67ee6ae0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 14:37:38.750709: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 14:37:40.725976: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 14:37:41.415933: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:37:42.083210: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:37:42.089503: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:37:43.448199: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 14:37:43.497387: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 14:37:44.285814: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 5s 47ms/step
[INFOR]: Index of most vote   :383
[INFOR]: Class of most vote   :Madagascar cat, ring-tailed lemur, Lemur catta
[INFOR]: Number of most vote  :92.0


[INFOR]: Index of second most vote     :371
[INFOR]: Class of second most vote     :patas, hussar monkey, Erythrocebus patas
[INFOR]: Number of second most vote    :35.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 2s 32ms/step
[INFOR]: Toltal norm before transform: 0.7740
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0925

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 1s 32ms/step
[INFOR]: SEN training of class 66_500 before transform: 92
[INFOR]: SPE training of class 66_500 before transform: 497

[INFOR]: SEN training of class 66_500 after transform: 382
[INFOR]: SPE training of class 66_500 after transform: 325
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 32ms/step
[INFOR]: Index of most vote   :383
[INFOR]: Class of most vote   :Madagascar cat, ring-tailed lemur, Lemur catta
[INFOR]: Number of most vote  :16.0


[INFOR]: Index of second most vote     :371
[INFOR]: Class of second most vote     :patas, hussar monkey, Erythrocebus patas
[INFOR]: Number of second most vote    :7.0
[INFOR]: SEN testing of class 66_100 before transform: 16
[INFOR]: SPE testing of class 66_100 before transform: 100

[INFOR]: SEN testing of class 66_100 after transform: 100
[INFOR]: SPE testing of class 66_100 after transform: 0
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name cifar_100 --class_name_train 67_500 --class_name_test 67_100
2021-09-08 14:37:52.545495: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  cifar_100
class_name_train =  67_500
class_name_test =  67_100
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 14:37:55.087497: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 14:37:55.114171: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 14:37:55.119568: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 14:37:55.127585: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:37:55.129703: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:37:55.135002: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 14:37:55.138426: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 14:37:55.144690: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 14:37:55.149682: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 14:37:55.152616: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:37:55.154764: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 14:37:55.156742: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 14:37:55.169461: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1d833cada60 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 14:37:55.172996: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 14:37:55.175152: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 14:37:55.179561: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 14:37:55.181807: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:37:55.183992: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:37:55.186379: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 14:37:55.188554: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 14:37:55.190740: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 14:37:55.193056: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 14:37:55.195452: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:37:55.197707: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 14:37:55.624559: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 14:37:55.627919: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 14:37:55.629504: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 14:37:55.631102: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 14:37:55.637959: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1d85d036ff0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 14:37:55.640924: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 14:37:57.612798: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 14:37:58.292902: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:37:58.954637: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:37:58.961722: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:38:00.316858: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 14:38:00.365873: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 14:38:01.088851: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 5s 47ms/step
[INFOR]: Index of most vote   :392
[INFOR]: Class of most vote   :rock beauty, Holocanthus tricolor
[INFOR]: Number of most vote  :49.0


[INFOR]: Index of second most vote     :5
[INFOR]: Class of second most vote     :electric ray, crampfish, numbfish, torpedo
[INFOR]: Number of second most vote    :37.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 2s 31ms/step
[INFOR]: Toltal norm before transform: 0.9151
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0651

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 1s 31ms/step
[INFOR]: SEN training of class 67_500 before transform: 49
[INFOR]: SPE training of class 67_500 before transform: 486

[INFOR]: SEN training of class 67_500 after transform: 381
[INFOR]: SPE training of class 67_500 after transform: 352
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 32ms/step
[INFOR]: Index of most vote   :392
[INFOR]: Class of most vote   :rock beauty, Holocanthus tricolor
[INFOR]: Number of most vote  :18.0


[INFOR]: Index of second most vote     :149
[INFOR]: Class of second most vote     :dugong, Dugong dugon
[INFOR]: Number of second most vote    :8.0
[INFOR]: SEN testing of class 67_100 before transform: 18
[INFOR]: SPE testing of class 67_100 before transform: 98

[INFOR]: SEN testing of class 67_100 after transform: 100
[INFOR]: SPE testing of class 67_100 after transform: 0
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name cifar_100 --class_name_train 68_500 --class_name_test 68_100
2021-09-08 14:38:09.301279: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  cifar_100
class_name_train =  68_500
class_name_test =  68_100
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 14:38:11.937051: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 14:38:11.963046: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 14:38:11.967618: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 14:38:11.975626: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:38:11.977910: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:38:11.986870: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 14:38:11.991491: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 14:38:11.998206: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 14:38:12.003406: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 14:38:12.006718: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:38:12.009199: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 14:38:12.011442: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 14:38:12.024424: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x2b0baa03060 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 14:38:12.027762: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 14:38:12.029949: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 14:38:12.034425: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 14:38:12.036696: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:38:12.038968: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:38:12.041255: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 14:38:12.043607: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 14:38:12.045974: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 14:38:12.048241: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 14:38:12.050475: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:38:12.052744: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 14:38:12.477296: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 14:38:12.479690: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 14:38:12.481187: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 14:38:12.482797: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 14:38:12.489586: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x2b0e9501090 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 14:38:12.492476: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 14:38:14.494842: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 14:38:15.193319: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:38:15.847938: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:38:15.854027: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:38:17.203904: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 14:38:17.253376: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 14:38:17.973502: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 5s 47ms/step
[INFOR]: Index of most vote   :672
[INFOR]: Class of most vote   :mountain tent
[INFOR]: Number of most vote  :48.0


[INFOR]: Index of second most vote     :604
[INFOR]: Class of second most vote     :hourglass
[INFOR]: Number of second most vote    :34.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 2s 32ms/step
[INFOR]: Toltal norm before transform: 0.8817
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.3324

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 1s 32ms/step
[INFOR]: SEN training of class 68_500 before transform: 48
[INFOR]: SPE training of class 68_500 before transform: 500

[INFOR]: SEN training of class 68_500 after transform: 435
[INFOR]: SPE training of class 68_500 after transform: 354
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 32ms/step
[INFOR]: Index of most vote   :672
[INFOR]: Class of most vote   :mountain tent
[INFOR]: Number of most vote  :12.0


[INFOR]: Index of second most vote     :604
[INFOR]: Class of second most vote     :hourglass
[INFOR]: Number of second most vote    :6.0
[INFOR]: SEN testing of class 68_100 before transform: 12
[INFOR]: SPE testing of class 68_100 before transform: 100

[INFOR]: SEN testing of class 68_100 after transform: 83
[INFOR]: SPE testing of class 68_100 after transform: 10
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name cifar_100 --class_name_train 69_500 --class_name_test 69_100
2021-09-08 14:38:26.243778: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  cifar_100
class_name_train =  69_500
class_name_test =  69_100
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 14:38:28.789224: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 14:38:28.815028: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 14:38:28.820044: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 14:38:28.828032: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:38:28.830196: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:38:28.835483: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 14:38:28.838901: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 14:38:28.845252: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 14:38:28.850318: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 14:38:28.853429: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:38:28.855620: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 14:38:28.857606: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 14:38:28.870390: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1c035133f30 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 14:38:28.874232: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 14:38:28.876389: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 14:38:28.880920: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 14:38:28.883163: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:38:28.885352: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:38:28.887676: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 14:38:28.889991: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 14:38:28.892278: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 14:38:28.894579: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 14:38:28.896837: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:38:28.899119: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 14:38:29.312590: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 14:38:29.315459: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 14:38:29.316956: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 14:38:29.318509: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 14:38:29.325477: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1c0605a4aa0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 14:38:29.328372: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 14:38:31.282812: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 14:38:31.977129: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:38:32.632762: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:38:32.638968: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:38:33.978493: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 14:38:34.028563: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 14:38:34.747174: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 5s 47ms/step
[INFOR]: Index of most vote   :744
[INFOR]: Class of most vote   :projectile, missile
[INFOR]: Number of most vote  :67.0


[INFOR]: Index of second most vote     :811
[INFOR]: Class of second most vote     :space heater
[INFOR]: Number of second most vote    :29.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 2s 32ms/step
[INFOR]: Toltal norm before transform: 0.8651
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1514

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 1s 32ms/step
[INFOR]: SEN training of class 69_500 before transform: 67
[INFOR]: SPE training of class 69_500 before transform: 500

[INFOR]: SEN training of class 69_500 after transform: 415
[INFOR]: SPE training of class 69_500 after transform: 351
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 32ms/step
[INFOR]: Index of most vote   :744
[INFOR]: Class of most vote   :projectile, missile
[INFOR]: Number of most vote  :12.0


[INFOR]: Index of second most vote     :683
[INFOR]: Class of second most vote     :oboe, hautboy, hautbois
[INFOR]: Number of second most vote    :8.0
[INFOR]: SEN testing of class 69_100 before transform: 12
[INFOR]: SPE testing of class 69_100 before transform: 100

[INFOR]: SEN testing of class 69_100 after transform: 90
[INFOR]: SPE testing of class 69_100 after transform: 22
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name cifar_100 --class_name_train 70_500 --class_name_test 70_100
2021-09-08 14:38:42.958275: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  cifar_100
class_name_train =  70_500
class_name_test =  70_100
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 14:38:45.530946: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 14:38:45.554937: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 14:38:45.560011: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 14:38:45.568125: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:38:45.570522: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:38:45.575990: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 14:38:45.579614: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 14:38:45.586364: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 14:38:45.591529: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 14:38:45.594719: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:38:45.597179: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 14:38:45.599302: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 14:38:45.611844: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x26ab4934170 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 14:38:45.615109: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 14:38:45.617416: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 14:38:45.622183: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 14:38:45.624586: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:38:45.626977: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:38:45.629397: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 14:38:45.631778: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 14:38:45.634188: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 14:38:45.636695: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 14:38:45.639110: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:38:45.641485: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 14:38:46.070963: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 14:38:46.074323: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 14:38:46.075780: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 14:38:46.077374: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 14:38:46.084213: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x26adef9cb60 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 14:38:46.087203: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 14:38:48.048838: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 14:38:48.745338: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:38:49.401204: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:38:49.407789: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:38:50.752004: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 14:38:50.799247: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 14:38:51.518771: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 5s 47ms/step
[INFOR]: Index of most vote   :392
[INFOR]: Class of most vote   :rock beauty, Holocanthus tricolor
[INFOR]: Number of most vote  :42.0


[INFOR]: Index of second most vote     :713
[INFOR]: Class of second most vote     :photocopier
[INFOR]: Number of second most vote    :38.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 2s 32ms/step
[INFOR]: Toltal norm before transform: 0.8971
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1549

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 1s 32ms/step
[INFOR]: SEN training of class 70_500 before transform: 42
[INFOR]: SPE training of class 70_500 before transform: 487

[INFOR]: SEN training of class 70_500 after transform: 447
[INFOR]: SPE training of class 70_500 after transform: 361
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 32ms/step
[INFOR]: Index of most vote   :392
[INFOR]: Class of most vote   :rock beauty, Holocanthus tricolor
[INFOR]: Number of most vote  :7.0


[INFOR]: Index of second most vote     :583
[INFOR]: Class of second most vote     :guillotine
[INFOR]: Number of second most vote    :6.0
[INFOR]: SEN testing of class 70_100 before transform: 7
[INFOR]: SPE testing of class 70_100 before transform: 97

[INFOR]: SEN testing of class 70_100 after transform: 91
[INFOR]: SPE testing of class 70_100 after transform: 16
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name cifar_100 --class_name_train 71_500 --class_name_test 71_100
2021-09-08 14:38:59.820963: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  cifar_100
class_name_train =  71_500
class_name_test =  71_100
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 14:39:02.445102: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 14:39:02.471336: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 14:39:02.476344: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 14:39:02.484467: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:39:02.486634: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:39:02.491995: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 14:39:02.495358: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 14:39:02.501677: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 14:39:02.506626: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 14:39:02.509767: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:39:02.511927: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 14:39:02.513982: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 14:39:02.526402: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x13f3a1f2e50 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 14:39:02.529915: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 14:39:02.532051: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 14:39:02.536623: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 14:39:02.538946: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:39:02.541252: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:39:02.543599: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 14:39:02.545839: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 14:39:02.548045: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 14:39:02.550337: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 14:39:02.552661: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:39:02.554857: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 14:39:02.986675: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 14:39:02.989385: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 14:39:02.990860: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 14:39:02.992580: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 14:39:02.999897: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x13f657ecc40 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 14:39:03.002767: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 14:39:05.016786: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 14:39:05.711117: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:39:06.379760: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:39:06.386054: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:39:07.735681: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 14:39:07.785313: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 14:39:08.513538: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 5s 47ms/step
[INFOR]: Index of most vote   :782
[INFOR]: Class of most vote   :screen, CRT screen
[INFOR]: Number of most vote  :38.0


[INFOR]: Index of second most vote     :499
[INFOR]: Class of second most vote     :cleaver, meat cleaver, chopper
[INFOR]: Number of second most vote    :36.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 2s 32ms/step
[INFOR]: Toltal norm before transform: 0.9366
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.2108

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 1s 31ms/step
[INFOR]: SEN training of class 71_500 before transform: 38
[INFOR]: SPE training of class 71_500 before transform: 487

[INFOR]: SEN training of class 71_500 after transform: 419
[INFOR]: SPE training of class 71_500 after transform: 369
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 31ms/step
[INFOR]: Index of most vote   :653
[INFOR]: Class of most vote   :milk can
[INFOR]: Number of most vote  :10.0


[INFOR]: Index of second most vote     :781
[INFOR]: Class of second most vote     :scoreboard
[INFOR]: Number of second most vote    :9.0
[INFOR]: SEN testing of class 71_100 before transform: 10
[INFOR]: SPE testing of class 71_100 before transform: 98

[INFOR]: SEN testing of class 71_100 after transform: 87
[INFOR]: SPE testing of class 71_100 after transform: 55
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name cifar_100 --class_name_train 72_500 --class_name_test 72_100
2021-09-08 14:39:16.744410: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  cifar_100
class_name_train =  72_500
class_name_test =  72_100
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 14:39:19.286787: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 14:39:19.312350: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 14:39:19.317079: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 14:39:19.324987: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:39:19.327143: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:39:19.332336: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 14:39:19.335753: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 14:39:19.342070: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 14:39:19.346937: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 14:39:19.349897: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:39:19.352058: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 14:39:19.354028: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 14:39:19.366133: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x20d33f11e50 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 14:39:19.369604: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 14:39:19.371723: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 14:39:19.376163: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 14:39:19.378416: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:39:19.380757: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:39:19.382988: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 14:39:19.385230: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 14:39:19.387438: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 14:39:19.389841: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 14:39:19.392125: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:39:19.394723: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 14:39:19.822386: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 14:39:19.824892: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 14:39:19.826425: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 14:39:19.828014: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 14:39:19.835527: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x20d5d3576b0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 14:39:19.838440: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 14:39:21.808629: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 14:39:22.495515: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:39:23.153975: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:39:23.160607: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:39:24.510696: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 14:39:24.561054: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 14:39:25.284489: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 5s 48ms/step
[INFOR]: Index of most vote   :149
[INFOR]: Class of most vote   :dugong, Dugong dugon
[INFOR]: Number of most vote  :40.0


[INFOR]: Index of second most vote     :103
[INFOR]: Class of second most vote     :platypus, duckbill, duckbilled platypus, duck-billed platypus, Ornithorhynchus anatinus
[INFOR]: Number of second most vote    :35.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 2s 32ms/step
[INFOR]: Toltal norm before transform: 0.9135
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.3629

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 1s 31ms/step
[INFOR]: SEN training of class 72_500 before transform: 40
[INFOR]: SPE training of class 72_500 before transform: 493

[INFOR]: SEN training of class 72_500 after transform: 383
[INFOR]: SPE training of class 72_500 after transform: 347
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 32ms/step
[INFOR]: Index of most vote   :150
[INFOR]: Class of most vote   :sea lion
[INFOR]: Number of most vote  :9.0


[INFOR]: Index of second most vote     :103
[INFOR]: Class of second most vote     :platypus, duckbill, duckbilled platypus, duck-billed platypus, Ornithorhynchus anatinus
[INFOR]: Number of second most vote    :5.0
[INFOR]: SEN testing of class 72_100 before transform: 9
[INFOR]: SPE testing of class 72_100 before transform: 100

[INFOR]: SEN testing of class 72_100 after transform: 84
[INFOR]: SPE testing of class 72_100 after transform: 6
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name cifar_100 --class_name_train 73_500 --class_name_test 73_100
2021-09-08 14:39:33.515447: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  cifar_100
class_name_train =  73_500
class_name_test =  73_100
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 14:39:36.148669: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 14:39:36.174763: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 14:39:36.179909: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 14:39:36.187924: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:39:36.190333: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:39:36.195453: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 14:39:36.198934: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 14:39:36.205328: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 14:39:36.210788: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 14:39:36.213841: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:39:36.216114: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 14:39:36.218081: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 14:39:36.230778: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x154b36d5fe0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 14:39:36.234619: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 14:39:36.236780: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 14:39:36.241365: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 14:39:36.243722: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:39:36.246014: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:39:36.248272: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 14:39:36.250573: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 14:39:36.252829: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 14:39:36.255187: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 14:39:36.257597: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:39:36.259804: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 14:39:36.687768: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 14:39:36.690744: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 14:39:36.692285: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 14:39:36.693900: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 14:39:36.700694: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x154e27ec460 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 14:39:36.703534: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 14:39:38.717353: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 14:39:39.410744: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:39:40.070131: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:39:40.076601: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:39:41.427431: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 14:39:41.476784: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 14:39:42.199862: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 5s 47ms/step
[INFOR]: Index of most vote   :149
[INFOR]: Class of most vote   :dugong, Dugong dugon
[INFOR]: Number of most vote  :47.0


[INFOR]: Index of second most vote     :103
[INFOR]: Class of second most vote     :platypus, duckbill, duckbilled platypus, duck-billed platypus, Ornithorhynchus anatinus
[INFOR]: Number of second most vote    :44.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 2s 31ms/step
[INFOR]: Toltal norm before transform: 0.8921
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0882

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 1s 31ms/step
[INFOR]: SEN training of class 73_500 before transform: 47
[INFOR]: SPE training of class 73_500 before transform: 490

[INFOR]: SEN training of class 73_500 after transform: 428
[INFOR]: SPE training of class 73_500 after transform: 383
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 32ms/step
[INFOR]: Index of most vote   :149
[INFOR]: Class of most vote   :dugong, Dugong dugon
[INFOR]: Number of most vote  :9.0


[INFOR]: Index of second most vote     :103
[INFOR]: Class of second most vote     :platypus, duckbill, duckbilled platypus, duck-billed platypus, Ornithorhynchus anatinus
[INFOR]: Number of second most vote    :8.0
[INFOR]: SEN testing of class 73_100 before transform: 9
[INFOR]: SPE testing of class 73_100 before transform: 98

[INFOR]: SEN testing of class 73_100 after transform: 74
[INFOR]: SPE testing of class 73_100 after transform: 55
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name cifar_100 --class_name_train 74_500 --class_name_test 74_100
2021-09-08 14:39:50.436327: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  cifar_100
class_name_train =  74_500
class_name_test =  74_100
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 14:39:52.975351: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 14:39:53.000998: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 14:39:53.005737: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 14:39:53.013602: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:39:53.015764: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:39:53.021102: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 14:39:53.024444: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 14:39:53.030750: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 14:39:53.035737: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 14:39:53.038693: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:39:53.040982: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 14:39:53.042921: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 14:39:53.055038: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x176b7591680 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 14:39:53.058566: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 14:39:53.060639: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 14:39:53.065038: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 14:39:53.067401: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:39:53.069593: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:39:53.071856: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 14:39:53.074169: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 14:39:53.076429: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 14:39:53.078680: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 14:39:53.081000: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:39:53.083200: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 14:39:53.523640: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 14:39:53.526596: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 14:39:53.528066: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 14:39:53.529718: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 14:39:53.536758: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x176e10da620 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 14:39:53.539619: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 14:39:55.503784: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 14:39:56.191915: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:39:56.851387: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:39:56.857989: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:39:58.211420: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 14:39:58.260245: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 14:39:59.020951: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 5s 48ms/step
[INFOR]: Index of most vote   :335
[INFOR]: Class of most vote   :fox squirrel, eastern fox squirrel, Sciurus niger
[INFOR]: Number of most vote  :65.0


[INFOR]: Index of second most vote     :103
[INFOR]: Class of second most vote     :platypus, duckbill, duckbilled platypus, duck-billed platypus, Ornithorhynchus anatinus
[INFOR]: Number of second most vote    :51.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 2s 32ms/step
[INFOR]: Toltal norm before transform: 0.8426
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1849

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 1s 31ms/step
[INFOR]: SEN training of class 74_500 before transform: 65
[INFOR]: SPE training of class 74_500 before transform: 480

[INFOR]: SEN training of class 74_500 after transform: 399
[INFOR]: SPE training of class 74_500 after transform: 324
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 31ms/step
[INFOR]: Index of most vote   :103
[INFOR]: Class of most vote   :platypus, duckbill, duckbilled platypus, duck-billed platypus, Ornithorhynchus anatinus
[INFOR]: Number of most vote  :11.0


[INFOR]: Index of second most vote     :334
[INFOR]: Class of second most vote     :porcupine, hedgehog
[INFOR]: Number of second most vote    :10.0
[INFOR]: SEN testing of class 74_100 before transform: 11
[INFOR]: SPE testing of class 74_100 before transform: 100

[INFOR]: SEN testing of class 74_100 after transform: 77
[INFOR]: SPE testing of class 74_100 after transform: 46
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name cifar_100 --class_name_train 75_500 --class_name_test 75_100
2021-09-08 14:40:07.301391: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  cifar_100
class_name_train =  75_500
class_name_test =  75_100
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 14:40:09.868455: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 14:40:09.894276: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 14:40:09.899361: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 14:40:09.907321: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:40:09.909504: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:40:09.914906: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 14:40:09.918371: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 14:40:09.924750: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 14:40:09.929753: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 14:40:09.933077: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:40:09.935302: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 14:40:09.937263: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 14:40:09.950237: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x2c9b5b27ec0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 14:40:09.954085: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 14:40:09.956251: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 14:40:09.960809: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 14:40:09.963047: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:40:09.965237: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:40:09.967650: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 14:40:09.969865: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 14:40:09.972134: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 14:40:09.974497: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 14:40:09.976948: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:40:09.979371: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 14:40:10.411301: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 14:40:10.414553: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 14:40:10.416102: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 14:40:10.417743: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 14:40:10.424771: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x2c9e53d9840 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 14:40:10.427676: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 14:40:12.391564: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 14:40:13.087407: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:40:13.741529: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:40:13.747867: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:40:15.106153: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 14:40:15.154108: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 14:40:15.907393: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 5s 47ms/step
[INFOR]: Index of most vote   :361
[INFOR]: Class of most vote   :skunk, polecat, wood pussy
[INFOR]: Number of most vote  :262.0


[INFOR]: Index of second most vote     :152
[INFOR]: Class of second most vote     :Japanese spaniel
[INFOR]: Number of second most vote    :21.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 2s 31ms/step
[INFOR]: Toltal norm before transform: 0.3243
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0581

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 1s 31ms/step
[INFOR]: SEN training of class 75_500 before transform: 262
[INFOR]: SPE training of class 75_500 before transform: 500

[INFOR]: SEN training of class 75_500 after transform: 405
[INFOR]: SPE training of class 75_500 after transform: 412
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 31ms/step
[INFOR]: Index of most vote   :361
[INFOR]: Class of most vote   :skunk, polecat, wood pussy
[INFOR]: Number of most vote  :48.0


[INFOR]: Index of second most vote     :374
[INFOR]: Class of second most vote     :langur
[INFOR]: Number of second most vote    :5.0
[INFOR]: SEN testing of class 75_100 before transform: 48
[INFOR]: SPE testing of class 75_100 before transform: 100

[INFOR]: SEN testing of class 75_100 after transform: 93
[INFOR]: SPE testing of class 75_100 after transform: 28
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name cifar_100 --class_name_train 76_500 --class_name_test 76_100
2021-09-08 14:40:24.177222: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  cifar_100
class_name_train =  76_500
class_name_test =  76_100
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 14:40:26.806169: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 14:40:26.829700: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 14:40:26.834452: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 14:40:26.842701: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:40:26.844853: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:40:26.850136: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 14:40:26.853586: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 14:40:26.860141: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 14:40:26.865047: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 14:40:26.868123: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:40:26.870341: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 14:40:26.872319: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 14:40:26.884833: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x23433c3e120 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 14:40:26.888617: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 14:40:26.890853: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 14:40:26.895352: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 14:40:26.897617: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:40:26.899860: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:40:26.902155: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 14:40:26.904458: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 14:40:26.906741: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 14:40:26.909025: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 14:40:26.911309: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:40:26.913554: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 14:40:27.354844: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 14:40:27.357376: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 14:40:27.358844: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 14:40:27.360401: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 14:40:27.367256: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x234630ede30 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 14:40:27.370195: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 14:40:29.390043: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 14:40:30.089408: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:40:30.755201: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:40:30.761769: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:40:32.107136: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 14:40:32.155301: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 14:40:32.877756: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 5s 47ms/step
[INFOR]: Index of most vote   :906
[INFOR]: Class of most vote   :Windsor tie
[INFOR]: Number of most vote  :38.0


[INFOR]: Index of second most vote     :913
[INFOR]: Class of second most vote     :wreck
[INFOR]: Number of second most vote    :27.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 2s 31ms/step
[INFOR]: Toltal norm before transform: 0.9150
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0141

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 1s 31ms/step
[INFOR]: SEN training of class 76_500 before transform: 38
[INFOR]: SPE training of class 76_500 before transform: 490

[INFOR]: SEN training of class 76_500 after transform: 399
[INFOR]: SPE training of class 76_500 after transform: 351
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 32ms/step
[INFOR]: Index of most vote   :906
[INFOR]: Class of most vote   :Windsor tie
[INFOR]: Number of most vote  :12.0


[INFOR]: Index of second most vote     :913
[INFOR]: Class of second most vote     :wreck
[INFOR]: Number of second most vote    :9.0
[INFOR]: SEN testing of class 76_100 before transform: 12
[INFOR]: SPE testing of class 76_100 before transform: 99

[INFOR]: SEN testing of class 76_100 after transform: 98
[INFOR]: SPE testing of class 76_100 after transform: 20
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name cifar_100 --class_name_train 77_500 --class_name_test 77_100
2021-09-08 14:40:41.095940: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  cifar_100
class_name_train =  77_500
class_name_test =  77_100
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 14:40:43.627512: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 14:40:43.651868: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 14:40:43.656987: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 14:40:43.664994: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:40:43.667157: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:40:43.672322: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 14:40:43.675713: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 14:40:43.682007: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 14:40:43.686976: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 14:40:43.690040: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:40:43.692265: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 14:40:43.694301: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 14:40:43.707438: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x241336c4fc0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 14:40:43.710818: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 14:40:43.713050: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 14:40:43.717794: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 14:40:43.720125: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:40:43.722504: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:40:43.724928: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 14:40:43.727316: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 14:40:43.729875: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 14:40:43.732302: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 14:40:43.734739: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:40:43.737107: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 14:40:44.169138: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 14:40:44.172514: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 14:40:44.173970: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 14:40:44.175570: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 14:40:44.182429: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x2415df9de10 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 14:40:44.185288: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 14:40:46.147977: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 14:40:46.831425: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:40:47.487478: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:40:47.495007: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:40:48.844720: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 14:40:48.892695: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 14:40:49.616173: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 5s 47ms/step
[INFOR]: Index of most vote   :149
[INFOR]: Class of most vote   :dugong, Dugong dugon
[INFOR]: Number of most vote  :48.0


[INFOR]: Index of second most vote     :521
[INFOR]: Class of second most vote     :Crock Pot
[INFOR]: Number of second most vote    :32.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 2s 32ms/step
[INFOR]: Toltal norm before transform: 0.9160
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1756

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 1s 31ms/step
[INFOR]: SEN training of class 77_500 before transform: 48
[INFOR]: SPE training of class 77_500 before transform: 488

[INFOR]: SEN training of class 77_500 after transform: 368
[INFOR]: SPE training of class 77_500 after transform: 322
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 31ms/step
[INFOR]: Index of most vote   :149
[INFOR]: Class of most vote   :dugong, Dugong dugon
[INFOR]: Number of most vote  :8.0


[INFOR]: Index of second most vote     :679
[INFOR]: Class of second most vote     :necklace
[INFOR]: Number of second most vote    :7.0
[INFOR]: SEN testing of class 77_100 before transform: 8
[INFOR]: SPE testing of class 77_100 before transform: 99

[INFOR]: SEN testing of class 77_100 after transform: 89
[INFOR]: SPE testing of class 77_100 after transform: 8
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name cifar_100 --class_name_train 78_500 --class_name_test 78_100
2021-09-08 14:40:57.871845: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  cifar_100
class_name_train =  78_500
class_name_test =  78_100
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 14:41:00.486724: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 14:41:00.512214: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 14:41:00.517040: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 14:41:00.524997: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:41:00.527170: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:41:00.532352: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 14:41:00.535923: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 14:41:00.542224: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 14:41:00.547107: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 14:41:00.550119: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:41:00.552437: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 14:41:00.554386: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 14:41:00.567421: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x209b5b9e600 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 14:41:00.571314: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 14:41:00.573619: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 14:41:00.578227: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 14:41:00.580646: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:41:00.582874: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:41:00.585162: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 14:41:00.587378: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 14:41:00.589660: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 14:41:00.591976: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 14:41:00.594284: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:41:00.596494: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 14:41:01.017287: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 14:41:01.019883: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 14:41:01.021543: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 14:41:01.023134: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 14:41:01.030154: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x209e494a6a0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 14:41:01.033085: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 14:41:03.013822: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 14:41:03.708649: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:41:04.362214: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:41:04.369168: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:41:05.716866: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 14:41:05.766453: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 14:41:06.486314: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 5s 48ms/step
[INFOR]: Index of most vote   :111
[INFOR]: Class of most vote   :nematode, nematode worm, roundworm
[INFOR]: Number of most vote  :133.0


[INFOR]: Index of second most vote     :68
[INFOR]: Class of second most vote     :sidewinder, horned rattlesnake, Crotalus cerastes
[INFOR]: Number of second most vote    :58.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 2s 32ms/step
[INFOR]: Toltal norm before transform: 0.7123
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.3597

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 1s 32ms/step
[INFOR]: SEN training of class 78_500 before transform: 133
[INFOR]: SPE training of class 78_500 before transform: 496

[INFOR]: SEN training of class 78_500 after transform: 408
[INFOR]: SPE training of class 78_500 after transform: 358
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 32ms/step
[INFOR]: Index of most vote   :111
[INFOR]: Class of most vote   :nematode, nematode worm, roundworm
[INFOR]: Number of most vote  :23.0


[INFOR]: Index of second most vote     :68
[INFOR]: Class of second most vote     :sidewinder, horned rattlesnake, Crotalus cerastes
[INFOR]: Number of second most vote    :10.0
[INFOR]: SEN testing of class 78_100 before transform: 23
[INFOR]: SPE testing of class 78_100 before transform: 98

[INFOR]: SEN testing of class 78_100 after transform: 93
[INFOR]: SPE testing of class 78_100 after transform: 62
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name cifar_100 --class_name_train 79_500 --class_name_test 79_100
2021-09-08 14:41:14.803244: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  cifar_100
class_name_train =  79_500
class_name_test =  79_100
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 14:41:17.352577: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 14:41:17.376861: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 14:41:17.381723: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 14:41:17.390009: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:41:17.392237: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:41:17.397671: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 14:41:17.401330: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 14:41:17.407695: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 14:41:17.412562: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 14:41:17.415474: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:41:17.417629: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 14:41:17.419629: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 14:41:17.431870: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x158b7d38b00 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 14:41:17.434997: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 14:41:17.437099: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 14:41:17.441553: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 14:41:17.443736: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:41:17.445901: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:41:17.448140: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 14:41:17.450424: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 14:41:17.452799: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 14:41:17.455015: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 14:41:17.457235: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:41:17.459445: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 14:41:17.882037: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 14:41:17.884874: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 14:41:17.886342: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 14:41:17.887944: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 14:41:17.894964: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x158e0e5c580 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 14:41:17.897882: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 14:41:19.942238: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 14:41:20.665949: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:41:21.319952: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:41:21.326193: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:41:22.700927: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 14:41:22.756955: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 14:41:23.479912: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 5s 47ms/step
[INFOR]: Index of most vote   :73
[INFOR]: Class of most vote   :barn spider, Araneus cavaticus
[INFOR]: Number of most vote  :139.0


[INFOR]: Index of second most vote     :77
[INFOR]: Class of second most vote     :wolf spider, hunting spider
[INFOR]: Number of second most vote    :23.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 2s 32ms/step
[INFOR]: Toltal norm before transform: 0.6485
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0645

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 1s 31ms/step
[INFOR]: SEN training of class 79_500 before transform: 139
[INFOR]: SPE training of class 79_500 before transform: 497

[INFOR]: SEN training of class 79_500 after transform: 389
[INFOR]: SPE training of class 79_500 after transform: 383
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 31ms/step
[INFOR]: Index of most vote   :73
[INFOR]: Class of most vote   :barn spider, Araneus cavaticus
[INFOR]: Number of most vote  :21.0


[INFOR]: Index of second most vote     :603
[INFOR]: Class of second most vote     :horse cart, horse-cart
[INFOR]: Number of second most vote    :5.0
[INFOR]: SEN testing of class 79_100 before transform: 21
[INFOR]: SPE testing of class 79_100 before transform: 100

[INFOR]: SEN testing of class 79_100 after transform: 81
[INFOR]: SPE testing of class 79_100 after transform: 17
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name cifar_100 --class_name_train 80_500 --class_name_test 80_100
2021-09-08 14:41:31.733390: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  cifar_100
class_name_train =  80_500
class_name_test =  80_100
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 14:41:34.350984: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 14:41:34.374551: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 14:41:34.379364: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 14:41:34.387336: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:41:34.389557: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:41:34.394858: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 14:41:34.398266: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 14:41:34.404682: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 14:41:34.409620: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 14:41:34.412641: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:41:34.414884: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 14:41:34.416967: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 14:41:34.430145: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x24fba39aee0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 14:41:34.433474: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 14:41:34.435823: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 14:41:34.440353: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 14:41:34.442747: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:41:34.445026: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:41:34.447370: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 14:41:34.449897: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 14:41:34.452144: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 14:41:34.454468: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 14:41:34.456900: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:41:34.459123: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 14:41:34.887600: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 14:41:34.890410: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 14:41:34.891946: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 14:41:34.893571: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 14:41:34.900775: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x24fe55157f0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 14:41:34.903688: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 14:41:36.953944: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 14:41:37.663412: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:41:38.331194: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:41:38.337294: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:41:39.691910: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 14:41:39.739793: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 14:41:40.458859: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 5s 48ms/step
[INFOR]: Index of most vote   :335
[INFOR]: Class of most vote   :fox squirrel, eastern fox squirrel, Sciurus niger
[INFOR]: Number of most vote  :156.0


[INFOR]: Index of second most vote     :149
[INFOR]: Class of second most vote     :dugong, Dugong dugon
[INFOR]: Number of second most vote    :20.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 2s 31ms/step
[INFOR]: Toltal norm before transform: 0.6453
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1879

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 1s 32ms/step
[INFOR]: SEN training of class 80_500 before transform: 156
[INFOR]: SPE training of class 80_500 before transform: 485

[INFOR]: SEN training of class 80_500 after transform: 337
[INFOR]: SPE training of class 80_500 after transform: 358
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 32ms/step
[INFOR]: Index of most vote   :335
[INFOR]: Class of most vote   :fox squirrel, eastern fox squirrel, Sciurus niger
[INFOR]: Number of most vote  :33.0


[INFOR]: Index of second most vote     :149
[INFOR]: Class of second most vote     :dugong, Dugong dugon
[INFOR]: Number of second most vote    :5.0
[INFOR]: SEN testing of class 80_100 before transform: 33
[INFOR]: SPE testing of class 80_100 before transform: 99

[INFOR]: SEN testing of class 80_100 after transform: 95
[INFOR]: SPE testing of class 80_100 after transform: 14
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name cifar_100 --class_name_train 81_500 --class_name_test 81_100
2021-09-08 14:41:48.787733: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  cifar_100
class_name_train =  81_500
class_name_test =  81_100
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 14:41:51.368688: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 14:41:51.393165: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 14:41:51.398100: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 14:41:51.406262: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:41:51.408494: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:41:51.413620: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 14:41:51.416994: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 14:41:51.423139: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 14:41:51.428171: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 14:41:51.431125: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:41:51.433268: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 14:41:51.435257: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 14:41:51.447083: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1f8ba6d6d10 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 14:41:51.450310: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 14:41:51.452354: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 14:41:51.456781: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 14:41:51.458966: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:41:51.461378: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:41:51.463568: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 14:41:51.465755: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 14:41:51.468048: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 14:41:51.470325: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 14:41:51.472526: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:41:51.474767: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 14:41:51.897672: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 14:41:51.900554: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 14:41:51.902014: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 14:41:51.903900: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 14:41:51.910558: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1f8daae21f0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 14:41:51.914455: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 14:41:53.910949: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 14:41:54.592772: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:41:55.248953: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:41:55.255545: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:41:56.598568: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 14:41:56.648740: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 14:41:57.372633: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 5s 47ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :173.0


[INFOR]: Index of second most vote     :510
[INFOR]: Class of second most vote     :container ship, containership, container vessel
[INFOR]: Number of second most vote    :59.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 2s 32ms/step
[INFOR]: Toltal norm before transform: 0.6012
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1717

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 1s 32ms/step
[INFOR]: SEN training of class 81_500 before transform: 173
[INFOR]: SPE training of class 81_500 before transform: 485

[INFOR]: SEN training of class 81_500 after transform: 445
[INFOR]: SPE training of class 81_500 after transform: 379
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 32ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :45.0


[INFOR]: Index of second most vote     :510
[INFOR]: Class of second most vote     :container ship, containership, container vessel
[INFOR]: Number of second most vote    :14.0
[INFOR]: SEN testing of class 81_100 before transform: 45
[INFOR]: SPE testing of class 81_100 before transform: 97

[INFOR]: SEN testing of class 81_100 after transform: 86
[INFOR]: SPE testing of class 81_100 after transform: 5
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name cifar_100 --class_name_train 82_500 --class_name_test 82_100
2021-09-08 14:42:05.671083: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  cifar_100
class_name_train =  82_500
class_name_test =  82_100
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 14:42:08.279692: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 14:42:08.310270: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 14:42:08.315233: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 14:42:08.323400: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:42:08.325577: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:42:08.330768: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 14:42:08.334205: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 14:42:08.340601: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 14:42:08.345518: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 14:42:08.348502: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:42:08.350728: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 14:42:08.352688: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 14:42:08.364850: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x23bbaeb49e0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 14:42:08.368268: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 14:42:08.370397: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 14:42:08.374761: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 14:42:08.376989: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:42:08.379195: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:42:08.381467: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 14:42:08.383667: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 14:42:08.385920: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 14:42:08.388144: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 14:42:08.390398: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:42:08.392667: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 14:42:08.817195: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 14:42:08.820168: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 14:42:08.821642: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 14:42:08.823232: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 14:42:08.830173: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x23be9e9e3d0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 14:42:08.833058: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 14:42:10.829409: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 14:42:11.525171: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:42:12.191531: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:42:12.198755: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:42:13.555955: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 14:42:13.605874: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 14:42:14.329256: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 5s 47ms/step
[INFOR]: Index of most vote   :985
[INFOR]: Class of most vote   :daisy
[INFOR]: Number of most vote  :76.0


[INFOR]: Index of second most vote     :392
[INFOR]: Class of second most vote     :rock beauty, Holocanthus tricolor
[INFOR]: Number of second most vote    :70.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 2s 32ms/step
[INFOR]: Toltal norm before transform: 0.7943
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0196

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 1s 32ms/step
[INFOR]: SEN training of class 82_500 before transform: 76
[INFOR]: SPE training of class 82_500 before transform: 500

[INFOR]: SEN training of class 82_500 after transform: 460
[INFOR]: SPE training of class 82_500 after transform: 368
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 32ms/step
[INFOR]: Index of most vote   :985
[INFOR]: Class of most vote   :daisy
[INFOR]: Number of most vote  :23.0


[INFOR]: Index of second most vote     :723
[INFOR]: Class of second most vote     :pinwheel
[INFOR]: Number of second most vote    :11.0
[INFOR]: SEN testing of class 82_100 before transform: 23
[INFOR]: SPE testing of class 82_100 before transform: 100

[INFOR]: SEN testing of class 82_100 after transform: 94
[INFOR]: SPE testing of class 82_100 after transform: 18
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name cifar_100 --class_name_train 83_500 --class_name_test 83_100
2021-09-08 14:42:22.616703: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  cifar_100
class_name_train =  83_500
class_name_test =  83_100
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 14:42:25.256006: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 14:42:25.280828: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 14:42:25.285768: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 14:42:25.293868: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:42:25.296183: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:42:25.301723: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 14:42:25.305255: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 14:42:25.311812: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 14:42:25.316940: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 14:42:25.319978: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:42:25.322330: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 14:42:25.324300: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 14:42:25.336637: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x26d357c4260 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 14:42:25.339745: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 14:42:25.341940: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 14:42:25.346430: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 14:42:25.348746: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:42:25.351032: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:42:25.353461: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 14:42:25.355708: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 14:42:25.358082: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 14:42:25.360418: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 14:42:25.362775: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:42:25.365028: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 14:42:25.799053: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 14:42:25.801686: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 14:42:25.803135: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 14:42:25.804694: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 14:42:25.811761: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x26d649fabf0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 14:42:25.814760: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 14:42:27.847878: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 14:42:28.567017: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:42:29.236729: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:42:29.242570: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:42:30.622679: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 14:42:30.670644: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 14:42:31.389127: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 5s 47ms/step
[INFOR]: Index of most vote   :945
[INFOR]: Class of most vote   :bell pepper
[INFOR]: Number of most vote  :51.0


[INFOR]: Index of second most vote     :714
[INFOR]: Class of second most vote     :pick, plectrum, plectron
[INFOR]: Number of second most vote    :35.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 2s 32ms/step
[INFOR]: Toltal norm before transform: 0.8831
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0571

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 1s 31ms/step
[INFOR]: SEN training of class 83_500 before transform: 51
[INFOR]: SPE training of class 83_500 before transform: 499

[INFOR]: SEN training of class 83_500 after transform: 384
[INFOR]: SPE training of class 83_500 after transform: 377
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 32ms/step
[INFOR]: Index of most vote   :945
[INFOR]: Class of most vote   :bell pepper
[INFOR]: Number of most vote  :10.0


[INFOR]: Index of second most vote     :714
[INFOR]: Class of second most vote     :pick, plectrum, plectron
[INFOR]: Number of second most vote    :9.0
[INFOR]: SEN testing of class 83_100 before transform: 10
[INFOR]: SPE testing of class 83_100 before transform: 100

[INFOR]: SEN testing of class 83_100 after transform: 94
[INFOR]: SPE testing of class 83_100 after transform: 19
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name cifar_100 --class_name_train 84_500 --class_name_test 84_100
2021-09-08 14:42:39.639823: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  cifar_100
class_name_train =  84_500
class_name_test =  84_100
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 14:42:42.266757: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 14:42:42.291137: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 14:42:42.295734: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 14:42:42.303772: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:42:42.305938: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:42:42.311027: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 14:42:42.314525: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 14:42:42.320849: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 14:42:42.325763: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 14:42:42.328759: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:42:42.330982: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 14:42:42.332913: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 14:42:42.345418: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x203374f3c70 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 14:42:42.349038: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 14:42:42.351148: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 14:42:42.355501: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 14:42:42.357671: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:42:42.359822: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:42:42.362039: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 14:42:42.364255: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 14:42:42.366468: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 14:42:42.368781: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 14:42:42.371015: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:42:42.373215: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 14:42:42.797951: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 14:42:42.800639: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 14:42:42.802003: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 14:42:42.803509: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 14:42:42.810556: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x2036632f570 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 14:42:42.813512: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 14:42:44.807950: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 14:42:45.503041: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:42:46.158849: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:42:46.165504: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:42:47.518598: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 14:42:47.567009: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 14:42:48.292074: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 5s 47ms/step
[INFOR]: Index of most vote   :708
[INFOR]: Class of most vote   :pedestal, plinth, footstall
[INFOR]: Number of most vote  :43.0


[INFOR]: Index of second most vote     :532
[INFOR]: Class of second most vote     :dining table, board
[INFOR]: Number of second most vote    :33.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 2s 32ms/step
[INFOR]: Toltal norm before transform: 0.9145
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.3392

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 1s 32ms/step
[INFOR]: SEN training of class 84_500 before transform: 43
[INFOR]: SPE training of class 84_500 before transform: 499

[INFOR]: SEN training of class 84_500 after transform: 399
[INFOR]: SPE training of class 84_500 after transform: 368
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 33ms/step
[INFOR]: Index of most vote   :708
[INFOR]: Class of most vote   :pedestal, plinth, footstall
[INFOR]: Number of most vote  :10.0


[INFOR]: Index of second most vote     :550
[INFOR]: Class of second most vote     :espresso maker
[INFOR]: Number of second most vote    :6.0
[INFOR]: SEN testing of class 84_100 before transform: 10
[INFOR]: SPE testing of class 84_100 before transform: 100

[INFOR]: SEN testing of class 84_100 after transform: 100
[INFOR]: SPE testing of class 84_100 after transform: 7
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name cifar_100 --class_name_train 85_500 --class_name_test 85_100
2021-09-08 14:42:56.559783: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  cifar_100
class_name_train =  85_500
class_name_test =  85_100
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 14:42:59.106693: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 14:42:59.133626: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 14:42:59.138455: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 14:42:59.146263: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:42:59.148380: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:42:59.153457: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 14:42:59.156880: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 14:42:59.163116: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 14:42:59.167932: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 14:42:59.170849: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:42:59.172976: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 14:42:59.174835: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 14:42:59.187235: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1d2b544f380 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 14:42:59.191376: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 14:42:59.193501: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 14:42:59.197762: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 14:42:59.199935: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:42:59.202045: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:42:59.204207: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 14:42:59.206347: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 14:42:59.208528: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 14:42:59.210675: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 14:42:59.212941: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:42:59.215086: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 14:42:59.640207: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 14:42:59.643645: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 14:42:59.645045: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 14:42:59.646560: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 14:42:59.653449: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1d2ddc260b0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 14:42:59.656389: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 14:43:01.637703: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 14:43:02.328832: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:43:02.984136: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:43:02.991013: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:43:04.352352: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 14:43:04.403721: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 14:43:05.193431: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 5s 49ms/step
[INFOR]: Index of most vote   :408
[INFOR]: Class of most vote   :amphibian, amphibious vehicle
[INFOR]: Number of most vote  :181.0


[INFOR]: Index of second most vote     :855
[INFOR]: Class of second most vote     :thimble
[INFOR]: Number of second most vote    :59.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 2s 32ms/step
[INFOR]: Toltal norm before transform: 0.5683
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0373

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 1s 32ms/step
[INFOR]: SEN training of class 85_500 before transform: 181
[INFOR]: SPE training of class 85_500 before transform: 495

[INFOR]: SEN training of class 85_500 after transform: 426
[INFOR]: SPE training of class 85_500 after transform: 393
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 32ms/step
[INFOR]: Index of most vote   :408
[INFOR]: Class of most vote   :amphibian, amphibious vehicle
[INFOR]: Number of most vote  :39.0


[INFOR]: Index of second most vote     :855
[INFOR]: Class of second most vote     :thimble
[INFOR]: Number of second most vote    :13.0
[INFOR]: SEN testing of class 85_100 before transform: 39
[INFOR]: SPE testing of class 85_100 before transform: 99

[INFOR]: SEN testing of class 85_100 after transform: 94
[INFOR]: SPE testing of class 85_100 after transform: 1
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name cifar_100 --class_name_train 86_500 --class_name_test 86_100
2021-09-08 14:43:13.541447: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  cifar_100
class_name_train =  86_500
class_name_test =  86_100
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 14:43:16.110869: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 14:43:16.134215: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 14:43:16.138553: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 14:43:16.146368: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:43:16.148509: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:43:16.153635: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 14:43:16.156998: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 14:43:16.163325: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 14:43:16.168173: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 14:43:16.171101: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:43:16.173349: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 14:43:16.175221: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 14:43:16.187164: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1703afd8ac0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 14:43:16.190355: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 14:43:16.192359: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 14:43:16.196786: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 14:43:16.198929: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:43:16.201108: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:43:16.203282: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 14:43:16.205393: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 14:43:16.207739: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 14:43:16.209905: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 14:43:16.212066: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:43:16.214195: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 14:43:16.638442: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 14:43:16.641536: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 14:43:16.643049: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 14:43:16.644575: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 14:43:16.651070: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1705dce47d0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 14:43:16.654067: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 14:43:18.639075: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 14:43:19.334922: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:43:19.992825: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:43:20.000374: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:43:21.353986: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 14:43:21.404009: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 14:43:22.127190: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 5s 46ms/step
[INFOR]: Index of most vote   :590
[INFOR]: Class of most vote   :hand-held computer, hand-held microcomputer
[INFOR]: Number of most vote  :76.0


[INFOR]: Index of second most vote     :482
[INFOR]: Class of second most vote     :cassette player
[INFOR]: Number of second most vote    :54.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 2s 31ms/step
[INFOR]: Toltal norm before transform: 0.8220
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1517

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 1s 31ms/step
[INFOR]: SEN training of class 86_500 before transform: 76
[INFOR]: SPE training of class 86_500 before transform: 499

[INFOR]: SEN training of class 86_500 after transform: 404
[INFOR]: SPE training of class 86_500 after transform: 327
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 33ms/step
[INFOR]: Index of most vote   :590
[INFOR]: Class of most vote   :hand-held computer, hand-held microcomputer
[INFOR]: Number of most vote  :14.0


[INFOR]: Index of second most vote     :482
[INFOR]: Class of second most vote     :cassette player
[INFOR]: Number of second most vote    :9.0
[INFOR]: SEN testing of class 86_100 before transform: 14
[INFOR]: SPE testing of class 86_100 before transform: 100

[INFOR]: SEN testing of class 86_100 after transform: 100
[INFOR]: SPE testing of class 86_100 after transform: 0
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name cifar_100 --class_name_train 87_500 --class_name_test 87_100
2021-09-08 14:43:30.353631: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  cifar_100
class_name_train =  87_500
class_name_test =  87_100
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 14:43:32.949958: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 14:43:32.978143: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 14:43:32.983046: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 14:43:32.990914: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:43:32.993095: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:43:32.998121: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 14:43:33.001435: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 14:43:33.007745: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 14:43:33.012811: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 14:43:33.015791: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:43:33.018007: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 14:43:33.019891: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 14:43:33.032560: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x24cb72ee600 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 14:43:33.036326: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 14:43:33.038397: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 14:43:33.042746: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 14:43:33.044948: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:43:33.047081: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:43:33.049240: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 14:43:33.051517: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 14:43:33.053649: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 14:43:33.055817: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 14:43:33.057976: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:43:33.060235: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 14:43:33.484847: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 14:43:33.487766: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 14:43:33.489213: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 14:43:33.490722: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 14:43:33.497459: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x24cdf5560f0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 14:43:33.500319: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 14:43:35.487550: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 14:43:36.185293: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:43:36.842554: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:43:36.849642: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:43:38.197577: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 14:43:38.246220: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 14:43:38.968979: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 5s 48ms/step
[INFOR]: Index of most vote   :782
[INFOR]: Class of most vote   :screen, CRT screen
[INFOR]: Number of most vote  :194.0


[INFOR]: Index of second most vote     :675
[INFOR]: Class of second most vote     :moving van
[INFOR]: Number of second most vote    :41.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 2s 32ms/step
[INFOR]: Toltal norm before transform: 0.5643
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1953

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 1s 32ms/step
[INFOR]: SEN training of class 87_500 before transform: 194
[INFOR]: SPE training of class 87_500 before transform: 493

[INFOR]: SEN training of class 87_500 after transform: 429
[INFOR]: SPE training of class 87_500 after transform: 403
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 32ms/step
[INFOR]: Index of most vote   :782
[INFOR]: Class of most vote   :screen, CRT screen
[INFOR]: Number of most vote  :39.0


[INFOR]: Index of second most vote     :631
[INFOR]: Class of second most vote     :lotion
[INFOR]: Number of second most vote    :7.0
[INFOR]: SEN testing of class 87_100 before transform: 39
[INFOR]: SPE testing of class 87_100 before transform: 98

[INFOR]: SEN testing of class 87_100 after transform: 93
[INFOR]: SPE testing of class 87_100 after transform: 28
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name cifar_100 --class_name_train 88_500 --class_name_test 88_100
2021-09-08 14:43:47.281498: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  cifar_100
class_name_train =  88_500
class_name_test =  88_100
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 14:43:49.838738: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 14:43:49.865188: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 14:43:49.870126: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 14:43:49.878203: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:43:49.880336: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:43:49.885396: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 14:43:49.888652: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 14:43:49.894838: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 14:43:49.899803: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 14:43:49.902745: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:43:49.904898: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 14:43:49.906877: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 14:43:49.918546: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x25bb6703180 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 14:43:49.921753: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 14:43:49.923843: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 14:43:49.928214: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 14:43:49.930373: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:43:49.932588: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:43:49.934822: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 14:43:49.936988: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 14:43:49.939160: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 14:43:49.941385: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 14:43:49.943553: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:43:49.945790: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 14:43:50.375985: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 14:43:50.379093: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 14:43:50.380448: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 14:43:50.381984: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 14:43:50.388704: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x25bdff3c2e0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 14:43:50.391529: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 14:43:52.357013: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 14:43:53.036312: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:43:53.687980: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:43:53.695524: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:43:55.046858: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 14:43:55.103935: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 14:43:55.823625: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 5s 49ms/step
[INFOR]: Index of most vote   :292
[INFOR]: Class of most vote   :tiger, Panthera tigris
[INFOR]: Number of most vote  :56.0


[INFOR]: Index of second most vote     :334
[INFOR]: Class of second most vote     :porcupine, hedgehog
[INFOR]: Number of second most vote    :43.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 2s 32ms/step
[INFOR]: Toltal norm before transform: 0.8729
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.3653

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 1s 31ms/step
[INFOR]: SEN training of class 88_500 before transform: 56
[INFOR]: SPE training of class 88_500 before transform: 500

[INFOR]: SEN training of class 88_500 after transform: 402
[INFOR]: SPE training of class 88_500 after transform: 373
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 32ms/step
[INFOR]: Index of most vote   :292
[INFOR]: Class of most vote   :tiger, Panthera tigris
[INFOR]: Number of most vote  :12.0


[INFOR]: Index of second most vote     :334
[INFOR]: Class of second most vote     :porcupine, hedgehog
[INFOR]: Number of second most vote    :7.0
[INFOR]: SEN testing of class 88_100 before transform: 12
[INFOR]: SPE testing of class 88_100 before transform: 100

[INFOR]: SEN testing of class 88_100 after transform: 94
[INFOR]: SPE testing of class 88_100 after transform: 3
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name cifar_100 --class_name_train 89_500 --class_name_test 89_100
2021-09-08 14:44:04.106266: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  cifar_100
class_name_train =  89_500
class_name_test =  89_100
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 14:44:06.689850: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 14:44:06.715443: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 14:44:06.720149: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 14:44:06.728054: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:44:06.730239: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:44:06.735285: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 14:44:06.738564: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 14:44:06.744816: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 14:44:06.749797: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 14:44:06.752720: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:44:06.754906: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 14:44:06.757378: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 14:44:06.770381: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x27c331561b0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 14:44:06.773638: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 14:44:06.775880: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 14:44:06.780446: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 14:44:06.782859: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:44:06.785090: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:44:06.787473: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 14:44:06.789768: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 14:44:06.792185: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 14:44:06.794472: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 14:44:06.796789: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:44:06.799077: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 14:44:07.220407: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 14:44:07.223304: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 14:44:07.224686: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 14:44:07.226218: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 14:44:07.232817: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x27c61b16cf0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 14:44:07.235736: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 14:44:09.218174: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 14:44:09.919621: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:44:10.575981: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:44:10.582221: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:44:11.925388: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 14:44:11.974425: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 14:44:12.698187: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 5s 49ms/step
[INFOR]: Index of most vote   :856
[INFOR]: Class of most vote   :thresher, thrasher, threshing machine
[INFOR]: Number of most vote  :231.0


[INFOR]: Index of second most vote     :675
[INFOR]: Class of second most vote     :moving van
[INFOR]: Number of second most vote    :39.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 2s 32ms/step
[INFOR]: Toltal norm before transform: 0.4129
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0917

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 1s 32ms/step
[INFOR]: SEN training of class 89_500 before transform: 231
[INFOR]: SPE training of class 89_500 before transform: 489

[INFOR]: SEN training of class 89_500 after transform: 448
[INFOR]: SPE training of class 89_500 after transform: 364
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 33ms/step
[INFOR]: Index of most vote   :856
[INFOR]: Class of most vote   :thresher, thrasher, threshing machine
[INFOR]: Number of most vote  :44.0


[INFOR]: Index of second most vote     :408
[INFOR]: Class of second most vote     :amphibian, amphibious vehicle
[INFOR]: Number of second most vote    :11.0
[INFOR]: SEN testing of class 89_100 before transform: 44
[INFOR]: SPE testing of class 89_100 before transform: 97

[INFOR]: SEN testing of class 89_100 after transform: 84
[INFOR]: SPE testing of class 89_100 after transform: 7
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name cifar_100 --class_name_train 90_500 --class_name_test 90_100
2021-09-08 14:44:21.079868: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  cifar_100
class_name_train =  90_500
class_name_test =  90_100
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 14:44:23.650431: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 14:44:23.675152: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 14:44:23.679879: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 14:44:23.687787: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:44:23.689953: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:44:23.694999: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 14:44:23.698408: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 14:44:23.704744: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 14:44:23.709576: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 14:44:23.712509: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:44:23.714649: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 14:44:23.716623: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 14:44:23.728298: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1613678d580 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 14:44:23.731447: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 14:44:23.733451: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 14:44:23.737652: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 14:44:23.739784: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:44:23.742020: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:44:23.744171: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 14:44:23.746268: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 14:44:23.748472: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 14:44:23.750718: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 14:44:23.752863: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:44:23.754964: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 14:44:24.175134: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 14:44:24.177715: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 14:44:24.179092: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 14:44:24.180577: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 14:44:24.187481: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1615803edf0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 14:44:24.190350: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 14:44:26.165950: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 14:44:26.853955: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:44:27.509572: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:44:27.515408: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:44:28.891665: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 14:44:28.940026: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 14:44:29.717853: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 5s 49ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :73.0


[INFOR]: Index of second most vote     :510
[INFOR]: Class of second most vote     :container ship, containership, container vessel
[INFOR]: Number of second most vote    :60.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 2s 32ms/step
[INFOR]: Toltal norm before transform: 0.8089
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0860

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 1s 32ms/step
[INFOR]: SEN training of class 90_500 before transform: 73
[INFOR]: SPE training of class 90_500 before transform: 485

[INFOR]: SEN training of class 90_500 after transform: 428
[INFOR]: SPE training of class 90_500 after transform: 341
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 31ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :25.0


[INFOR]: Index of second most vote     :510
[INFOR]: Class of second most vote     :container ship, containership, container vessel
[INFOR]: Number of second most vote    :16.0
[INFOR]: SEN testing of class 90_100 before transform: 25
[INFOR]: SPE testing of class 90_100 before transform: 96

[INFOR]: SEN testing of class 90_100 after transform: 74
[INFOR]: SPE testing of class 90_100 after transform: 5
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name cifar_100 --class_name_train 91_500 --class_name_test 91_100
2021-09-08 14:44:37.995630: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  cifar_100
class_name_train =  91_500
class_name_test =  91_100
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 14:44:40.586004: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 14:44:40.611643: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 14:44:40.616840: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 14:44:40.624950: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:44:40.627662: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:44:40.632964: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 14:44:40.636529: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 14:44:40.642822: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 14:44:40.647691: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 14:44:40.650547: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:44:40.652670: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 14:44:40.654680: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 14:44:40.667388: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x28633df0ce0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 14:44:40.671106: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 14:44:40.673234: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 14:44:40.677486: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 14:44:40.679604: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:44:40.681703: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:44:40.683918: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 14:44:40.686108: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 14:44:40.688277: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 14:44:40.690411: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 14:44:40.692606: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:44:40.694798: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 14:44:41.119837: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 14:44:41.122832: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 14:44:41.124311: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 14:44:41.125778: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 14:44:41.132472: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x2865f5ba070 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 14:44:41.135423: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 14:44:43.114703: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 14:44:43.802775: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:44:44.457015: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:44:44.463226: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:44:45.795492: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 14:44:45.851437: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 14:44:46.572419: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 5s 47ms/step
[INFOR]: Index of most vote   :103
[INFOR]: Class of most vote   :platypus, duckbill, duckbilled platypus, duck-billed platypus, Ornithorhynchus anatinus
[INFOR]: Number of most vote  :50.0


[INFOR]: Index of second most vote     :391
[INFOR]: Class of second most vote     :coho, cohoe, coho salmon, blue jack, silver salmon, Oncorhynchus kisutch
[INFOR]: Number of second most vote    :29.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 2s 32ms/step
[INFOR]: Toltal norm before transform: 0.9132
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0424

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 1s 32ms/step
[INFOR]: SEN training of class 91_500 before transform: 50
[INFOR]: SPE training of class 91_500 before transform: 491

[INFOR]: SEN training of class 91_500 after transform: 345
[INFOR]: SPE training of class 91_500 after transform: 320
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 32ms/step
[INFOR]: Index of most vote   :103
[INFOR]: Class of most vote   :platypus, duckbill, duckbilled platypus, duck-billed platypus, Ornithorhynchus anatinus
[INFOR]: Number of most vote  :10.0


[INFOR]: Index of second most vote     :472
[INFOR]: Class of second most vote     :canoe
[INFOR]: Number of second most vote    :6.0
[INFOR]: SEN testing of class 91_100 before transform: 10
[INFOR]: SPE testing of class 91_100 before transform: 98

[INFOR]: SEN testing of class 91_100 after transform: 86
[INFOR]: SPE testing of class 91_100 after transform: 6
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name cifar_100 --class_name_train 92_500 --class_name_test 92_100
2021-09-08 14:44:54.790159: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  cifar_100
class_name_train =  92_500
class_name_test =  92_100
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 14:44:57.410075: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 14:44:57.435029: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 14:44:57.439788: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 14:44:57.447813: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:44:57.450080: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:44:57.455210: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 14:44:57.458622: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 14:44:57.464973: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 14:44:57.470059: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 14:44:57.473102: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:44:57.475304: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 14:44:57.477422: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 14:44:57.489888: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x19d39f0a060 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 14:44:57.493608: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 14:44:57.495679: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 14:44:57.500133: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 14:44:57.502275: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:44:57.504434: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:44:57.506798: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 14:44:57.508937: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 14:44:57.511154: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 14:44:57.513338: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 14:44:57.515857: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:44:57.518068: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 14:44:57.948088: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 14:44:57.950939: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 14:44:57.952338: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 14:44:57.953935: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 14:44:57.960759: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x19d655f08c0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 14:44:57.963755: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 14:44:59.980004: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 14:45:00.687298: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:45:01.346973: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:45:01.353171: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:45:02.691718: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 14:45:02.741353: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 14:45:03.465449: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 5s 48ms/step
[INFOR]: Index of most vote   :392
[INFOR]: Class of most vote   :rock beauty, Holocanthus tricolor
[INFOR]: Number of most vote  :54.0


[INFOR]: Index of second most vote     :945
[INFOR]: Class of second most vote     :bell pepper
[INFOR]: Number of second most vote    :51.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 2s 31ms/step
[INFOR]: Toltal norm before transform: 0.8800
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0044

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 1s 32ms/step
[INFOR]: SEN training of class 92_500 before transform: 54
[INFOR]: SPE training of class 92_500 before transform: 479

[INFOR]: SEN training of class 92_500 after transform: 408
[INFOR]: SPE training of class 92_500 after transform: 361
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 32ms/step
[INFOR]: Index of most vote   :946
[INFOR]: Class of most vote   :cardoon
[INFOR]: Number of most vote  :16.0


[INFOR]: Index of second most vote     :723
[INFOR]: Class of second most vote     :pinwheel
[INFOR]: Number of second most vote    :12.0
[INFOR]: SEN testing of class 92_100 before transform: 16
[INFOR]: SPE testing of class 92_100 before transform: 100

[INFOR]: SEN testing of class 92_100 after transform: 96
[INFOR]: SPE testing of class 92_100 after transform: 14
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name cifar_100 --class_name_train 93_500 --class_name_test 93_100
2021-09-08 14:45:11.707378: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  cifar_100
class_name_train =  93_500
class_name_test =  93_100
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 14:45:14.243340: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 14:45:14.266568: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 14:45:14.271161: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 14:45:14.278931: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:45:14.281104: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:45:14.286102: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 14:45:14.289658: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 14:45:14.296064: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 14:45:14.300971: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 14:45:14.303954: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:45:14.306105: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 14:45:14.308102: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 14:45:14.319869: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x257b4613840 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 14:45:14.323188: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 14:45:14.325282: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 14:45:14.329766: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 14:45:14.331908: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:45:14.334138: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:45:14.336331: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 14:45:14.338582: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 14:45:14.340713: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 14:45:14.342927: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 14:45:14.345117: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:45:14.347327: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 14:45:14.771414: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 14:45:14.774040: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 14:45:14.775388: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 14:45:14.776883: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 14:45:14.783622: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x257e34a8fb0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 14:45:14.786548: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 14:45:16.747959: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 14:45:17.426032: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:45:18.077459: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:45:18.084004: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:45:19.425160: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 14:45:19.474056: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 14:45:20.200033: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 5s 47ms/step
[INFOR]: Index of most vote   :103
[INFOR]: Class of most vote   :platypus, duckbill, duckbilled platypus, duck-billed platypus, Ornithorhynchus anatinus
[INFOR]: Number of most vote  :48.0


[INFOR]: Index of second most vote     :125
[INFOR]: Class of second most vote     :hermit crab
[INFOR]: Number of second most vote    :36.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 2s 32ms/step
[INFOR]: Toltal norm before transform: 0.8953
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0560

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 1s 32ms/step
[INFOR]: SEN training of class 93_500 before transform: 48
[INFOR]: SPE training of class 93_500 before transform: 491

[INFOR]: SEN training of class 93_500 after transform: 343
[INFOR]: SPE training of class 93_500 after transform: 309
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 31ms/step
[INFOR]: Index of most vote   :103
[INFOR]: Class of most vote   :platypus, duckbill, duckbilled platypus, duck-billed platypus, Ornithorhynchus anatinus
[INFOR]: Number of most vote  :14.0


[INFOR]: Index of second most vote     :125
[INFOR]: Class of second most vote     :hermit crab
[INFOR]: Number of second most vote    :5.0
[INFOR]: SEN testing of class 93_100 before transform: 14
[INFOR]: SPE testing of class 93_100 before transform: 97

[INFOR]: SEN testing of class 93_100 after transform: 98
[INFOR]: SPE testing of class 93_100 after transform: 1
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name cifar_100 --class_name_train 94_500 --class_name_test 94_100
2021-09-08 14:45:28.462898: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  cifar_100
class_name_train =  94_500
class_name_test =  94_100
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 14:45:31.078838: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 14:45:31.103287: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 14:45:31.108014: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 14:45:31.116092: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:45:31.118275: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:45:31.123354: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 14:45:31.126877: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 14:45:31.133317: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 14:45:31.138179: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 14:45:31.141142: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:45:31.143285: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 14:45:31.145174: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 14:45:31.157578: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1bab34700a0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 14:45:31.161262: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 14:45:31.163272: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 14:45:31.167579: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 14:45:31.169694: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:45:31.171957: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:45:31.174307: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 14:45:31.176476: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 14:45:31.178683: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 14:45:31.180846: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 14:45:31.182974: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:45:31.185161: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 14:45:31.614533: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 14:45:31.617095: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 14:45:31.618472: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 14:45:31.619986: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 14:45:31.626621: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1badeb36240 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 14:45:31.629571: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 14:45:33.609970: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 14:45:34.315038: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:45:34.967565: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:45:34.973900: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:45:36.318162: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 14:45:36.365547: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 14:45:37.085723: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 5s 47ms/step
[INFOR]: Index of most vote   :631
[INFOR]: Class of most vote   :lotion
[INFOR]: Number of most vote  :112.0


[INFOR]: Index of second most vote     :781
[INFOR]: Class of second most vote     :scoreboard
[INFOR]: Number of second most vote    :50.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 2s 32ms/step
[INFOR]: Toltal norm before transform: 0.7713
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.3005

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 1s 32ms/step
[INFOR]: SEN training of class 94_500 before transform: 112
[INFOR]: SPE training of class 94_500 before transform: 493

[INFOR]: SEN training of class 94_500 after transform: 472
[INFOR]: SPE training of class 94_500 after transform: 426
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 31ms/step
[INFOR]: Index of most vote   :631
[INFOR]: Class of most vote   :lotion
[INFOR]: Number of most vote  :24.0


[INFOR]: Index of second most vote     :781
[INFOR]: Class of second most vote     :scoreboard
[INFOR]: Number of second most vote    :9.0
[INFOR]: SEN testing of class 94_100 before transform: 24
[INFOR]: SPE testing of class 94_100 before transform: 98

[INFOR]: SEN testing of class 94_100 after transform: 98
[INFOR]: SPE testing of class 94_100 after transform: 41
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name cifar_100 --class_name_train 95_500 --class_name_test 95_100
2021-09-08 14:45:45.358931: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  cifar_100
class_name_train =  95_500
class_name_test =  95_100
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 14:45:47.929513: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 14:45:47.953554: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 14:45:47.957757: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 14:45:47.965666: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:45:47.967755: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:45:47.972925: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 14:45:47.976228: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 14:45:47.982411: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 14:45:47.987299: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 14:45:47.990257: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:45:47.992536: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 14:45:47.994560: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 14:45:48.006796: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x27ab40b2a20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 14:45:48.010053: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 14:45:48.012077: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 14:45:48.016503: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 14:45:48.018823: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:45:48.020978: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:45:48.023271: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 14:45:48.025443: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 14:45:48.027596: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 14:45:48.029845: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 14:45:48.032029: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:45:48.034294: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 14:45:48.464303: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 14:45:48.467643: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 14:45:48.469080: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 14:45:48.470541: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 14:45:48.477218: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x27ad86893d0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 14:45:48.480036: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 14:45:50.457021: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 14:45:51.147333: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:45:51.798102: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:45:51.804477: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:45:53.156831: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 14:45:53.204986: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 14:45:53.926365: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 5s 47ms/step
[INFOR]: Index of most vote   :103
[INFOR]: Class of most vote   :platypus, duckbill, duckbilled platypus, duck-billed platypus, Ornithorhynchus anatinus
[INFOR]: Number of most vote  :36.0


[INFOR]: Index of second most vote     :98
[INFOR]: Class of second most vote     :red-breasted merganser, Mergus serrator
[INFOR]: Number of second most vote    :35.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 2s 32ms/step
[INFOR]: Toltal norm before transform: 0.9313
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1898

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 1s 32ms/step
[INFOR]: SEN training of class 95_500 before transform: 36
[INFOR]: SPE training of class 95_500 before transform: 484

[INFOR]: SEN training of class 95_500 after transform: 444
[INFOR]: SPE training of class 95_500 after transform: 416
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 32ms/step
[INFOR]: Index of most vote   :98
[INFOR]: Class of most vote   :red-breasted merganser, Mergus serrator
[INFOR]: Number of most vote  :8.0


[INFOR]: Index of second most vote     :725
[INFOR]: Class of second most vote     :pitcher, ewer
[INFOR]: Number of second most vote    :8.0
[INFOR]: SEN testing of class 95_100 before transform: 8
[INFOR]: SPE testing of class 95_100 before transform: 100

[INFOR]: SEN testing of class 95_100 after transform: 96
[INFOR]: SPE testing of class 95_100 after transform: 54
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name cifar_100 --class_name_train 96_500 --class_name_test 96_100
2021-09-08 14:46:02.153062: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  cifar_100
class_name_train =  96_500
class_name_test =  96_100
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 14:46:04.708499: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 14:46:04.735352: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 14:46:04.739959: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 14:46:04.747751: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:46:04.750044: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:46:04.755083: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 14:46:04.758449: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 14:46:04.764714: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 14:46:04.769599: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 14:46:04.772520: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:46:04.774687: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 14:46:04.776586: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 14:46:04.789148: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x208b799b920 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 14:46:04.792817: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 14:46:04.794819: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 14:46:04.799000: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 14:46:04.801290: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:46:04.803493: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:46:04.805612: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 14:46:04.807777: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 14:46:04.809993: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 14:46:04.812182: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 14:46:04.814665: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:46:04.816812: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 14:46:05.243211: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 14:46:05.246030: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 14:46:05.247432: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 14:46:05.248951: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 14:46:05.255523: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x208e6a37170 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 14:46:05.258524: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 14:46:07.240354: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 14:46:07.920217: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:46:08.576321: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:46:08.582609: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:46:09.926561: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 14:46:09.976574: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 14:46:10.695266: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 5s 47ms/step
[INFOR]: Index of most vote   :252
[INFOR]: Class of most vote   :affenpinscher, monkey pinscher, monkey dog
[INFOR]: Number of most vote  :48.0


[INFOR]: Index of second most vote     :945
[INFOR]: Class of second most vote     :bell pepper
[INFOR]: Number of second most vote    :39.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 2s 31ms/step
[INFOR]: Toltal norm before transform: 0.8906
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1821

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 1s 31ms/step
[INFOR]: SEN training of class 96_500 before transform: 48
[INFOR]: SPE training of class 96_500 before transform: 494

[INFOR]: SEN training of class 96_500 after transform: 464
[INFOR]: SPE training of class 96_500 after transform: 383
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 32ms/step
[INFOR]: Index of most vote   :147
[INFOR]: Class of most vote   :grey whale, gray whale, devilfish, Eschrichtius gibbosus, Eschrichtius robustus
[INFOR]: Number of most vote  :12.0


[INFOR]: Index of second most vote     :251
[INFOR]: Class of second most vote     :dalmatian, coach dog, carriage dog
[INFOR]: Number of second most vote    :12.0
[INFOR]: SEN testing of class 96_100 before transform: 12
[INFOR]: SPE testing of class 96_100 before transform: 99

[INFOR]: SEN testing of class 96_100 after transform: 99
[INFOR]: SPE testing of class 96_100 after transform: 9
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name cifar_100 --class_name_train 97_500 --class_name_test 97_100
2021-09-08 14:46:18.928254: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  cifar_100
class_name_train =  97_500
class_name_test =  97_100
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 14:46:21.514136: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 14:46:21.538019: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 14:46:21.542429: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 14:46:21.550220: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:46:21.552475: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:46:21.557652: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 14:46:21.561030: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 14:46:21.567309: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 14:46:21.572175: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 14:46:21.575158: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:46:21.577305: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 14:46:21.579206: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 14:46:21.591656: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x153353ac060 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 14:46:21.595332: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 14:46:21.597415: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 14:46:21.601852: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 14:46:21.604034: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:46:21.606161: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:46:21.608439: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 14:46:21.610644: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 14:46:21.612876: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 14:46:21.615164: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 14:46:21.617400: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:46:21.619683: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 14:46:22.052917: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 14:46:22.055329: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 14:46:22.056700: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 14:46:22.058195: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 14:46:22.064984: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x15364e1dc70 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 14:46:22.067985: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 14:46:24.061190: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 14:46:24.763134: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:46:25.421672: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:46:25.427927: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:46:26.773562: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 14:46:26.822156: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 14:46:27.541249: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 5s 47ms/step
[INFOR]: Index of most vote   :269
[INFOR]: Class of most vote   :timber wolf, grey wolf, gray wolf, Canis lupus
[INFOR]: Number of most vote  :82.0


[INFOR]: Index of second most vote     :248
[INFOR]: Class of second most vote     :Eskimo dog, husky
[INFOR]: Number of second most vote    :42.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 2s 32ms/step
[INFOR]: Toltal norm before transform: 0.7815
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0921

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 1s 32ms/step
[INFOR]: SEN training of class 97_500 before transform: 82
[INFOR]: SPE training of class 97_500 before transform: 500

[INFOR]: SEN training of class 97_500 after transform: 365
[INFOR]: SPE training of class 97_500 after transform: 363
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 32ms/step
[INFOR]: Index of most vote   :269
[INFOR]: Class of most vote   :timber wolf, grey wolf, gray wolf, Canis lupus
[INFOR]: Number of most vote  :21.0


[INFOR]: Index of second most vote     :278
[INFOR]: Class of second most vote     :kit fox, Vulpes macrotis
[INFOR]: Number of second most vote    :5.0
[INFOR]: SEN testing of class 97_100 before transform: 21
[INFOR]: SPE testing of class 97_100 before transform: 100

[INFOR]: SEN testing of class 97_100 after transform: 82
[INFOR]: SPE testing of class 97_100 after transform: 48
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name cifar_100 --class_name_train 98_500 --class_name_test 98_100
2021-09-08 14:46:35.778790: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  cifar_100
class_name_train =  98_500
class_name_test =  98_100
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 14:46:38.341992: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 14:46:38.373970: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 14:46:38.378598: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 14:46:38.386416: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:46:38.388700: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:46:38.393723: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 14:46:38.397761: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 14:46:38.404135: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 14:46:38.409204: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 14:46:38.412102: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:46:38.414248: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 14:46:38.416146: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 14:46:38.428142: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x230ba8f2180 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 14:46:38.431225: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 14:46:38.433270: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 14:46:38.437493: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 14:46:38.439707: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:46:38.441840: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:46:38.443999: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 14:46:38.446142: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 14:46:38.448331: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 14:46:38.450562: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 14:46:38.452722: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:46:38.454957: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 14:46:38.874323: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 14:46:38.877347: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 14:46:38.878763: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 14:46:38.880363: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 14:46:38.887415: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x230e901cd60 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 14:46:38.890269: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 14:46:40.852864: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 14:46:41.533336: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:46:42.195675: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:46:42.202039: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:46:43.545671: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 14:46:43.595086: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 14:46:44.357405: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 5s 48ms/step
[INFOR]: Index of most vote   :906
[INFOR]: Class of most vote   :Windsor tie
[INFOR]: Number of most vote  :41.0


[INFOR]: Index of second most vote     :714
[INFOR]: Class of second most vote     :pick, plectrum, plectron
[INFOR]: Number of second most vote    :32.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 2s 32ms/step
[INFOR]: Toltal norm before transform: 0.8993
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.3984

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 1s 32ms/step
[INFOR]: SEN training of class 98_500 before transform: 41
[INFOR]: SPE training of class 98_500 before transform: 489

[INFOR]: SEN training of class 98_500 after transform: 383
[INFOR]: SPE training of class 98_500 after transform: 361
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 32ms/step
[INFOR]: Index of most vote   :714
[INFOR]: Class of most vote   :pick, plectrum, plectron
[INFOR]: Number of most vote  :9.0


[INFOR]: Index of second most vote     :465
[INFOR]: Class of second most vote     :bulletproof vest
[INFOR]: Number of second most vote    :8.0
[INFOR]: SEN testing of class 98_100 before transform: 9
[INFOR]: SPE testing of class 98_100 before transform: 99

[INFOR]: SEN testing of class 98_100 after transform: 99
[INFOR]: SPE testing of class 98_100 after transform: 0
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3  --model_shape 299 299 --dataset_name cifar_100 --class_name_train 99_500 --class_name_test 99_100
2021-09-08 14:46:52.625681: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
dataset_name =  cifar_100
class_name_train =  99_500
class_name_test =  99_100
data_shape =  (32, 32, 3)
model_shape =  [299, 299]
output_dir =  output/csv_data
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (1000, 32, 32, 3)
[INFOR]: shape of y: (1000, 1)
[INFOR]: get pretrained model
2021-09-08 14:46:55.205093: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-09-08 14:46:55.229660: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 14:46:55.234288: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 14:46:55.242279: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:46:55.244455: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:46:55.249575: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 14:46:55.252993: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 14:46:55.259467: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 14:46:55.264885: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 14:46:55.267897: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:46:55.270107: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 14:46:55.272030: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-09-08 14:46:55.284807: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x21a34c4ca40 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-08 14:46:55.288470: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-08 14:46:55.290516: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-09-08 14:46:55.294858: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-09-08 14:46:55.296996: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:46:55.299290: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:46:55.302248: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-09-08 14:46:55.304533: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-09-08 14:46:55.306706: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-09-08 14:46:55.308944: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-09-08 14:46:55.311140: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:46:55.313373: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 14:46:55.735304: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 14:46:55.738142: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-09-08 14:46:55.739627: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-09-08 14:46:55.741091: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 14:46:55.747898: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x21a5d6cc960 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-08 14:46:55.750799: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-09-08 14:46:57.720555: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 14:46:58.414599: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-09-08 14:46:59.073069: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-09-08 14:46:59.079794: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-09-08 14:47:00.447137: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 14:47:00.496536: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-09-08 14:47:01.289585: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
32/32 [==============================] - 5s 49ms/step
[INFOR]: Index of most vote   :111
[INFOR]: Class of most vote   :nematode, nematode worm, roundworm
[INFOR]: Number of most vote  :278.0


[INFOR]: Index of second most vote     :771
[INFOR]: Class of second most vote     :safe
[INFOR]: Number of second most vote    :18.0

[INFOR]: Create PDF for Positive Label

32/32 [==============================] - 2s 31ms/step
[INFOR]: Toltal norm before transform: 0.3703
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0797

[INFOR]: Create PDF for Negative Label

32/32 [==============================] - 1s 31ms/step
[INFOR]: SEN training of class 99_500 before transform: 278
[INFOR]: SPE training of class 99_500 before transform: 497

[INFOR]: SEN training of class 99_500 after transform: 429
[INFOR]: SPE training of class 99_500 after transform: 416
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (200, 32, 32, 3)
[INFOR]: shape of y: (200, 1)
7/7 [==============================] - 0s 31ms/step
[INFOR]: Index of most vote   :111
[INFOR]: Class of most vote   :nematode, nematode worm, roundworm
[INFOR]: Number of most vote  :54.0


[INFOR]: Index of second most vote     :713
[INFOR]: Class of second most vote     :photocopier
[INFOR]: Number of second most vote    :6.0
[INFOR]: SEN testing of class 99_100 before transform: 54
[INFOR]: SPE testing of class 99_100 before transform: 99

[INFOR]: SEN testing of class 99_100 after transform: 92
[INFOR]: SPE testing of class 99_100 after transform: 24
[INFOR]: Complete save data

C:\Users\LauNT\Desktop\topology>