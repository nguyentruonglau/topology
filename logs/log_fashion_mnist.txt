
C:\Users\LauNT\Desktop\topology>run_fashion_mnist.bat

C:\Users\LauNT\Desktop\topology>python main.py --model_name ResNet50 --data_shape 28 28 3 --model_shape 224 224 --data_name fashion_mnist --class_name t-shirt --num_img_train 6000 --num_img_test 1000
2021-07-27 10:42:26.365085: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  ResNet50
data_name =  fashion_mnist
class_name =  t-shirt
data_shape =  [28, 28, 3]
model_shape =  [224, 224]
output_dir =  ./output/npy_data
num_img_train =  6000
num_img_test =  1000
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (12000, 28, 28, 3)
[INFOR]: shape of y: (12000, 1)
[INFOR]: get pretrained model
2021-07-27 10:42:28.993968: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-07-27 10:42:29.028642: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-07-27 10:42:29.033579: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-07-27 10:42:29.048881: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 10:42:29.051057: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 10:42:29.056355: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-07-27 10:42:29.059947: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-07-27 10:42:29.066266: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-07-27 10:42:29.071524: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-07-27 10:42:29.074621: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 10:42:29.076888: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-07-27 10:42:29.078849: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-07-27 10:42:29.090723: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1cabbc2e580 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-07-27 10:42:29.093866: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-07-27 10:42:29.095966: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-07-27 10:42:29.100486: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-07-27 10:42:29.102765: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 10:42:29.105166: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 10:42:29.107286: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-07-27 10:42:29.109561: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-07-27 10:42:29.111740: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-07-27 10:42:29.114425: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-07-27 10:42:29.116540: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 10:42:29.118634: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-07-27 10:42:29.560697: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-07-27 10:42:29.563801: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-07-27 10:42:29.565265: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-07-27 10:42:29.566789: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-07-27 10:42:29.573681: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1caeada3b90 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-07-27 10:42:29.576554: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-07-27 10:42:31.243861: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-07-27 10:42:31.732481: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 10:42:32.402677: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 10:42:32.408570: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 10:42:33.801054: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-07-27 10:42:33.855484: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-07-27 10:42:34.164201: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
375/375 [==============================] - 13s 26ms/step
[INFOR]: Index of most vote   :610
[INFOR]: Class of most vote   :jersey, T-shirt, tee shirt
[INFOR]: Number of most vote  :2402.0


[INFOR]: Index of second most vote     :499
[INFOR]: Class of second most vote     :cleaver, meat cleaver, chopper
[INFOR]: Number of second most vote    :954.0

[INFOR]: Create PDF for Positive Label

375/375 [==============================] - 10s 25ms/step
[INFOR]: Toltal norm before transform: 0.5481
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.2335

[INFOR]: Create PDF for Negative Label

375/375 [==============================] - 10s 25ms/step
[INFOR]: Recall training of class t-shirt before transform: 2402
[INFOR]: Recall training of class not t-shirt before transform: 5901

[INFOR]: Recall training of class t-shirt after transform: 5201
[INFOR]: Recall training of class not t-shirt after transform: 4299
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (2000, 28, 28, 3)
[INFOR]: shape of y: (2000, 1)
63/63 [==============================] - 2s 26ms/step
[INFOR]: Index of most vote   :610
[INFOR]: Class of most vote   :jersey, T-shirt, tee shirt
[INFOR]: Number of most vote  :406.0


[INFOR]: Index of second most vote     :499
[INFOR]: Class of second most vote     :cleaver, meat cleaver, chopper
[INFOR]: Number of second most vote    :160.0
[INFOR]: Recall testing of class t-shirt before transform: 406
[INFOR]: Recall testing of class not t-shirt before transform: 988

[INFOR]: Recall testing of class t-shirt after transform: 949
[INFOR]: Recall testing of class not t-shirt after transform: 386
[INFOR]: Complete save data
[INFOR] TOLTAL TIME: 90.538

C:\Users\LauNT\Desktop\topology>python main.py --model_name ResNet50 --data_shape 28 28 3 --model_shape 224 224 --data_name fashion_mnist --class_name trouser --num_img_train 6000 --num_img_test 1000
2021-07-27 10:44:01.400936: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  ResNet50
data_name =  fashion_mnist
class_name =  trouser
data_shape =  [28, 28, 3]
model_shape =  [224, 224]
output_dir =  ./output/npy_data
num_img_train =  6000
num_img_test =  1000
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (12000, 28, 28, 3)
[INFOR]: shape of y: (12000, 1)
[INFOR]: get pretrained model
2021-07-27 10:44:03.941089: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-07-27 10:44:03.966220: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-07-27 10:44:03.970641: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-07-27 10:44:03.985405: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 10:44:03.987688: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 10:44:03.993074: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-07-27 10:44:03.996600: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-07-27 10:44:04.003113: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-07-27 10:44:04.008201: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-07-27 10:44:04.011149: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 10:44:04.013294: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-07-27 10:44:04.015240: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-07-27 10:44:04.027274: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x2263fb39860 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-07-27 10:44:04.030406: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-07-27 10:44:04.032536: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-07-27 10:44:04.036900: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-07-27 10:44:04.039180: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 10:44:04.041473: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 10:44:04.043684: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-07-27 10:44:04.045864: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-07-27 10:44:04.047994: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-07-27 10:44:04.050359: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-07-27 10:44:04.052650: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 10:44:04.054816: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-07-27 10:44:04.469166: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-07-27 10:44:04.471424: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-07-27 10:44:04.472845: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-07-27 10:44:04.474546: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-07-27 10:44:04.481235: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x2266a309270 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-07-27 10:44:04.484027: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-07-27 10:44:06.176747: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-07-27 10:44:06.670477: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 10:44:07.327614: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 10:44:07.333245: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 10:44:08.722770: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-07-27 10:44:08.776247: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-07-27 10:44:09.089701: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
375/375 [==============================] - 12s 26ms/step
[INFOR]: Index of most vote   :813
[INFOR]: Class of most vote   :spatula
[INFOR]: Number of most vote  :2148.0


[INFOR]: Index of second most vote     :473
[INFOR]: Class of second most vote     :can opener, tin opener
[INFOR]: Number of second most vote    :803.0

[INFOR]: Create PDF for Positive Label

375/375 [==============================] - 10s 25ms/step
[INFOR]: Toltal norm before transform: 0.5775
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.2646

[INFOR]: Create PDF for Negative Label

375/375 [==============================] - 9s 25ms/step
[INFOR]: Recall training of class trouser before transform: 2148
[INFOR]: Recall training of class not trouser before transform: 5674

[INFOR]: Recall training of class trouser after transform: 5677
[INFOR]: Recall training of class not trouser after transform: 5211
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (2000, 28, 28, 3)
[INFOR]: shape of y: (2000, 1)
63/63 [==============================] - 2s 26ms/step
[INFOR]: Index of most vote   :813
[INFOR]: Class of most vote   :spatula
[INFOR]: Number of most vote  :343.0


[INFOR]: Index of second most vote     :473
[INFOR]: Class of second most vote     :can opener, tin opener
[INFOR]: Number of second most vote    :119.0
[INFOR]: Recall testing of class trouser before transform: 343
[INFOR]: Recall testing of class not trouser before transform: 951

[INFOR]: Recall testing of class trouser after transform: 927
[INFOR]: Recall testing of class not trouser after transform: 848
[INFOR]: Complete save data
[INFOR] TOLTAL TIME: 88.9514

C:\Users\LauNT\Desktop\topology>python main.py --model_name ResNet50 --data_shape 28 28 3 --model_shape 224 224 --data_name fashion_mnist --class_name pullover --num_img_train 6000 --num_img_test 1000
2021-07-27 10:45:34.760056: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  ResNet50
data_name =  fashion_mnist
class_name =  pullover
data_shape =  [28, 28, 3]
model_shape =  [224, 224]
output_dir =  ./output/npy_data
num_img_train =  6000
num_img_test =  1000
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (12000, 28, 28, 3)
[INFOR]: shape of y: (12000, 1)
[INFOR]: get pretrained model
2021-07-27 10:45:37.405759: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-07-27 10:45:37.429691: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-07-27 10:45:37.434275: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-07-27 10:45:37.449303: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 10:45:37.451474: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 10:45:37.456750: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-07-27 10:45:37.460175: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-07-27 10:45:37.466537: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-07-27 10:45:37.471531: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-07-27 10:45:37.474616: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 10:45:37.476756: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-07-27 10:45:37.478640: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-07-27 10:45:37.490775: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x2c5bfedb9b0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-07-27 10:45:37.494027: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-07-27 10:45:37.496168: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-07-27 10:45:37.500614: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-07-27 10:45:37.502871: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 10:45:37.505183: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 10:45:37.507862: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-07-27 10:45:37.510045: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-07-27 10:45:37.512346: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-07-27 10:45:37.514514: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-07-27 10:45:37.516680: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 10:45:37.519014: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-07-27 10:45:37.948387: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-07-27 10:45:37.951079: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-07-27 10:45:37.952504: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-07-27 10:45:37.954183: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-07-27 10:45:37.961110: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x2c5e2f964c0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-07-27 10:45:37.963893: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-07-27 10:45:39.659418: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-07-27 10:45:40.153676: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 10:45:40.802505: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 10:45:40.808440: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 10:45:42.154474: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-07-27 10:45:42.202667: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-07-27 10:45:42.507085: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
375/375 [==============================] - 12s 25ms/step
[INFOR]: Index of most vote   :499
[INFOR]: Class of most vote   :cleaver, meat cleaver, chopper
[INFOR]: Number of most vote  :1132.0


[INFOR]: Index of second most vote     :812
[INFOR]: Class of second most vote     :space shuttle
[INFOR]: Number of second most vote    :1019.0

[INFOR]: Create PDF for Positive Label

375/375 [==============================] - 10s 26ms/step
[INFOR]: Toltal norm before transform: 0.7831
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.2716

[INFOR]: Create PDF for Negative Label

375/375 [==============================] - 10s 26ms/step
[INFOR]: Recall training of class pullover before transform: 1132
[INFOR]: Recall training of class not pullover before transform: 5480

[INFOR]: Recall training of class pullover after transform: 5368
[INFOR]: Recall training of class not pullover after transform: 4154
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (2000, 28, 28, 3)
[INFOR]: shape of y: (2000, 1)
63/63 [==============================] - 2s 26ms/step
[INFOR]: Index of most vote   :499
[INFOR]: Class of most vote   :cleaver, meat cleaver, chopper
[INFOR]: Number of most vote  :206.0


[INFOR]: Index of second most vote     :812
[INFOR]: Class of second most vote     :space shuttle
[INFOR]: Number of second most vote    :159.0
[INFOR]: Recall testing of class pullover before transform: 206
[INFOR]: Recall testing of class not pullover before transform: 920

[INFOR]: Recall testing of class pullover after transform: 934
[INFOR]: Recall testing of class not pullover after transform: 548
[INFOR]: Complete save data
[INFOR] TOLTAL TIME: 85.281

C:\Users\LauNT\Desktop\topology>python main.py --model_name ResNet50 --data_shape 28 28 3 --model_shape 224 224 --data_name fashion_mnist --class_name dress --num_img_train 6000 --num_img_test 1000
2021-07-27 10:47:04.424760: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  ResNet50
data_name =  fashion_mnist
class_name =  dress
data_shape =  [28, 28, 3]
model_shape =  [224, 224]
output_dir =  ./output/npy_data
num_img_train =  6000
num_img_test =  1000
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (12000, 28, 28, 3)
[INFOR]: shape of y: (12000, 1)
[INFOR]: get pretrained model
2021-07-27 10:47:06.897775: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-07-27 10:47:06.922323: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-07-27 10:47:06.926866: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-07-27 10:47:06.941494: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 10:47:06.943631: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 10:47:06.948938: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-07-27 10:47:06.952459: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-07-27 10:47:06.958812: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-07-27 10:47:06.963761: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-07-27 10:47:06.966649: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 10:47:06.969125: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-07-27 10:47:06.971180: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-07-27 10:47:06.983371: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x2043ad0f5c0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-07-27 10:47:06.986478: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-07-27 10:47:06.988600: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-07-27 10:47:06.993213: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-07-27 10:47:06.995743: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 10:47:06.997947: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 10:47:07.000149: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-07-27 10:47:07.002434: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-07-27 10:47:07.004672: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-07-27 10:47:07.006963: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-07-27 10:47:07.009186: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 10:47:07.011406: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-07-27 10:47:07.432997: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-07-27 10:47:07.435337: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-07-27 10:47:07.436782: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-07-27 10:47:07.438324: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-07-27 10:47:07.445052: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x20460400a10 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-07-27 10:47:07.447767: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-07-27 10:47:09.131759: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-07-27 10:47:09.621472: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 10:47:10.274281: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 10:47:10.280256: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 10:47:11.617950: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-07-27 10:47:11.664033: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-07-27 10:47:11.972634: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
375/375 [==============================] - 12s 25ms/step
[INFOR]: Index of most vote   :499
[INFOR]: Class of most vote   :cleaver, meat cleaver, chopper
[INFOR]: Number of most vote  :675.0


[INFOR]: Index of second most vote     :473
[INFOR]: Class of second most vote     :can opener, tin opener
[INFOR]: Number of second most vote    :628.0

[INFOR]: Create PDF for Positive Label

375/375 [==============================] - 10s 25ms/step
[INFOR]: Toltal norm before transform: 0.8689
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.2712

[INFOR]: Create PDF for Negative Label

375/375 [==============================] - 10s 26ms/step
[INFOR]: Recall training of class dress before transform: 675
[INFOR]: Recall training of class not dress before transform: 5433

[INFOR]: Recall training of class dress after transform: 3922
[INFOR]: Recall training of class not dress after transform: 3942
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (2000, 28, 28, 3)
[INFOR]: shape of y: (2000, 1)
63/63 [==============================] - 2s 27ms/step
[INFOR]: Index of most vote   :499
[INFOR]: Class of most vote   :cleaver, meat cleaver, chopper
[INFOR]: Number of most vote  :113.0


[INFOR]: Index of second most vote     :473
[INFOR]: Class of second most vote     :can opener, tin opener
[INFOR]: Number of second most vote    :101.0
[INFOR]: Recall testing of class dress before transform: 113
[INFOR]: Recall testing of class not dress before transform: 889

[INFOR]: Recall testing of class dress after transform: 914
[INFOR]: Recall testing of class not dress after transform: 109
[INFOR]: Complete save data
[INFOR] TOLTAL TIME: 84.8022

C:\Users\LauNT\Desktop\topology>python main.py --model_name ResNet50 --data_shape 28 28 3 --model_shape 224 224 --data_name fashion_mnist --class_name coat --num_img_train 6000 --num_img_test 1000
2021-07-27 10:48:33.624474: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  ResNet50
data_name =  fashion_mnist
class_name =  coat
data_shape =  [28, 28, 3]
model_shape =  [224, 224]
output_dir =  ./output/npy_data
num_img_train =  6000
num_img_test =  1000
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (12000, 28, 28, 3)
[INFOR]: shape of y: (12000, 1)
[INFOR]: get pretrained model
2021-07-27 10:48:36.241256: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-07-27 10:48:36.266595: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-07-27 10:48:36.271504: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-07-27 10:48:36.279462: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 10:48:36.282170: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 10:48:36.287867: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-07-27 10:48:36.291459: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-07-27 10:48:36.297678: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-07-27 10:48:36.302556: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-07-27 10:48:36.305513: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 10:48:36.307822: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-07-27 10:48:36.309871: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-07-27 10:48:36.322150: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x2d0ba76b090 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-07-27 10:48:36.325077: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-07-27 10:48:36.327341: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-07-27 10:48:36.331712: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-07-27 10:48:36.333966: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 10:48:36.336281: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 10:48:36.338510: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-07-27 10:48:36.340761: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-07-27 10:48:36.342980: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-07-27 10:48:36.345684: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-07-27 10:48:36.347982: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 10:48:36.350260: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-07-27 10:48:36.783409: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-07-27 10:48:36.786467: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-07-27 10:48:36.788224: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-07-27 10:48:36.790084: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-07-27 10:48:36.797861: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x2d0e4dd1380 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-07-27 10:48:36.801610: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-07-27 10:48:38.575844: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-07-27 10:48:39.103913: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 10:48:39.759821: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 10:48:39.765973: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 10:48:41.109529: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-07-27 10:48:41.162655: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-07-27 10:48:41.470579: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
375/375 [==============================] - 12s 25ms/step
[INFOR]: Index of most vote   :499
[INFOR]: Class of most vote   :cleaver, meat cleaver, chopper
[INFOR]: Number of most vote  :936.0


[INFOR]: Index of second most vote     :500
[INFOR]: Class of second most vote     :cliff dwelling
[INFOR]: Number of second most vote    :699.0

[INFOR]: Create PDF for Positive Label

375/375 [==============================] - 10s 26ms/step
[INFOR]: Toltal norm before transform: 0.8197
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0820

[INFOR]: Create PDF for Negative Label

375/375 [==============================] - 10s 26ms/step
[INFOR]: Recall training of class coat before transform: 936
[INFOR]: Recall training of class not coat before transform: 5474

[INFOR]: Recall training of class coat after transform: 5048
[INFOR]: Recall training of class not coat after transform: 3934
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (2000, 28, 28, 3)
[INFOR]: shape of y: (2000, 1)
63/63 [==============================] - 2s 26ms/step
[INFOR]: Index of most vote   :499
[INFOR]: Class of most vote   :cleaver, meat cleaver, chopper
[INFOR]: Number of most vote  :163.0


[INFOR]: Index of second most vote     :500
[INFOR]: Class of second most vote     :cliff dwelling
[INFOR]: Number of second most vote    :124.0
[INFOR]: Recall testing of class coat before transform: 163
[INFOR]: Recall testing of class not coat before transform: 914

[INFOR]: Recall testing of class coat after transform: 945
[INFOR]: Recall testing of class not coat after transform: 356
[INFOR]: Complete save data
[INFOR] TOLTAL TIME: 86.4093

C:\Users\LauNT\Desktop\topology>python main.py --model_name ResNet50 --data_shape 28 28 3 --model_shape 224 224 --data_name fashion_mnist --class_name sandal --num_img_train 6000 --num_img_test 1000
2021-07-27 10:50:04.508888: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  ResNet50
data_name =  fashion_mnist
class_name =  sandal
data_shape =  [28, 28, 3]
model_shape =  [224, 224]
output_dir =  ./output/npy_data
num_img_train =  6000
num_img_test =  1000
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (12000, 28, 28, 3)
[INFOR]: shape of y: (12000, 1)
[INFOR]: get pretrained model
2021-07-27 10:50:07.038589: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-07-27 10:50:07.084376: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-07-27 10:50:07.089346: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-07-27 10:50:07.097191: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 10:50:07.099381: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 10:50:07.104476: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-07-27 10:50:07.107930: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-07-27 10:50:07.114010: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-07-27 10:50:07.118822: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-07-27 10:50:07.121830: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 10:50:07.124035: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-07-27 10:50:07.126060: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-07-27 10:50:07.138932: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x2c2bc604050 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-07-27 10:50:07.142280: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-07-27 10:50:07.144352: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-07-27 10:50:07.148650: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-07-27 10:50:07.151283: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 10:50:07.153489: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 10:50:07.155722: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-07-27 10:50:07.158025: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-07-27 10:50:07.160212: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-07-27 10:50:07.162386: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-07-27 10:50:07.164591: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 10:50:07.166779: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-07-27 10:50:07.607757: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-07-27 10:50:07.610459: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-07-27 10:50:07.611874: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-07-27 10:50:07.613447: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-07-27 10:50:07.620039: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x2c2e722b660 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-07-27 10:50:07.622831: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-07-27 10:50:09.307191: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-07-27 10:50:09.806389: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 10:50:10.461232: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 10:50:10.466884: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 10:50:11.820204: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-07-27 10:50:11.867013: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-07-27 10:50:12.174667: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
375/375 [==============================] - 12s 26ms/step
[INFOR]: Index of most vote   :795
[INFOR]: Class of most vote   :ski
[INFOR]: Number of most vote  :4028.0


[INFOR]: Index of second most vote     :683
[INFOR]: Class of second most vote     :oboe, hautboy, hautbois
[INFOR]: Number of second most vote    :311.0

[INFOR]: Create PDF for Positive Label

375/375 [==============================] - 10s 25ms/step
[INFOR]: Toltal norm before transform: 0.2751
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0595

[INFOR]: Create PDF for Negative Label

375/375 [==============================] - 10s 26ms/step
[INFOR]: Recall training of class sandal before transform: 4028
[INFOR]: Recall training of class not sandal before transform: 5601

[INFOR]: Recall training of class sandal after transform: 5600
[INFOR]: Recall training of class not sandal after transform: 5057
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (2000, 28, 28, 3)
[INFOR]: shape of y: (2000, 1)
63/63 [==============================] - 2s 26ms/step
[INFOR]: Index of most vote   :795
[INFOR]: Class of most vote   :ski
[INFOR]: Number of most vote  :688.0


[INFOR]: Index of second most vote     :409
[INFOR]: Class of second most vote     :analog clock
[INFOR]: Number of second most vote    :48.0
[INFOR]: Recall testing of class sandal before transform: 688
[INFOR]: Recall testing of class not sandal before transform: 945

[INFOR]: Recall testing of class sandal after transform: 961
[INFOR]: Recall testing of class not sandal after transform: 571
[INFOR]: Complete save data
[INFOR] TOLTAL TIME: 97.3376

C:\Users\LauNT\Desktop\topology>python main.py --model_name ResNet50 --data_shape 28 28 3 --model_shape 224 224 --data_name fashion_mnist --class_name shirt --num_img_train 6000 --num_img_test 1000
2021-07-27 10:51:46.241353: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  ResNet50
data_name =  fashion_mnist
class_name =  shirt
data_shape =  [28, 28, 3]
model_shape =  [224, 224]
output_dir =  ./output/npy_data
num_img_train =  6000
num_img_test =  1000
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (12000, 28, 28, 3)
[INFOR]: shape of y: (12000, 1)
[INFOR]: get pretrained model
2021-07-27 10:51:48.770251: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-07-27 10:51:48.831885: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-07-27 10:51:48.837429: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-07-27 10:51:48.845912: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 10:51:48.848100: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 10:51:48.853286: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-07-27 10:51:48.856640: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-07-27 10:51:48.862902: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-07-27 10:51:48.867920: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-07-27 10:51:48.870925: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 10:51:48.873091: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-07-27 10:51:48.875091: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-07-27 10:51:48.886819: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x2a2be628af0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-07-27 10:51:48.889831: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-07-27 10:51:48.892003: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-07-27 10:51:48.896478: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-07-27 10:51:48.898703: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 10:51:48.900983: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 10:51:48.903247: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-07-27 10:51:48.905536: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-07-27 10:51:48.907770: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-07-27 10:51:48.910055: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-07-27 10:51:48.912300: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 10:51:48.914512: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-07-27 10:51:49.357782: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-07-27 10:51:49.360716: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-07-27 10:51:49.362179: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-07-27 10:51:49.363800: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-07-27 10:51:49.370583: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x2a2ed6c97e0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-07-27 10:51:49.373495: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-07-27 10:51:51.064667: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-07-27 10:51:51.558751: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 10:51:52.202514: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 10:51:52.207822: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 10:51:53.554535: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-07-27 10:51:53.608125: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-07-27 10:51:53.914701: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
375/375 [==============================] - 12s 26ms/step
[INFOR]: Index of most vote   :501
[INFOR]: Class of most vote   :cloak
[INFOR]: Number of most vote  :884.0


[INFOR]: Index of second most vote     :499
[INFOR]: Class of second most vote     :cleaver, meat cleaver, chopper
[INFOR]: Number of second most vote    :691.0

[INFOR]: Create PDF for Positive Label

375/375 [==============================] - 10s 25ms/step
[INFOR]: Toltal norm before transform: 0.7902
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1427

[INFOR]: Create PDF for Negative Label

375/375 [==============================] - 10s 25ms/step
[INFOR]: Recall training of class shirt before transform: 884
[INFOR]: Recall training of class not shirt before transform: 5884

[INFOR]: Recall training of class shirt after transform: 4393
[INFOR]: Recall training of class not shirt after transform: 4447
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (2000, 28, 28, 3)
[INFOR]: shape of y: (2000, 1)
63/63 [==============================] - 2s 26ms/step
[INFOR]: Index of most vote   :501
[INFOR]: Class of most vote   :cloak
[INFOR]: Number of most vote  :145.0


[INFOR]: Index of second most vote     :499
[INFOR]: Class of second most vote     :cleaver, meat cleaver, chopper
[INFOR]: Number of second most vote    :128.0
[INFOR]: Recall testing of class shirt before transform: 145
[INFOR]: Recall testing of class not shirt before transform: 980

[INFOR]: Recall testing of class shirt after transform: 825
[INFOR]: Recall testing of class not shirt after transform: 543
[INFOR]: Complete save data
[INFOR] TOLTAL TIME: 85.0167

C:\Users\LauNT\Desktop\topology>python main.py --model_name ResNet50 --data_shape 28 28 3 --model_shape 224 224 --data_name fashion_mnist --class_name sneaker --num_img_train 6000 --num_img_test 1000
2021-07-27 10:53:15.638758: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  ResNet50
data_name =  fashion_mnist
class_name =  sneaker
data_shape =  [28, 28, 3]
model_shape =  [224, 224]
output_dir =  ./output/npy_data
num_img_train =  6000
num_img_test =  1000
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (12000, 28, 28, 3)
[INFOR]: shape of y: (12000, 1)
[INFOR]: get pretrained model
2021-07-27 10:53:18.102130: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-07-27 10:53:18.193374: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-07-27 10:53:18.197767: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-07-27 10:53:18.205634: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 10:53:18.207713: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 10:53:18.212977: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-07-27 10:53:18.216280: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-07-27 10:53:18.222391: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-07-27 10:53:18.227216: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-07-27 10:53:18.230172: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 10:53:18.232349: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-07-27 10:53:18.234236: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-07-27 10:53:18.246025: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x190be0793e0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-07-27 10:53:18.249328: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-07-27 10:53:18.251555: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-07-27 10:53:18.255894: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-07-27 10:53:18.258171: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 10:53:18.260414: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 10:53:18.262653: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-07-27 10:53:18.264869: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-07-27 10:53:18.267148: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-07-27 10:53:18.269301: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-07-27 10:53:18.271516: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 10:53:18.273717: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-07-27 10:53:18.708953: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-07-27 10:53:18.711752: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-07-27 10:53:18.713222: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-07-27 10:53:18.714871: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-07-27 10:53:18.722400: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x190ec8d7210 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-07-27 10:53:18.725315: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-07-27 10:53:20.404482: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-07-27 10:53:20.892625: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 10:53:21.541541: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 10:53:21.547492: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 10:53:22.895716: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-07-27 10:53:22.949951: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-07-27 10:53:23.254352: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
375/375 [==============================] - 12s 26ms/step
[INFOR]: Index of most vote   :795
[INFOR]: Class of most vote   :ski
[INFOR]: Number of most vote  :2381.0


[INFOR]: Index of second most vote     :623
[INFOR]: Class of second most vote     :letter opener, paper knife, paperknife
[INFOR]: Number of second most vote    :1375.0

[INFOR]: Create PDF for Positive Label

375/375 [==============================] - 10s 26ms/step
[INFOR]: Toltal norm before transform: 0.6090
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.2900

[INFOR]: Create PDF for Negative Label

375/375 [==============================] - 10s 26ms/step
[INFOR]: Recall training of class sneaker before transform: 2381
[INFOR]: Recall training of class not sneaker before transform: 5409

[INFOR]: Recall training of class sneaker after transform: 5487
[INFOR]: Recall training of class not sneaker after transform: 4693
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (2000, 28, 28, 3)
[INFOR]: shape of y: (2000, 1)
63/63 [==============================] - 2s 26ms/step
[INFOR]: Index of most vote   :795
[INFOR]: Class of most vote   :ski
[INFOR]: Number of most vote  :418.0


[INFOR]: Index of second most vote     :623
[INFOR]: Class of second most vote     :letter opener, paper knife, paperknife
[INFOR]: Number of second most vote    :227.0
[INFOR]: Recall testing of class sneaker before transform: 418
[INFOR]: Recall testing of class not sneaker before transform: 901

[INFOR]: Recall testing of class sneaker after transform: 969
[INFOR]: Recall testing of class not sneaker after transform: 456
[INFOR]: Complete save data
[INFOR] TOLTAL TIME: 89.2528

C:\Users\LauNT\Desktop\topology>python main.py --model_name ResNet50 --data_shape 28 28 3 --model_shape 224 224 --data_name fashion_mnist --class_name bag --num_img_train 6000 --num_img_test 1000
2021-07-27 10:54:49.188423: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  ResNet50
data_name =  fashion_mnist
class_name =  bag
data_shape =  [28, 28, 3]
model_shape =  [224, 224]
output_dir =  ./output/npy_data
num_img_train =  6000
num_img_test =  1000
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (12000, 28, 28, 3)
[INFOR]: shape of y: (12000, 1)
[INFOR]: get pretrained model
2021-07-27 10:54:51.719070: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-07-27 10:54:51.743241: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-07-27 10:54:51.747904: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-07-27 10:54:51.756072: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 10:54:51.758145: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 10:54:51.763096: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-07-27 10:54:51.766400: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-07-27 10:54:51.772525: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-07-27 10:54:51.777423: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-07-27 10:54:51.780270: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 10:54:51.782344: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-07-27 10:54:51.784245: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-07-27 10:54:51.796550: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1acbecb9020 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-07-27 10:54:51.799850: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-07-27 10:54:51.801872: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-07-27 10:54:51.806147: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-07-27 10:54:51.808578: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 10:54:51.810759: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 10:54:51.812947: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-07-27 10:54:51.815111: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-07-27 10:54:51.817311: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-07-27 10:54:51.819625: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-07-27 10:54:51.821759: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 10:54:51.823862: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-07-27 10:54:52.255201: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-07-27 10:54:52.258237: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-07-27 10:54:52.259776: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-07-27 10:54:52.261323: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-07-27 10:54:52.267943: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1ace8d94970 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-07-27 10:54:52.270760: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-07-27 10:54:53.936840: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-07-27 10:54:54.420804: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 10:54:55.074853: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 10:54:55.080686: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 10:54:56.429942: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-07-27 10:54:56.477284: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-07-27 10:54:56.786619: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
375/375 [==============================] - 12s 25ms/step
[INFOR]: Index of most vote   :507
[INFOR]: Class of most vote   :combination lock
[INFOR]: Number of most vote  :765.0


[INFOR]: Index of second most vote     :499
[INFOR]: Class of second most vote     :cleaver, meat cleaver, chopper
[INFOR]: Number of second most vote    :658.0

[INFOR]: Create PDF for Positive Label

375/375 [==============================] - 10s 25ms/step
[INFOR]: Toltal norm before transform: 0.8631
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.3597

[INFOR]: Create PDF for Negative Label

375/375 [==============================] - 10s 25ms/step
[INFOR]: Recall training of class bag before transform: 765
[INFOR]: Recall training of class not bag before transform: 5978

[INFOR]: Recall training of class bag after transform: 5291
[INFOR]: Recall training of class not bag after transform: 5275
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (2000, 28, 28, 3)
[INFOR]: shape of y: (2000, 1)
63/63 [==============================] - 2s 26ms/step
[INFOR]: Index of most vote   :507
[INFOR]: Class of most vote   :combination lock
[INFOR]: Number of most vote  :142.0


[INFOR]: Index of second most vote     :499
[INFOR]: Class of second most vote     :cleaver, meat cleaver, chopper
[INFOR]: Number of second most vote    :104.0
[INFOR]: Recall testing of class bag before transform: 142
[INFOR]: Recall testing of class not bag before transform: 994

[INFOR]: Recall testing of class bag after transform: 897
[INFOR]: Recall testing of class not bag after transform: 619
[INFOR]: Complete save data
[INFOR] TOLTAL TIME: 84.4946

C:\Users\LauNT\Desktop\topology>python main.py --model_name ResNet50 --data_shape 28 28 3 --model_shape 224 224 --data_name fashion_mnist --class_name ankle-boot --num_img_train 6000 --num_img_test 1000
2021-07-27 10:56:18.055265: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  ResNet50
data_name =  fashion_mnist
class_name =  ankle-boot
data_shape =  [28, 28, 3]
model_shape =  [224, 224]
output_dir =  ./output/npy_data
num_img_train =  6000
num_img_test =  1000
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (12000, 28, 28, 3)
[INFOR]: shape of y: (12000, 1)
[INFOR]: get pretrained model
2021-07-27 10:56:20.617822: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-07-27 10:56:20.642002: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-07-27 10:56:20.646844: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-07-27 10:56:20.654607: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 10:56:20.656857: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 10:56:20.662267: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-07-27 10:56:20.665571: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-07-27 10:56:20.671671: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-07-27 10:56:20.676537: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-07-27 10:56:20.679481: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 10:56:20.681609: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-07-27 10:56:20.683559: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-07-27 10:56:20.695689: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x24aba0a2320 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-07-27 10:56:20.699042: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-07-27 10:56:20.701259: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-07-27 10:56:20.705816: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-07-27 10:56:20.708112: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 10:56:20.710382: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 10:56:20.712743: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-07-27 10:56:20.715067: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-07-27 10:56:20.717360: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-07-27 10:56:20.719669: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-07-27 10:56:20.721935: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 10:56:20.724256: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-07-27 10:56:21.150594: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-07-27 10:56:21.153400: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-07-27 10:56:21.154955: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-07-27 10:56:21.156503: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-07-27 10:56:21.163378: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x24ae8cda070 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-07-27 10:56:21.166108: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-07-27 10:56:22.853828: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-07-27 10:56:23.345479: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 10:56:23.997421: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 10:56:24.003154: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 10:56:25.377516: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-07-27 10:56:25.430631: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-07-27 10:56:25.761911: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
375/375 [==============================] - 13s 26ms/step
[INFOR]: Index of most vote   :596
[INFOR]: Class of most vote   :hatchet
[INFOR]: Number of most vote  :3210.0


[INFOR]: Index of second most vote     :794
[INFOR]: Class of second most vote     :shower curtain
[INFOR]: Number of second most vote    :446.0

[INFOR]: Create PDF for Positive Label

375/375 [==============================] - 10s 26ms/step
[INFOR]: Toltal norm before transform: 0.4042
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1120

[INFOR]: Create PDF for Negative Label

375/375 [==============================] - 10s 26ms/step
[INFOR]: Recall training of class ankle-boot before transform: 3210
[INFOR]: Recall training of class not ankle-boot before transform: 5926

[INFOR]: Recall training of class ankle-boot after transform: 4922
[INFOR]: Recall training of class not ankle-boot after transform: 4905
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (2000, 28, 28, 3)
[INFOR]: shape of y: (2000, 1)
63/63 [==============================] - 2s 26ms/step
[INFOR]: Index of most vote   :596
[INFOR]: Class of most vote   :hatchet
[INFOR]: Number of most vote  :566.0


[INFOR]: Index of second most vote     :794
[INFOR]: Class of second most vote     :shower curtain
[INFOR]: Number of second most vote    :64.0
[INFOR]: Recall testing of class ankle-boot before transform: 566
[INFOR]: Recall testing of class not ankle-boot before transform: 990

[INFOR]: Recall testing of class ankle-boot after transform: 859
[INFOR]: Recall testing of class not ankle-boot after transform: 553
[INFOR]: Complete save data
[INFOR] TOLTAL TIME: 94.5442

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3 --data_shape 28 28 3 --model_shape 300 300 --data_name fashion_mnist --class_name t-shirt --num_img_train 6000 --num_img_test 1000
2021-07-27 10:57:56.985519: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
data_name =  fashion_mnist
class_name =  t-shirt
data_shape =  [28, 28, 3]
model_shape =  [300, 300]
output_dir =  ./output/npy_data
num_img_train =  6000
num_img_test =  1000
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (12000, 28, 28, 3)
[INFOR]: shape of y: (12000, 1)
[INFOR]: get pretrained model
2021-07-27 10:57:59.519890: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-07-27 10:57:59.544774: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-07-27 10:57:59.549867: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-07-27 10:57:59.557601: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 10:57:59.559751: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 10:57:59.564868: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-07-27 10:57:59.568299: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-07-27 10:57:59.574485: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-07-27 10:57:59.579493: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-07-27 10:57:59.582424: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 10:57:59.584610: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-07-27 10:57:59.586495: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-07-27 10:57:59.598374: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1ce3ee294a0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-07-27 10:57:59.601430: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-07-27 10:57:59.603582: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-07-27 10:57:59.607974: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-07-27 10:57:59.610136: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 10:57:59.612292: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 10:57:59.614489: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-07-27 10:57:59.616762: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-07-27 10:57:59.618918: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-07-27 10:57:59.621106: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-07-27 10:57:59.623331: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 10:57:59.625480: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-07-27 10:58:00.057396: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-07-27 10:58:00.060213: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-07-27 10:58:00.061670: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-07-27 10:58:00.063206: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-07-27 10:58:00.069695: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1ce6ce3dd40 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-07-27 10:58:00.072511: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-07-27 10:58:02.351316: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-07-27 10:58:03.514297: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 10:58:04.168495: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 10:58:04.176773: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 10:58:05.536106: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-07-27 10:58:05.583684: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-07-27 10:58:06.144212: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
375/375 [==============================] - 27s 62ms/step
[INFOR]: Index of most vote   :610
[INFOR]: Class of most vote   :jersey, T-shirt, tee shirt
[INFOR]: Number of most vote  :2998.0


[INFOR]: Index of second most vote     :707
[INFOR]: Class of second most vote     :pay-phone, pay-station
[INFOR]: Number of second most vote    :1961.0

[INFOR]: Create PDF for Positive Label

375/375 [==============================] - 24s 62ms/step
[INFOR]: Toltal norm before transform: 0.3059
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1375

[INFOR]: Create PDF for Negative Label

375/375 [==============================] - 23s 62ms/step
[INFOR]: Recall training of class t-shirt before transform: 2998
[INFOR]: Recall training of class not t-shirt before transform: 5891

[INFOR]: Recall training of class t-shirt after transform: 5597
[INFOR]: Recall training of class not t-shirt after transform: 4704
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (2000, 28, 28, 3)
[INFOR]: shape of y: (2000, 1)
63/63 [==============================] - 5s 66ms/step
[INFOR]: Index of most vote   :610
[INFOR]: Class of most vote   :jersey, T-shirt, tee shirt
[INFOR]: Number of most vote  :497.0


[INFOR]: Index of second most vote     :707
[INFOR]: Class of second most vote     :pay-phone, pay-station
[INFOR]: Number of second most vote    :326.0
[INFOR]: Recall testing of class t-shirt before transform: 497
[INFOR]: Recall testing of class not t-shirt before transform: 984

[INFOR]: Recall testing of class t-shirt after transform: 945
[INFOR]: Recall testing of class not t-shirt after transform: 607
[INFOR]: Complete save data
[INFOR] TOLTAL TIME: 142.8692

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3 --data_shape 28 28 3 --model_shape 300 300 --data_name fashion_mnist --class_name trouser --num_img_train 6000 --num_img_test 1000
2021-07-27 11:00:24.366013: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
data_name =  fashion_mnist
class_name =  trouser
data_shape =  [28, 28, 3]
model_shape =  [300, 300]
output_dir =  ./output/npy_data
num_img_train =  6000
num_img_test =  1000
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (12000, 28, 28, 3)
[INFOR]: shape of y: (12000, 1)
[INFOR]: get pretrained model
2021-07-27 11:00:26.972894: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-07-27 11:00:27.021555: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-07-27 11:00:27.026574: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-07-27 11:00:27.034320: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 11:00:27.036411: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 11:00:27.041651: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-07-27 11:00:27.045137: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-07-27 11:00:27.051212: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-07-27 11:00:27.055998: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-07-27 11:00:27.058886: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 11:00:27.060969: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-07-27 11:00:27.062932: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-07-27 11:00:27.074732: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1c23c16c8d0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-07-27 11:00:27.077835: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-07-27 11:00:27.079867: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-07-27 11:00:27.084302: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-07-27 11:00:27.086466: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 11:00:27.088655: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 11:00:27.090828: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-07-27 11:00:27.093099: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-07-27 11:00:27.095351: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-07-27 11:00:27.097557: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-07-27 11:00:27.099776: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 11:00:27.101998: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-07-27 11:00:27.552441: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-07-27 11:00:27.555472: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-07-27 11:00:27.556887: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-07-27 11:00:27.558417: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-07-27 11:00:27.565251: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1c26832ab10 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-07-27 11:00:27.568057: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-07-27 11:00:29.842862: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-07-27 11:00:31.046233: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 11:00:31.703858: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 11:00:31.711119: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 11:00:33.067063: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-07-27 11:00:33.116015: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-07-27 11:00:33.677401: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
375/375 [==============================] - 27s 62ms/step
[INFOR]: Index of most vote   :708
[INFOR]: Class of most vote   :pedestal, plinth, footstall
[INFOR]: Number of most vote  :2933.0


[INFOR]: Index of second most vote     :812
[INFOR]: Class of second most vote     :space shuttle
[INFOR]: Number of second most vote    :1595.0

[INFOR]: Create PDF for Positive Label

375/375 [==============================] - 24s 62ms/step
[INFOR]: Toltal norm before transform: 0.5106
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1519

[INFOR]: Create PDF for Negative Label

375/375 [==============================] - 23s 62ms/step
[INFOR]: Recall training of class trouser before transform: 2933
[INFOR]: Recall training of class not trouser before transform: 5017

[INFOR]: Recall training of class trouser after transform: 5977
[INFOR]: Recall training of class not trouser after transform: 4580
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (2000, 28, 28, 3)
[INFOR]: shape of y: (2000, 1)
63/63 [==============================] - 5s 65ms/step
[INFOR]: Index of most vote   :708
[INFOR]: Class of most vote   :pedestal, plinth, footstall
[INFOR]: Number of most vote  :491.0


[INFOR]: Index of second most vote     :812
[INFOR]: Class of second most vote     :space shuttle
[INFOR]: Number of second most vote    :263.0
[INFOR]: Recall testing of class trouser before transform: 491
[INFOR]: Recall testing of class not trouser before transform: 823

[INFOR]: Recall testing of class trouser after transform: 649
[INFOR]: Recall testing of class not trouser after transform: 1
[INFOR]: Complete save data
[INFOR] TOLTAL TIME: 141.685

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3 --data_shape 28 28 3 --model_shape 300 300 --data_name fashion_mnist --class_name pullover --num_img_train 6000 --num_img_test 1000
2021-07-27 11:02:50.657765: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
data_name =  fashion_mnist
class_name =  pullover
data_shape =  [28, 28, 3]
model_shape =  [300, 300]
output_dir =  ./output/npy_data
num_img_train =  6000
num_img_test =  1000
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (12000, 28, 28, 3)
[INFOR]: shape of y: (12000, 1)
[INFOR]: get pretrained model
2021-07-27 11:02:53.228544: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-07-27 11:02:53.258155: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-07-27 11:02:53.263026: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-07-27 11:02:53.278124: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 11:02:53.280308: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 11:02:53.285570: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-07-27 11:02:53.289154: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-07-27 11:02:53.296024: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-07-27 11:02:53.301149: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-07-27 11:02:53.304274: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 11:02:53.306609: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-07-27 11:02:53.308552: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-07-27 11:02:53.321378: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x19bc078aa70 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-07-27 11:02:53.324306: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-07-27 11:02:53.326638: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-07-27 11:02:53.331044: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-07-27 11:02:53.333302: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 11:02:53.335553: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 11:02:53.337775: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-07-27 11:02:53.340086: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-07-27 11:02:53.342632: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-07-27 11:02:53.344928: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-07-27 11:02:53.347154: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 11:02:53.349402: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-07-27 11:02:53.783584: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-07-27 11:02:53.786152: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-07-27 11:02:53.787682: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-07-27 11:02:53.789248: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-07-27 11:02:53.797168: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x19beb08b9e0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-07-27 11:02:53.800130: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-07-27 11:02:56.116883: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-07-27 11:02:57.314957: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 11:02:57.970078: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 11:02:57.978368: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 11:02:59.343569: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-07-27 11:02:59.391015: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-07-27 11:02:59.953850: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
375/375 [==============================] - 27s 63ms/step
[INFOR]: Index of most vote   :841
[INFOR]: Class of most vote   :sweatshirt
[INFOR]: Number of most vote  :3568.0


[INFOR]: Index of second most vote     :708
[INFOR]: Class of second most vote     :pedestal, plinth, footstall
[INFOR]: Number of second most vote    :397.0

[INFOR]: Create PDF for Positive Label

375/375 [==============================] - 25s 63ms/step
[INFOR]: Toltal norm before transform: 0.2252
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0176

[INFOR]: Create PDF for Negative Label

375/375 [==============================] - 24s 63ms/step
[INFOR]: Recall training of class pullover before transform: 3568
[INFOR]: Recall training of class not pullover before transform: 5576

[INFOR]: Recall training of class pullover after transform: 5723
[INFOR]: Recall training of class not pullover after transform: 4771
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (2000, 28, 28, 3)
[INFOR]: shape of y: (2000, 1)
63/63 [==============================] - 5s 63ms/step
[INFOR]: Index of most vote   :841
[INFOR]: Class of most vote   :sweatshirt
[INFOR]: Number of most vote  :610.0


[INFOR]: Index of second most vote     :708
[INFOR]: Class of second most vote     :pedestal, plinth, footstall
[INFOR]: Number of second most vote    :60.0
[INFOR]: Recall testing of class pullover before transform: 610
[INFOR]: Recall testing of class not pullover before transform: 934

[INFOR]: Recall testing of class pullover after transform: 977
[INFOR]: Recall testing of class not pullover after transform: 553
[INFOR]: Complete save data
[INFOR] TOLTAL TIME: 145.1744

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3 --data_shape 28 28 3 --model_shape 300 300 --data_name fashion_mnist --class_name dress --num_img_train 6000 --num_img_test 1000
2021-07-27 11:05:20.362093: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
data_name =  fashion_mnist
class_name =  dress
data_shape =  [28, 28, 3]
model_shape =  [300, 300]
output_dir =  ./output/npy_data
num_img_train =  6000
num_img_test =  1000
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (12000, 28, 28, 3)
[INFOR]: shape of y: (12000, 1)
[INFOR]: get pretrained model
2021-07-27 11:05:22.868874: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-07-27 11:05:22.926064: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-07-27 11:05:22.931613: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-07-27 11:05:22.946814: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 11:05:22.949234: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 11:05:22.954630: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-07-27 11:05:22.958418: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-07-27 11:05:22.965122: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-07-27 11:05:22.970392: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-07-27 11:05:22.973541: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 11:05:22.975879: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-07-27 11:05:22.977935: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-07-27 11:05:22.990617: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x2bcbc62b3b0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-07-27 11:05:22.994482: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-07-27 11:05:22.996748: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-07-27 11:05:23.001621: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-07-27 11:05:23.003988: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 11:05:23.006352: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 11:05:23.008705: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-07-27 11:05:23.011090: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-07-27 11:05:23.013509: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-07-27 11:05:23.015856: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-07-27 11:05:23.018459: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 11:05:23.020681: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-07-27 11:05:23.445914: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-07-27 11:05:23.448440: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-07-27 11:05:23.449938: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-07-27 11:05:23.451502: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-07-27 11:05:23.458496: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x2bce820c590 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-07-27 11:05:23.461453: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-07-27 11:05:25.738416: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-07-27 11:05:26.892375: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 11:05:27.547545: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 11:05:27.554712: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 11:05:28.913176: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-07-27 11:05:28.959939: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-07-27 11:05:29.539762: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
375/375 [==============================] - 27s 63ms/step
[INFOR]: Index of most vote   :708
[INFOR]: Class of most vote   :pedestal, plinth, footstall
[INFOR]: Number of most vote  :3234.0


[INFOR]: Index of second most vote     :868
[INFOR]: Class of second most vote     :tray
[INFOR]: Number of second most vote    :535.0

[INFOR]: Create PDF for Positive Label

375/375 [==============================] - 24s 62ms/step
[INFOR]: Toltal norm before transform: 0.3889
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1085

[INFOR]: Create PDF for Negative Label

375/375 [==============================] - 24s 63ms/step
[INFOR]: Recall training of class dress before transform: 3234
[INFOR]: Recall training of class not dress before transform: 5062

[INFOR]: Recall training of class dress after transform: 5517
[INFOR]: Recall training of class not dress after transform: 4649
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (2000, 28, 28, 3)
[INFOR]: shape of y: (2000, 1)
63/63 [==============================] - 5s 63ms/step
[INFOR]: Index of most vote   :708
[INFOR]: Class of most vote   :pedestal, plinth, footstall
[INFOR]: Number of most vote  :563.0


[INFOR]: Index of second most vote     :868
[INFOR]: Class of second most vote     :tray
[INFOR]: Number of second most vote    :104.0
[INFOR]: Recall testing of class dress before transform: 563
[INFOR]: Recall testing of class not dress before transform: 854

[INFOR]: Recall testing of class dress after transform: 942
[INFOR]: Recall testing of class not dress after transform: 498
[INFOR]: Complete save data
[INFOR] TOLTAL TIME: 143.3677

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3 --data_shape 28 28 3 --model_shape 300 300 --data_name fashion_mnist --class_name coat --num_img_train 6000 --num_img_test 1000
2021-07-27 11:07:48.228349: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
data_name =  fashion_mnist
class_name =  coat
data_shape =  [28, 28, 3]
model_shape =  [300, 300]
output_dir =  ./output/npy_data
num_img_train =  6000
num_img_test =  1000
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (12000, 28, 28, 3)
[INFOR]: shape of y: (12000, 1)
[INFOR]: get pretrained model
2021-07-27 11:07:50.850782: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-07-27 11:07:50.940732: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-07-27 11:07:50.945438: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-07-27 11:07:50.960605: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 11:07:50.962745: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 11:07:50.968091: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-07-27 11:07:50.971483: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-07-27 11:07:50.977784: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-07-27 11:07:50.982699: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-07-27 11:07:50.985554: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 11:07:50.987683: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-07-27 11:07:50.989599: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-07-27 11:07:51.002257: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x2b4bdf359f0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-07-27 11:07:51.005604: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-07-27 11:07:51.007736: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-07-27 11:07:51.012318: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-07-27 11:07:51.014521: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 11:07:51.016763: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 11:07:51.018965: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-07-27 11:07:51.021129: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-07-27 11:07:51.023354: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-07-27 11:07:51.025622: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-07-27 11:07:51.027822: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 11:07:51.030061: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-07-27 11:07:51.463492: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-07-27 11:07:51.466276: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-07-27 11:07:51.467754: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-07-27 11:07:51.469327: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-07-27 11:07:51.475907: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x2b4ebf38ae0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-07-27 11:07:51.478777: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-07-27 11:07:53.719610: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-07-27 11:07:54.879654: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 11:07:55.542430: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 11:07:55.550673: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 11:07:56.927085: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-07-27 11:07:56.974492: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-07-27 11:07:57.533929: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
375/375 [==============================] - 27s 62ms/step
[INFOR]: Index of most vote   :841
[INFOR]: Class of most vote   :sweatshirt
[INFOR]: Number of most vote  :1850.0


[INFOR]: Index of second most vote     :868
[INFOR]: Class of second most vote     :tray
[INFOR]: Number of second most vote    :1285.0

[INFOR]: Create PDF for Positive Label

375/375 [==============================] - 24s 62ms/step
[INFOR]: Toltal norm before transform: 0.5756
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1005

[INFOR]: Create PDF for Negative Label

375/375 [==============================] - 24s 63ms/step
[INFOR]: Recall training of class coat before transform: 1850
[INFOR]: Recall training of class not coat before transform: 5346

[INFOR]: Recall training of class coat after transform: 5827
[INFOR]: Recall training of class not coat after transform: 4437
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (2000, 28, 28, 3)
[INFOR]: shape of y: (2000, 1)
63/63 [==============================] - 5s 64ms/step
[INFOR]: Index of most vote   :841
[INFOR]: Class of most vote   :sweatshirt
[INFOR]: Number of most vote  :355.0


[INFOR]: Index of second most vote     :868
[INFOR]: Class of second most vote     :tray
[INFOR]: Number of second most vote    :193.0
[INFOR]: Recall testing of class coat before transform: 355
[INFOR]: Recall testing of class not coat before transform: 899

[INFOR]: Recall testing of class coat after transform: 982
[INFOR]: Recall testing of class not coat after transform: 546
[INFOR]: Complete save data
[INFOR] TOLTAL TIME: 138.8794

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3 --data_shape 28 28 3 --model_shape 300 300 --data_name fashion_mnist --class_name sandal --num_img_train 6000 --num_img_test 1000
2021-07-27 11:10:11.703267: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
data_name =  fashion_mnist
class_name =  sandal
data_shape =  [28, 28, 3]
model_shape =  [300, 300]
output_dir =  ./output/npy_data
num_img_train =  6000
num_img_test =  1000
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (12000, 28, 28, 3)
[INFOR]: shape of y: (12000, 1)
[INFOR]: get pretrained model
2021-07-27 11:10:14.316413: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-07-27 11:10:14.349488: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-07-27 11:10:14.354339: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-07-27 11:10:14.362229: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 11:10:14.364338: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 11:10:14.369565: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-07-27 11:10:14.372832: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-07-27 11:10:14.378942: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-07-27 11:10:14.383830: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-07-27 11:10:14.386810: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 11:10:14.389041: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-07-27 11:10:14.390928: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-07-27 11:10:14.402806: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1c339ab9800 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-07-27 11:10:14.405796: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-07-27 11:10:14.407847: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-07-27 11:10:14.412046: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-07-27 11:10:14.414249: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 11:10:14.416422: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 11:10:14.418587: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-07-27 11:10:14.420766: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-07-27 11:10:14.423017: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-07-27 11:10:14.425230: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-07-27 11:10:14.427553: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 11:10:14.429685: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-07-27 11:10:14.884959: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-07-27 11:10:14.887630: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-07-27 11:10:14.889138: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-07-27 11:10:14.890878: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-07-27 11:10:14.898682: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1c363df68b0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-07-27 11:10:14.901518: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-07-27 11:10:17.175121: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-07-27 11:10:18.397346: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 11:10:19.062296: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 11:10:19.069720: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 11:10:20.427639: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-07-27 11:10:20.475307: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-07-27 11:10:21.039961: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
375/375 [==============================] - 27s 63ms/step
[INFOR]: Index of most vote   :726
[INFOR]: Class of most vote   :plane, carpenter's plane, woodworking plane
[INFOR]: Number of most vote  :1046.0


[INFOR]: Index of second most vote     :111
[INFOR]: Class of second most vote     :nematode, nematode worm, roundworm
[INFOR]: Number of second most vote    :721.0

[INFOR]: Create PDF for Positive Label

375/375 [==============================] - 25s 63ms/step
[INFOR]: Toltal norm before transform: 0.8153
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0873

[INFOR]: Create PDF for Negative Label

375/375 [==============================] - 23s 63ms/step
[INFOR]: Recall training of class sandal before transform: 1046
[INFOR]: Recall training of class not sandal before transform: 5936

[INFOR]: Recall training of class sandal after transform: 5836
[INFOR]: Recall training of class not sandal after transform: 4954
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (2000, 28, 28, 3)
[INFOR]: shape of y: (2000, 1)
63/63 [==============================] - 5s 62ms/step
[INFOR]: Index of most vote   :726
[INFOR]: Class of most vote   :plane, carpenter's plane, woodworking plane
[INFOR]: Number of most vote  :178.0


[INFOR]: Index of second most vote     :111
[INFOR]: Class of second most vote     :nematode, nematode worm, roundworm
[INFOR]: Number of second most vote    :140.0
[INFOR]: Recall testing of class sandal before transform: 178
[INFOR]: Recall testing of class not sandal before transform: 990

[INFOR]: Recall testing of class sandal after transform: 996
[INFOR]: Recall testing of class not sandal after transform: 357
[INFOR]: Complete save data
[INFOR] TOLTAL TIME: 136.8641

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3 --data_shape 28 28 3 --model_shape 300 300 --data_name fashion_mnist --class_name shirt --num_img_train 6000 --num_img_test 1000
2021-07-27 11:12:33.136767: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
data_name =  fashion_mnist
class_name =  shirt
data_shape =  [28, 28, 3]
model_shape =  [300, 300]
output_dir =  ./output/npy_data
num_img_train =  6000
num_img_test =  1000
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (12000, 28, 28, 3)
[INFOR]: shape of y: (12000, 1)
[INFOR]: get pretrained model
2021-07-27 11:12:35.735953: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-07-27 11:12:35.781214: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-07-27 11:12:35.786408: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-07-27 11:12:35.801647: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 11:12:35.803864: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 11:12:35.809245: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-07-27 11:12:35.812794: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-07-27 11:12:35.819207: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-07-27 11:12:35.824125: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-07-27 11:12:35.827208: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 11:12:35.829438: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-07-27 11:12:35.831349: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-07-27 11:12:35.844057: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x244400d57f0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-07-27 11:12:35.847755: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-07-27 11:12:35.849985: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-07-27 11:12:35.854480: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-07-27 11:12:35.856751: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 11:12:35.858918: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 11:12:35.861183: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-07-27 11:12:35.863525: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-07-27 11:12:35.865746: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-07-27 11:12:35.867985: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-07-27 11:12:35.870156: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 11:12:35.872289: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-07-27 11:12:36.313979: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-07-27 11:12:36.316700: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-07-27 11:12:36.318201: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-07-27 11:12:36.319759: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-07-27 11:12:36.326546: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x2446fbc6970 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-07-27 11:12:36.329462: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-07-27 11:12:38.615714: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-07-27 11:12:39.802220: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 11:12:40.459064: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 11:12:40.466138: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 11:12:41.825848: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-07-27 11:12:41.879081: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-07-27 11:12:42.436814: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
375/375 [==============================] - 27s 62ms/step
[INFOR]: Index of most vote   :841
[INFOR]: Class of most vote   :sweatshirt
[INFOR]: Number of most vote  :1872.0


[INFOR]: Index of second most vote     :708
[INFOR]: Class of second most vote     :pedestal, plinth, footstall
[INFOR]: Number of second most vote    :1061.0

[INFOR]: Create PDF for Positive Label

375/375 [==============================] - 24s 62ms/step
[INFOR]: Toltal norm before transform: 0.4759
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0135

[INFOR]: Create PDF for Negative Label

375/375 [==============================] - 23s 62ms/step
[INFOR]: Recall training of class shirt before transform: 1872
[INFOR]: Recall training of class not shirt before transform: 5410

[INFOR]: Recall training of class shirt after transform: 5363
[INFOR]: Recall training of class not shirt after transform: 4059
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (2000, 28, 28, 3)
[INFOR]: shape of y: (2000, 1)
63/63 [==============================] - 5s 63ms/step
[INFOR]: Index of most vote   :841
[INFOR]: Class of most vote   :sweatshirt
[INFOR]: Number of most vote  :292.0


[INFOR]: Index of second most vote     :708
[INFOR]: Class of second most vote     :pedestal, plinth, footstall
[INFOR]: Number of second most vote    :178.0
[INFOR]: Recall testing of class shirt before transform: 292
[INFOR]: Recall testing of class not shirt before transform: 897

[INFOR]: Recall testing of class shirt after transform: 911
[INFOR]: Recall testing of class not shirt after transform: 417
[INFOR]: Complete save data
[INFOR] TOLTAL TIME: 137.5772

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3 --data_shape 28 28 3 --model_shape 300 300 --data_name fashion_mnist --class_name sneaker --num_img_train 6000 --num_img_test 1000
2021-07-27 11:14:55.275366: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
data_name =  fashion_mnist
class_name =  sneaker
data_shape =  [28, 28, 3]
model_shape =  [300, 300]
output_dir =  ./output/npy_data
num_img_train =  6000
num_img_test =  1000
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (12000, 28, 28, 3)
[INFOR]: shape of y: (12000, 1)
[INFOR]: get pretrained model
2021-07-27 11:14:57.864026: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-07-27 11:14:57.921446: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-07-27 11:14:57.926184: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-07-27 11:14:57.941144: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 11:14:57.943531: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 11:14:57.948964: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-07-27 11:14:57.952525: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-07-27 11:14:57.958995: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-07-27 11:14:57.964041: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-07-27 11:14:57.967045: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 11:14:57.969282: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-07-27 11:14:57.971265: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-07-27 11:14:57.983417: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1b1c09241e0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-07-27 11:14:57.986440: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-07-27 11:14:57.988627: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-07-27 11:14:57.993206: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-07-27 11:14:57.995505: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 11:14:57.997703: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 11:14:58.000121: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-07-27 11:14:58.002341: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-07-27 11:14:58.004644: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-07-27 11:14:58.006958: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-07-27 11:14:58.009414: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 11:14:58.011575: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-07-27 11:14:58.458973: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-07-27 11:14:58.461414: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-07-27 11:14:58.462908: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-07-27 11:14:58.464518: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-07-27 11:14:58.471126: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1b1eb113b00 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-07-27 11:14:58.474031: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-07-27 11:15:00.802509: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-07-27 11:15:02.010832: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 11:15:02.665712: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 11:15:02.672627: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 11:15:04.028271: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-07-27 11:15:04.079602: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-07-27 11:15:04.638716: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
375/375 [==============================] - 27s 62ms/step
[INFOR]: Index of most vote   :499
[INFOR]: Class of most vote   :cleaver, meat cleaver, chopper
[INFOR]: Number of most vote  :2029.0


[INFOR]: Index of second most vote     :698
[INFOR]: Class of second most vote     :palace
[INFOR]: Number of second most vote    :702.0

[INFOR]: Create PDF for Positive Label

375/375 [==============================] - 24s 62ms/step
[INFOR]: Toltal norm before transform: 0.6204
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1496

[INFOR]: Create PDF for Negative Label

375/375 [==============================] - 23s 62ms/step
[INFOR]: Recall training of class sneaker before transform: 2029
[INFOR]: Recall training of class not sneaker before transform: 5788

[INFOR]: Recall training of class sneaker after transform: 5879
[INFOR]: Recall training of class not sneaker after transform: 4642
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (2000, 28, 28, 3)
[INFOR]: shape of y: (2000, 1)
63/63 [==============================] - 5s 62ms/step
[INFOR]: Index of most vote   :499
[INFOR]: Class of most vote   :cleaver, meat cleaver, chopper
[INFOR]: Number of most vote  :319.0


[INFOR]: Index of second most vote     :673
[INFOR]: Class of second most vote     :mouse, computer mouse
[INFOR]: Number of second most vote    :129.0
[INFOR]: Recall testing of class sneaker before transform: 319
[INFOR]: Recall testing of class not sneaker before transform: 962

[INFOR]: Recall testing of class sneaker after transform: 985
[INFOR]: Recall testing of class not sneaker after transform: 457
[INFOR]: Complete save data
[INFOR] TOLTAL TIME: 138.0243

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3 --data_shape 28 28 3 --model_shape 300 300 --data_name fashion_mnist --class_name bag --num_img_train 6000 --num_img_test 1000
2021-07-27 11:17:17.795396: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
data_name =  fashion_mnist
class_name =  bag
data_shape =  [28, 28, 3]
model_shape =  [300, 300]
output_dir =  ./output/npy_data
num_img_train =  6000
num_img_test =  1000
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (12000, 28, 28, 3)
[INFOR]: shape of y: (12000, 1)
[INFOR]: get pretrained model
2021-07-27 11:17:20.306059: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-07-27 11:17:20.398469: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-07-27 11:17:20.403282: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-07-27 11:17:20.418161: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 11:17:20.420340: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 11:17:20.425637: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-07-27 11:17:20.429105: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-07-27 11:17:20.435560: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-07-27 11:17:20.440582: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-07-27 11:17:20.443536: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 11:17:20.445718: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-07-27 11:17:20.447650: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-07-27 11:17:20.459734: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x2193dc46310 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-07-27 11:17:20.463032: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-07-27 11:17:20.465265: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-07-27 11:17:20.469769: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-07-27 11:17:20.472065: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 11:17:20.474342: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 11:17:20.476582: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-07-27 11:17:20.478693: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-07-27 11:17:20.480844: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-07-27 11:17:20.483078: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-07-27 11:17:20.485234: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 11:17:20.487345: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-07-27 11:17:20.928844: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-07-27 11:17:20.931581: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-07-27 11:17:20.933068: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-07-27 11:17:20.935209: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-07-27 11:17:20.942215: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x2196da65ee0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-07-27 11:17:20.944965: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-07-27 11:17:23.205091: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-07-27 11:17:24.404193: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 11:17:25.051276: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 11:17:25.058127: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 11:17:26.436620: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-07-27 11:17:26.484533: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-07-27 11:17:27.042010: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
375/375 [==============================] - 27s 62ms/step
[INFOR]: Index of most vote   :636
[INFOR]: Class of most vote   :mailbag, postbag
[INFOR]: Number of most vote  :698.0


[INFOR]: Index of second most vote     :789
[INFOR]: Class of second most vote     :shoji
[INFOR]: Number of second most vote    :603.0

[INFOR]: Create PDF for Positive Label

375/375 [==============================] - 24s 62ms/step
[INFOR]: Toltal norm before transform: 0.8432
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.3559

[INFOR]: Create PDF for Negative Label

375/375 [==============================] - 23s 62ms/step
[INFOR]: Recall training of class bag before transform: 698
[INFOR]: Recall training of class not bag before transform: 6000

[INFOR]: Recall training of class bag after transform: 5924
[INFOR]: Recall training of class not bag after transform: 5421
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (2000, 28, 28, 3)
[INFOR]: shape of y: (2000, 1)
63/63 [==============================] - 5s 62ms/step
[INFOR]: Index of most vote   :636
[INFOR]: Class of most vote   :mailbag, postbag
[INFOR]: Number of most vote  :133.0


[INFOR]: Index of second most vote     :507
[INFOR]: Class of second most vote     :combination lock
[INFOR]: Number of second most vote    :110.0
[INFOR]: Recall testing of class bag before transform: 133
[INFOR]: Recall testing of class not bag before transform: 1000

[INFOR]: Recall testing of class bag after transform: 987
[INFOR]: Recall testing of class not bag after transform: 650
[INFOR]: Complete save data
[INFOR] TOLTAL TIME: 133.1402

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3 --data_shape 28 28 3 --model_shape 300 300 --data_name fashion_mnist --class_name ankle-boot --num_img_train 6000 --num_img_test 1000
2021-07-27 11:19:35.370300: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
data_name =  fashion_mnist
class_name =  ankle-boot
data_shape =  [28, 28, 3]
model_shape =  [300, 300]
output_dir =  ./output/npy_data
num_img_train =  6000
num_img_test =  1000
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (12000, 28, 28, 3)
[INFOR]: shape of y: (12000, 1)
[INFOR]: get pretrained model
2021-07-27 11:19:37.822915: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-07-27 11:19:37.872945: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-07-27 11:19:37.877690: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-07-27 11:19:37.892509: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 11:19:37.894678: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 11:19:37.899944: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-07-27 11:19:37.903411: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-07-27 11:19:37.913752: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-07-27 11:19:37.918684: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-07-27 11:19:37.921671: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 11:19:37.923815: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-07-27 11:19:37.925895: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-07-27 11:19:37.938459: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x16b3dd03770 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-07-27 11:19:37.941580: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-07-27 11:19:37.943717: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-07-27 11:19:37.948105: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-07-27 11:19:37.950452: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 11:19:37.952810: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 11:19:37.955128: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-07-27 11:19:37.957296: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-07-27 11:19:37.959445: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-07-27 11:19:37.961714: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-07-27 11:19:37.963935: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 11:19:37.966177: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-07-27 11:19:38.408104: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-07-27 11:19:38.410954: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-07-27 11:19:38.412382: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-07-27 11:19:38.413985: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-07-27 11:19:38.420460: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x16b6d1ae4c0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-07-27 11:19:38.423526: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-07-27 11:19:40.650843: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-07-27 11:19:41.812377: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 11:19:42.459085: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 11:19:42.465925: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 11:19:43.808644: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-07-27 11:19:43.855250: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-07-27 11:19:44.409179: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
375/375 [==============================] - 27s 62ms/step
[INFOR]: Index of most vote   :596
[INFOR]: Class of most vote   :hatchet
[INFOR]: Number of most vote  :1681.0


[INFOR]: Index of second most vote     :707
[INFOR]: Class of second most vote     :pay-phone, pay-station
[INFOR]: Number of second most vote    :1045.0

[INFOR]: Create PDF for Positive Label

375/375 [==============================] - 24s 62ms/step
[INFOR]: Toltal norm before transform: 0.6656
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.2380

[INFOR]: Create PDF for Negative Label

375/375 [==============================] - 23s 62ms/step
[INFOR]: Recall training of class ankle-boot before transform: 1681
[INFOR]: Recall training of class not ankle-boot before transform: 5952

[INFOR]: Recall training of class ankle-boot after transform: 5875
[INFOR]: Recall training of class not ankle-boot after transform: 4957
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (2000, 28, 28, 3)
[INFOR]: shape of y: (2000, 1)
63/63 [==============================] - 5s 62ms/step
[INFOR]: Index of most vote   :596
[INFOR]: Class of most vote   :hatchet
[INFOR]: Number of most vote  :266.0


[INFOR]: Index of second most vote     :707
[INFOR]: Class of second most vote     :pay-phone, pay-station
[INFOR]: Number of second most vote    :189.0
[INFOR]: Recall testing of class ankle-boot before transform: 266
[INFOR]: Recall testing of class not ankle-boot before transform: 999

[INFOR]: Recall testing of class ankle-boot after transform: 986
[INFOR]: Recall testing of class not ankle-boot after transform: 496
[INFOR]: Complete save data
[INFOR] TOLTAL TIME: 137.7388

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3 --data_shape 28 28 3 --model_shape 299 299 --data_name fashion_mnist --class_name t-shirt --num_img_train 6000 --num_img_test 1000
2021-07-27 11:21:57.564489: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
data_name =  fashion_mnist
class_name =  t-shirt
data_shape =  [28, 28, 3]
model_shape =  [299, 299]
output_dir =  ./output/npy_data
num_img_train =  6000
num_img_test =  1000
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (12000, 28, 28, 3)
[INFOR]: shape of y: (12000, 1)
[INFOR]: get pretrained model
2021-07-27 11:22:00.200935: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-07-27 11:22:00.235283: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-07-27 11:22:00.240427: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-07-27 11:22:00.248644: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 11:22:00.251421: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 11:22:00.257135: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-07-27 11:22:00.260885: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-07-27 11:22:00.267559: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-07-27 11:22:00.272697: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-07-27 11:22:00.275798: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 11:22:00.278036: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-07-27 11:22:00.280152: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-07-27 11:22:00.292619: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1ee3d55da70 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-07-27 11:22:00.296043: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-07-27 11:22:00.298905: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-07-27 11:22:00.304061: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-07-27 11:22:00.306781: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 11:22:00.309531: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 11:22:00.311898: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-07-27 11:22:00.314413: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-07-27 11:22:00.317120: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-07-27 11:22:00.319549: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-07-27 11:22:00.321940: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 11:22:00.324320: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-07-27 11:22:00.789545: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-07-27 11:22:00.792324: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-07-27 11:22:00.793919: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-07-27 11:22:00.795735: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-07-27 11:22:00.802549: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1ee6d14a110 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-07-27 11:22:00.805542: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-07-27 11:22:02.848201: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-07-27 11:22:03.557258: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 11:22:04.226708: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 11:22:04.233169: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 11:22:05.590434: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-07-27 11:22:05.643080: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-07-27 11:22:06.390425: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
375/375 [==============================] - 15s 32ms/step
[INFOR]: Index of most vote   :610
[INFOR]: Class of most vote   :jersey, T-shirt, tee shirt
[INFOR]: Number of most vote  :2904.0


[INFOR]: Index of second most vote     :465
[INFOR]: Class of second most vote     :bulletproof vest
[INFOR]: Number of second most vote    :471.0

[INFOR]: Create PDF for Positive Label

375/375 [==============================] - 13s 32ms/step
[INFOR]: Toltal norm before transform: 0.4260
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0358

[INFOR]: Create PDF for Negative Label

375/375 [==============================] - 12s 31ms/step
[INFOR]: Recall training of class t-shirt before transform: 2904
[INFOR]: Recall training of class not t-shirt before transform: 5772

[INFOR]: Recall training of class t-shirt after transform: 5010
[INFOR]: Recall training of class not t-shirt after transform: 4390
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (2000, 28, 28, 3)
[INFOR]: shape of y: (2000, 1)
63/63 [==============================] - 3s 32ms/step
[INFOR]: Index of most vote   :610
[INFOR]: Class of most vote   :jersey, T-shirt, tee shirt
[INFOR]: Number of most vote  :490.0


[INFOR]: Index of second most vote     :465
[INFOR]: Class of second most vote     :bulletproof vest
[INFOR]: Number of second most vote    :76.0
[INFOR]: Recall testing of class t-shirt before transform: 490
[INFOR]: Recall testing of class not t-shirt before transform: 969

[INFOR]: Recall testing of class t-shirt after transform: 857
[INFOR]: Recall testing of class not t-shirt after transform: 529
[INFOR]: Complete save data
[INFOR] TOLTAL TIME: 104.8908

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3 --data_shape 28 28 3 --model_shape 299 299 --data_name fashion_mnist --class_name trouser --num_img_train 6000 --num_img_test 1000
2021-07-27 11:23:47.023233: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
data_name =  fashion_mnist
class_name =  trouser
data_shape =  [28, 28, 3]
model_shape =  [299, 299]
output_dir =  ./output/npy_data
num_img_train =  6000
num_img_test =  1000
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (12000, 28, 28, 3)
[INFOR]: shape of y: (12000, 1)
[INFOR]: get pretrained model
2021-07-27 11:23:49.709031: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-07-27 11:23:49.732228: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-07-27 11:23:49.736696: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-07-27 11:23:49.744444: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 11:23:49.746626: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 11:23:49.751923: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-07-27 11:23:49.755414: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-07-27 11:23:49.761620: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-07-27 11:23:49.766742: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-07-27 11:23:49.769982: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 11:23:49.772217: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-07-27 11:23:49.774236: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-07-27 11:23:49.786966: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x22640f62eb0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-07-27 11:23:49.790213: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-07-27 11:23:49.792347: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-07-27 11:23:49.796930: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-07-27 11:23:49.799134: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 11:23:49.801445: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 11:23:49.803787: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-07-27 11:23:49.806011: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-07-27 11:23:49.808222: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-07-27 11:23:49.810484: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-07-27 11:23:49.812740: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 11:23:49.814995: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-07-27 11:23:50.255096: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-07-27 11:23:50.257468: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-07-27 11:23:50.258962: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-07-27 11:23:50.260692: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-07-27 11:23:50.269171: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x2266fb05490 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-07-27 11:23:50.272431: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-07-27 11:23:52.311827: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-07-27 11:23:53.033169: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 11:23:53.702798: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 11:23:53.709064: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 11:23:55.081273: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-07-27 11:23:55.130646: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-07-27 11:23:55.866480: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
375/375 [==============================] - 16s 32ms/step
[INFOR]: Index of most vote   :813
[INFOR]: Class of most vote   :spatula
[INFOR]: Number of most vote  :1987.0


[INFOR]: Index of second most vote     :451
[INFOR]: Class of second most vote     :bolo tie, bolo, bola tie, bola
[INFOR]: Number of second most vote    :1440.0

[INFOR]: Create PDF for Positive Label

375/375 [==============================] - 13s 32ms/step
[INFOR]: Toltal norm before transform: 0.6076
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1198

[INFOR]: Create PDF for Negative Label

375/375 [==============================] - 12s 31ms/step
[INFOR]: Recall training of class trouser before transform: 1987
[INFOR]: Recall training of class not trouser before transform: 5450

[INFOR]: Recall training of class trouser after transform: 5782
[INFOR]: Recall training of class not trouser after transform: 4648
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (2000, 28, 28, 3)
[INFOR]: shape of y: (2000, 1)
63/63 [==============================] - 3s 33ms/step
[INFOR]: Index of most vote   :813
[INFOR]: Class of most vote   :spatula
[INFOR]: Number of most vote  :303.0


[INFOR]: Index of second most vote     :451
[INFOR]: Class of second most vote     :bolo tie, bolo, bola tie, bola
[INFOR]: Number of second most vote    :233.0
[INFOR]: Recall testing of class trouser before transform: 303
[INFOR]: Recall testing of class not trouser before transform: 908

[INFOR]: Recall testing of class trouser after transform: 986
[INFOR]: Recall testing of class not trouser after transform: 436
[INFOR]: Complete save data
[INFOR] TOLTAL TIME: 98.9917

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3 --data_shape 28 28 3 --model_shape 299 299 --data_name fashion_mnist --class_name pullover --num_img_train 6000 --num_img_test 1000
2021-07-27 11:25:30.662866: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
data_name =  fashion_mnist
class_name =  pullover
data_shape =  [28, 28, 3]
model_shape =  [299, 299]
output_dir =  ./output/npy_data
num_img_train =  6000
num_img_test =  1000
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (12000, 28, 28, 3)
[INFOR]: shape of y: (12000, 1)
[INFOR]: get pretrained model
2021-07-27 11:25:33.294919: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-07-27 11:25:33.317475: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-07-27 11:25:33.321895: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-07-27 11:25:33.329957: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 11:25:33.332066: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 11:25:33.337176: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-07-27 11:25:33.340511: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-07-27 11:25:33.346501: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-07-27 11:25:33.351686: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-07-27 11:25:33.354657: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 11:25:33.357015: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-07-27 11:25:33.358974: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-07-27 11:25:33.370967: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x2ccbae62ce0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-07-27 11:25:33.374392: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-07-27 11:25:33.376477: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-07-27 11:25:33.380890: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-07-27 11:25:33.383121: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 11:25:33.385305: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 11:25:33.387579: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-07-27 11:25:33.389891: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-07-27 11:25:33.392117: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-07-27 11:25:33.394340: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-07-27 11:25:33.396551: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 11:25:33.398782: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-07-27 11:25:33.822709: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-07-27 11:25:33.825464: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-07-27 11:25:33.826881: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-07-27 11:25:33.828474: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-07-27 11:25:33.835054: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x2cce68648e0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-07-27 11:25:33.837773: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-07-27 11:25:35.835456: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-07-27 11:25:36.568427: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 11:25:37.251060: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 11:25:37.257969: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 11:25:38.674687: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-07-27 11:25:38.724100: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-07-27 11:25:39.461787: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
375/375 [==============================] - 16s 32ms/step
[INFOR]: Index of most vote   :813
[INFOR]: Class of most vote   :spatula
[INFOR]: Number of most vote  :1469.0


[INFOR]: Index of second most vote     :499
[INFOR]: Class of second most vote     :cleaver, meat cleaver, chopper
[INFOR]: Number of second most vote    :759.0

[INFOR]: Create PDF for Positive Label

375/375 [==============================] - 13s 32ms/step
[INFOR]: Toltal norm before transform: 0.7112
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.2366

[INFOR]: Create PDF for Negative Label

375/375 [==============================] - 12s 32ms/step
[INFOR]: Recall training of class pullover before transform: 1469
[INFOR]: Recall training of class not pullover before transform: 5369

[INFOR]: Recall training of class pullover after transform: 4589
[INFOR]: Recall training of class not pullover after transform: 4402
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (2000, 28, 28, 3)
[INFOR]: shape of y: (2000, 1)
63/63 [==============================] - 3s 32ms/step
[INFOR]: Index of most vote   :813
[INFOR]: Class of most vote   :spatula
[INFOR]: Number of most vote  :230.0


[INFOR]: Index of second most vote     :499
[INFOR]: Class of second most vote     :cleaver, meat cleaver, chopper
[INFOR]: Number of second most vote    :147.0
[INFOR]: Recall testing of class pullover before transform: 230
[INFOR]: Recall testing of class not pullover before transform: 905

[INFOR]: Recall testing of class pullover after transform: 690
[INFOR]: Recall testing of class not pullover after transform: 634
[INFOR]: Complete save data
[INFOR] TOLTAL TIME: 98.9372

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3 --data_shape 28 28 3 --model_shape 299 299 --data_name fashion_mnist --class_name dress --num_img_train 6000 --num_img_test 1000
2021-07-27 11:27:14.099073: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
data_name =  fashion_mnist
class_name =  dress
data_shape =  [28, 28, 3]
model_shape =  [299, 299]
output_dir =  ./output/npy_data
num_img_train =  6000
num_img_test =  1000
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (12000, 28, 28, 3)
[INFOR]: shape of y: (12000, 1)
[INFOR]: get pretrained model
2021-07-27 11:27:16.658020: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-07-27 11:27:16.682362: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-07-27 11:27:16.687472: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-07-27 11:27:16.695693: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 11:27:16.697904: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 11:27:16.704655: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-07-27 11:27:16.708226: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-07-27 11:27:16.714795: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-07-27 11:27:16.720463: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-07-27 11:27:16.723497: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 11:27:16.725744: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-07-27 11:27:16.727717: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-07-27 11:27:16.739853: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x13b3a0eed10 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-07-27 11:27:16.743916: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-07-27 11:27:16.746073: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-07-27 11:27:16.750577: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-07-27 11:27:16.752851: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 11:27:16.755323: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 11:27:16.757719: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-07-27 11:27:16.760042: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-07-27 11:27:16.762468: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-07-27 11:27:16.764840: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-07-27 11:27:16.767225: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 11:27:16.769557: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-07-27 11:27:17.238739: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-07-27 11:27:17.241226: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-07-27 11:27:17.242672: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-07-27 11:27:17.244229: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-07-27 11:27:17.251275: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x13b697fb2c0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-07-27 11:27:17.254491: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-07-27 11:27:19.439448: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-07-27 11:27:20.157438: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 11:27:20.811402: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 11:27:20.817912: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 11:27:22.174509: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-07-27 11:27:22.228782: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-07-27 11:27:22.958682: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
375/375 [==============================] - 15s 32ms/step
[INFOR]: Index of most vote   :689
[INFOR]: Class of most vote   :overskirt
[INFOR]: Number of most vote  :1681.0


[INFOR]: Index of second most vote     :905
[INFOR]: Class of second most vote     :window shade
[INFOR]: Number of second most vote    :1026.0

[INFOR]: Create PDF for Positive Label

375/375 [==============================] - 13s 32ms/step
[INFOR]: Toltal norm before transform: 0.6669
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1703

[INFOR]: Create PDF for Negative Label

375/375 [==============================] - 12s 32ms/step
[INFOR]: Recall training of class dress before transform: 1681
[INFOR]: Recall training of class not dress before transform: 5835

[INFOR]: Recall training of class dress after transform: 4919
[INFOR]: Recall training of class not dress after transform: 4679
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (2000, 28, 28, 3)
[INFOR]: shape of y: (2000, 1)
63/63 [==============================] - 3s 32ms/step
[INFOR]: Index of most vote   :689
[INFOR]: Class of most vote   :overskirt
[INFOR]: Number of most vote  :254.0


[INFOR]: Index of second most vote     :905
[INFOR]: Class of second most vote     :window shade
[INFOR]: Number of second most vote    :175.0
[INFOR]: Recall testing of class dress before transform: 254
[INFOR]: Recall testing of class not dress before transform: 971

[INFOR]: Recall testing of class dress after transform: 857
[INFOR]: Recall testing of class not dress after transform: 612
[INFOR]: Complete save data
[INFOR] TOLTAL TIME: 98.0003

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3 --data_shape 28 28 3 --model_shape 299 299 --data_name fashion_mnist --class_name coat --num_img_train 6000 --num_img_test 1000
2021-07-27 11:28:56.558841: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
data_name =  fashion_mnist
class_name =  coat
data_shape =  [28, 28, 3]
model_shape =  [299, 299]
output_dir =  ./output/npy_data
num_img_train =  6000
num_img_test =  1000
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (12000, 28, 28, 3)
[INFOR]: shape of y: (12000, 1)
[INFOR]: get pretrained model
2021-07-27 11:28:59.124696: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-07-27 11:28:59.149667: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-07-27 11:28:59.154805: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-07-27 11:28:59.170178: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 11:28:59.172488: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 11:28:59.177743: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-07-27 11:28:59.181271: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-07-27 11:28:59.187858: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-07-27 11:28:59.192804: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-07-27 11:28:59.195730: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 11:28:59.197869: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-07-27 11:28:59.199791: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-07-27 11:28:59.212263: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1e8bd7e37b0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-07-27 11:28:59.215538: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-07-27 11:28:59.217705: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-07-27 11:28:59.222180: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-07-27 11:28:59.224377: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 11:28:59.226528: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 11:28:59.228708: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-07-27 11:28:59.230910: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-07-27 11:28:59.233222: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-07-27 11:28:59.235385: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-07-27 11:28:59.237676: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 11:28:59.239910: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-07-27 11:28:59.665524: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-07-27 11:28:59.668256: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-07-27 11:28:59.669694: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-07-27 11:28:59.671212: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-07-27 11:28:59.677956: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1e8ed0e1bc0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-07-27 11:28:59.680759: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-07-27 11:29:01.663143: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-07-27 11:29:02.350572: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 11:29:02.999174: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 11:29:03.006086: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 11:29:04.378790: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-07-27 11:29:04.431465: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-07-27 11:29:05.147769: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
375/375 [==============================] - 15s 32ms/step
[INFOR]: Index of most vote   :813
[INFOR]: Class of most vote   :spatula
[INFOR]: Number of most vote  :1219.0


[INFOR]: Index of second most vote     :680
[INFOR]: Class of second most vote     :nipple
[INFOR]: Number of second most vote    :726.0

[INFOR]: Create PDF for Positive Label

375/375 [==============================] - 13s 32ms/step
[INFOR]: Toltal norm before transform: 0.7725
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1200

[INFOR]: Create PDF for Negative Label

375/375 [==============================] - 12s 31ms/step
[INFOR]: Recall training of class coat before transform: 1219
[INFOR]: Recall training of class not coat before transform: 5324

[INFOR]: Recall training of class coat after transform: 3411
[INFOR]: Recall training of class not coat after transform: 4032
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (2000, 28, 28, 3)
[INFOR]: shape of y: (2000, 1)
63/63 [==============================] - 3s 32ms/step
[INFOR]: Index of most vote   :813
[INFOR]: Class of most vote   :spatula
[INFOR]: Number of most vote  :217.0


[INFOR]: Index of second most vote     :905
[INFOR]: Class of second most vote     :window shade
[INFOR]: Number of second most vote    :111.0
[INFOR]: Recall testing of class coat before transform: 217
[INFOR]: Recall testing of class not coat before transform: 889

[INFOR]: Recall testing of class coat after transform: 559
[INFOR]: Recall testing of class not coat after transform: 482
[INFOR]: Complete save data
[INFOR] TOLTAL TIME: 94.0733

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3 --data_shape 28 28 3 --model_shape 299 299 --data_name fashion_mnist --class_name sandal --num_img_train 6000 --num_img_test 1000
2021-07-27 11:30:35.076636: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
data_name =  fashion_mnist
class_name =  sandal
data_shape =  [28, 28, 3]
model_shape =  [299, 299]
output_dir =  ./output/npy_data
num_img_train =  6000
num_img_test =  1000
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (12000, 28, 28, 3)
[INFOR]: shape of y: (12000, 1)
[INFOR]: get pretrained model
2021-07-27 11:30:37.685172: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-07-27 11:30:37.708937: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-07-27 11:30:37.713757: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-07-27 11:30:37.721968: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 11:30:37.724762: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 11:30:37.730069: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-07-27 11:30:37.733504: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-07-27 11:30:37.739817: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-07-27 11:30:37.745078: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-07-27 11:30:37.748011: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 11:30:37.750181: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-07-27 11:30:37.752112: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-07-27 11:30:37.764298: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x2023fee6070 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-07-27 11:30:37.767692: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-07-27 11:30:37.769882: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-07-27 11:30:37.774367: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-07-27 11:30:37.776594: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 11:30:37.778756: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 11:30:37.781056: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-07-27 11:30:37.783355: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-07-27 11:30:37.785521: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-07-27 11:30:37.787779: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-07-27 11:30:37.790002: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 11:30:37.792245: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-07-27 11:30:38.238593: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-07-27 11:30:38.241412: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-07-27 11:30:38.242831: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-07-27 11:30:38.244393: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-07-27 11:30:38.251042: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x2026e85f820 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-07-27 11:30:38.253922: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-07-27 11:30:40.304637: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-07-27 11:30:41.058082: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 11:30:41.718759: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 11:30:41.725174: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 11:30:43.119706: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-07-27 11:30:43.169476: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-07-27 11:30:43.914871: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
375/375 [==============================] - 16s 32ms/step
[INFOR]: Index of most vote   :473
[INFOR]: Class of most vote   :can opener, tin opener
[INFOR]: Number of most vote  :1039.0


[INFOR]: Index of second most vote     :622
[INFOR]: Class of second most vote     :lens cap, lens cover
[INFOR]: Number of second most vote    :670.0

[INFOR]: Create PDF for Positive Label

375/375 [==============================] - 13s 32ms/step
[INFOR]: Toltal norm before transform: 0.8162
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0566

[INFOR]: Create PDF for Negative Label

375/375 [==============================] - 12s 32ms/step
[INFOR]: Recall training of class sandal before transform: 1039
[INFOR]: Recall training of class not sandal before transform: 5798

[INFOR]: Recall training of class sandal after transform: 5460
[INFOR]: Recall training of class not sandal after transform: 4707
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (2000, 28, 28, 3)
[INFOR]: shape of y: (2000, 1)
63/63 [==============================] - 3s 32ms/step
[INFOR]: Index of most vote   :473
[INFOR]: Class of most vote   :can opener, tin opener
[INFOR]: Number of most vote  :163.0


[INFOR]: Index of second most vote     :622
[INFOR]: Class of second most vote     :lens cap, lens cover
[INFOR]: Number of second most vote    :105.0
[INFOR]: Recall testing of class sandal before transform: 163
[INFOR]: Recall testing of class not sandal before transform: 968

[INFOR]: Recall testing of class sandal after transform: 931
[INFOR]: Recall testing of class not sandal after transform: 499
[INFOR]: Complete save data
[INFOR] TOLTAL TIME: 95.4748

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3 --data_shape 28 28 3 --model_shape 299 299 --data_name fashion_mnist --class_name shirt --num_img_train 6000 --num_img_test 1000
2021-07-27 11:32:14.999806: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
data_name =  fashion_mnist
class_name =  shirt
data_shape =  [28, 28, 3]
model_shape =  [299, 299]
output_dir =  ./output/npy_data
num_img_train =  6000
num_img_test =  1000
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (12000, 28, 28, 3)
[INFOR]: shape of y: (12000, 1)
[INFOR]: get pretrained model
2021-07-27 11:32:17.548966: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-07-27 11:32:17.573665: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-07-27 11:32:17.578090: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-07-27 11:32:17.593171: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 11:32:17.595563: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 11:32:17.600785: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-07-27 11:32:17.604187: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-07-27 11:32:17.610526: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-07-27 11:32:17.615594: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-07-27 11:32:17.618478: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 11:32:17.620628: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-07-27 11:32:17.622533: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-07-27 11:32:17.634417: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x2243a4419d0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-07-27 11:32:17.637515: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-07-27 11:32:17.639646: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-07-27 11:32:17.643950: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-07-27 11:32:17.646262: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 11:32:17.648485: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 11:32:17.650673: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-07-27 11:32:17.652810: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-07-27 11:32:17.654972: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-07-27 11:32:17.657373: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-07-27 11:32:17.659541: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 11:32:17.661733: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-07-27 11:32:18.085409: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-07-27 11:32:18.087827: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-07-27 11:32:18.089275: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-07-27 11:32:18.090852: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-07-27 11:32:18.097509: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x224688d4ce0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-07-27 11:32:18.100359: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-07-27 11:32:20.166468: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-07-27 11:32:20.873939: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 11:32:21.532218: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 11:32:21.538076: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 11:32:22.878688: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-07-27 11:32:22.925110: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-07-27 11:32:23.641523: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
375/375 [==============================] - 16s 32ms/step
[INFOR]: Index of most vote   :610
[INFOR]: Class of most vote   :jersey, T-shirt, tee shirt
[INFOR]: Number of most vote  :998.0


[INFOR]: Index of second most vote     :905
[INFOR]: Class of second most vote     :window shade
[INFOR]: Number of second most vote    :758.0

[INFOR]: Create PDF for Positive Label

375/375 [==============================] - 12s 32ms/step
[INFOR]: Toltal norm before transform: 0.8256
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1127

[INFOR]: Create PDF for Negative Label

375/375 [==============================] - 12s 32ms/step
[INFOR]: Recall training of class shirt before transform: 998
[INFOR]: Recall training of class not shirt before transform: 5554

[INFOR]: Recall training of class shirt after transform: 4232
[INFOR]: Recall training of class not shirt after transform: 4189
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (2000, 28, 28, 3)
[INFOR]: shape of y: (2000, 1)
63/63 [==============================] - 3s 31ms/step
[INFOR]: Index of most vote   :610
[INFOR]: Class of most vote   :jersey, T-shirt, tee shirt
[INFOR]: Number of most vote  :156.0


[INFOR]: Index of second most vote     :688
[INFOR]: Class of second most vote     :oscilloscope, scope, cathode-ray oscilloscope, CRO
[INFOR]: Number of second most vote    :127.0
[INFOR]: Recall testing of class shirt before transform: 156
[INFOR]: Recall testing of class not shirt before transform: 921

[INFOR]: Recall testing of class shirt after transform: 980
[INFOR]: Recall testing of class not shirt after transform: 8
[INFOR]: Complete save data
[INFOR] TOLTAL TIME: 95.3745

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3 --data_shape 28 28 3 --model_shape 299 299 --data_name fashion_mnist --class_name sneaker --num_img_train 6000 --num_img_test 1000
2021-07-27 11:33:54.870745: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
data_name =  fashion_mnist
class_name =  sneaker
data_shape =  [28, 28, 3]
model_shape =  [299, 299]
output_dir =  ./output/npy_data
num_img_train =  6000
num_img_test =  1000
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (12000, 28, 28, 3)
[INFOR]: shape of y: (12000, 1)
[INFOR]: get pretrained model
2021-07-27 11:33:57.358994: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-07-27 11:33:57.383796: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-07-27 11:33:57.388274: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-07-27 11:33:57.396084: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 11:33:57.398140: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 11:33:57.403181: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-07-27 11:33:57.406815: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-07-27 11:33:57.412884: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-07-27 11:33:57.417803: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-07-27 11:33:57.420771: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 11:33:57.422914: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-07-27 11:33:57.424806: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-07-27 11:33:57.436922: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1ffc0996be0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-07-27 11:33:57.440326: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-07-27 11:33:57.442457: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-07-27 11:33:57.447059: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-07-27 11:33:57.449432: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 11:33:57.451683: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 11:33:57.453938: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-07-27 11:33:57.456196: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-07-27 11:33:57.458349: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-07-27 11:33:57.460585: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-07-27 11:33:57.462836: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 11:33:57.465081: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-07-27 11:33:57.885562: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-07-27 11:33:57.888205: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-07-27 11:33:57.889819: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-07-27 11:33:57.891388: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-07-27 11:33:57.898188: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1ffea39c870 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-07-27 11:33:57.900912: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-07-27 11:33:59.888592: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-07-27 11:34:00.579765: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 11:34:01.229680: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 11:34:01.235869: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 11:34:02.572301: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-07-27 11:34:02.623870: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-07-27 11:34:03.337363: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
375/375 [==============================] - 15s 32ms/step
[INFOR]: Index of most vote   :596
[INFOR]: Class of most vote   :hatchet
[INFOR]: Number of most vote  :2124.0


[INFOR]: Index of second most vote     :813
[INFOR]: Class of second most vote     :spatula
[INFOR]: Number of second most vote    :438.0

[INFOR]: Create PDF for Positive Label

375/375 [==============================] - 12s 31ms/step
[INFOR]: Toltal norm before transform: 0.6168
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1472

[INFOR]: Create PDF for Negative Label

375/375 [==============================] - 12s 32ms/step
[INFOR]: Recall training of class sneaker before transform: 2124
[INFOR]: Recall training of class not sneaker before transform: 5501

[INFOR]: Recall training of class sneaker after transform: 5832
[INFOR]: Recall training of class not sneaker after transform: 4670
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (2000, 28, 28, 3)
[INFOR]: shape of y: (2000, 1)
63/63 [==============================] - 3s 32ms/step
[INFOR]: Index of most vote   :596
[INFOR]: Class of most vote   :hatchet
[INFOR]: Number of most vote  :378.0


[INFOR]: Index of second most vote     :813
[INFOR]: Class of second most vote     :spatula
[INFOR]: Number of second most vote    :72.0
[INFOR]: Recall testing of class sneaker before transform: 378
[INFOR]: Recall testing of class not sneaker before transform: 918

[INFOR]: Recall testing of class sneaker after transform: 536
[INFOR]: Recall testing of class not sneaker after transform: 28
[INFOR]: Complete save data
[INFOR] TOLTAL TIME: 97.8699

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3 --data_shape 28 28 3 --model_shape 299 299 --data_name fashion_mnist --class_name bag --num_img_train 6000 --num_img_test 1000
2021-07-27 11:35:37.094066: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
data_name =  fashion_mnist
class_name =  bag
data_shape =  [28, 28, 3]
model_shape =  [299, 299]
output_dir =  ./output/npy_data
num_img_train =  6000
num_img_test =  1000
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (12000, 28, 28, 3)
[INFOR]: shape of y: (12000, 1)
[INFOR]: get pretrained model
2021-07-27 11:35:39.607084: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-07-27 11:35:39.629648: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-07-27 11:35:39.634025: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-07-27 11:35:39.641802: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 11:35:39.643920: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 11:35:39.649022: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-07-27 11:35:39.652444: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-07-27 11:35:39.658470: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-07-27 11:35:39.663553: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-07-27 11:35:39.666541: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 11:35:39.668641: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-07-27 11:35:39.670547: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-07-27 11:35:39.683113: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1f6414351f0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-07-27 11:35:39.686198: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-07-27 11:35:39.688313: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-07-27 11:35:39.692680: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-07-27 11:35:39.694892: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 11:35:39.697042: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 11:35:39.699282: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-07-27 11:35:39.701549: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-07-27 11:35:39.703716: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-07-27 11:35:39.705879: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-07-27 11:35:39.708038: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 11:35:39.710157: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-07-27 11:35:40.133087: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-07-27 11:35:40.135847: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-07-27 11:35:40.137269: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-07-27 11:35:40.138853: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-07-27 11:35:40.145510: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1f670a8ff60 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-07-27 11:35:40.148304: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-07-27 11:35:42.128720: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-07-27 11:35:42.824923: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 11:35:43.485212: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 11:35:43.492110: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 11:35:44.827925: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-07-27 11:35:44.875528: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-07-27 11:35:45.590069: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
375/375 [==============================] - 15s 32ms/step
[INFOR]: Index of most vote   :901
[INFOR]: Class of most vote   :whiskey jug
[INFOR]: Number of most vote  :612.0


[INFOR]: Index of second most vote     :499
[INFOR]: Class of second most vote     :cleaver, meat cleaver, chopper
[INFOR]: Number of second most vote    :562.0

[INFOR]: Create PDF for Positive Label

375/375 [==============================] - 13s 32ms/step
[INFOR]: Toltal norm before transform: 0.8912
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0818

[INFOR]: Create PDF for Negative Label

375/375 [==============================] - 12s 32ms/step
[INFOR]: Recall training of class bag before transform: 612
[INFOR]: Recall training of class not bag before transform: 5935

[INFOR]: Recall training of class bag after transform: 5013
[INFOR]: Recall training of class not bag after transform: 4608
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (2000, 28, 28, 3)
[INFOR]: shape of y: (2000, 1)
63/63 [==============================] - 3s 32ms/step
[INFOR]: Index of most vote   :901
[INFOR]: Class of most vote   :whiskey jug
[INFOR]: Number of most vote  :111.0


[INFOR]: Index of second most vote     :482
[INFOR]: Class of second most vote     :cassette player
[INFOR]: Number of second most vote    :100.0
[INFOR]: Recall testing of class bag before transform: 111
[INFOR]: Recall testing of class not bag before transform: 988

[INFOR]: Recall testing of class bag after transform: 919
[INFOR]: Recall testing of class not bag after transform: 293
[INFOR]: Complete save data
[INFOR] TOLTAL TIME: 93.6704

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3 --data_shape 28 28 3 --model_shape 299 299 --data_name fashion_mnist --class_name ankle-boot --num_img_train 6000 --num_img_test 1000
2021-07-27 11:37:15.139811: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
data_name =  fashion_mnist
class_name =  ankle-boot
data_shape =  [28, 28, 3]
model_shape =  [299, 299]
output_dir =  ./output/npy_data
num_img_train =  6000
num_img_test =  1000
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (12000, 28, 28, 3)
[INFOR]: shape of y: (12000, 1)
[INFOR]: get pretrained model
2021-07-27 11:37:17.628172: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-07-27 11:37:17.654365: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-07-27 11:37:17.659015: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-07-27 11:37:17.673863: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 11:37:17.675980: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 11:37:17.681211: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-07-27 11:37:17.684544: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-07-27 11:37:17.690799: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-07-27 11:37:17.695768: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-07-27 11:37:17.698642: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 11:37:17.700799: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-07-27 11:37:17.702684: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-07-27 11:37:17.714593: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x249ba1ade90 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-07-27 11:37:17.717561: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-07-27 11:37:17.719643: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-07-27 11:37:17.723961: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-07-27 11:37:17.726117: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 11:37:17.728275: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 11:37:17.730529: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-07-27 11:37:17.732806: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-07-27 11:37:17.734923: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-07-27 11:37:17.737170: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-07-27 11:37:17.739317: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 11:37:17.741722: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-07-27 11:37:18.162980: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-07-27 11:37:18.165609: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-07-27 11:37:18.167019: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-07-27 11:37:18.168581: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-07-27 11:37:18.175295: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x249dea2c9a0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-07-27 11:37:18.178039: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-07-27 11:37:20.155386: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-07-27 11:37:20.835607: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 11:37:21.479178: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 11:37:21.485159: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 11:37:22.831019: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-07-27 11:37:22.883519: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-07-27 11:37:23.599488: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
375/375 [==============================] - 15s 32ms/step
[INFOR]: Index of most vote   :596
[INFOR]: Class of most vote   :hatchet
[INFOR]: Number of most vote  :4307.0


[INFOR]: Index of second most vote     :473
[INFOR]: Class of second most vote     :can opener, tin opener
[INFOR]: Number of second most vote    :198.0

[INFOR]: Create PDF for Positive Label

375/375 [==============================] - 12s 32ms/step
[INFOR]: Toltal norm before transform: 0.2103
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0132

[INFOR]: Create PDF for Negative Label

375/375 [==============================] - 12s 31ms/step
[INFOR]: Recall training of class ankle-boot before transform: 4307
[INFOR]: Recall training of class not ankle-boot before transform: 5708

[INFOR]: Recall training of class ankle-boot after transform: 5457
[INFOR]: Recall training of class not ankle-boot after transform: 5058
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (2000, 28, 28, 3)
[INFOR]: shape of y: (2000, 1)
63/63 [==============================] - 3s 32ms/step
[INFOR]: Index of most vote   :596
[INFOR]: Class of most vote   :hatchet
[INFOR]: Number of most vote  :730.0


[INFOR]: Index of second most vote     :473
[INFOR]: Class of second most vote     :can opener, tin opener
[INFOR]: Number of second most vote    :32.0
[INFOR]: Recall testing of class ankle-boot before transform: 730
[INFOR]: Recall testing of class not ankle-boot before transform: 955

[INFOR]: Recall testing of class ankle-boot after transform: 945
[INFOR]: Recall testing of class not ankle-boot after transform: 419
[INFOR]: Complete save data
[INFOR] TOLTAL TIME: 105.716

C:\Users\LauNT\Desktop\topology>