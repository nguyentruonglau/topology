
C:\Users\LauNT\Desktop\topology>run_cifar10.bat

C:\Users\LauNT\Desktop\topology>python main.py --model_name ResNet50 --data_shape 32 32 3 --model_shape 224 224 --data_name cifar10 --class_name airplane --num_img_train 5000 --num_img_test 1000
2021-07-27 09:30:31.967659: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  ResNet50
data_name =  cifar10
class_name =  airplane
data_shape =  [32, 32, 3]
model_shape =  [224, 224]
output_dir =  ./output/npy_data
num_img_train =  5000
num_img_test =  1000
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (10000, 32, 32, 3)
[INFOR]: shape of y: (10000, 1)
[INFOR]: get pretrained model
2021-07-27 09:30:34.469023: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-07-27 09:30:34.506172: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-07-27 09:30:34.511506: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-07-27 09:30:34.526942: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 09:30:34.529343: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 09:30:34.534783: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-07-27 09:30:34.538909: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-07-27 09:30:34.545726: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-07-27 09:30:34.551196: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-07-27 09:30:34.554335: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 09:30:34.556777: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-07-27 09:30:34.558813: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-07-27 09:30:34.572388: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x13439aa21e0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-07-27 09:30:34.575828: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-07-27 09:30:34.578307: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-07-27 09:30:34.583482: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-07-27 09:30:34.585962: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 09:30:34.588402: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 09:30:34.591260: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-07-27 09:30:34.593692: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-07-27 09:30:34.596591: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-07-27 09:30:34.599606: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-07-27 09:30:34.602310: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 09:30:34.604859: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-07-27 09:30:35.056163: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-07-27 09:30:35.059740: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-07-27 09:30:35.061262: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-07-27 09:30:35.062905: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-07-27 09:30:35.070279: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1346648ece0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-07-27 09:30:35.073438: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-07-27 09:30:36.802323: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-07-27 09:30:37.298630: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 09:30:37.966117: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 09:30:37.972970: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 09:30:39.352550: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-07-27 09:30:39.407796: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-07-27 09:30:39.717709: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
313/313 [==============================] - 11s 27ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :1582.0


[INFOR]: Index of second most vote     :855
[INFOR]: Class of second most vote     :thimble
[INFOR]: Number of second most vote    :297.0

[INFOR]: Create PDF for Positive Label

313/313 [==============================] - 9s 26ms/step
[INFOR]: Toltal norm before transform: 0.6418
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0853

[INFOR]: Create PDF for Negative Label

313/313 [==============================] - 8s 26ms/step
[INFOR]: Recall training of class airplane before transform: 1582
[INFOR]: Recall training of class not airplane before transform: 4994

[INFOR]: Recall training of class airplane after transform: 4156
[INFOR]: Recall training of class not airplane after transform: 3734
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (2000, 32, 32, 3)
[INFOR]: shape of y: (2000, 1)
63/63 [==============================] - 2s 26ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :295.0


[INFOR]: Index of second most vote     :855
[INFOR]: Class of second most vote     :thimble
[INFOR]: Number of second most vote    :61.0
[INFOR]: Recall testing of class airplane before transform: 295
[INFOR]: Recall testing of class not airplane before transform: 998

[INFOR]: Recall testing of class airplane after transform: 894
[INFOR]: Recall testing of class not airplane after transform: 474
[INFOR]: Complete save data
[INFOR] TOLTAL TIME: 67.6374

C:\Users\LauNT\Desktop\topology>python main.py --model_name ResNet50 --data_shape 32 32 3 --model_shape 224 224 --data_name cifar10 --class_name automobile --num_img_train 5000 --num_img_test 1000
2021-07-27 09:31:43.968940: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  ResNet50
data_name =  cifar10
class_name =  automobile
data_shape =  [32, 32, 3]
model_shape =  [224, 224]
output_dir =  ./output/npy_data
num_img_train =  5000
num_img_test =  1000
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (10000, 32, 32, 3)
[INFOR]: shape of y: (10000, 1)
[INFOR]: get pretrained model
2021-07-27 09:31:46.460075: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-07-27 09:31:46.486138: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-07-27 09:31:46.491744: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-07-27 09:31:46.507737: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 09:31:46.510349: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 09:31:46.517368: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-07-27 09:31:46.521561: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-07-27 09:31:46.528489: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-07-27 09:31:46.534066: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-07-27 09:31:46.537593: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 09:31:46.539911: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-07-27 09:31:46.541980: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-07-27 09:31:46.555740: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x2473770aff0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-07-27 09:31:46.559082: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-07-27 09:31:46.561929: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-07-27 09:31:46.566832: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-07-27 09:31:46.569440: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 09:31:46.572378: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 09:31:46.575057: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-07-27 09:31:46.577564: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-07-27 09:31:46.581377: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-07-27 09:31:46.584635: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-07-27 09:31:46.587324: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 09:31:46.590298: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-07-27 09:31:47.025700: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-07-27 09:31:47.028562: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-07-27 09:31:47.030226: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-07-27 09:31:47.031842: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-07-27 09:31:47.039233: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x24737651830 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-07-27 09:31:47.042472: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-07-27 09:31:48.770367: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-07-27 09:31:49.268357: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 09:31:49.924338: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 09:31:49.930869: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 09:31:51.318187: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-07-27 09:31:51.373111: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-07-27 09:31:51.681695: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
313/313 [==============================] - 11s 27ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :1999.0


[INFOR]: Index of second most vote     :491
[INFOR]: Class of second most vote     :chain saw, chainsaw
[INFOR]: Number of second most vote    :644.0

[INFOR]: Create PDF for Positive Label

313/313 [==============================] - 9s 27ms/step
[INFOR]: Toltal norm before transform: 0.5243
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.2251

[INFOR]: Create PDF for Negative Label

313/313 [==============================] - 8s 27ms/step
[INFOR]: Recall training of class automobile before transform: 1999
[INFOR]: Recall training of class not automobile before transform: 4649

[INFOR]: Recall training of class automobile after transform: 4444
[INFOR]: Recall training of class not automobile after transform: 3745
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (2000, 32, 32, 3)
[INFOR]: shape of y: (2000, 1)
63/63 [==============================] - 2s 26ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :407.0


[INFOR]: Index of second most vote     :491
[INFOR]: Class of second most vote     :chain saw, chainsaw
[INFOR]: Number of second most vote    :118.0
[INFOR]: Recall testing of class automobile before transform: 407
[INFOR]: Recall testing of class not automobile before transform: 922

[INFOR]: Recall testing of class automobile after transform: 905
[INFOR]: Recall testing of class not automobile after transform: 463
[INFOR]: Complete save data
[INFOR] TOLTAL TIME: 68.9231

C:\Users\LauNT\Desktop\topology>python main.py --model_name ResNet50 --data_shape 32 32 3 --model_shape 224 224 --data_name cifar10 --class_name bird --num_img_train 5000 --num_img_test 1000
2021-07-27 09:32:57.222502: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  ResNet50
data_name =  cifar10
class_name =  bird
data_shape =  [32, 32, 3]
model_shape =  [224, 224]
output_dir =  ./output/npy_data
num_img_train =  5000
num_img_test =  1000
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (10000, 32, 32, 3)
[INFOR]: shape of y: (10000, 1)
[INFOR]: get pretrained model
2021-07-27 09:32:59.712002: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-07-27 09:32:59.738761: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-07-27 09:32:59.743985: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-07-27 09:32:59.752154: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 09:32:59.754632: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 09:32:59.760642: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-07-27 09:32:59.764382: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-07-27 09:32:59.771012: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-07-27 09:32:59.776317: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-07-27 09:32:59.779467: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 09:32:59.781768: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-07-27 09:32:59.784109: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-07-27 09:32:59.797631: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1d538bbab50 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-07-27 09:32:59.800972: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-07-27 09:32:59.803678: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-07-27 09:32:59.808268: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-07-27 09:32:59.811271: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 09:32:59.813774: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 09:32:59.816348: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-07-27 09:32:59.818949: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-07-27 09:32:59.822650: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-07-27 09:32:59.825447: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-07-27 09:32:59.827871: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 09:32:59.830635: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-07-27 09:33:00.267974: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-07-27 09:33:00.271140: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-07-27 09:33:00.272714: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-07-27 09:33:00.274371: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-07-27 09:33:00.281790: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1d564d30b10 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-07-27 09:33:00.284776: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-07-27 09:33:02.010257: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-07-27 09:33:02.500308: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 09:33:03.162393: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 09:33:03.168980: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 09:33:04.557162: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-07-27 09:33:04.603859: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-07-27 09:33:04.911243: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
313/313 [==============================] - 11s 27ms/step
[INFOR]: Index of most vote   :10
[INFOR]: Class of most vote   :brambling, Fringilla montifringilla
[INFOR]: Number of most vote  :657.0


[INFOR]: Index of second most vote     :134
[INFOR]: Class of second most vote     :crane
[INFOR]: Number of second most vote    :257.0

[INFOR]: Create PDF for Positive Label

313/313 [==============================] - 9s 27ms/step
[INFOR]: Toltal norm before transform: 0.8406
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0704

[INFOR]: Create PDF for Negative Label

313/313 [==============================] - 8s 26ms/step
[INFOR]: Recall training of class bird before transform: 657
[INFOR]: Recall training of class not bird before transform: 4996

[INFOR]: Recall training of class bird after transform: 4005
[INFOR]: Recall training of class not bird after transform: 3101
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (2000, 32, 32, 3)
[INFOR]: shape of y: (2000, 1)
63/63 [==============================] - 2s 26ms/step
[INFOR]: Index of most vote   :10
[INFOR]: Class of most vote   :brambling, Fringilla montifringilla
[INFOR]: Number of most vote  :140.0


[INFOR]: Index of second most vote     :79
[INFOR]: Class of second most vote     :centipede
[INFOR]: Number of second most vote    :45.0
[INFOR]: Recall testing of class bird before transform: 140
[INFOR]: Recall testing of class not bird before transform: 1000

[INFOR]: Recall testing of class bird after transform: 915
[INFOR]: Recall testing of class not bird after transform: 310
[INFOR]: Complete save data
[INFOR] TOLTAL TIME: 65.9324

C:\Users\LauNT\Desktop\topology>python main.py --model_name ResNet50 --data_shape 32 32 3 --model_shape 224 224 --data_name cifar10 --class_name cat --num_img_train 5000 --num_img_test 1000
2021-07-27 09:34:07.517991: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  ResNet50
data_name =  cifar10
class_name =  cat
data_shape =  [32, 32, 3]
model_shape =  [224, 224]
output_dir =  ./output/npy_data
num_img_train =  5000
num_img_test =  1000
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (10000, 32, 32, 3)
[INFOR]: shape of y: (10000, 1)
[INFOR]: get pretrained model
2021-07-27 09:34:10.040281: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-07-27 09:34:10.065410: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-07-27 09:34:10.070941: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-07-27 09:34:10.079208: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 09:34:10.081549: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 09:34:10.087129: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-07-27 09:34:10.090731: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-07-27 09:34:10.097726: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-07-27 09:34:10.103257: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-07-27 09:34:10.106446: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 09:34:10.108801: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-07-27 09:34:10.110919: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-07-27 09:34:10.123439: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1cbb53ae150 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-07-27 09:34:10.126891: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-07-27 09:34:10.129784: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-07-27 09:34:10.134422: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-07-27 09:34:10.137064: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 09:34:10.139936: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 09:34:10.142491: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-07-27 09:34:10.144975: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-07-27 09:34:10.147812: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-07-27 09:34:10.150251: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-07-27 09:34:10.152759: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 09:34:10.155348: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-07-27 09:34:10.589517: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-07-27 09:34:10.592994: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-07-27 09:34:10.594538: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-07-27 09:34:10.596271: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-07-27 09:34:10.603623: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1cbe3235180 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-07-27 09:34:10.606738: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-07-27 09:34:12.322959: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-07-27 09:34:12.812979: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 09:34:13.471130: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 09:34:13.476960: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 09:34:14.828768: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-07-27 09:34:14.875069: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-07-27 09:34:15.186231: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
313/313 [==============================] - 11s 27ms/step
[INFOR]: Index of most vote   :281
[INFOR]: Class of most vote   :tabby, tabby cat
[INFOR]: Number of most vote  :428.0


[INFOR]: Index of second most vote     :334
[INFOR]: Class of second most vote     :porcupine, hedgehog
[INFOR]: Number of second most vote    :374.0

[INFOR]: Create PDF for Positive Label

313/313 [==============================] - 9s 26ms/step
[INFOR]: Toltal norm before transform: 0.9133
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0387

[INFOR]: Create PDF for Negative Label

313/313 [==============================] - 8s 26ms/step
[INFOR]: Recall training of class cat before transform: 428
[INFOR]: Recall training of class not cat before transform: 5000

[INFOR]: Recall training of class cat after transform: 3592
[INFOR]: Recall training of class not cat after transform: 2929
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (2000, 32, 32, 3)
[INFOR]: shape of y: (2000, 1)
63/63 [==============================] - 2s 26ms/step
[INFOR]: Index of most vote   :335
[INFOR]: Class of most vote   :fox squirrel, eastern fox squirrel, Sciurus niger
[INFOR]: Number of most vote  :87.0


[INFOR]: Index of second most vote     :281
[INFOR]: Class of second most vote     :tabby, tabby cat
[INFOR]: Number of second most vote    :82.0
[INFOR]: Recall testing of class cat before transform: 87
[INFOR]: Recall testing of class not cat before transform: 975

[INFOR]: Recall testing of class cat after transform: 803
[INFOR]: Recall testing of class not cat after transform: 405
[INFOR]: Complete save data
[INFOR] TOLTAL TIME: 64.3349

C:\Users\LauNT\Desktop\topology>python main.py --model_name ResNet50 --data_shape 32 32 3 --model_shape 224 224 --data_name cifar10 --class_name deer --num_img_train 5000 --num_img_test 1000
2021-07-27 09:35:16.203763: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  ResNet50
data_name =  cifar10
class_name =  deer
data_shape =  [32, 32, 3]
model_shape =  [224, 224]
output_dir =  ./output/npy_data
num_img_train =  5000
num_img_test =  1000
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (10000, 32, 32, 3)
[INFOR]: shape of y: (10000, 1)
[INFOR]: get pretrained model
2021-07-27 09:35:18.700467: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-07-27 09:35:18.724909: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-07-27 09:35:18.730090: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-07-27 09:35:18.746186: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 09:35:18.748732: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 09:35:18.754326: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-07-27 09:35:18.758203: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-07-27 09:35:18.764977: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-07-27 09:35:18.770893: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-07-27 09:35:18.774456: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 09:35:18.776785: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-07-27 09:35:18.778859: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-07-27 09:35:18.791590: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1e837995d00 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-07-27 09:35:18.795001: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-07-27 09:35:18.797497: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-07-27 09:35:18.802836: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-07-27 09:35:18.805313: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 09:35:18.807775: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 09:35:18.810616: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-07-27 09:35:18.813139: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-07-27 09:35:18.815748: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-07-27 09:35:18.818212: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-07-27 09:35:18.821137: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 09:35:18.823694: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-07-27 09:35:19.261811: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-07-27 09:35:19.264829: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-07-27 09:35:19.266560: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-07-27 09:35:19.268486: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-07-27 09:35:19.275986: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1e8604e2dd0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-07-27 09:35:19.279005: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-07-27 09:35:20.994971: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-07-27 09:35:21.485623: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 09:35:22.151791: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 09:35:22.158478: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 09:35:23.541401: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-07-27 09:35:23.591590: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-07-27 09:35:23.900832: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
313/313 [==============================] - 11s 27ms/step
[INFOR]: Index of most vote   :351
[INFOR]: Class of most vote   :hartebeest
[INFOR]: Number of most vote  :1304.0


[INFOR]: Index of second most vote     :274
[INFOR]: Class of second most vote     :dhole, Cuon alpinus
[INFOR]: Number of second most vote    :302.0

[INFOR]: Create PDF for Positive Label

313/313 [==============================] - 9s 26ms/step
[INFOR]: Toltal norm before transform: 0.7150
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.2729

[INFOR]: Create PDF for Negative Label

313/313 [==============================] - 8s 26ms/step
[INFOR]: Recall training of class deer before transform: 1304
[INFOR]: Recall training of class not deer before transform: 4989

[INFOR]: Recall training of class deer after transform: 4048
[INFOR]: Recall training of class not deer after transform: 3692
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (2000, 32, 32, 3)
[INFOR]: shape of y: (2000, 1)
63/63 [==============================] - 2s 26ms/step
[INFOR]: Index of most vote   :351
[INFOR]: Class of most vote   :hartebeest
[INFOR]: Number of most vote  :247.0


[INFOR]: Index of second most vote     :274
[INFOR]: Class of second most vote     :dhole, Cuon alpinus
[INFOR]: Number of second most vote    :60.0
[INFOR]: Recall testing of class deer before transform: 247
[INFOR]: Recall testing of class not deer before transform: 997

[INFOR]: Recall testing of class deer after transform: 908
[INFOR]: Recall testing of class not deer after transform: 328
[INFOR]: Complete save data
[INFOR] TOLTAL TIME: 67.1947

C:\Users\LauNT\Desktop\topology>python main.py --model_name ResNet50 --data_shape 32 32 3 --model_shape 224 224 --data_name cifar10 --class_name dog --num_img_train 5000 --num_img_test 1000
2021-07-27 09:36:27.748308: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  ResNet50
data_name =  cifar10
class_name =  dog
data_shape =  [32, 32, 3]
model_shape =  [224, 224]
output_dir =  ./output/npy_data
num_img_train =  5000
num_img_test =  1000
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (10000, 32, 32, 3)
[INFOR]: shape of y: (10000, 1)
[INFOR]: get pretrained model
2021-07-27 09:36:30.260433: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-07-27 09:36:30.289149: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-07-27 09:36:30.294542: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-07-27 09:36:30.302982: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 09:36:30.305846: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 09:36:30.311742: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-07-27 09:36:30.315377: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-07-27 09:36:30.321954: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-07-27 09:36:30.327095: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-07-27 09:36:30.330229: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 09:36:30.332724: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-07-27 09:36:30.335077: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-07-27 09:36:30.347760: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x24d3b21b4f0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-07-27 09:36:30.350932: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-07-27 09:36:30.353614: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-07-27 09:36:30.358163: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-07-27 09:36:30.360563: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 09:36:30.363401: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 09:36:30.365980: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-07-27 09:36:30.368546: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-07-27 09:36:30.371467: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-07-27 09:36:30.374018: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-07-27 09:36:30.376430: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 09:36:30.379236: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-07-27 09:36:30.811616: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-07-27 09:36:30.814813: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-07-27 09:36:30.816325: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-07-27 09:36:30.818071: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-07-27 09:36:30.825434: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x24d65297a80 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-07-27 09:36:30.828541: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-07-27 09:36:32.565580: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-07-27 09:36:33.056159: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 09:36:33.719864: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 09:36:33.726565: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 09:36:35.093061: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-07-27 09:36:35.141543: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-07-27 09:36:35.457438: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
313/313 [==============================] - 11s 27ms/step
[INFOR]: Index of most vote   :152
[INFOR]: Class of most vote   :Japanese spaniel
[INFOR]: Number of most vote  :648.0


[INFOR]: Index of second most vote     :193
[INFOR]: Class of second most vote     :Australian terrier
[INFOR]: Number of second most vote    :269.0

[INFOR]: Create PDF for Positive Label

313/313 [==============================] - 9s 27ms/step
[INFOR]: Toltal norm before transform: 0.8704
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.2985

[INFOR]: Create PDF for Negative Label

313/313 [==============================] - 8s 27ms/step
[INFOR]: Recall training of class dog before transform: 648
[INFOR]: Recall training of class not dog before transform: 4958

[INFOR]: Recall training of class dog after transform: 4187
[INFOR]: Recall training of class not dog after transform: 3465
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (2000, 32, 32, 3)
[INFOR]: shape of y: (2000, 1)
63/63 [==============================] - 2s 27ms/step
[INFOR]: Index of most vote   :152
[INFOR]: Class of most vote   :Japanese spaniel
[INFOR]: Number of most vote  :140.0


[INFOR]: Index of second most vote     :153
[INFOR]: Class of second most vote     :Maltese dog, Maltese terrier, Maltese
[INFOR]: Number of second most vote    :55.0
[INFOR]: Recall testing of class dog before transform: 140
[INFOR]: Recall testing of class not dog before transform: 994

[INFOR]: Recall testing of class dog after transform: 533
[INFOR]: Recall testing of class not dog after transform: 166
[INFOR]: Complete save data
[INFOR] TOLTAL TIME: 65.3006

C:\Users\LauNT\Desktop\topology>python main.py --model_name ResNet50 --data_shape 32 32 3 --model_shape 224 224 --data_name cifar10 --class_name frog --num_img_train 5000 --num_img_test 1000
2021-07-27 09:37:37.375014: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  ResNet50
data_name =  cifar10
class_name =  frog
data_shape =  [32, 32, 3]
model_shape =  [224, 224]
output_dir =  ./output/npy_data
num_img_train =  5000
num_img_test =  1000
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (10000, 32, 32, 3)
[INFOR]: shape of y: (10000, 1)
[INFOR]: get pretrained model
2021-07-27 09:37:39.862382: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-07-27 09:37:39.887625: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-07-27 09:37:39.892534: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-07-27 09:37:39.900886: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 09:37:39.903500: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 09:37:39.909647: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-07-27 09:37:39.913204: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-07-27 09:37:39.919874: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-07-27 09:37:39.925170: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-07-27 09:37:39.928363: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 09:37:39.930871: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-07-27 09:37:39.933495: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-07-27 09:37:39.946331: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1dd38b494f0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-07-27 09:37:39.949891: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-07-27 09:37:39.952612: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-07-27 09:37:39.957637: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-07-27 09:37:39.960522: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 09:37:39.963013: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 09:37:39.965984: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-07-27 09:37:39.968976: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-07-27 09:37:39.971567: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-07-27 09:37:39.974135: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-07-27 09:37:39.976740: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 09:37:39.979767: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-07-27 09:37:40.410851: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-07-27 09:37:40.414149: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-07-27 09:37:40.415700: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-07-27 09:37:40.417454: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-07-27 09:37:40.424928: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1dd67ab1220 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-07-27 09:37:40.428119: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-07-27 09:37:42.161610: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-07-27 09:37:42.657013: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 09:37:43.322492: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 09:37:43.328090: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 09:37:44.682897: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-07-27 09:37:44.728920: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-07-27 09:37:45.043646: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
313/313 [==============================] - 11s 27ms/step
[INFOR]: Index of most vote   :335
[INFOR]: Class of most vote   :fox squirrel, eastern fox squirrel, Sciurus niger
[INFOR]: Number of most vote  :718.0


[INFOR]: Index of second most vote     :32
[INFOR]: Class of second most vote     :tailed frog, bell toad, ribbed toad, tailed toad, Ascaphus trui
[INFOR]: Number of second most vote    :590.0

[INFOR]: Create PDF for Positive Label

313/313 [==============================] - 9s 27ms/step
[INFOR]: Toltal norm before transform: 0.8249
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0184

[INFOR]: Create PDF for Negative Label

313/313 [==============================] - 8s 27ms/step
[INFOR]: Recall training of class frog before transform: 718
[INFOR]: Recall training of class not frog before transform: 4915

[INFOR]: Recall training of class frog after transform: 4576
[INFOR]: Recall training of class not frog after transform: 3339
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (2000, 32, 32, 3)
[INFOR]: shape of y: (2000, 1)
63/63 [==============================] - 2s 26ms/step
[INFOR]: Index of most vote   :335
[INFOR]: Class of most vote   :fox squirrel, eastern fox squirrel, Sciurus niger
[INFOR]: Number of most vote  :127.0


[INFOR]: Index of second most vote     :32
[INFOR]: Class of second most vote     :tailed frog, bell toad, ribbed toad, tailed toad, Ascaphus trui
[INFOR]: Number of second most vote    :114.0
[INFOR]: Recall testing of class frog before transform: 127
[INFOR]: Recall testing of class not frog before transform: 989

[INFOR]: Recall testing of class frog after transform: 970
[INFOR]: Recall testing of class not frog after transform: 423
[INFOR]: Complete save data
[INFOR] TOLTAL TIME: 65.4593

C:\Users\LauNT\Desktop\topology>python main.py --model_name ResNet50 --data_shape 32 32 3 --model_shape 224 224 --data_name cifar10 --class_name horse --num_img_train 5000 --num_img_test 1000
2021-07-27 09:38:47.175016: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  ResNet50
data_name =  cifar10
class_name =  horse
data_shape =  [32, 32, 3]
model_shape =  [224, 224]
output_dir =  ./output/npy_data
num_img_train =  5000
num_img_test =  1000
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (10000, 32, 32, 3)
[INFOR]: shape of y: (10000, 1)
[INFOR]: get pretrained model
2021-07-27 09:38:49.717071: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-07-27 09:38:49.754531: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-07-27 09:38:49.759847: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-07-27 09:38:49.768199: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 09:38:49.770677: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 09:38:49.776543: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-07-27 09:38:49.780203: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-07-27 09:38:49.786910: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-07-27 09:38:49.792146: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-07-27 09:38:49.795318: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 09:38:49.797676: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-07-27 09:38:49.800191: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-07-27 09:38:49.812818: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x113b66ecfc0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-07-27 09:38:49.816754: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-07-27 09:38:49.819340: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-07-27 09:38:49.823863: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-07-27 09:38:49.826226: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 09:38:49.829024: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 09:38:49.831726: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-07-27 09:38:49.834553: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-07-27 09:38:49.837429: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-07-27 09:38:49.839888: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-07-27 09:38:49.842354: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 09:38:49.845209: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-07-27 09:38:50.277556: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-07-27 09:38:50.280862: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-07-27 09:38:50.282431: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-07-27 09:38:50.284031: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-07-27 09:38:50.291716: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x113e269dbf0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-07-27 09:38:50.294859: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-07-27 09:38:52.040513: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-07-27 09:38:52.531223: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 09:38:53.193568: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 09:38:53.200293: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 09:38:54.554562: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-07-27 09:38:54.602652: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-07-27 09:38:54.916915: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
313/313 [==============================] - 11s 27ms/step
[INFOR]: Index of most vote   :339
[INFOR]: Class of most vote   :sorrel
[INFOR]: Number of most vote  :1889.0


[INFOR]: Index of second most vote     :268
[INFOR]: Class of second most vote     :Mexican hairless
[INFOR]: Number of second most vote    :174.0

[INFOR]: Create PDF for Positive Label

313/313 [==============================] - 9s 26ms/step
[INFOR]: Toltal norm before transform: 0.5222
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1530

[INFOR]: Create PDF for Negative Label

313/313 [==============================] - 8s 26ms/step
[INFOR]: Recall training of class horse before transform: 1889
[INFOR]: Recall training of class not horse before transform: 4979

[INFOR]: Recall training of class horse after transform: 4292
[INFOR]: Recall training of class not horse after transform: 3959
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (2000, 32, 32, 3)
[INFOR]: shape of y: (2000, 1)
63/63 [==============================] - 2s 27ms/step
[INFOR]: Index of most vote   :339
[INFOR]: Class of most vote   :sorrel
[INFOR]: Number of most vote  :377.0


[INFOR]: Index of second most vote     :210
[INFOR]: Class of second most vote     :German short-haired pointer
[INFOR]: Number of second most vote    :26.0
[INFOR]: Recall testing of class horse before transform: 377
[INFOR]: Recall testing of class not horse before transform: 993

[INFOR]: Recall testing of class horse after transform: 962
[INFOR]: Recall testing of class not horse after transform: 383
[INFOR]: Complete save data
[INFOR] TOLTAL TIME: 68.897

C:\Users\LauNT\Desktop\topology>python main.py --model_name ResNet50 --data_shape 32 32 3 --model_shape 224 224 --data_name cifar10 --class_name ship --num_img_train 5000 --num_img_test 1000
2021-07-27 09:40:00.505784: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  ResNet50
data_name =  cifar10
class_name =  ship
data_shape =  [32, 32, 3]
model_shape =  [224, 224]
output_dir =  ./output/npy_data
num_img_train =  5000
num_img_test =  1000
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (10000, 32, 32, 3)
[INFOR]: shape of y: (10000, 1)
[INFOR]: get pretrained model
2021-07-27 09:40:03.050355: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-07-27 09:40:03.074145: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-07-27 09:40:03.079059: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-07-27 09:40:03.087165: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 09:40:03.089555: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 09:40:03.095381: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-07-27 09:40:03.098983: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-07-27 09:40:03.105576: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-07-27 09:40:03.110713: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-07-27 09:40:03.113917: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 09:40:03.116234: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-07-27 09:40:03.118224: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-07-27 09:40:03.131032: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x156baf4ecc0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-07-27 09:40:03.134179: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-07-27 09:40:03.136591: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-07-27 09:40:03.141456: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-07-27 09:40:03.143902: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 09:40:03.146632: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 09:40:03.149083: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-07-27 09:40:03.151481: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-07-27 09:40:03.154102: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-07-27 09:40:03.157008: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-07-27 09:40:03.159438: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 09:40:03.161887: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-07-27 09:40:03.589508: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-07-27 09:40:03.592513: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-07-27 09:40:03.594087: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-07-27 09:40:03.595875: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-07-27 09:40:03.603223: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x156db607600 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-07-27 09:40:03.606352: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-07-27 09:40:05.356841: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-07-27 09:40:05.854269: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 09:40:06.512342: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 09:40:06.518954: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 09:40:07.853252: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-07-27 09:40:07.905864: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-07-27 09:40:08.223061: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
313/313 [==============================] - 11s 26ms/step
[INFOR]: Index of most vote   :510
[INFOR]: Class of most vote   :container ship, containership, container vessel
[INFOR]: Number of most vote  :1337.0


[INFOR]: Index of second most vote     :913
[INFOR]: Class of second most vote     :wreck
[INFOR]: Number of second most vote    :651.0

[INFOR]: Create PDF for Positive Label

313/313 [==============================] - 8s 25ms/step
[INFOR]: Toltal norm before transform: 0.6824
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1561

[INFOR]: Create PDF for Negative Label

313/313 [==============================] - 8s 26ms/step
[INFOR]: Recall training of class ship before transform: 1337
[INFOR]: Recall training of class not ship before transform: 4994

[INFOR]: Recall training of class ship after transform: 4250
[INFOR]: Recall training of class not ship after transform: 3634
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (2000, 32, 32, 3)
[INFOR]: shape of y: (2000, 1)
63/63 [==============================] - 2s 26ms/step
[INFOR]: Index of most vote   :510
[INFOR]: Class of most vote   :container ship, containership, container vessel
[INFOR]: Number of most vote  :282.0


[INFOR]: Index of second most vote     :813
[INFOR]: Class of second most vote     :spatula
[INFOR]: Number of second most vote    :127.0
[INFOR]: Recall testing of class ship before transform: 282
[INFOR]: Recall testing of class not ship before transform: 999

[INFOR]: Recall testing of class ship after transform: 937
[INFOR]: Recall testing of class not ship after transform: 371
[INFOR]: Complete save data
[INFOR] TOLTAL TIME: 67.2386

C:\Users\LauNT\Desktop\topology>python main.py --model_name ResNet50 --data_shape 32 32 3 --model_shape 224 224 --data_name cifar10 --class_name truck --num_img_train 5000 --num_img_test 1000
2021-07-27 09:41:12.107736: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  ResNet50
data_name =  cifar10
class_name =  truck
data_shape =  [32, 32, 3]
model_shape =  [224, 224]
output_dir =  ./output/npy_data
num_img_train =  5000
num_img_test =  1000
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (10000, 32, 32, 3)
[INFOR]: shape of y: (10000, 1)
[INFOR]: get pretrained model
2021-07-27 09:41:14.592112: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-07-27 09:41:14.620842: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-07-27 09:41:14.625987: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-07-27 09:41:14.634290: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 09:41:14.636647: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 09:41:14.642388: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-07-27 09:41:14.646775: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-07-27 09:41:14.653494: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-07-27 09:41:14.658789: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-07-27 09:41:14.662038: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 09:41:14.664483: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-07-27 09:41:14.666928: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-07-27 09:41:14.679494: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1bdbb8cb320 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-07-27 09:41:14.683160: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-07-27 09:41:14.685898: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-07-27 09:41:14.690530: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-07-27 09:41:14.692990: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 09:41:14.695880: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 09:41:14.698403: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-07-27 09:41:14.700798: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-07-27 09:41:14.703652: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-07-27 09:41:14.706258: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-07-27 09:41:14.708668: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 09:41:14.711048: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-07-27 09:41:15.185682: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-07-27 09:41:15.188729: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-07-27 09:41:15.190461: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-07-27 09:41:15.192129: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-07-27 09:41:15.199803: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1bdeb7bb450 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-07-27 09:41:15.202874: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-07-27 09:41:16.922706: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-07-27 09:41:17.413739: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 09:41:18.061840: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 09:41:18.068621: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 09:41:19.434615: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-07-27 09:41:19.481163: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-07-27 09:41:19.799493: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
313/313 [==============================] - 11s 27ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :2827.0


[INFOR]: Index of second most vote     :855
[INFOR]: Class of second most vote     :thimble
[INFOR]: Number of second most vote    :1070.0

[INFOR]: Create PDF for Positive Label

313/313 [==============================] - 8s 26ms/step
[INFOR]: Toltal norm before transform: 0.3664
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0093

[INFOR]: Create PDF for Negative Label

313/313 [==============================] - 8s 26ms/step
[INFOR]: Recall training of class truck before transform: 2827
[INFOR]: Recall training of class not truck before transform: 4753

[INFOR]: Recall training of class truck after transform: 4565
[INFOR]: Recall training of class not truck after transform: 4053
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (2000, 32, 32, 3)
[INFOR]: shape of y: (2000, 1)
63/63 [==============================] - 2s 26ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :574.0


[INFOR]: Index of second most vote     :855
[INFOR]: Class of second most vote     :thimble
[INFOR]: Number of second most vote    :216.0
[INFOR]: Recall testing of class truck before transform: 574
[INFOR]: Recall testing of class not truck before transform: 948

[INFOR]: Recall testing of class truck after transform: 876
[INFOR]: Recall testing of class not truck after transform: 103
[INFOR]: Complete save data
[INFOR] TOLTAL TIME: 72.3416

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3 --data_shape 32 32 3 --model_shape 300 300 --data_name cifar10 --class_name airplane --num_img_train 5000 --num_img_test 1000
2021-07-27 09:42:28.776972: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
data_name =  cifar10
class_name =  airplane
data_shape =  [32, 32, 3]
model_shape =  [300, 300]
output_dir =  ./output/npy_data
num_img_train =  5000
num_img_test =  1000
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (10000, 32, 32, 3)
[INFOR]: shape of y: (10000, 1)
[INFOR]: get pretrained model
2021-07-27 09:42:31.302251: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-07-27 09:42:31.327195: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-07-27 09:42:31.333084: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-07-27 09:42:31.342495: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 09:42:31.345336: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 09:42:31.351077: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-07-27 09:42:31.354860: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-07-27 09:42:31.361502: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-07-27 09:42:31.367052: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-07-27 09:42:31.370170: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 09:42:31.372898: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-07-27 09:42:31.375006: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-07-27 09:42:31.387340: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1fa39538390 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-07-27 09:42:31.391024: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-07-27 09:42:31.393398: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-07-27 09:42:31.398051: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-07-27 09:42:31.400908: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 09:42:31.403369: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 09:42:31.405830: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-07-27 09:42:31.408593: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-07-27 09:42:31.411030: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-07-27 09:42:31.413547: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-07-27 09:42:31.416007: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 09:42:31.418829: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-07-27 09:42:31.844990: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-07-27 09:42:31.848262: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-07-27 09:42:31.849835: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-07-27 09:42:31.851547: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-07-27 09:42:31.859034: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1fa63627a20 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-07-27 09:42:31.862006: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-07-27 09:42:34.196723: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-07-27 09:42:35.425046: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 09:42:36.078114: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 09:42:36.087563: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 09:42:37.433678: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-07-27 09:42:37.480791: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-07-27 09:42:38.061532: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
313/313 [==============================] - 24s 64ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :1598.0


[INFOR]: Index of second most vote     :855
[INFOR]: Class of second most vote     :thimble
[INFOR]: Number of second most vote    :178.0

[INFOR]: Create PDF for Positive Label

313/313 [==============================] - 21s 63ms/step
[INFOR]: Toltal norm before transform: 0.6199
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0660

[INFOR]: Create PDF for Negative Label

313/313 [==============================] - 20s 63ms/step
[INFOR]: Recall training of class airplane before transform: 1598
[INFOR]: Recall training of class not airplane before transform: 4997

[INFOR]: Recall training of class airplane after transform: 4382
[INFOR]: Recall training of class not airplane after transform: 4048
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (2000, 32, 32, 3)
[INFOR]: shape of y: (2000, 1)
63/63 [==============================] - 4s 64ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :271.0


[INFOR]: Index of second most vote     :811
[INFOR]: Class of second most vote     :space heater
[INFOR]: Number of second most vote    :44.0
[INFOR]: Recall testing of class airplane before transform: 271
[INFOR]: Recall testing of class not airplane before transform: 999

[INFOR]: Recall testing of class airplane after transform: 874
[INFOR]: Recall testing of class not airplane after transform: 343
[INFOR]: Complete save data
[INFOR] TOLTAL TIME: 108.7033

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3 --data_shape 32 32 3 --model_shape 300 300 --data_name cifar10 --class_name automobile --num_img_train 5000 --num_img_test 1000
2021-07-27 09:44:21.915922: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
data_name =  cifar10
class_name =  automobile
data_shape =  [32, 32, 3]
model_shape =  [300, 300]
output_dir =  ./output/npy_data
num_img_train =  5000
num_img_test =  1000
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (10000, 32, 32, 3)
[INFOR]: shape of y: (10000, 1)
[INFOR]: get pretrained model
2021-07-27 09:44:24.390907: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-07-27 09:44:24.422299: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-07-27 09:44:24.427889: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-07-27 09:44:24.436606: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 09:44:24.439164: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 09:44:24.445027: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-07-27 09:44:24.448511: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-07-27 09:44:24.455439: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-07-27 09:44:24.462070: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-07-27 09:44:24.465301: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 09:44:24.467962: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-07-27 09:44:24.470041: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-07-27 09:44:24.482516: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1e4b4b77f70 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-07-27 09:44:24.486122: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-07-27 09:44:24.488550: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-07-27 09:44:24.493499: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-07-27 09:44:24.496572: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 09:44:24.499011: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 09:44:24.501476: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-07-27 09:44:24.504321: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-07-27 09:44:24.506960: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-07-27 09:44:24.509453: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-07-27 09:44:24.512374: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 09:44:24.514993: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-07-27 09:44:24.954240: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-07-27 09:44:24.957608: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-07-27 09:44:24.959126: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-07-27 09:44:24.960836: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-07-27 09:44:24.968259: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1e4de7601c0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-07-27 09:44:24.971247: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-07-27 09:44:27.217174: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-07-27 09:44:28.399339: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 09:44:29.057266: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 09:44:29.065464: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 09:44:30.429305: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-07-27 09:44:30.477311: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-07-27 09:44:31.040605: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
313/313 [==============================] - 24s 65ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :1384.0


[INFOR]: Index of second most vote     :482
[INFOR]: Class of second most vote     :cassette player
[INFOR]: Number of second most vote    :529.0

[INFOR]: Create PDF for Positive Label

313/313 [==============================] - 21s 63ms/step
[INFOR]: Toltal norm before transform: 0.6532
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0115

[INFOR]: Create PDF for Negative Label

313/313 [==============================] - 20s 63ms/step
[INFOR]: Recall training of class automobile before transform: 1384
[INFOR]: Recall training of class not automobile before transform: 4682

[INFOR]: Recall training of class automobile after transform: 4720
[INFOR]: Recall training of class not automobile after transform: 3809
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (2000, 32, 32, 3)
[INFOR]: shape of y: (2000, 1)
63/63 [==============================] - 4s 63ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :293.0


[INFOR]: Index of second most vote     :482
[INFOR]: Class of second most vote     :cassette player
[INFOR]: Number of second most vote    :110.0
[INFOR]: Recall testing of class automobile before transform: 293
[INFOR]: Recall testing of class not automobile before transform: 928

[INFOR]: Recall testing of class automobile after transform: 995
[INFOR]: Recall testing of class not automobile after transform: 319
[INFOR]: Complete save data
[INFOR] TOLTAL TIME: 108.5175

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3 --data_shape 32 32 3 --model_shape 300 300 --data_name cifar10 --class_name bird --num_img_train 5000 --num_img_test 1000
2021-07-27 09:46:14.821470: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
data_name =  cifar10
class_name =  bird
data_shape =  [32, 32, 3]
model_shape =  [300, 300]
output_dir =  ./output/npy_data
num_img_train =  5000
num_img_test =  1000
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (10000, 32, 32, 3)
[INFOR]: shape of y: (10000, 1)
[INFOR]: get pretrained model
2021-07-27 09:46:17.325554: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-07-27 09:46:17.353413: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-07-27 09:46:17.359424: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-07-27 09:46:17.375705: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 09:46:17.378512: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 09:46:17.384353: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-07-27 09:46:17.388368: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-07-27 09:46:17.395227: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-07-27 09:46:17.401404: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-07-27 09:46:17.405238: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 09:46:17.407843: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-07-27 09:46:17.409852: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-07-27 09:46:17.422225: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x205b5411160 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-07-27 09:46:17.425421: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-07-27 09:46:17.429516: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-07-27 09:46:17.434537: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-07-27 09:46:17.436989: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 09:46:17.439900: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 09:46:17.442407: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-07-27 09:46:17.444778: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-07-27 09:46:17.447164: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-07-27 09:46:17.450119: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-07-27 09:46:17.452869: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 09:46:17.455333: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-07-27 09:46:17.887825: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-07-27 09:46:17.891211: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-07-27 09:46:17.892766: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-07-27 09:46:17.894459: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-07-27 09:46:17.901888: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x205e4811c60 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-07-27 09:46:17.904822: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-07-27 09:46:20.161040: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-07-27 09:46:21.349769: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 09:46:22.016140: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 09:46:22.023380: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 09:46:23.407808: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-07-27 09:46:23.456058: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-07-27 09:46:24.019721: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
313/313 [==============================] - 24s 65ms/step
[INFOR]: Index of most vote   :10
[INFOR]: Class of most vote   :brambling, Fringilla montifringilla
[INFOR]: Number of most vote  :837.0


[INFOR]: Index of second most vote     :334
[INFOR]: Class of second most vote     :porcupine, hedgehog
[INFOR]: Number of second most vote    :427.0

[INFOR]: Create PDF for Positive Label

313/313 [==============================] - 21s 62ms/step
[INFOR]: Toltal norm before transform: 0.7463
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0225

[INFOR]: Create PDF for Negative Label

313/313 [==============================] - 20s 63ms/step
[INFOR]: Recall training of class bird before transform: 837
[INFOR]: Recall training of class not bird before transform: 4998

[INFOR]: Recall training of class bird after transform: 4467
[INFOR]: Recall training of class not bird after transform: 3918
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (2000, 32, 32, 3)
[INFOR]: shape of y: (2000, 1)
63/63 [==============================] - 4s 62ms/step
[INFOR]: Index of most vote   :10
[INFOR]: Class of most vote   :brambling, Fringilla montifringilla
[INFOR]: Number of most vote  :185.0


[INFOR]: Index of second most vote     :334
[INFOR]: Class of second most vote     :porcupine, hedgehog
[INFOR]: Number of second most vote    :82.0
[INFOR]: Recall testing of class bird before transform: 185
[INFOR]: Recall testing of class not bird before transform: 1000

[INFOR]: Recall testing of class bird after transform: 897
[INFOR]: Recall testing of class not bird after transform: 461
[INFOR]: Complete save data
[INFOR] TOLTAL TIME: 106.3149

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3 --data_shape 32 32 3 --model_shape 300 300 --data_name cifar10 --class_name cat --num_img_train 5000 --num_img_test 1000
2021-07-27 09:48:05.555281: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
data_name =  cifar10
class_name =  cat
data_shape =  [32, 32, 3]
model_shape =  [300, 300]
output_dir =  ./output/npy_data
num_img_train =  5000
num_img_test =  1000
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (10000, 32, 32, 3)
[INFOR]: shape of y: (10000, 1)
[INFOR]: get pretrained model
2021-07-27 09:48:08.100666: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-07-27 09:48:08.130674: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-07-27 09:48:08.136143: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-07-27 09:48:08.144368: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 09:48:08.146773: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 09:48:08.152579: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-07-27 09:48:08.156218: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-07-27 09:48:08.162846: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-07-27 09:48:08.168613: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-07-27 09:48:08.171777: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 09:48:08.174161: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-07-27 09:48:08.176605: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-07-27 09:48:08.189675: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x209b8863b10 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-07-27 09:48:08.193005: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-07-27 09:48:08.195661: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-07-27 09:48:08.200506: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-07-27 09:48:08.203335: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 09:48:08.205866: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 09:48:08.208560: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-07-27 09:48:08.210945: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-07-27 09:48:08.213886: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-07-27 09:48:08.216335: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-07-27 09:48:08.218765: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 09:48:08.221628: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-07-27 09:48:08.654395: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-07-27 09:48:08.657538: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-07-27 09:48:08.659124: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-07-27 09:48:08.660802: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-07-27 09:48:08.668416: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x209dffad4f0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-07-27 09:48:08.671380: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-07-27 09:48:10.950262: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-07-27 09:48:12.153040: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 09:48:12.802347: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 09:48:12.810148: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 09:48:14.159620: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-07-27 09:48:14.213580: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-07-27 09:48:14.772093: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
313/313 [==============================] - 24s 64ms/step
[INFOR]: Index of most vote   :335
[INFOR]: Class of most vote   :fox squirrel, eastern fox squirrel, Sciurus niger
[INFOR]: Number of most vote  :862.0


[INFOR]: Index of second most vote     :283
[INFOR]: Class of second most vote     :Persian cat
[INFOR]: Number of second most vote    :458.0

[INFOR]: Create PDF for Positive Label

313/313 [==============================] - 21s 63ms/step
[INFOR]: Toltal norm before transform: 0.8077
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1632

[INFOR]: Create PDF for Negative Label

313/313 [==============================] - 20s 63ms/step
[INFOR]: Recall training of class cat before transform: 862
[INFOR]: Recall training of class not cat before transform: 4729

[INFOR]: Recall training of class cat after transform: 4408
[INFOR]: Recall training of class not cat after transform: 2871
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (2000, 32, 32, 3)
[INFOR]: shape of y: (2000, 1)
63/63 [==============================] - 4s 63ms/step
[INFOR]: Index of most vote   :335
[INFOR]: Class of most vote   :fox squirrel, eastern fox squirrel, Sciurus niger
[INFOR]: Number of most vote  :175.0


[INFOR]: Index of second most vote     :283
[INFOR]: Class of second most vote     :Persian cat
[INFOR]: Number of second most vote    :86.0
[INFOR]: Recall testing of class cat before transform: 175
[INFOR]: Recall testing of class not cat before transform: 949

[INFOR]: Recall testing of class cat after transform: 962
[INFOR]: Recall testing of class not cat after transform: 324
[INFOR]: Complete save data
[INFOR] TOLTAL TIME: 105.7225

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3 --data_shape 32 32 3 --model_shape 300 300 --data_name cifar10 --class_name deer --num_img_train 5000 --num_img_test 1000
2021-07-27 09:49:55.719587: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
data_name =  cifar10
class_name =  deer
data_shape =  [32, 32, 3]
model_shape =  [300, 300]
output_dir =  ./output/npy_data
num_img_train =  5000
num_img_test =  1000
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (10000, 32, 32, 3)
[INFOR]: shape of y: (10000, 1)
[INFOR]: get pretrained model
2021-07-27 09:49:58.172505: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-07-27 09:49:58.198416: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-07-27 09:49:58.203410: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-07-27 09:49:58.212109: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 09:49:58.214463: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 09:49:58.220466: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-07-27 09:49:58.224118: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-07-27 09:49:58.231064: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-07-27 09:49:58.236492: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-07-27 09:49:58.239806: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 09:49:58.242236: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-07-27 09:49:58.244649: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-07-27 09:49:58.256991: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x25db7065f80 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-07-27 09:49:58.260264: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-07-27 09:49:58.262892: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-07-27 09:49:58.267582: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-07-27 09:49:58.270049: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 09:49:58.272886: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 09:49:58.275320: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-07-27 09:49:58.277641: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-07-27 09:49:58.280324: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-07-27 09:49:58.282800: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-07-27 09:49:58.285211: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 09:49:58.287523: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-07-27 09:49:58.720046: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-07-27 09:49:58.723101: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-07-27 09:49:58.724709: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-07-27 09:49:58.726443: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-07-27 09:49:58.733734: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x25dde667670 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-07-27 09:49:58.736880: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-07-27 09:50:00.979313: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-07-27 09:50:02.149091: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 09:50:02.793527: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 09:50:02.800273: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 09:50:04.166006: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-07-27 09:50:04.214247: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-07-27 09:50:04.832903: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
313/313 [==============================] - 24s 64ms/step
[INFOR]: Index of most vote   :351
[INFOR]: Class of most vote   :hartebeest
[INFOR]: Number of most vote  :1910.0


[INFOR]: Index of second most vote     :352
[INFOR]: Class of second most vote     :impala, Aepyceros melampus
[INFOR]: Number of second most vote    :397.0

[INFOR]: Create PDF for Positive Label

313/313 [==============================] - 21s 63ms/step
[INFOR]: Toltal norm before transform: 0.5215
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0664

[INFOR]: Create PDF for Negative Label

313/313 [==============================] - 20s 63ms/step
[INFOR]: Recall training of class deer before transform: 1910
[INFOR]: Recall training of class not deer before transform: 4959

[INFOR]: Recall training of class deer after transform: 4728
[INFOR]: Recall training of class not deer after transform: 3516
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (2000, 32, 32, 3)
[INFOR]: shape of y: (2000, 1)
63/63 [==============================] - 4s 63ms/step
[INFOR]: Index of most vote   :351
[INFOR]: Class of most vote   :hartebeest
[INFOR]: Number of most vote  :386.0


[INFOR]: Index of second most vote     :352
[INFOR]: Class of second most vote     :impala, Aepyceros melampus
[INFOR]: Number of second most vote    :83.0
[INFOR]: Recall testing of class deer before transform: 386
[INFOR]: Recall testing of class not deer before transform: 994

[INFOR]: Recall testing of class deer after transform: 975
[INFOR]: Recall testing of class not deer after transform: 288
[INFOR]: Complete save data
[INFOR] TOLTAL TIME: 109.383

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3 --data_shape 32 32 3 --model_shape 300 300 --data_name cifar10 --class_name dog --num_img_train 5000 --num_img_test 1000
2021-07-27 09:51:49.449659: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
data_name =  cifar10
class_name =  dog
data_shape =  [32, 32, 3]
model_shape =  [300, 300]
output_dir =  ./output/npy_data
num_img_train =  5000
num_img_test =  1000
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (10000, 32, 32, 3)
[INFOR]: shape of y: (10000, 1)
[INFOR]: get pretrained model
2021-07-27 09:51:51.921291: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-07-27 09:51:51.945194: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-07-27 09:51:51.950124: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-07-27 09:51:51.958519: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 09:51:51.960903: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 09:51:51.967162: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-07-27 09:51:51.970781: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-07-27 09:51:51.977333: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-07-27 09:51:51.982660: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-07-27 09:51:51.985825: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 09:51:51.988133: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-07-27 09:51:51.990432: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-07-27 09:51:52.004166: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x216b9283ea0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-07-27 09:51:52.007675: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-07-27 09:51:52.010332: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-07-27 09:51:52.014825: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-07-27 09:51:52.017640: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 09:51:52.020201: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 09:51:52.022588: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-07-27 09:51:52.025027: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-07-27 09:51:52.027798: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-07-27 09:51:52.030204: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-07-27 09:51:52.032640: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 09:51:52.035316: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-07-27 09:51:52.457726: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-07-27 09:51:52.460845: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-07-27 09:51:52.462360: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-07-27 09:51:52.464026: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-07-27 09:51:52.471317: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x216e78775b0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-07-27 09:51:52.474301: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-07-27 09:51:54.725990: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-07-27 09:51:55.908302: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 09:51:56.553179: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 09:51:56.560529: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 09:51:57.926852: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-07-27 09:51:57.976033: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-07-27 09:51:58.536873: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
313/313 [==============================] - 24s 64ms/step
[INFOR]: Index of most vote   :152
[INFOR]: Class of most vote   :Japanese spaniel
[INFOR]: Number of most vote  :529.0


[INFOR]: Index of second most vote     :153
[INFOR]: Class of second most vote     :Maltese dog, Maltese terrier, Maltese
[INFOR]: Number of second most vote    :394.0

[INFOR]: Create PDF for Positive Label

313/313 [==============================] - 21s 62ms/step
[INFOR]: Toltal norm before transform: 0.8864
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1799

[INFOR]: Create PDF for Negative Label

313/313 [==============================] - 20s 62ms/step
[INFOR]: Recall training of class dog before transform: 529
[INFOR]: Recall training of class not dog before transform: 4985

[INFOR]: Recall training of class dog after transform: 4739
[INFOR]: Recall training of class not dog after transform: 3681
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (2000, 32, 32, 3)
[INFOR]: shape of y: (2000, 1)
63/63 [==============================] - 4s 63ms/step
[INFOR]: Index of most vote   :152
[INFOR]: Class of most vote   :Japanese spaniel
[INFOR]: Number of most vote  :112.0


[INFOR]: Index of second most vote     :153
[INFOR]: Class of second most vote     :Maltese dog, Maltese terrier, Maltese
[INFOR]: Number of second most vote    :89.0
[INFOR]: Recall testing of class dog before transform: 112
[INFOR]: Recall testing of class not dog before transform: 1000

[INFOR]: Recall testing of class dog after transform: 969
[INFOR]: Recall testing of class not dog after transform: 408
[INFOR]: Complete save data
[INFOR] TOLTAL TIME: 104.6732

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3 --data_shape 32 32 3 --model_shape 300 300 --data_name cifar10 --class_name frog --num_img_train 5000 --num_img_test 1000
2021-07-27 09:53:38.480361: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
data_name =  cifar10
class_name =  frog
data_shape =  [32, 32, 3]
model_shape =  [300, 300]
output_dir =  ./output/npy_data
num_img_train =  5000
num_img_test =  1000
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (10000, 32, 32, 3)
[INFOR]: shape of y: (10000, 1)
[INFOR]: get pretrained model
2021-07-27 09:53:40.939471: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-07-27 09:53:40.986544: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-07-27 09:53:40.991548: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-07-27 09:53:40.999738: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 09:53:41.002645: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 09:53:41.008589: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-07-27 09:53:41.012168: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-07-27 09:53:41.018800: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-07-27 09:53:41.024562: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-07-27 09:53:41.027727: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 09:53:41.030006: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-07-27 09:53:41.032802: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-07-27 09:53:41.046089: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1ad3b79f060 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-07-27 09:53:41.049935: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-07-27 09:53:41.052438: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-07-27 09:53:41.057121: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-07-27 09:53:41.060016: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 09:53:41.062482: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 09:53:41.065054: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-07-27 09:53:41.067470: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-07-27 09:53:41.070462: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-07-27 09:53:41.072954: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-07-27 09:53:41.075409: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 09:53:41.078217: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-07-27 09:53:41.514909: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-07-27 09:53:41.518027: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-07-27 09:53:41.519568: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-07-27 09:53:41.521226: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-07-27 09:53:41.528681: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1ad6b88f660 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-07-27 09:53:41.531691: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-07-27 09:53:43.785085: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-07-27 09:53:44.980287: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 09:53:45.626946: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 09:53:45.633800: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 09:53:46.995999: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-07-27 09:53:47.043098: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-07-27 09:53:47.656341: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
313/313 [==============================] - 24s 64ms/step
[INFOR]: Index of most vote   :335
[INFOR]: Class of most vote   :fox squirrel, eastern fox squirrel, Sciurus niger
[INFOR]: Number of most vote  :1346.0


[INFOR]: Index of second most vote     :32
[INFOR]: Class of second most vote     :tailed frog, bell toad, ribbed toad, tailed toad, Ascaphus trui
[INFOR]: Number of second most vote    :852.0

[INFOR]: Create PDF for Positive Label

313/313 [==============================] - 21s 63ms/step
[INFOR]: Toltal norm before transform: 0.7124
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0005

[INFOR]: Create PDF for Negative Label

313/313 [==============================] - 20s 63ms/step
[INFOR]: Recall training of class frog before transform: 1346
[INFOR]: Recall training of class not frog before transform: 4785

[INFOR]: Recall training of class frog after transform: 4809
[INFOR]: Recall training of class not frog after transform: 3765
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (2000, 32, 32, 3)
[INFOR]: shape of y: (2000, 1)
63/63 [==============================] - 4s 63ms/step
[INFOR]: Index of most vote   :335
[INFOR]: Class of most vote   :fox squirrel, eastern fox squirrel, Sciurus niger
[INFOR]: Number of most vote  :249.0


[INFOR]: Index of second most vote     :32
[INFOR]: Class of second most vote     :tailed frog, bell toad, ribbed toad, tailed toad, Ascaphus trui
[INFOR]: Number of second most vote    :155.0
[INFOR]: Recall testing of class frog before transform: 249
[INFOR]: Recall testing of class not frog before transform: 962

[INFOR]: Recall testing of class frog after transform: 966
[INFOR]: Recall testing of class not frog after transform: 501
[INFOR]: Complete save data
[INFOR] TOLTAL TIME: 107.9773

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3 --data_shape 32 32 3 --model_shape 300 300 --data_name cifar10 --class_name horse --num_img_train 5000 --num_img_test 1000
2021-07-27 09:55:30.830541: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
data_name =  cifar10
class_name =  horse
data_shape =  [32, 32, 3]
model_shape =  [300, 300]
output_dir =  ./output/npy_data
num_img_train =  5000
num_img_test =  1000
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (10000, 32, 32, 3)
[INFOR]: shape of y: (10000, 1)
[INFOR]: get pretrained model
2021-07-27 09:55:33.357060: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-07-27 09:55:33.410168: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-07-27 09:55:33.415768: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-07-27 09:55:33.424885: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 09:55:33.427935: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 09:55:33.434097: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-07-27 09:55:33.438351: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-07-27 09:55:33.445315: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-07-27 09:55:33.450861: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-07-27 09:55:33.454070: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 09:55:33.456759: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-07-27 09:55:33.458951: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-07-27 09:55:33.471606: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x18eb8a03500 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-07-27 09:55:33.475407: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-07-27 09:55:33.477958: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-07-27 09:55:33.483231: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-07-27 09:55:33.485772: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 09:55:33.488235: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 09:55:33.490996: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-07-27 09:55:33.493383: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-07-27 09:55:33.496085: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-07-27 09:55:33.498689: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-07-27 09:55:33.501542: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 09:55:33.504116: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-07-27 09:55:33.945886: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-07-27 09:55:33.948958: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-07-27 09:55:33.950524: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-07-27 09:55:33.952276: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-07-27 09:55:33.959895: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x18ee80a1700 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-07-27 09:55:33.962875: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-07-27 09:55:36.294291: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-07-27 09:55:37.509867: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 09:55:38.169908: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 09:55:38.177558: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 09:55:39.511487: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-07-27 09:55:39.558085: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-07-27 09:55:40.118378: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
313/313 [==============================] - 24s 64ms/step
[INFOR]: Index of most vote   :339
[INFOR]: Class of most vote   :sorrel
[INFOR]: Number of most vote  :2394.0


[INFOR]: Index of second most vote     :268
[INFOR]: Class of second most vote     :Mexican hairless
[INFOR]: Number of second most vote    :254.0

[INFOR]: Create PDF for Positive Label

313/313 [==============================] - 21s 63ms/step
[INFOR]: Toltal norm before transform: 0.2843
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0487

[INFOR]: Create PDF for Negative Label

313/313 [==============================] - 20s 62ms/step
[INFOR]: Recall training of class horse before transform: 2394
[INFOR]: Recall training of class not horse before transform: 4977

[INFOR]: Recall training of class horse after transform: 4761
[INFOR]: Recall training of class not horse after transform: 3464
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (2000, 32, 32, 3)
[INFOR]: shape of y: (2000, 1)
63/63 [==============================] - 4s 63ms/step
[INFOR]: Index of most vote   :339
[INFOR]: Class of most vote   :sorrel
[INFOR]: Number of most vote  :470.0


[INFOR]: Index of second most vote     :168
[INFOR]: Class of second most vote     :redbone
[INFOR]: Number of second most vote    :42.0
[INFOR]: Recall testing of class horse before transform: 470
[INFOR]: Recall testing of class not horse before transform: 996

[INFOR]: Recall testing of class horse after transform: 960
[INFOR]: Recall testing of class not horse after transform: 579
[INFOR]: Complete save data
[INFOR] TOLTAL TIME: 110.5218

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3 --data_shape 32 32 3 --model_shape 300 300 --data_name cifar10 --class_name ship --num_img_train 5000 --num_img_test 1000
2021-07-27 09:57:25.786757: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
data_name =  cifar10
class_name =  ship
data_shape =  [32, 32, 3]
model_shape =  [300, 300]
output_dir =  ./output/npy_data
num_img_train =  5000
num_img_test =  1000
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (10000, 32, 32, 3)
[INFOR]: shape of y: (10000, 1)
[INFOR]: get pretrained model
2021-07-27 09:57:28.271802: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-07-27 09:57:28.307792: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-07-27 09:57:28.312658: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-07-27 09:57:28.328138: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 09:57:28.330540: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 09:57:28.336118: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-07-27 09:57:28.340027: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-07-27 09:57:28.346617: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-07-27 09:57:28.352065: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-07-27 09:57:28.355298: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 09:57:28.357627: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-07-27 09:57:28.359632: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-07-27 09:57:28.372298: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x131b590cf00 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-07-27 09:57:28.376072: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-07-27 09:57:28.378377: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-07-27 09:57:28.383325: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-07-27 09:57:28.385826: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 09:57:28.388324: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 09:57:28.391096: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-07-27 09:57:28.393488: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-07-27 09:57:28.395957: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-07-27 09:57:28.398403: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-07-27 09:57:28.401191: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 09:57:28.403605: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-07-27 09:57:28.844740: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-07-27 09:57:28.847526: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-07-27 09:57:28.849103: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-07-27 09:57:28.850764: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-07-27 09:57:28.858530: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x131e3f5b070 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-07-27 09:57:28.861498: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-07-27 09:57:31.130155: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-07-27 09:57:32.325706: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 09:57:32.975328: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 09:57:32.981834: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 09:57:34.344995: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-07-27 09:57:34.399712: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-07-27 09:57:34.957779: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
313/313 [==============================] - 24s 64ms/step
[INFOR]: Index of most vote   :510
[INFOR]: Class of most vote   :container ship, containership, container vessel
[INFOR]: Number of most vote  :1427.0


[INFOR]: Index of second most vote     :913
[INFOR]: Class of second most vote     :wreck
[INFOR]: Number of second most vote    :498.0

[INFOR]: Create PDF for Positive Label

313/313 [==============================] - 21s 63ms/step
[INFOR]: Toltal norm before transform: 0.6435
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1651

[INFOR]: Create PDF for Negative Label

313/313 [==============================] - 20s 63ms/step
[INFOR]: Recall training of class ship before transform: 1427
[INFOR]: Recall training of class not ship before transform: 4957

[INFOR]: Recall training of class ship after transform: 4582
[INFOR]: Recall training of class not ship after transform: 3973
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (2000, 32, 32, 3)
[INFOR]: shape of y: (2000, 1)
63/63 [==============================] - 4s 63ms/step
[INFOR]: Index of most vote   :510
[INFOR]: Class of most vote   :container ship, containership, container vessel
[INFOR]: Number of most vote  :305.0


[INFOR]: Index of second most vote     :913
[INFOR]: Class of second most vote     :wreck
[INFOR]: Number of second most vote    :96.0
[INFOR]: Recall testing of class ship before transform: 305
[INFOR]: Recall testing of class not ship before transform: 989

[INFOR]: Recall testing of class ship after transform: 982
[INFOR]: Recall testing of class not ship after transform: 295
[INFOR]: Complete save data
[INFOR] TOLTAL TIME: 108.1287

C:\Users\LauNT\Desktop\topology>python main.py --model_name EfficientNetB3 --data_shape 32 32 3 --model_shape 300 300 --data_name cifar10 --class_name truck --num_img_train 5000 --num_img_test 1000
2021-07-27 09:59:18.316242: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  EfficientNetB3
data_name =  cifar10
class_name =  truck
data_shape =  [32, 32, 3]
model_shape =  [300, 300]
output_dir =  ./output/npy_data
num_img_train =  5000
num_img_test =  1000
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (10000, 32, 32, 3)
[INFOR]: shape of y: (10000, 1)
[INFOR]: get pretrained model
2021-07-27 09:59:20.781163: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-07-27 09:59:20.806923: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-07-27 09:59:20.811945: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-07-27 09:59:20.820374: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 09:59:20.822687: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 09:59:20.828328: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-07-27 09:59:20.831823: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-07-27 09:59:20.838557: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-07-27 09:59:20.843715: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-07-27 09:59:20.846901: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 09:59:20.849334: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-07-27 09:59:20.851307: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-07-27 09:59:20.864009: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1c234dccf70 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-07-27 09:59:20.867353: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-07-27 09:59:20.870054: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-07-27 09:59:20.874751: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-07-27 09:59:20.877185: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 09:59:20.879947: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 09:59:20.882396: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-07-27 09:59:20.885042: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-07-27 09:59:20.887868: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-07-27 09:59:20.890475: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-07-27 09:59:20.892868: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 09:59:20.895229: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-07-27 09:59:21.322468: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-07-27 09:59:21.325537: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-07-27 09:59:21.327031: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-07-27 09:59:21.328797: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-07-27 09:59:21.336090: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1c262fbd6b0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-07-27 09:59:21.339042: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-07-27 09:59:23.587197: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-07-27 09:59:24.762554: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 09:59:25.409788: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 09:59:25.416694: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 09:59:26.767361: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-07-27 09:59:26.814535: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-07-27 09:59:27.372480: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
313/313 [==============================] - 24s 63ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :2835.0


[INFOR]: Index of second most vote     :855
[INFOR]: Class of second most vote     :thimble
[INFOR]: Number of second most vote    :604.0

[INFOR]: Create PDF for Positive Label

313/313 [==============================] - 21s 63ms/step
[INFOR]: Toltal norm before transform: 0.3060
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0166

[INFOR]: Create PDF for Negative Label

313/313 [==============================] - 20s 63ms/step
[INFOR]: Recall training of class truck before transform: 2835
[INFOR]: Recall training of class not truck before transform: 4835

[INFOR]: Recall training of class truck after transform: 4711
[INFOR]: Recall training of class not truck after transform: 4045
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (2000, 32, 32, 3)
[INFOR]: shape of y: (2000, 1)
63/63 [==============================] - 4s 63ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :604.0


[INFOR]: Index of second most vote     :855
[INFOR]: Class of second most vote     :thimble
[INFOR]: Number of second most vote    :113.0
[INFOR]: Recall testing of class truck before transform: 604
[INFOR]: Recall testing of class not truck before transform: 969

[INFOR]: Recall testing of class truck after transform: 972
[INFOR]: Recall testing of class not truck after transform: 461
[INFOR]: Complete save data
[INFOR] TOLTAL TIME: 113.4638

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3 --data_shape 32 32 3 --model_shape 299 299 --data_name cifar10 --class_name airplane --num_img_train 5000 --num_img_test 1000
2021-07-27 10:01:16.145818: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
data_name =  cifar10
class_name =  airplane
data_shape =  [32, 32, 3]
model_shape =  [299, 299]
output_dir =  ./output/npy_data
num_img_train =  5000
num_img_test =  1000
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (10000, 32, 32, 3)
[INFOR]: shape of y: (10000, 1)
[INFOR]: get pretrained model
2021-07-27 10:01:18.603712: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-07-27 10:01:18.632677: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-07-27 10:01:18.637807: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-07-27 10:01:18.653317: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 10:01:18.655777: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 10:01:18.661538: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-07-27 10:01:18.665473: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-07-27 10:01:18.671938: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-07-27 10:01:18.677278: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-07-27 10:01:18.680510: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 10:01:18.683084: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-07-27 10:01:18.685096: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-07-27 10:01:18.698108: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x14eb7a63f00 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-07-27 10:01:18.701663: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-07-27 10:01:18.703986: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-07-27 10:01:18.708947: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-07-27 10:01:18.711297: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 10:01:18.713656: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 10:01:18.716146: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-07-27 10:01:18.718929: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-07-27 10:01:18.721382: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-07-27 10:01:18.723777: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-07-27 10:01:18.726644: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 10:01:18.729130: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-07-27 10:01:19.158146: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-07-27 10:01:19.161236: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-07-27 10:01:19.162843: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-07-27 10:01:19.164465: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-07-27 10:01:19.171679: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x14ee62884e0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-07-27 10:01:19.174632: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-07-27 10:01:21.246847: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-07-27 10:01:21.935126: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 10:01:22.577851: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 10:01:22.585080: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 10:01:23.952785: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-07-27 10:01:24.001224: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-07-27 10:01:24.739407: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
313/313 [==============================] - 14s 34ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :2008.0


[INFOR]: Index of second most vote     :472
[INFOR]: Class of second most vote     :canoe
[INFOR]: Number of second most vote    :205.0

[INFOR]: Create PDF for Positive Label

313/313 [==============================] - 11s 32ms/step
[INFOR]: Toltal norm before transform: 0.5391
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0853

[INFOR]: Create PDF for Negative Label

313/313 [==============================] - 10s 32ms/step
[INFOR]: Recall training of class airplane before transform: 2008
[INFOR]: Recall training of class not airplane before transform: 4985

[INFOR]: Recall training of class airplane after transform: 3751
[INFOR]: Recall training of class not airplane after transform: 3655
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (2000, 32, 32, 3)
[INFOR]: shape of y: (2000, 1)
63/63 [==============================] - 2s 32ms/step
[INFOR]: Index of most vote   :404
[INFOR]: Class of most vote   :airliner
[INFOR]: Number of most vote  :360.0


[INFOR]: Index of second most vote     :472
[INFOR]: Class of second most vote     :canoe
[INFOR]: Number of second most vote    :48.0
[INFOR]: Recall testing of class airplane before transform: 360
[INFOR]: Recall testing of class not airplane before transform: 998

[INFOR]: Recall testing of class airplane after transform: 792
[INFOR]: Recall testing of class not airplane after transform: 382
[INFOR]: Complete save data
[INFOR] TOLTAL TIME: 76.2529

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3 --data_shape 32 32 3 --model_shape 299 299 --data_name cifar10 --class_name automobile --num_img_train 5000 --num_img_test 1000
2021-07-27 10:02:36.731853: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
data_name =  cifar10
class_name =  automobile
data_shape =  [32, 32, 3]
model_shape =  [299, 299]
output_dir =  ./output/npy_data
num_img_train =  5000
num_img_test =  1000
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (10000, 32, 32, 3)
[INFOR]: shape of y: (10000, 1)
[INFOR]: get pretrained model
2021-07-27 10:02:39.210385: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-07-27 10:02:39.237010: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-07-27 10:02:39.241717: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-07-27 10:02:39.256921: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 10:02:39.259327: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 10:02:39.264905: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-07-27 10:02:39.268851: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-07-27 10:02:39.275306: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-07-27 10:02:39.280790: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-07-27 10:02:39.284092: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 10:02:39.286450: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-07-27 10:02:39.288600: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-07-27 10:02:39.302047: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x22b3720bec0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-07-27 10:02:39.306010: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-07-27 10:02:39.308441: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-07-27 10:02:39.313305: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-07-27 10:02:39.315795: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 10:02:39.318280: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 10:02:39.321084: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-07-27 10:02:39.323525: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-07-27 10:02:39.325875: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-07-27 10:02:39.328272: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-07-27 10:02:39.331134: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 10:02:39.333549: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-07-27 10:02:39.758271: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-07-27 10:02:39.761558: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-07-27 10:02:39.763106: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-07-27 10:02:39.764826: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-07-27 10:02:39.772132: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x22b66bb4130 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-07-27 10:02:39.775101: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-07-27 10:02:41.785354: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-07-27 10:02:42.465786: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 10:02:43.118740: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 10:02:43.125519: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 10:02:44.468965: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-07-27 10:02:44.522172: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-07-27 10:02:45.238608: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
313/313 [==============================] - 14s 34ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :1886.0


[INFOR]: Index of second most vote     :408
[INFOR]: Class of second most vote     :amphibian, amphibious vehicle
[INFOR]: Number of second most vote    :549.0

[INFOR]: Create PDF for Positive Label

313/313 [==============================] - 11s 32ms/step
[INFOR]: Toltal norm before transform: 0.5833
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.3645

[INFOR]: Create PDF for Negative Label

313/313 [==============================] - 10s 32ms/step
[INFOR]: Recall training of class automobile before transform: 1886
[INFOR]: Recall training of class not automobile before transform: 4606

[INFOR]: Recall training of class automobile after transform: 4450
[INFOR]: Recall training of class not automobile after transform: 4028
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (2000, 32, 32, 3)
[INFOR]: shape of y: (2000, 1)
63/63 [==============================] - 2s 32ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :380.0


[INFOR]: Index of second most vote     :511
[INFOR]: Class of second most vote     :convertible
[INFOR]: Number of second most vote    :96.0
[INFOR]: Recall testing of class automobile before transform: 380
[INFOR]: Recall testing of class not automobile before transform: 912

[INFOR]: Recall testing of class automobile after transform: 625
[INFOR]: Recall testing of class not automobile after transform: 96
[INFOR]: Complete save data
[INFOR] TOLTAL TIME: 75.2022

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3 --data_shape 32 32 3 --model_shape 299 299 --data_name cifar10 --class_name bird --num_img_train 5000 --num_img_test 1000
2021-07-27 10:03:56.277937: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
data_name =  cifar10
class_name =  bird
data_shape =  [32, 32, 3]
model_shape =  [299, 299]
output_dir =  ./output/npy_data
num_img_train =  5000
num_img_test =  1000
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (10000, 32, 32, 3)
[INFOR]: shape of y: (10000, 1)
[INFOR]: get pretrained model
2021-07-27 10:03:58.767468: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-07-27 10:03:58.792520: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-07-27 10:03:58.797309: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-07-27 10:03:58.805753: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 10:03:58.808152: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 10:03:58.813983: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-07-27 10:03:58.817826: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-07-27 10:03:58.824456: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-07-27 10:03:58.829651: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-07-27 10:03:58.832709: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 10:03:58.835012: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-07-27 10:03:58.836992: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-07-27 10:03:58.849429: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x24837d00f30 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-07-27 10:03:58.852808: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-07-27 10:03:58.855127: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-07-27 10:03:58.860037: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-07-27 10:03:58.862495: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 10:03:58.865192: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 10:03:58.867609: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-07-27 10:03:58.869987: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-07-27 10:03:58.872532: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-07-27 10:03:58.875341: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-07-27 10:03:58.877807: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 10:03:58.880245: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-07-27 10:03:59.308730: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-07-27 10:03:59.311639: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-07-27 10:03:59.313178: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-07-27 10:03:59.314812: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-07-27 10:03:59.322168: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x248637717e0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-07-27 10:03:59.325218: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-07-27 10:04:01.355785: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-07-27 10:04:02.049904: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 10:04:02.699127: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 10:04:02.705739: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 10:04:04.060844: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-07-27 10:04:04.109155: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-07-27 10:04:04.829222: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
313/313 [==============================] - 14s 34ms/step
[INFOR]: Index of most vote   :10
[INFOR]: Class of most vote   :brambling, Fringilla montifringilla
[INFOR]: Number of most vote  :600.0


[INFOR]: Index of second most vote     :79
[INFOR]: Class of second most vote     :centipede
[INFOR]: Number of second most vote    :323.0

[INFOR]: Create PDF for Positive Label

313/313 [==============================] - 11s 32ms/step
[INFOR]: Toltal norm before transform: 0.8656
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.2292

[INFOR]: Create PDF for Negative Label

313/313 [==============================] - 10s 32ms/step
[INFOR]: Recall training of class bird before transform: 600
[INFOR]: Recall training of class not bird before transform: 4999

[INFOR]: Recall training of class bird after transform: 3753
[INFOR]: Recall training of class not bird after transform: 3358
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (2000, 32, 32, 3)
[INFOR]: shape of y: (2000, 1)
63/63 [==============================] - 2s 32ms/step
[INFOR]: Index of most vote   :10
[INFOR]: Class of most vote   :brambling, Fringilla montifringilla
[INFOR]: Number of most vote  :125.0


[INFOR]: Index of second most vote     :79
[INFOR]: Class of second most vote     :centipede
[INFOR]: Number of second most vote    :73.0
[INFOR]: Recall testing of class bird before transform: 125
[INFOR]: Recall testing of class not bird before transform: 1000

[INFOR]: Recall testing of class bird after transform: 944
[INFOR]: Recall testing of class not bird after transform: 268
[INFOR]: Complete save data
[INFOR] TOLTAL TIME: 71.8761

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3 --data_shape 32 32 3 --model_shape 299 299 --data_name cifar10 --class_name cat --num_img_train 5000 --num_img_test 1000
2021-07-27 10:05:12.529724: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
data_name =  cifar10
class_name =  cat
data_shape =  [32, 32, 3]
model_shape =  [299, 299]
output_dir =  ./output/npy_data
num_img_train =  5000
num_img_test =  1000
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (10000, 32, 32, 3)
[INFOR]: shape of y: (10000, 1)
[INFOR]: get pretrained model
2021-07-27 10:05:14.970971: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-07-27 10:05:14.994041: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-07-27 10:05:14.998747: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-07-27 10:05:15.007141: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 10:05:15.009488: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 10:05:15.014984: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-07-27 10:05:15.018722: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-07-27 10:05:15.025026: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-07-27 10:05:15.030290: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-07-27 10:05:15.033504: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 10:05:15.035876: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-07-27 10:05:15.037892: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-07-27 10:05:15.050553: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1eab61ef560 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-07-27 10:05:15.053803: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-07-27 10:05:15.056212: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-07-27 10:05:15.061340: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-07-27 10:05:15.063798: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 10:05:15.066555: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 10:05:15.069093: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-07-27 10:05:15.071480: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-07-27 10:05:15.073960: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-07-27 10:05:15.076767: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-07-27 10:05:15.079254: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 10:05:15.081823: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-07-27 10:05:15.508263: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-07-27 10:05:15.511341: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-07-27 10:05:15.512939: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-07-27 10:05:15.514684: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-07-27 10:05:15.522235: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1eae66a2a30 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-07-27 10:05:15.525207: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-07-27 10:05:17.541632: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-07-27 10:05:18.226765: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 10:05:18.877026: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 10:05:18.883564: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 10:05:20.238258: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-07-27 10:05:20.286275: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-07-27 10:05:21.008855: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
313/313 [==============================] - 14s 34ms/step
[INFOR]: Index of most vote   :281
[INFOR]: Class of most vote   :tabby, tabby cat
[INFOR]: Number of most vote  :260.0


[INFOR]: Index of second most vote     :152
[INFOR]: Class of second most vote     :Japanese spaniel
[INFOR]: Number of second most vote    :229.0

[INFOR]: Create PDF for Positive Label

313/313 [==============================] - 11s 32ms/step
[INFOR]: Toltal norm before transform: 0.9505
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.2393

[INFOR]: Create PDF for Negative Label

313/313 [==============================] - 10s 32ms/step
[INFOR]: Recall training of class cat before transform: 260
[INFOR]: Recall training of class not cat before transform: 5000

[INFOR]: Recall training of class cat after transform: 3912
[INFOR]: Recall training of class not cat after transform: 3531
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (2000, 32, 32, 3)
[INFOR]: shape of y: (2000, 1)
63/63 [==============================] - 2s 32ms/step
[INFOR]: Index of most vote   :152
[INFOR]: Class of most vote   :Japanese spaniel
[INFOR]: Number of most vote  :57.0


[INFOR]: Index of second most vote     :280
[INFOR]: Class of second most vote     :grey fox, gray fox, Urocyon cinereoargenteus
[INFOR]: Number of second most vote    :46.0
[INFOR]: Recall testing of class cat before transform: 57
[INFOR]: Recall testing of class not cat before transform: 986

[INFOR]: Recall testing of class cat after transform: 836
[INFOR]: Recall testing of class not cat after transform: 542
[INFOR]: Complete save data
[INFOR] TOLTAL TIME: 70.3905

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3 --data_shape 32 32 3 --model_shape 299 299 --data_name cifar10 --class_name deer --num_img_train 5000 --num_img_test 1000
2021-07-27 10:06:27.250967: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
data_name =  cifar10
class_name =  deer
data_shape =  [32, 32, 3]
model_shape =  [299, 299]
output_dir =  ./output/npy_data
num_img_train =  5000
num_img_test =  1000
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (10000, 32, 32, 3)
[INFOR]: shape of y: (10000, 1)
[INFOR]: get pretrained model
2021-07-27 10:06:29.788530: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-07-27 10:06:29.813563: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-07-27 10:06:29.818288: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-07-27 10:06:29.826596: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 10:06:29.828884: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 10:06:29.834541: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-07-27 10:06:29.838084: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-07-27 10:06:29.844709: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-07-27 10:06:29.849845: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-07-27 10:06:29.852920: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 10:06:29.855417: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-07-27 10:06:29.857437: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-07-27 10:06:29.870088: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1c9b63af1f0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-07-27 10:06:29.873169: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-07-27 10:06:29.875544: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-07-27 10:06:29.880423: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-07-27 10:06:29.882948: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 10:06:29.885891: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 10:06:29.888325: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-07-27 10:06:29.890837: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-07-27 10:06:29.893267: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-07-27 10:06:29.896105: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-07-27 10:06:29.898559: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 10:06:29.901059: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-07-27 10:06:30.326767: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-07-27 10:06:30.329769: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-07-27 10:06:30.331304: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-07-27 10:06:30.333029: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-07-27 10:06:30.340416: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1c9e5b7dd60 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-07-27 10:06:30.343416: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-07-27 10:06:32.401550: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-07-27 10:06:33.100785: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 10:06:33.755776: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 10:06:33.761861: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 10:06:35.103024: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-07-27 10:06:35.158460: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-07-27 10:06:35.877913: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
313/313 [==============================] - 14s 34ms/step
[INFOR]: Index of most vote   :351
[INFOR]: Class of most vote   :hartebeest
[INFOR]: Number of most vote  :1033.0


[INFOR]: Index of second most vote     :339
[INFOR]: Class of second most vote     :sorrel
[INFOR]: Number of second most vote    :538.0

[INFOR]: Create PDF for Positive Label

313/313 [==============================] - 11s 32ms/step
[INFOR]: Toltal norm before transform: 0.7501
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1839

[INFOR]: Create PDF for Negative Label

313/313 [==============================] - 10s 32ms/step
[INFOR]: Recall training of class deer before transform: 1033
[INFOR]: Recall training of class not deer before transform: 4986

[INFOR]: Recall training of class deer after transform: 4163
[INFOR]: Recall training of class not deer after transform: 3623
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (2000, 32, 32, 3)
[INFOR]: shape of y: (2000, 1)
63/63 [==============================] - 2s 32ms/step
[INFOR]: Index of most vote   :351
[INFOR]: Class of most vote   :hartebeest
[INFOR]: Number of most vote  :199.0


[INFOR]: Index of second most vote     :339
[INFOR]: Class of second most vote     :sorrel
[INFOR]: Number of second most vote    :115.0
[INFOR]: Recall testing of class deer before transform: 199
[INFOR]: Recall testing of class not deer before transform: 999

[INFOR]: Recall testing of class deer after transform: 857
[INFOR]: Recall testing of class not deer after transform: 671
[INFOR]: Complete save data
[INFOR] TOLTAL TIME: 73.0872

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3 --data_shape 32 32 3 --model_shape 299 299 --data_name cifar10 --class_name dog --num_img_train 5000 --num_img_test 1000
2021-07-27 10:07:44.716259: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
data_name =  cifar10
class_name =  dog
data_shape =  [32, 32, 3]
model_shape =  [299, 299]
output_dir =  ./output/npy_data
num_img_train =  5000
num_img_test =  1000
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (10000, 32, 32, 3)
[INFOR]: shape of y: (10000, 1)
[INFOR]: get pretrained model
2021-07-27 10:07:47.181040: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-07-27 10:07:47.206691: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-07-27 10:07:47.211461: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-07-27 10:07:47.226892: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 10:07:47.229368: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 10:07:47.234991: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-07-27 10:07:47.239040: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-07-27 10:07:47.245692: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-07-27 10:07:47.250854: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-07-27 10:07:47.253971: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 10:07:47.256263: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-07-27 10:07:47.258308: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-07-27 10:07:47.270708: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x20b3b4811e0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-07-27 10:07:47.274299: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-07-27 10:07:47.276679: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-07-27 10:07:47.281487: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-07-27 10:07:47.283869: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 10:07:47.286215: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 10:07:47.288684: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-07-27 10:07:47.291423: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-07-27 10:07:47.293989: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-07-27 10:07:47.296377: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-07-27 10:07:47.299175: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 10:07:47.301647: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-07-27 10:07:47.729021: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-07-27 10:07:47.731989: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-07-27 10:07:47.733480: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-07-27 10:07:47.735129: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-07-27 10:07:47.742303: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x20b662852e0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-07-27 10:07:47.745213: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-07-27 10:07:49.752918: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-07-27 10:07:50.437073: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 10:07:51.085956: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 10:07:51.092106: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 10:07:52.435194: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-07-27 10:07:52.488062: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-07-27 10:07:53.204160: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
313/313 [==============================] - 14s 33ms/step
[INFOR]: Index of most vote   :152
[INFOR]: Class of most vote   :Japanese spaniel
[INFOR]: Number of most vote  :875.0


[INFOR]: Index of second most vote     :193
[INFOR]: Class of second most vote     :Australian terrier
[INFOR]: Number of second most vote    :240.0

[INFOR]: Create PDF for Positive Label

313/313 [==============================] - 11s 32ms/step
[INFOR]: Toltal norm before transform: 0.8079
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.3525

[INFOR]: Create PDF for Negative Label

313/313 [==============================] - 10s 32ms/step
[INFOR]: Recall training of class dog before transform: 875
[INFOR]: Recall training of class not dog before transform: 4947

[INFOR]: Recall training of class dog after transform: 3513
[INFOR]: Recall training of class not dog after transform: 3295
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (2000, 32, 32, 3)
[INFOR]: shape of y: (2000, 1)
63/63 [==============================] - 2s 32ms/step
[INFOR]: Index of most vote   :152
[INFOR]: Class of most vote   :Japanese spaniel
[INFOR]: Number of most vote  :177.0


[INFOR]: Index of second most vote     :153
[INFOR]: Class of second most vote     :Maltese dog, Maltese terrier, Maltese
[INFOR]: Number of second most vote    :54.0
[INFOR]: Recall testing of class dog before transform: 177
[INFOR]: Recall testing of class not dog before transform: 990

[INFOR]: Recall testing of class dog after transform: 603
[INFOR]: Recall testing of class not dog after transform: 508
[INFOR]: Complete save data
[INFOR] TOLTAL TIME: 72.4031

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3 --data_shape 32 32 3 --model_shape 299 299 --data_name cifar10 --class_name frog --num_img_train 5000 --num_img_test 1000
2021-07-27 10:09:01.436882: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
data_name =  cifar10
class_name =  frog
data_shape =  [32, 32, 3]
model_shape =  [299, 299]
output_dir =  ./output/npy_data
num_img_train =  5000
num_img_test =  1000
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (10000, 32, 32, 3)
[INFOR]: shape of y: (10000, 1)
[INFOR]: get pretrained model
2021-07-27 10:09:03.875586: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-07-27 10:09:03.899277: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-07-27 10:09:03.903918: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-07-27 10:09:03.919188: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 10:09:03.921631: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 10:09:03.927138: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-07-27 10:09:03.931004: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-07-27 10:09:03.937358: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-07-27 10:09:03.942547: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-07-27 10:09:03.945691: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 10:09:03.948239: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-07-27 10:09:03.950209: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-07-27 10:09:03.962513: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x22138801d40 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-07-27 10:09:03.966186: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-07-27 10:09:03.968654: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-07-27 10:09:03.973596: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-07-27 10:09:03.975984: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 10:09:03.978374: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 10:09:03.980872: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-07-27 10:09:03.983723: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-07-27 10:09:03.986285: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-07-27 10:09:03.988752: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-07-27 10:09:03.991533: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 10:09:03.993912: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-07-27 10:09:04.417369: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-07-27 10:09:04.420666: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-07-27 10:09:04.422282: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-07-27 10:09:04.423938: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-07-27 10:09:04.431235: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x2216708fa20 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-07-27 10:09:04.434127: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-07-27 10:09:06.439573: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-07-27 10:09:07.118397: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 10:09:07.771358: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 10:09:07.777683: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 10:09:09.130634: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-07-27 10:09:09.183789: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-07-27 10:09:09.904458: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
313/313 [==============================] - 14s 33ms/step
[INFOR]: Index of most vote   :335
[INFOR]: Class of most vote   :fox squirrel, eastern fox squirrel, Sciurus niger
[INFOR]: Number of most vote  :744.0


[INFOR]: Index of second most vote     :32
[INFOR]: Class of second most vote     :tailed frog, bell toad, ribbed toad, tailed toad, Ascaphus trui
[INFOR]: Number of second most vote    :492.0

[INFOR]: Create PDF for Positive Label

313/313 [==============================] - 11s 32ms/step
[INFOR]: Toltal norm before transform: 0.8313
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0003

[INFOR]: Create PDF for Negative Label

313/313 [==============================] - 10s 32ms/step
[INFOR]: Recall training of class frog before transform: 744
[INFOR]: Recall training of class not frog before transform: 4928

[INFOR]: Recall training of class frog after transform: 4385
[INFOR]: Recall training of class not frog after transform: 3969
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (2000, 32, 32, 3)
[INFOR]: shape of y: (2000, 1)
63/63 [==============================] - 2s 32ms/step
[INFOR]: Index of most vote   :335
[INFOR]: Class of most vote   :fox squirrel, eastern fox squirrel, Sciurus niger
[INFOR]: Number of most vote  :147.0


[INFOR]: Index of second most vote     :32
[INFOR]: Class of second most vote     :tailed frog, bell toad, ribbed toad, tailed toad, Ascaphus trui
[INFOR]: Number of second most vote    :83.0
[INFOR]: Recall testing of class frog before transform: 147
[INFOR]: Recall testing of class not frog before transform: 986

[INFOR]: Recall testing of class frog after transform: 865
[INFOR]: Recall testing of class not frog after transform: 740
[INFOR]: Complete save data
[INFOR] TOLTAL TIME: 71.9731

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3 --data_shape 32 32 3 --model_shape 299 299 --data_name cifar10 --class_name horse --num_img_train 5000 --num_img_test 1000
2021-07-27 10:10:17.709001: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
data_name =  cifar10
class_name =  horse
data_shape =  [32, 32, 3]
model_shape =  [299, 299]
output_dir =  ./output/npy_data
num_img_train =  5000
num_img_test =  1000
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (10000, 32, 32, 3)
[INFOR]: shape of y: (10000, 1)
[INFOR]: get pretrained model
2021-07-27 10:10:20.154491: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-07-27 10:10:20.179197: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-07-27 10:10:20.183943: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-07-27 10:10:20.192299: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 10:10:20.194657: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 10:10:20.200524: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-07-27 10:10:20.204231: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-07-27 10:10:20.210981: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-07-27 10:10:20.216231: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-07-27 10:10:20.219352: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 10:10:20.221787: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-07-27 10:10:20.223827: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-07-27 10:10:20.236971: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x187b8ecc970 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-07-27 10:10:20.240602: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-07-27 10:10:20.243201: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-07-27 10:10:20.247886: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-07-27 10:10:20.250324: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 10:10:20.253162: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 10:10:20.255659: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-07-27 10:10:20.258110: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-07-27 10:10:20.260980: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-07-27 10:10:20.263512: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-07-27 10:10:20.265942: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 10:10:20.268416: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-07-27 10:10:20.694965: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-07-27 10:10:20.698664: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-07-27 10:10:20.700398: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-07-27 10:10:20.702316: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-07-27 10:10:20.709434: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x187e3a3e4f0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-07-27 10:10:20.712480: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-07-27 10:10:22.717298: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-07-27 10:10:23.398963: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 10:10:24.046741: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 10:10:24.053203: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 10:10:25.403348: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-07-27 10:10:25.452101: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-07-27 10:10:26.167835: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
313/313 [==============================] - 14s 34ms/step
[INFOR]: Index of most vote   :339
[INFOR]: Class of most vote   :sorrel
[INFOR]: Number of most vote  :2753.0


[INFOR]: Index of second most vote     :167
[INFOR]: Class of second most vote     :English foxhound
[INFOR]: Number of second most vote    :147.0

[INFOR]: Create PDF for Positive Label

313/313 [==============================] - 11s 32ms/step
[INFOR]: Toltal norm before transform: 0.3184
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1037

[INFOR]: Create PDF for Negative Label

313/313 [==============================] - 10s 32ms/step
[INFOR]: Recall training of class horse before transform: 2753
[INFOR]: Recall training of class not horse before transform: 4932

[INFOR]: Recall training of class horse after transform: 4099
[INFOR]: Recall training of class not horse after transform: 4407
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (2000, 32, 32, 3)
[INFOR]: shape of y: (2000, 1)
63/63 [==============================] - 2s 32ms/step
[INFOR]: Index of most vote   :339
[INFOR]: Class of most vote   :sorrel
[INFOR]: Number of most vote  :532.0


[INFOR]: Index of second most vote     :167
[INFOR]: Class of second most vote     :English foxhound
[INFOR]: Number of second most vote    :23.0
[INFOR]: Recall testing of class horse before transform: 532
[INFOR]: Recall testing of class not horse before transform: 985

[INFOR]: Recall testing of class horse after transform: 993
[INFOR]: Recall testing of class not horse after transform: 23
[INFOR]: Complete save data
[INFOR] TOLTAL TIME: 79.4773

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3 --data_shape 32 32 3 --model_shape 299 299 --data_name cifar10 --class_name ship --num_img_train 5000 --num_img_test 1000
2021-07-27 10:11:41.487564: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
data_name =  cifar10
class_name =  ship
data_shape =  [32, 32, 3]
model_shape =  [299, 299]
output_dir =  ./output/npy_data
num_img_train =  5000
num_img_test =  1000
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (10000, 32, 32, 3)
[INFOR]: shape of y: (10000, 1)
[INFOR]: get pretrained model
2021-07-27 10:11:43.960153: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-07-27 10:11:43.984832: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-07-27 10:11:43.989465: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-07-27 10:11:43.997638: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 10:11:44.000009: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 10:11:44.005715: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-07-27 10:11:44.009364: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-07-27 10:11:44.015953: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-07-27 10:11:44.021138: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-07-27 10:11:44.024270: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 10:11:44.026539: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-07-27 10:11:44.028522: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-07-27 10:11:44.041251: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1493b719b60 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-07-27 10:11:44.044461: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-07-27 10:11:44.046804: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-07-27 10:11:44.052098: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-07-27 10:11:44.054520: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 10:11:44.057375: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 10:11:44.059845: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-07-27 10:11:44.062256: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-07-27 10:11:44.064921: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-07-27 10:11:44.067847: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-07-27 10:11:44.070277: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 10:11:44.072909: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-07-27 10:11:44.502991: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-07-27 10:11:44.505787: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-07-27 10:11:44.507518: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-07-27 10:11:44.509218: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-07-27 10:11:44.517053: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1496b5b1df0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-07-27 10:11:44.520129: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-07-27 10:11:46.550919: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-07-27 10:11:47.254525: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 10:11:47.907202: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 10:11:47.913073: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 10:11:49.258489: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-07-27 10:11:49.312225: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-07-27 10:11:50.031068: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
313/313 [==============================] - 14s 34ms/step
[INFOR]: Index of most vote   :510
[INFOR]: Class of most vote   :container ship, containership, container vessel
[INFOR]: Number of most vote  :1481.0


[INFOR]: Index of second most vote     :813
[INFOR]: Class of second most vote     :spatula
[INFOR]: Number of second most vote    :723.0

[INFOR]: Create PDF for Positive Label

313/313 [==============================] - 11s 32ms/step
[INFOR]: Toltal norm before transform: 0.6919
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.1548

[INFOR]: Create PDF for Negative Label

313/313 [==============================] - 10s 32ms/step
[INFOR]: Recall training of class ship before transform: 1481
[INFOR]: Recall training of class not ship before transform: 4940

[INFOR]: Recall training of class ship after transform: 3629
[INFOR]: Recall training of class not ship after transform: 3779
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (2000, 32, 32, 3)
[INFOR]: shape of y: (2000, 1)
63/63 [==============================] - 2s 32ms/step
[INFOR]: Index of most vote   :510
[INFOR]: Class of most vote   :container ship, containership, container vessel
[INFOR]: Number of most vote  :306.0


[INFOR]: Index of second most vote     :813
[INFOR]: Class of second most vote     :spatula
[INFOR]: Number of second most vote    :152.0
[INFOR]: Recall testing of class ship before transform: 306
[INFOR]: Recall testing of class not ship before transform: 987

[INFOR]: Recall testing of class ship after transform: 906
[INFOR]: Recall testing of class not ship after transform: 384
[INFOR]: Complete save data
[INFOR] TOLTAL TIME: 75.1243

C:\Users\LauNT\Desktop\topology>python main.py --model_name InceptionV3 --data_shape 32 32 3 --model_shape 299 299 --data_name cifar10 --class_name truck --num_img_train 5000 --num_img_test 1000
2021-07-27 10:13:00.948135: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
model_name =  InceptionV3
data_name =  cifar10
class_name =  truck
data_shape =  [32, 32, 3]
model_shape =  [299, 299]
output_dir =  ./output/npy_data
num_img_train =  5000
num_img_test =  1000
==================== TRAINING STAGE ====================
[INFOR]: shape of x: (10000, 32, 32, 3)
[INFOR]: shape of y: (10000, 1)
[INFOR]: get pretrained model
2021-07-27 10:13:03.410922: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library nvcuda.dll
2021-07-27 10:13:03.435221: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-07-27 10:13:03.439850: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-07-27 10:13:03.448148: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 10:13:03.450504: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 10:13:03.456430: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-07-27 10:13:03.459971: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-07-27 10:13:03.466498: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-07-27 10:13:03.471751: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-07-27 10:13:03.474957: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 10:13:03.477528: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-07-27 10:13:03.479771: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-07-27 10:13:03.492694: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1ff3cae6d20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-07-27 10:13:03.495780: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-07-27 10:13:03.498318: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.785GHz coreCount: 82 deviceMemorySize: 24.00GiB deviceMemoryBandwidth: 871.81GiB/s
2021-07-27 10:13:03.502822: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
2021-07-27 10:13:03.505279: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 10:13:03.508122: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 10:13:03.510551: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cufft64_10.dll
2021-07-27 10:13:03.512911: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library curand64_10.dll
2021-07-27 10:13:03.515272: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusolver64_10.dll
2021-07-27 10:13:03.518079: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cusparse64_11.dll
2021-07-27 10:13:03.520530: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 10:13:03.522970: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-07-27 10:13:03.946048: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-07-27 10:13:03.949388: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-07-27 10:13:03.950961: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-07-27 10:13:03.952827: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19110 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-07-27 10:13:03.961402: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1ff6c35b3b0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-07-27 10:13:03.965180: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-07-27 10:13:05.964669: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-07-27 10:13:06.652502: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2021-07-27 10:13:07.323873: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2021-07-27 10:13:07.331039: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2021-07-27 10:13:08.663548: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-07-27 10:13:08.712334: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2021-07-27 10:13:09.427871: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
313/313 [==============================] - 14s 33ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :3243.0


[INFOR]: Index of second most vote     :855
[INFOR]: Class of second most vote     :thimble
[INFOR]: Number of second most vote    :690.0

[INFOR]: Create PDF for Positive Label

313/313 [==============================] - 11s 32ms/step
[INFOR]: Toltal norm before transform: 0.2759
[INFOR]: Start create matrix geometry transform R
[INFOR]: Shape of matrix R: 17x17
[INFOR]: Toltal norm after transform: 0.0066

[INFOR]: Create PDF for Negative Label

313/313 [==============================] - 10s 32ms/step
[INFOR]: Recall training of class truck before transform: 3243
[INFOR]: Recall training of class not truck before transform: 4763

[INFOR]: Recall training of class truck after transform: 4344
[INFOR]: Recall training of class not truck after transform: 4224
[INFOR]

==================== TESTING STAGE ====================


[INFOR]: shape of x: (2000, 32, 32, 3)
[INFOR]: shape of y: (2000, 1)
63/63 [==============================] - 2s 32ms/step
[INFOR]: Index of most vote   :675
[INFOR]: Class of most vote   :moving van
[INFOR]: Number of most vote  :661.0


[INFOR]: Index of second most vote     :855
[INFOR]: Class of second most vote     :thimble
[INFOR]: Number of second most vote    :131.0
[INFOR]: Recall testing of class truck before transform: 661
[INFOR]: Recall testing of class not truck before transform: 965

[INFOR]: Recall testing of class truck after transform: 930
[INFOR]: Recall testing of class not truck after transform: 11
[INFOR]: Complete save data
[INFOR] TOLTAL TIME: 80.2709
